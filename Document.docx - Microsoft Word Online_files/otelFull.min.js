var otelFull=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([,,,,function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){var r=n(8),i=n(9),o=i;o.v1=r,o.v4=i,e.exports=o},,function(e,t,n){var r,i,o=n(4),a=n(5),s=0,c=0;e.exports=function(e,t,n){var u=t&&n||0,l=t||[],d=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==f){var p=o();null==d&&(d=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==f&&(f=i=16383&(p[6]<<8|p[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:c+1,g=h-s+(v-c)/1e4;if(g<0&&void 0===e.clockseq&&(f=f+1&16383),(g<0||h>s)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,c=v,i=f;var m=(1e4*(268435455&(h+=122192928e5))+v)%4294967296;l[u++]=m>>>24&255,l[u++]=m>>>16&255,l[u++]=m>>>8&255,l[u++]=255&m;var y=h/4294967296*1e4&268435455;l[u++]=y>>>8&255,l[u++]=255&y,l[u++]=y>>>24&15|16,l[u++]=y>>>16&255,l[u++]=f>>>8|128,l[u++]=255&f;for(var T=0;T<6;++T)l[u+T]=d[T];return t||a(l)}},function(e,t,n){var r=n(4),i=n(5);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},function(e,t,n){"use strict";n.r(t);var r,i,o=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),a=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}();!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout"}(i||(i={}));!function(){function e(){}e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.getLogMessage=function(t,n,r){return"tag_"+e.tagIntToString(t)+" ["+i[n]+"] "+r},e.prototype.sendTraceTag=function(t,n,i,o){var a=console.log;switch(i){case r.Error:a=console.error;break;case r.Warning:a=console.warn;break;case r.Info:a=console.info;break;case r.Verbose:a=console.debug;break;case r.Spam:default:a=console.log}try{a(e.getLogMessage(t,n,o))}catch(e){var s="undefined"!=typeof navigator?navigator:void 0;if(s&&!/rv:11.0/i.test(s.userAgent))throw e}},e.prototype.shipAssertTag=function(t,n,r,i){console.assert(r,e.getLogMessage(t,n,i))},e.prototype.debugAssertTag=function(e,t,n,r){this.shipAssertTag(e,t,n,r)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789"}();var s,c=new(function(){function e(){this.externalLogger=new a}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,r){this.externalLogger.sendTraceTag(e,t,n,r)},e.prototype.debugAssertTag=function(e,t,n,r){this.externalLogger.debugAssertTag(e,t,n,r)},e.prototype.shipAssertTag=function(e,t,n,r){this.externalLogger.shipAssertTag(e,t,n,r)},e}());function u(e,t,n,r){var i=e.map((function(e){return function(e,t){var n={};n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category;var r=1e3*e.type+e.level;return n.D=r,n}(e,r)})),o=function(e,t,n,r){var i={};return i.T=e,i.L=t,i.S=n,i.I=r,i.V=1,i}(r,i,t,n);return JSON.stringify(o)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(s||(s={}));!function(){function e(t,n){var r=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){r.triggerUpload(!1,!1)},this.flush=function(){r.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return r.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,n){(window.clearTimeout(r.timeoutId),r.logCache.length>0)&&(r.uploadId+=1,function(e,t,n){if(""!==t)if(navigator&&navigator.sendBeacon)navigator.sendBeacon(t,e);else{var r=new XMLHttpRequest;r.readyState!==XMLHttpRequest.UNSENT&&r.readyState!==XMLHttpRequest.DONE||(r.open("POST",t,n),r.send(e))}}(u(r.logCache,r.userSessionId,r.uploadId,r.timestampBase),r.remoteUrlEndpoint,n),r.logCache=[],r.timestampBase=Date.now());t&&(r.timeoutId=window.setTimeout(r.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=n+"?usid="+t,window.setTimeout((function(){return r.triggerUpload(!0,!0)}),0)}e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===r.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]"}();r.Info;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(function(e,t){function n(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)})(t,e)}(a);var d,f,p,h,v,g,m,y=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),T=new y;function S(e,t,n){T.fireEvent({level:e,category:t,message:n})}function b(e,t){return{name:e,dataType:v.Boolean,value:t,classification:m.SystemMetadata}}function E(e,t){return{name:e,dataType:v.Int64,value:t,classification:m.SystemMetadata}}function w(e,t){return{name:e,dataType:v.Double,value:t,classification:m.SystemMetadata}}function _(e,t){return{name:e,dataType:v.String,value:t,classification:m.SystemMetadata}}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(d||(d={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(f||(f={})),function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(p||(p={})),function(e){var t={},n={},r={};function i(e){if("object"!=typeof e)throw new Error("tokenTree must be an object");r=function e(t,n){if("object"!=typeof n)return n;for(var r=0,i=Object.keys(n);r<i.length;r++){var o=i[r];o in t&&(t[o],1)?t[o]=e(t[o],n[o]):t[o]=n[o]}return t}(r,e)}function o(e){if(t[e])return t[e];var n=s(e,p.Aria);return"string"==typeof n?(t[e]=n,n):void 0}function a(e){if(n[e])return n[e];var t=s(e,p.Nexus);return"number"==typeof t?(n[e]=t,t):void 0}function s(e,t){var n=e.split("."),i=r,o=void 0;if(i){for(var a=0;a<n.length-1;a++)i[n[a]]&&(i=i[n[a]],t===p.Aria&&"string"==typeof i.ariaTenantToken?o=i.ariaTenantToken:t===p.Nexus&&"number"==typeof i.nexusTenantToken&&(o=i.nexusTenantToken));return o}}e.setTenantToken=function(e,t,n){var r=e.split(".");if(r.length<2||"Office"!==r[0])S(d.Error,f.Core,(function(){return"Invalid namespace: "+e}));else{var o=Object.create(Object.prototype);t&&(o.ariaTenantToken=t),n&&(o.nexusTenantToken=n);var a,s=o;for(a=r.length-1;a>=0;--a){var c=Object.create(Object.prototype);c[r[a]]=s,s=c}i(s)}},e.setTenantTokens=i,e.getTenantTokens=function(e){var t=o(e),n=a(e);if(!n||!t)throw new Error("Could not find tenant token for "+e);return{ariaTenantToken:t,nexusTenantToken:n}},e.getAriaTenantToken=o,e.getNexusTenantToken=a,e.clear=function(){t={},n={},r={}}}(h||(h={})),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Guid=4]="Guid"}(v||(v={})),function(e){var t=/^[A-Z][a-zA-Z0-9]*$/,n=/^[a-zA-Z0-9_\.]*$/;function r(e){return void 0!==e&&n.test(e)}function i(e){if(!((t=e.name)&&r(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===v.Int64&&o(e.value)}function o(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var n=e.split("."),r=n[n.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(n)&&(i=r,void 0!==i&&t.test(i));var i}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!r(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var n=0;n<e.dataFields.length;n++)i(e.dataFields[n])},e.validateInt=o}(g||(g={})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(m||(m={}));var C,x=function(){return(x=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},O=function(){function e(e,t,n){var r,i;this.onSendEvent=new y,this.persistentDataFields=[],this.config=n||{},e?(this.onSendEvent=e.onSendEvent,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=x(x({},e.getConfig()),this.config)):this.persistentDataFields.push(_("OTelJS.Version","3.1.59")),t&&(i=this.persistentDataFields).push.apply(i,t)}return e.prototype.sendTelemetryEvent=function(e){var t;try{if(0===this.onSendEvent.getListenerCount())return void S(d.Warning,f.Core,(function(){return"No telemetry sinks are attached."}));t=this.cloneEvent(e),this.processTelemetryEvent(t)}catch(e){return void function(e,t,n){S(d.Error,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}(f.Core,"SendTelemetryEvent",e)}try{this.onSendEvent.fireEvent(t)}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t;e.telemetryProperties||(e.telemetryProperties=h.getTenantTokens(e.eventName)),e.dataFields&&this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields),this.config.disableValidation||g.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.onSendEvent.addListener((function(t){return e.sendTelemetryEvent(t)}))},e.prototype.setTenantToken=function(e,t,n){h.setTenantToken(e,t,n)},e.prototype.setTenantTokens=function(e){h.setTenantTokens(e)},e.prototype.cloneEvent=function(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return e.telemetryProperties&&(t.telemetryProperties={ariaTenantToken:e.telemetryProperties.ariaTenantToken,nexusTenantToken:e.telemetryProperties.nexusTenantToken}),e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t},e.prototype.getConfig=function(){return this.config},e}();!function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new r(t,++n)},e.getNextChild=function(e){return new r(e.getString(),++e.nextChild)};var r=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=r}(C||(C={}));var I=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},N=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},P=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(P=function(){return 1e3*Math.floor(window.performance.now())});var k,A,M,F,D,L,U,R,W,B=function(){function e(e,t,n){this._optionalEventFlags={},this._ended=!1,this._telemetryLogger=e,this._activityName=t,this._cv=n?C.getNextChild(n._cv):C.getNext(),this._dataFields=[],this._success=void 0,this._startTime=P()}return e.createNew=function(t,n){return new e(t,n)},e.prototype.createChildActivity=function(t){return new e(this._telemetryLogger,t,this)},e.prototype.setEventFlags=function(e){this._optionalEventFlags=e},e.prototype.addDataField=function(e){this._dataFields.push(e)},e.prototype.addDataFields=function(e){var t;(t=this._dataFields).push.apply(t,e)},e.prototype.setSuccess=function(e){this._success=e},e.prototype.setResult=function(e,t,n){this._result={code:e,type:t,tag:n}},e.prototype.endNow=function(){if(!this._ended){void 0===this._success&&void 0===this._result&&S(d.Warning,f.Core,(function(){return"Activity does not have success or result set"}));var e=P()-this._startTime;this._ended=!0;var t={duration:e,count:1,aggMode:0,cV:this._cv.getString(),success:this._success,result:this._result};return this._telemetryLogger.sendActivity(this._activityName,t,this._dataFields,this._optionalEventFlags)}S(d.Error,f.Core,(function(){return"Activity has already ended"}))},e.prototype.executeAsync=function(e){return I(this,void 0,void 0,(function(){var t=this;return N(this,(function(n){return[2,e(this).then((function(e){return t.endNow(),e})).catch((function(e){throw t.endNow(),e}))]}))}))},e.prototype.executeSync=function(e){try{var t=e(this);return this.endNow(),t}catch(e){throw this.endNow(),e}},e.prototype.executeChildActivityAsync=function(e,t){return I(this,void 0,void 0,(function(){return N(this,(function(n){return[2,this.createChildActivity(e).executeAsync(t)]}))}))},e.prototype.executeChildActivitySync=function(e,t){return this.createChildActivity(e).executeSync(t)},e}();function z(e,t,n){e.push(_("zC."+t,n))}(k||(k={})).getFields=function(e,t){var n=[];return n.push(E(e+".Code",t.code)),void 0!==t.type&&n.push(_(e+".Type",t.type)),void 0!==t.tag&&n.push(E(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push(b(e+".IsExpected",t.isExpected)),z(n,e,"Office.System.Result"),n},(M=A||(A={})).contractName="Office.System.Activity",M.getFields=function(e){var t=[];return void 0!==e.cV&&t.push(_("Activity.CV",e.cV)),t.push(E("Activity.Duration",e.duration)),t.push(E("Activity.Count",e.count)),t.push(E("Activity.AggMode",e.aggMode)),void 0!==e.success&&t.push(b("Activity.Success",e.success)),void 0!==e.result&&t.push.apply(t,k.getFields("Activity.Result",e.result)),z(t,"Activity",M.contractName),t},(F||(F={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(_(e+".Id",t.id)),void 0!==t.version&&n.push(_(e+".Version",t.version)),void 0!==t.sessionId&&n.push(_(e+".SessionId",t.sessionId)),z(n,e,"Office.System.Host"),n},(D||(D={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(_(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push(_(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(_(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(_(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push(_(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push(b(e+".IsAnonymous",t.isAnonymous)),z(n,e,"Office.System.User"),n},(L||(L={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(_(e+".Id",t.id)),void 0!==t.version&&n.push(_(e+".Version",t.version)),void 0!==t.instanceId&&n.push(_(e+".InstanceId",t.instanceId)),void 0!==t.name&&n.push(_(e+".Name",t.name)),void 0!==t.marketplaceType&&n.push(_(e+".MarketplaceType",t.marketplaceType)),void 0!==t.sessionId&&n.push(_(e+".SessionId",t.sessionId)),void 0!==t.browserToken&&n.push(_(e+".BrowserToken",t.browserToken)),void 0!==t.osfRuntimeVersion&&n.push(_(e+".OsfRuntimeVersion",t.osfRuntimeVersion)),void 0!==t.officeJsVersion&&n.push(_(e+".OfficeJsVersion",t.officeJsVersion)),void 0!==t.hostJsVersion&&n.push(_(e+".HostJsVersion",t.hostJsVersion)),void 0!==t.assetId&&n.push(_(e+".AssetId",t.assetId)),void 0!==t.providerName&&n.push(_(e+".ProviderName",t.providerName)),void 0!==t.type&&n.push(_(e+".Type",t.type)),z(n,e,"Office.System.SDX"),n},(U||(U={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(_(e+".Name",t.name)),void 0!==t.state&&n.push(_(e+".State",t.state)),z(n,e,"Office.System.Funnel"),n},(R||(R={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(E(e+".Id",t.id)),void 0!==t.name&&n.push(_(e+".Name",t.name)),void 0!==t.commandSurface&&n.push(_(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push(_(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push(_(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(E(e+".TimeOffsetMs",t.timeOffsetMs)),z(n,e,"Office.System.UserAction"),n},function(e){e.getFields=function(e,t){var n=[];return n.push(_(e+".ErrorGroup",t.errorGroup)),n.push(E(e+".Tag",t.tag)),void 0!==t.code&&n.push(E(e+".Code",t.code)),void 0!==t.id&&n.push(E(e+".Id",t.id)),void 0!==t.count&&n.push(E(e+".Count",t.count)),z(n,e,"Office.System.Error"),n}}(W||(W={}));var V,j=A,H=k,q=W,K=U,G=F,J=L,X=R,Q=D;!function(e){!function(e){!function(e){e.Activity=j,e.Result=H,e.Error=q,e.Funnel=K,e.Host=G,e.SDX=J,e.User=Q,e.UserAction=X}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(V||(V={}));var Z,$,Y=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},te=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Y(t,e),t.prototype.executeActivityAsync=function(e,t){return ee(this,void 0,void 0,(function(){return te(this,(function(n){return[2,this.createNewActivity(e).executeAsync(t)]}))}))},t.prototype.executeActivitySync=function(e,t){return this.createNewActivity(e).executeSync(t)},t.prototype.createNewActivity=function(e){return B.createNew(this,e)},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:V.Office.System.Activity.contractName,dataFields:V.Office.System.Activity.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){var t=V.Office.System.Error.getFields("Error",e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t}(O),re=new(function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}());function ie(e,t,n){re.fireEvent({level:e,category:t,message:n})}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(Z||(Z={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}($||($={}));
/*!
 * Microsoft Dynamic Proto Utility, 1.0.0
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var oe=Object.getPrototypeOf,ae=0;function se(e,t){return e&&Object.prototype.hasOwnProperty.call(e,t)}function ce(e){return"function"==typeof e}function ue(e){return e&&(e===Object.prototype||e===Array.prototype)}function le(e){return ue(e)||e===Function.prototype}function de(e){if(e){if(oe)return oe(e);var t=e.__proto__||e.prototype||e.constructor;if(t)return t}return null}function fe(e,t,n){return"constructor"!==t&&ce(e[t])&&(n||se(e,t))}function pe(e){throw new TypeError("DynamicProto: "+e)}function he(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function ve(e,t){return se(e,"prototype")?e.name||t||"_unknown_":((e||{}).constructor||{}).name||t||"_unknown_"}var ge=function(e,t,n){se(e,"prototype")||pe("theClass is an invalid class definition.");var r=e.prototype;(function(e,t){for(var n=de(t);n&&!le(n);){if(n===e)return!0;n=de(n)}return!1})(r,t)||pe("["+ve(e)+"] is not in class heirarchy of ["+ve(t)+"]");var i=null;se(r,"_dynClass")?i=r._dynClass:(i="_dynCls$"+ve(e,"_")+"$"+ae,ae++,r._dynClass=i);var o=function(e){var t={};for(var n in e)!t[n]&&fe(e,n,!1)&&(t[n]=e[n]);return t}(t);n(t,function(e,t,n){function r(e,t){return function(){return t.apply(e,arguments)}}var i={};for(var o in n)i[o]=r(t,n[o]);for(var a=de(e),s=[];a&&!le(a)&&!he(s,a);){for(var o in a)!i[o]&&fe(a,o,!oe)&&(i[o]=r(t,a[o]));s.push(a),a=de(a)}return i}(r,t,o)),function(e,t,n,r){function i(e,t){var n=function(){var r=this;if(r&&se(e,"_dynClass")){var i=((r._dynInstFuncs||{})[e._dynClass]||{})[t];if(i)return i.apply(r,arguments);pe("Missing ["+t+"] function")}var o=e[t];return o===n&&(o=de(e)[t]),ce(o)||pe("["+t+"] is not a function"),o.apply(r,arguments)};return n._isDynProxy=1,n}if(!ue(e)){var o=n._dynInstFuncs=n._dynInstFuncs||{},a=o[t]=o[t]||{};for(var s in n)fe(n,s,!1)&&n[s]!==r[s]&&(a[s]=n[s],delete n[s],(!se(e,s)||e[s]&&!e[s]._isDynProxy)&&(e[s]=i(e,s)))}}(r,i,t,o)};function me(){return"undefined"!=typeof globalThis&&globalThis?globalThis:"undefined"!=typeof self&&self?self:"undefined"!=typeof window&&window?window:"undefined"!=typeof global&&global?global:null}function ye(e){var t=Object.create;if(t)return t(e);if(null==e)return{};var n=typeof e;if("object"!==n&&"function"!==n)throw new TypeError("Object prototype may only be an Object:"+e);function r(){}return r.prototype=e,new r}var Te=function(e,t){return(Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var Se,be,Ee,we=me()||{};be=function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ee=function(e,t){function n(){this.constructor=e}Te(e,t),e.prototype=null===t?ye(t):(n.prototype=t.prototype,new n)},(Se=we).__assign=Se.__assign||Object.assign||be,Se.__extends=Se.__extends||Ee,__assign=we.__assign,__extends=we.__extends;var _e=me;function Ce(e){var t=_e();return t&&t[e]?t[e]:"window"===e&&xe()?window:null}function xe(){return Boolean("object"==typeof window&&window)}function Oe(){return xe()?window:Ce("window")}function Ie(){return Boolean("object"==typeof document&&document)?document:Ce("document")}function Ne(){return Boolean("object"==typeof navigator&&navigator)}function Pe(){return Ne()?navigator:Ce("navigator")}function ke(){return"object"==typeof location&&location?location:Ce("location")}function Ae(){return Boolean("object"==typeof JSON&&JSON||null!==Ce("JSON"))}function Me(e,t){return typeof e===t}function Fe(e){return Me(e,"undefined")||void 0===e}function De(e){return Fe(e)||null===e}function Le(e,t){return e&&Object.prototype.hasOwnProperty.call(e,t)}function Ue(e){return Me(e,"object")}function Re(e){return Me(e,"function")}function We(e,t,n,r){void 0===r&&(r=!1);var i=!1;if(!De(e))try{De(e.addEventListener)?De(e.attachEvent)||(e.attachEvent("on"+t,n),i=!0):(e.addEventListener(t,n,r),i=!0)}catch(e){}return i}function Be(e,t,n,r){if(void 0===r&&(r=!1),!De(e))try{De(e.removeEventListener)?De(e.detachEvent)||e.detachEvent("on"+t,n):e.removeEventListener(t,n,r)}catch(e){}}var ze,Ve=function(){function e(){}return e.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.isError=function(e){return"[object Error]"===Object.prototype.toString.call(e)},e.isString=function(e){return Me(e,"string")},e.isNumber=function(e){return Me(e,"number")},e.isBoolean=function(e){return Me(e,"boolean")},e.disableCookies=function(){e._canUseCookies=!1},e.newGuid=function(){function e(){var e=Ce("crypto");return e?e.getRandomValues(new Uint8Array(1))[0]%16:16*Math.random()}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(je,(function(t){var n=0|e();return("x"===t?n:3&n|8).toString(16)}))},e.toISOString=function(t){if(e.isDate(t)){var n=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},e.arrForEach=function(e,t,n){for(var r=e.length,i=0;i<r;i++)i in e&&t.call(n||e,e[i],i,e)},e.arrIndexOf=function(e,t,n){for(var r=e.length,i=n||0,o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===t)return o;return-1},e.arrMap=function(e,t,n){for(var r=e.length,i=n||e,o=new Array(r),a=0;a<r;a++)a in e&&(o[a]=t.call(i,e[a],e));return o},e.arrReduce=function(e,t,n){var r,i=e.length,o=0;if(arguments.length>=3)r=arguments[2];else{for(;o<i&&!(o in e);)o++;r=e[o++]}for(;o<i;)o in e&&(r=t(r,e[o],o,e)),o++;return r},e.strTrim=function(t){return e.isString(t)?t.replace(/^\s+|\s+$/g,""):t},e.objKeys=function(e){var t=!{toString:null}.propertyIsEnumerable("toString");if(!(Re(e)||Ue(e)&&null!==e))throw new TypeError("objKeys called on non-object");var n=[];for(var r in e)Le(e,r)&&n.push(r);if(t)for(var i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=i.length,a=0;a<o;a++)Le(e,i[a])&&n.push(i[a]);return n},e.objDefineAccessors=function(e,t,n,r){var i=Object.defineProperty;if(i)try{var o={enumerable:!0,configurable:!0};return n&&(o.get=n),r&&(o.set=r),i(e,t,o),!0}catch(e){}return!1},e.addEventHandler=function(e,t){var n=!1,r=Oe();r&&(n=We(r,e,t),n=We(r.body,e,t)||n);var i=Ie();return i&&(n=He.Attach(i,e,t)||n),n},e.dateNow=function(){var e=Date;return e.now?e.now():(new e).getTime()},e.perfNow=function(){var t=Ce("performance");return t&&t.now?t.now():e.dateNow()},e.isTypeof=Me,e.isUndefined=Fe,e.isNullOrUndefined=De,e.hasOwnProperty=Le,e.isFunction=Re,e.isObject=Ue,e.objCreate=ye,e}(),je=/[xy]/g,He=function(){function e(){}return e.Attach=We,e.AttachEvent=We,e.Detach=Be,e.DetachEvent=Be,e}(),qe=function(){function e(t,n,r){var i,o=this,a=!1;(o.start=Ve.dateNow(),o.name=t,o.isAsync=r,o.isChildEvt=function(){return!1},Ve.isFunction(n))&&(a=Ve.objDefineAccessors(o,"payload",(function(){return!i&&Ve.isFunction(n)&&(i=n(),n=null),i})));o.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?o[t]:(o.ctx||{})[t]:null},o.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)o[t]||(o.isChildEvt=function(){return!0}),o[t]=n;else if(t===e.ChildrenContextKey)o[t]=n;else{(o.ctx=o.ctx||{})[t]=n}},o.complete=function(){var t=0,r=o.getCtx(e.ChildrenContextKey);if(Ve.isArray(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(t+=s.time)}o.time=Ve.dateNow()-o.start,o.exTime=o.time-t,o.complete=function(){},!a&&Ve.isFunction(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Ke=function(){function e(t){this.ctx={},ge(e,this,(function(e){e.create=function(e,t,n){return new qe(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))}return e.prototype.create=function(e,t,n){return null},e.prototype.fire=function(e){},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e}();function Ge(e,t,n,r,i){if(e){var o=e;if(o&&Ve.isFunction(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx("CoreUtils.doPerf");try{if(a=o.create(t(),r,i)){if(s&&a.setCtx&&(a.setCtx(qe.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(qe.ChildrenContextKey);c||(c=[],s.setCtx(qe.ChildrenContextKey,c)),c.push(a)}return o.setCtx("CoreUtils.doPerf",a),n(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&o.fire(a),o.setCtx("CoreUtils.doPerf",s)}}}return n()}!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(ze||(ze={}));var Je={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100};function Xe(e){return e?'"'+e.replace(/\"/g,"")+'"':""}var Qe=function(){function e(e,t,n,r){void 0===n&&(n=!1);this.messageId=e,this.message=(n?"AI: ":"AI (Internal): ")+e;var i="";Ae()&&(i=(Ae()?JSON||Ce("JSON"):null).stringify(r));var o=(t?" message:"+Xe(t):"")+(r?" props:"+Xe(i):"");this.message+=o}return e.dataType="MessageData",e}(),Ze=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={};ge(e,this,(function(e){var i=Ve.isNullOrUndefined,o=Ve.isUndefined,a=Ve.isFunction;function s(e,n){var r=t[e];return i(r)?n:r}i(t)&&(t={}),e.consoleLoggingLevel=function(){return s("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return s("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return s("maxMessageLimit",25)},e.enableDebugExceptions=function(){return s("enableDebugExceptions",!1)},e.throwInternal=function(t,n,i,a,s){void 0===s&&(s=!1);var c=new Qe(n,i,s,a);if(e.enableDebugExceptions())throw c;if(!o(c)&&c&&!o(c.message)){if(s){var u=+c.messageId;!r[u]&&e.consoleLoggingLevel()>=ze.WARNING&&(e.warnToConsole(c.message),r[u]=!0)}else e.consoleLoggingLevel()>=ze.WARNING&&e.warnToConsole(c.message);e.logInternalMessage(t,c)}},e.warnToConsole=function(e){var t="undefined"!=typeof console?console:Ce("console");if(t){var n="log";t.warn&&(n="warn"),a(t[n])&&t[n](e)}},e.resetInternalMessageCount=function(){n=0,r={}},e.logInternalMessage=function(t,i){if(!(n>=e.maxInternalMessageLimit())){var o=!0,a="AITR_"+i.messageId;if(r[a]?o=!1:r[a]=!0,o&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(i),n++),n===e.maxInternalMessageLimit())){var s="Internal events throttle limit per PageView reached for this app.",c=new Qe(Je.MessageLimitPerPVExceeded,s,!1);e.queue.push(c),e.warnToConsole(s)}}}}))}return e.prototype.enableDebugExceptions=function(){return!1},e.prototype.consoleLoggingLevel=function(){return 0},e.prototype.telemetryLoggingLevel=function(){return 1},e.prototype.maxInternalMessageLimit=function(){return 25},e.prototype.throwInternal=function(e,t,n,r,i){void 0===i&&(i=!1)},e.prototype.warnToConsole=function(e){},e.prototype.resetInternalMessageCount=function(){},e.prototype.logInternalMessage=function(e,t){},e}(),$e=Ve.isFunction,Ye=function(e,t){var n=this,r=null,i=$e(e.processTelemetry),o=$e(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return r},n.setNext=function(e){r=e},n.processTelemetry=function(a,s){s||(s=t);var c=e?e.identifier:"TelemetryPluginChain";Ge(s?s.core():null,(function(){return c+":processTelemetry"}),(function(){if(e&&i){n._hasRun=!0;try{s.setNext(r),o&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(a,s)}catch(n){var t=r&&r._hasRun;r&&t||s.diagLog().throwInternal(ze.CRITICAL,Je.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+n),r&&!t&&r.processTelemetry(a,s)}}else r&&(n._hasRun=!0,r.processTelemetry(a,s))}),(function(){return{item:a}}),!a.sync)}},et=Ve.isNullOrUndefined;function tt(e,t){var n=[];if(e&&e.length>0)for(var r=null,i=0;i<e.length;i++){var o=e[i];if(o&&Ve.isFunction(o.processTelemetry)){var a=new Ye(o,t);n.push(a),r&&r.setNext(a),r=a}}return n.length>0?n[0]:null}var nt=function e(t,n,r,i){var o=this,a=null;null!==i&&(t&&Ve.isFunction(t.getPlugin)?a=function(e,t,n){var r=[],i=!n;if(e)for(;e;){var o=e.getPlugin();(i||o===n)&&(i=!0,r.push(o)),e=e.getNext()}return i||r.push(n),tt(r,t)}(t,o,i||t.getPlugin()):i?a=function(e,t,n){var r=e,i=!1;return n&&e&&(r=[],Ve.arrForEach(e,(function(e){(i||e===n)&&(i=!0,r.push(e))}))),n&&!i&&(r||(r=[]),r.push(n)),tt(r,t)}(t,o,i):Ve.isUndefined(i)&&(a=tt(t,o))),o.core=function(){return r},o.diagLog=function(){var e=(r||{}).logger;return e||(e=new Ze(n||{})),e},o.getCfg=function(){return n},o.getExtCfg=function(e,t){var r;if(void 0===t&&(t={}),n){var i=n.extensionConfig;i&&e&&(r=i[e])}return r||t},o.getConfig=function(e,t,r){var i;void 0===r&&(r=!1);var a=o.getExtCfg(e,null);return a&&!et(a[t])?i=a[t]:n&&!et(n[t])&&(i=n[t]),et(i)?r:i},o.hasNext=function(){return null!=a},o.getNext=function(){return a},o.setNext=function(e){a=e},o.processNext=function(e){var t=a;t&&(a=t.getNext(),t.processTelemetry(e,o))},o.createNew=function(t,i){return void 0===t&&(t=null),new e(t||a,n,r,i)}},rt=Ve.isFunction,it=function(){function e(){var e=this,t=!1,n=null,r=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,t){t?t.processNext(e):r&&rt(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var i=t;if(!i){var o=n||new nt(null,{},e.core);i=r&&r.getPlugin?o.createNew(null,r.getPlugin):o.createNew(null,r)}return i},e._baseTelInit=function(i,o,a,s){i&&(i.extensionConfig=i.extensionConfig||[]),!s&&o&&(s=o.getProcessTelContext().getNext());var c=r;r&&r.getPlugin&&(c=r.getPlugin()),e.core=o,n=new nt(s,i,o,c),t=!0}}return e.prototype.initialize=function(e,t,n,r){this._baseTelInit(e,t,n,r)},e}(),ot=Ve.isFunction;function at(e,t){for(var n=[],r=null,i=e.getNext();i;){var o=i.getPlugin();o&&(r&&ot(r.setNextPlugin)&&ot(o.processTelemetry)&&r.setNextPlugin(o),ot(o.isInitialized)&&o.isInitialized()||n.push(o),r=o,i=i.getNext())}Ve.arrForEach(n,(function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function st(e){return e.sort((function(e,t){var n=0,r=ot(t.processTelemetry);return ot(e.processTelemetry)?n=r?e.priority-t.priority:1:r&&(n=-1),n}))}var ct=Ve.objDefineAccessors,ut=function(e){function t(){var n=e.call(this)||this;n.identifier="ChannelControllerPlugin",n.priority=500;var r,i=Ve.arrForEach;function o(e){e&&e.length>0&&(function(e){i(e,(function(e){if(e.priority<500)throw Error("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),r.push(e))}return ge(t,n,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){r&&i(r,(function(r){r.length>0&&n._getTelCtx(t).createNew(r).processNext(e)}))},e.getChannelControls=function(){return r},e.initialize=function(n,a,s){e.isInitialized()||(t.initialize(n,a,s),n.isCookieUseDisabled&&Ve.disableCookies(),function(e,t){r=[],e&&i(e,(function(e){return o(e)}));if(t){var n=[];i(t,(function(e){e.priority>500&&n.push(e)})),o(n)}}((n||{}).channels,s),i(r,(function(e){return at(new nt(e,n,a),s)})))}})),n}return __extends(t,e),t.prototype.processTelemetry=function(e,t){},t.prototype.getChannelControls=function(){return null},t.prototype.initialize=function(e,t,n){},t._staticInit=(ct(t.prototype,"ChannelControls",t.prototype.getChannelControls),void ct(t.prototype,"channelQueue",t.prototype.getChannelControls)),t}(it),lt=Ve.arrForEach,dt=Ve.isNullOrUndefined,ft=function(){function e(){var t,n,r,i,o=!1;ge(e,this,(function(e){e._extensions=new Array,n=new ut,t=[],e.isInitialized=function(){return o},e.initialize=function(t,i,a,s){if(e.isInitialized())throw Error("Core should not be initialized more than once");if(!t||dt(t.instrumentationKey))throw Error("Please provide instrumentation key");r=s,e._notificationManager=s,e.config=t||{},t.extensions=dt(t.extensions)?[]:t.extensions,(t.extensionConfig=dt(t.extensionConfig)?{}:t.extensionConfig).NotificationManager=s,a||(a=Ve.objCreate({throwInternal:function(e,t,n,r,i){void 0===i&&(i=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}})),e.logger=a;var c=[];c.push.apply(c,i.concat(t.extensions)),c=st(c);var u=[],l=[],d={};if(lt(c,(function(e){if(dt(e)||dt(e.initialize))throw Error("Extensions must provide callback to initialize");var t=e.priority,r=e.identifier;e&&t&&(dt(d[t])?d[t]=r:a.warnToConsole("Two extensions have same priority #"+t+" - "+d[t]+", "+r)),!t||t<n.priority?u.push(e):l.push(e)})),c.push(n),u.push(n),c=st(c),e._extensions=c,at(new nt([n],t,e),c),at(new nt(u,t,e),c),e._extensions=u,0===e.getTransmissionControls().length)throw new Error("No channels available");o=!0,e.releaseQueue()},e.getTransmissionControls=function(){return n.getChannelControls()},e.track=function(n){n.iKey||(n.iKey=e.config.instrumentationKey),n.time||(n.time=Ve.toISOString(new Date)),dt(n.ver)&&(n.ver="4.0"),e.isInitialized()?e.getProcessTelContext().processNext(n):t.push(n)},e.getProcessTelContext=function(){var t=e._extensions,r=t;return t&&0!==t.length||(r=[n]),new nt(r,e.config,e)},e.getNotifyMgr=function(){return r||(r=Ve.objCreate({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e._notificationManager=r),r},e.getPerfMgr=function(){return i||e.config&&e.config.enablePerfMgr&&(i=new Ke(e.getNotifyMgr())),i},e.setPerfMgr=function(e){i=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(lt(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))}return e.prototype.initialize=function(e,t,n,r){},e.prototype.getTransmissionControls=function(){return null},e.prototype.track=function(e){},e.prototype.getProcessTelContext=function(){return null},e.prototype.getNotifyMgr=function(){return null},e.prototype.getPerfMgr=function(){return null},e.prototype.setPerfMgr=function(e){},e.prototype.eventCnt=function(){return 0},e.prototype.releaseQueue=function(){},e}(),pt=0,ht=1,vt=2,gt=4,mt=5,yt=function(){function e(t){this.listeners=[];var n=Ve.arrForEach,r=!!(t||{}).perfEvtsSendAll;ge(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=Ve.arrIndexOf(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=Ve.arrIndexOf(e.listeners,t)},e.eventsSent=function(t){n(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,r){n(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,r)}),0)}))},e.eventsSendRequest=function(t,r){n(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(r)setTimeout((function(){return e.eventsSendRequest(t,r)}),0);else try{e.eventsSendRequest(t,r)}catch(e){}}))},e.perfEvent=function(t){t&&(!r&&t.isChildEvt()||n(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}})))}}))}return e.prototype.addNotificationListener=function(e){},e.prototype.removeNotificationListener=function(e){},e.prototype.eventsSent=function(e){},e.prototype.eventsDiscarded=function(e,t){},e.prototype.eventsSendRequest=function(e,t){},e}(),Tt=function(e){function t(){var n=e.call(this)||this;return ge(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],vt)}e.initialize=function(e,n,r,i){t.initialize(e,n,r||new Ze(e),i||new yt(e))},e.track=function(r){Ge(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){if(null===r)throw n(r),Error("Invalid telemetry item");!function(e){if(Ve.isNullOrUndefined(e.name))throw n(e),Error("telemetry name required")}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)},e.addNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.addNotificationListener(t)},e.removeNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.removeNotificationListener(t)},e.pollInternalLogs=function(t){var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),setInterval((function(){var n=e.logger?e.logger.queue:[];Ve.arrForEach(n,(function(n){var r={name:t||"InternalMessageId: "+n.messageId,iKey:e.config.instrumentationKey,time:Ve.toISOString(new Date),baseType:Qe.dataType,baseData:{message:n.message}};e.track(r)})),n.length=0}),n)}})),n}return __extends(t,e),t.prototype.initialize=function(e,t,n,r){},t.prototype.track=function(e){},t.prototype.addNotificationListener=function(e){},t.prototype.removeNotificationListener=function(e){},t.prototype.pollInternalLogs=function(e){return 0},t}(ft),St=1,bt=2,Et=3,wt={Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9},_t=__assign({},Je,{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519}),Ct=wt,xt=null;var Ot=Ve.isUndefined,It=Ve.isNullOrUndefined;function Nt(e){return!Ot(e)}Ve.hasOwnProperty;var Pt,kt=null,At=Ve.arrForEach,Mt=(Ve.arrIndexOf,Ve.arrMap,Ve.arrReduce,Ve.objKeys),Ft=(Ve.toISOString,function(){var e=Pe();return!(!e||!e.product)&&"ReactNative"===e.product}),Dt=Ve.isString,Lt=Ve.isNumber,Ut=Ve.isBoolean,Rt=(Ve.isFunction,Ve.isArray),Wt=(Ve.isObject,Ve.strTrim),Bt=(Boolean(Ie()),Boolean(Oe()));function zt(e){return!(It(e)||""===e)}function Vt(){return null===kt&&(kt=Ne()&&Boolean(Pe().sendBeacon)),kt}function jt(e,t,n){if(!Dt(e)||It(t)||""===t)return null;if(Dt(t)||Lt(t)||Ut(t)||Rt(t))t={value:t};else if("object"!=typeof t||t.hasOwnProperty("value")){if(It(t.value)||""===t.value||!Dt(t.value)&&!Lt(t.value)&&!Ut(t.value)&&!Rt(t.value))return null}else t={value:n?JSON.stringify(t):t};if(Rt(t.value)&&!(t.value.length>0))return null;if(Nt(t.kind)){if(Rt(t.value)||!function(e){if(Lt(e)&&(e>=0&&e<=13||32===e))return!0;return!1}(t.kind))return null;t.value=t.value.toString()}return t}function Ht(e,t,n){var r=-1;return Ot(e)?r:(t&&t>0&&(32===t?r=1<<13:t<=13&&(r=t<<5)),Nt(n)&&function(e){if(Lt(e)&&e>=0&&e<=9)return!0;return!1}(n)?(-1===r&&(r=0),r|n):(Rt(e)&&(e=e[0]),-1!==r?r|function(e){if(Ot(e))return-1;if(Lt(e))return Ct.Double;if(Dt(e))return Ct.String;if(Ut(e))return Ct.Bool;return-1}(e):Lt(e)?Ct.Double:r))}function qt(){if(void 0===Pt){Pt=!1;try{var e=Ie(),t=Pe();e&&!Ot(e.cookie)&&t&&t.cookieEnabled&&(Pt=!0)}catch(e){}}return Pt}function Kt(e,t,n){if(qt()){var r="",i=ke();i&&"https:"===i.protocol&&(r=";secure",null===xt&&(xt=function(e){return!!Dt(e)&&(-1!==e.indexOf("CPU iPhone OS 12")||-1!==e.indexOf("iPad; CPU OS 12")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&-1!==e.indexOf("Version/")&&-1!==e.indexOf("Safari")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&(n="AppleWebKit/605.1.15 (KHTML, like Gecko)",r=(t=e).length,i=r-n.length,t.substring(i>=0?i:0,r)===n)||(-1!==e.indexOf("Chrome/5")||-1!==e.indexOf("Chrome/6")||(-1!==e.indexOf("UnrealEngine")&&-1===e.indexOf("Chrome")||(-1!==e.indexOf("UCBrowser/12")||-1!==e.indexOf("UCBrowser/11")))))));var t,n,r,i}((Pe()||{}).userAgent)),xt||(t+=";SameSite=None"));var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var a="; expires="+o.toUTCString();Ie().cookie=e+"="+t+a+"; path=/"+r}}var Gt=Ve.perfNow;function Jt(e){return e<10?"0"+e:e.toString()}Ve.objDefineAccessors;function Xt(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=Gt()}var Qt=Ve.addEventHandler,Zt=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],n.pluginVersionString="",ge(t,n,(function(e,t){e.initialize=function(n,r,i,o){Ge(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var a=n.propertyStorageOverride;if(a&&(!a.getProperty||!a.setProperty))throw"Invalid property storage override passed.";n.channels&&At(n.channels,(function(t){t&&At(t,(function(t){if(t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},r&&At(r,(function(t){if(t&&t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{t.initialize(n,r,i,o)}catch(t){e.logger.throwInternal(ze.CRITICAL,_t.ErrorProvidedChannels,"Channels must be provided through config.channels only")}e.pollInternalLogs("InternalLog")}),(function(){return{config:n,extensions:r,logger:i,notificationManager:o}}))},e.track=function(n){Ge(e,(function(){return"AppInsightsCore.track"}),(function(){var r,i=n;if(i){i.timings=i.timings||{},i.timings.trackStart=Gt(),(r=i.latency)&&Lt(r)&&r>=1&&r<=3||(i.latency=St);var o=i.ext=i.ext||{};o.sdk=o.sdk||{},o.sdk.ver="1DS-Web-JS-2.4.2";var a=i.baseData=i.baseData||{};a.properties||(a.properties={});var s=a.properties;s.version||(s.version=""),""!=e.pluginVersionString&&(s.version=e.pluginVersionString)}t.track(i)}),(function(){return{item:n}}),!n.sync)}})),n}return __extends(t,e),t.prototype.initialize=function(e,t,n,r){},t.prototype.track=function(e){},t}(Tt),$t=function(){function e(t,n){var r=n?[].concat(n):[],i=Ve.isNullOrUndefined;ge(e,this,(function(n){n.iKey=function(){return t},n.count=function(){return r.length},n.events=function(){return r},n.addEvents=function(e,t){return void 0===t&&(t=!0),e&&e.length>0?(r=t?r.concat(e):e.concat(r),e.length):0},n.split=function(n,o){var a=new e(t);if(n<r.length){var s=r.length-n;i(o)||(s=o<s?o:s),a.addEvents(r.splice(n,s))}return a}}))}return e.create=function(t,n){return new e(t,n)},e}(),Yt=Math.min(2e6,65e3),en=function e(t){var n=this;ge(e,this,(function(e){e.createPayload=function(e,t,n,r){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r}},e.appendPayload=function(e,r,i){var o=e&&r&&!e.overflow;return o&&Ge(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=r.events(),o=e.payloadBlob,a=e.numEvents,s=!1,c=[],u=e.isBeacon,l=u?65e3:3984588,d=u?65e3:Yt,f=0;f<t.length;){var p=t[f];if(p){if(a>=i){e.overflow=r.split(f);break}var h=n.getEventBlob(p);if(h.length>d){c.concat(t.slice(f,1));continue}if(o.length+h.length>l){e.overflow=r.split(f);break}o&&(o+="\n"),o+=h,s=!0,a++,f++}}if(c&&c.length>0&&e.sizeExceed.push($t.create(r.iKey(),c)),s){e.batches.push(r),e.payloadBlob=o,e.numEvents=a;var v=r.iKey();-1===Ve.arrIndexOf(e.apiKeys,v)&&e.apiKeys.push(v)}}),(function(){return{payload:e,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),o},e.getEventBlob=function(e){return Ge(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};return t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}(e.iKey),e.ext&&(t.ext={},At(Mt(e.ext),(function(n){t.ext[n]={},At(Mt(e.ext[n]),(function(r){zt(e.ext[n][r])&&(t.ext[n][r]=jt(r,e.ext[n][r]).value)}))}))),t.data={},t.data.baseData={},t.data.baseType=e.baseType,e.baseData&&At(Mt(e.baseData),(function(n){var r=jt(n,e.baseData[n]);tn(t.data.baseData,n,r),nn(t.ext,"baseData."+n,r)})),e.data&&At(Mt(e.data),(function(n){var r=jt(n,e.data[n]);tn(t.data,n,r),nn(t.ext,n,r)})),JSON.stringify(t)}),(function(){return{item:e}}))}}))};function tn(e,t,n){if(n){for(var r=e,i=t.split("."),o=0;o<i.length-1;++o)r[i[o]]||(r[i[o]]={}),r=r[i[o]];r[i[i.length-1]]=n.value}}function nn(e,t,n){if(n){var r=Ht(n.value,n.kind,n.propertyType);if(r>-1){var i=e;i.metadata||(i.metadata={}),i.metadata.f||(i.metadata.f={}),i=i.metadata.f;for(var o=t.split("."),a=0;a<o.length-1;++a)i[o[a]]||(i[o[a]]={f:{}}),i=i[o[a]].f;Rt(n.value)?i[o[o.length-1]]={a:{t:r}}:i[o[o.length-1]]={t:r}}}}
/*!
 * 1DS JS SDK POST plugin, 2.4.2
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */var rn=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e&&429!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)},e}(),on=function e(){var t={};ge(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var r=(a=e.split(","),s=[],a&&At(a,(function(e){s.push(Wt(e))})),s);if("this-request-only"===n)return r;for(var i=1e3*parseInt(n,10),o=0;o<r.length;++o)t[r[o]]=Ve.dateNow()+i}catch(e){return[]}var a,s;return[]},e.isTenantKilled=function(e){var n=t,r=Wt(e);return void 0!==n[r]&&n[r]>Ve.dateNow()||(delete n[r],!1)}}))},an=function e(){var t=!0,n=!0,r=!0,i="use-collector-delta",o=!1;ge(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){r&&(r=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,n=!0,o=!0):n=!1,t=!0)}}))},sn=((un={})[1]="requeue",un[100]="requeue",un[200]="sent",un[8004]="drop",un[8003]="drop",un);function cn(e){try{return e.responseText}catch(e){}return""}var un,ln,dn,fn,pn,hn,vn=function e(t,n,r,i){this._responseHandlers=[];var o,a,s,c="?cors=true&content-type=application/x-json-stream&client-id=NO_AUTH&client-version=1DS-Web-JS-2.4.2",u=new on,l=!1,d=new an,f=!1,p=0,h=!0,v=[],g={},m=[],y=null,T=!0;ge(e,this,(function(e){var S=!0;function b(e,t){var n=new XDomainRequest;n.open("POST",e.urlString),n.onload=function(){var e=cn(n);_(t,200,{},e),L(e)},n.onerror=function(){_(t,400,{})},n.ontimeout=function(){_(t,500,{})},n.send(e.data)}function E(e,t){var n;fetch(e.urlString,(n={body:e.data,method:"POST",credentials:"include"},n.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,n.headers=e.headers,n)).then((function(e){var n={},r="";e.headers&&e.headers.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){r=e})),_(t,e.status,n,r),L(r)})).catch((function(e){_(t,0,{})}))}function w(e,t,n){function r(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var r=t.getResponseHeader(n);r&&(e[n]=Wt(r))}return e}function i(e){var t={};return e.getAllResponseHeaders?t=function(e){var t={};if(Dt(e)){var n=Wt(e).split(/[\r\n]+/);At(n,(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var r=Wt(e.substring(0,n)).toLowerCase(),i=Wt(e.substring(n+1));t[r]=i}else t[Wt(e)]=1}}))}return t}(e.getAllResponseHeaders()):(t=r(t,e,"time-delta-millis"),t=r(t,e,"kill-duration"),t=r(t,e,"kill-duration-seconds")),t}function o(e,n){_(t,e.status,i(e),n)}var a=new XMLHttpRequest;try{a.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0}catch(e){}S&&(a.withCredentials=!0),a.open("POST",e.urlString,!n),At(Mt(e.headers),(function(t){a.setRequestHeader(t,e.headers[t])})),a.onload=function(){var e=cn(a);o(a,e),L(e)},a.onerror=function(){o(a)},a.ontimeout=function(){o(a)},a.send(e.data)}function _(e,t,n,r){try{e(t,n,r)}catch(e){o.diagLog().throwInternal(ze.WARNING,_t.SendPostOnCompleteFailure,e)}}function C(){return!l&&p<n}function x(){var e=m;return m=[],e}function O(e,t,n){var r=!1;return e&&e.length>0&&!l&&a&&y&&(r=t||C()&&(n>0||d.allowRequestSending())),r}function I(e){var t={};return e&&At(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function N(e,n,r,i,o,a){if(e&&0!==e.length)if(l)U(e,1,i);else{var c=e;Ge(s,(function(){return"HttpManager:_sendBatches"}),(function(s){s&&(e=e.slice(0));for(var c=[],l=null,d=Gt();O(e,i,n);){var f=e.shift();f&&f.count()>0&&(u.isTenantKilled(f.iKey())?c.push(f):(l=l||y.createPayload(n,r,i,a&&k()),y.appendPayload(l,f,t)?null!==l.overflow&&(e=[l.overflow].concat(e),l.overflow=null,M(l,d,Gt(),o),d=Gt(),l=null):(M(l,d,Gt(),o),d=Gt(),e=[f].concat(e),l=null)))}l&&M(l,d,Gt(),o),e.length>0&&(m=e.concat(m)),U(c,8004,i)}),(function(){return{batches:I(c),retryCount:n,isTeardown:r,isSynchronous:i,sendReason:o,useSendBeacon:a}}),!i)}}function P(e){var t=c,n="";At(e.apiKeys,(function(e){n.length>0&&(n+=","),n+=e})),n.length>0&&(t+="&apikey="+n),t+="&upload-time="+Ve.dateNow().toString();var r=function(e){for(var t=0;t<e.batches.length;t++)for(var n=e.batches[t].events(),r=0;r<n.length;r++){var i=(n[r].ext||{}).intweb||{};if(zt(i.msfpc))return encodeURIComponent(i.msfpc)}return""}(e);if(zt(r)&&(t=t+"&ext.intweb.msfpc="+r),d.shouldAddClockSkewHeaders()&&(t+="&time-delta-to-apply-millis="+d.getClockSkewHeaderValue()),s.getWParam){var i=s.getWParam();i>=0&&(t+="&w="+i)}for(var o=0;o<v.length;o++)t+="&"+v[o].name+"="+v[o].value;return t}function k(){return!h&&f&&Vt()}function A(e,t,n){e[t]=e[t]||{},e[t][o.identifier]=n}function M(t,n,i,c){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var l=P(t),f=Gt();Ge(s,(function(){return"HttpManager:_doPayloadSend"}),(function(){At(t.batches,(function(e){At(e.events(),(function(e){if(T){var t=e.timings=e.timings||{};A(t,"sendEventStart",f),A(t,"serializationStart",n),A(t,"serializationCompleted",i)}e.sendAttempt>0?e.sendAttempt++:e.sendAttempt=1}))})),U(t.batches,1e3+(c||0),t.isSync,!0);var h={data:t.payloadBlob,urlString:l,headers:g};t.payloadBlob=null;var v=null,m=!!e.sendHook;k()&&t.isBeacon?(m=!1,v=function(n){!function(e,t,n){try{if(Vt()){var r=Pe();if(r.sendBeacon(e.urlString,e.data))return void F(t,200,n,!1);At(t.batches,(function(e){null.push(e.split(0))})),F(t,200,n,!1),U(null,8003,t.isSync,!0)}}catch(e){o.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e)}}(n,t,c),e.sendListener&&e.sendListener(h,n,t.isSync||t.isTeardown,!0)}):a&&(v=function(n){d.firstRequestSent();var i=function(e,n){!function(e,t,n,i){var o=9e3,a=null,s=!1,c=!1;try{var l=!0;if(void 0!==e){if(t){d.setClockSkew(t["time-delta-millis"]);var f=t["kill-duration"]||t["kill-duration-seconds"];At(u.setKillSwitchTenants(t["kill-tokens"],f),(function(e){At(n.batches,(function(t){if(t.iKey()===e){a=a||[];var r=t.split(0);n.numEvents-=r.count(),a.push(r)}}))}))}if(200===e)return void(o=200);(!rn.shouldRetryForStatus(e)||n.numEvents<=0)&&(l=!1),o=9e3+e%1e3}if(l){o=100;var h=n.retryCnt;n.isSync||(h<r?(s=!0,D((function(){n.isSync||p--,N(n.batches,h+1,n.isTeardown,n.isSync,5,n.isBeacon)}),!0,rn.getMillisToBackoffForRetry(h))):c=!0)}}finally{s||(d.setClockSkew(),F(n,o,i,c)),U(a,8004,n.isSync)}}(e,n,t,c)};try{a.sendPOST(n,i,t.isTeardown||t.isSync),e.sendListener&&e.sendListener(h,n,t.isSync||t.isTeardown,!1)}catch(e){_(i,0,{})}}),Ge(s,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(v)if(t.isSync||p++,m){var n={data:h.data,urlString:h.urlString,headers:h.headers},r=!1;Ge(s,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){r=!0,v(e)}),t.isSync||t.isTeardown)}catch(e){r||v(h)}}))}else v(h)})),U(t.sizeExceed,8003,t.isSync)}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:c}}),t.isSync)}}function F(t,n,r,i){try{i&&o._backOffTransmission(),200===n&&(i||t.isSync||o._clearBackOff(),function(e){if(T){var t=Gt();At(e,(function(e){var n,r;e&&e.count()>0&&(n=e.events(),r=t,T&&At(n,(function(e){A(e.timings=e.timings||{},"sendEventCompleted",r)})))}))}}(t.batches)),U(t.batches,n,t.isSync,!0)}finally{t.isSync||(p--,5!==r&&e.sendQueuedRequests(r,!t.isSync,t.isBeacon))}}function D(e,t,n){t?e():o._setTimeoutOverride(e,n)}function L(t){var n=e._responseHandlers;try{for(var r=0;r<n.length;r++)try{n[r](t)}catch(e){o.diagLog().throwInternal(ze.CRITICAL,_t.PostResponseHandler,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);zt(i.webResult)&&zt(i.webResult.msfpc)&&Kt("MSFPC",i.webResult.msfpc,365)}}catch(e){}}function U(e,t,n,r){if(e&&e.length>0&&i){var a=i[(c=t,u=sn[c],zt(u)||(u="oth",c>=9e3&&c<=9999?u="rspFail":c>=8e3&&c<=8999?u="drop":c>=1e3&&c<=1999&&(u="send")),u)];a&&Ge(s,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){D((function(){try{a.call(i,e,t,n)}catch(e){o.diagLog().throwInternal(ze.CRITICAL,_t.NotificationException,"send request notification failed: "+e)}}),r||n,0)}),(function(){return{batches:I(e),reason:t,isSync:n,sendSync:r}}),!n)}var c,u}e.initialize=function(e,t,n,r){if(c=e+c,T=!(s=t).config.disableEventTimings,o=n,y=new en(t),!(a=r)){h=!1,f=!Ft();var i=ke();i&&i.protocol&&"file:"===i.protocol.toLowerCase()&&(S=!1);var u=null;!function(){if(void 0!==typeof XMLHttpRequest){var e=Ce("XMLHttpRequest");if(e){var t=new e;return Boolean(Ot(t.withCredentials)&&void 0!==typeof XDomainRequest)}}}()?Ft()?u=E:"undefined"!=typeof XMLHttpRequest&&(u=w):u=b,a={sendPOST:u}}},e._getDbgPlgTargets=function(){return[a,u,y]},e.addQueryStringParameter=function(e,t){for(var n=0;n<v.length;n++)if(v[n].name===e)return void(v[n].value=t);v.push({name:e,value:t})},e.addHeader=function(e,t){g[e]=t},e.canSendRequest=function(){return C()&&d.allowRequestSending()},e.sendQueuedRequests=function(e,t,n){var r=!Ve.isNullOrUndefined(t)&&!t;O(m,r,0)&&N(x(),0,!1,r,e||0,!!n)},e.isCompletelyIdle=function(){return!l&&0===p&&0===m.length},e.addBatch=function(e){if(e&&e.count()>0){if(u.isTenantKilled(e.iKey()))return!1;m.push(e)}return!0},e.teardown=function(){m.length>0&&N(x(),0,!0,!0,2,!0)},e.pause=function(){l=!0},e.resume=function(){l=!1,e.sendQueuedRequests(4,!1)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&N([e],0,!1,!0,t||0,!!n)}}))},gn=Bt?window:void 0,mn=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="2.4.2";var i,o,a,s,c,u=!1,l=[],d=null,f=!1,p=0,h=1e4,v={},g="REAL_TIME",m=null,y=0,T=0,S={},b=-1;return ge(t,r,(function(e,t){function r(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=St),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,e.sync)if(y||f)e.latency=Et,e.sync=!1;else if(o)return void o.sendSynchronousBatch($t.create(e.iKey,[e]),3);var n=!1;p<h?n=!P(e,t):(n=!0,function(e,t){var n=St;for(;n<=t;){var r=I(e,t,!0);if(r&&r.count()>0){var i=r.split(0,20);if(i.count()>0)return D("eventsDiscarded",[i],mt),!0}n++}return!1}(e.iKey,e.latency)&&(n=!P(e,t))),n&&F("eventsDiscarded",[e],mt)}function E(e,t,n,r){var i=k(e,t,n);return o.sendQueuedRequests(t,n,r),i}function w(){return p>0}function _(){b>=0&&k(b,c,!0)&&o.sendQueuedRequests(c,!0,!1);var e=v[g][1];!m&&!d&&e>=0&&!f&&(w()?m=C((function(){m=null,E(0===T?Et:St,1,!0),T++,T%=2,_()}),e):T=0)}function C(t,n){0===n&&y&&(n=1);var r=1e3;return y&&(r=rn.getMillisToBackoffForRetry(y-1)),e._setTimeoutOverride(t,n*r)}function x(){null!==m&&(m=null,e._clearTimeoutOverride(m),T=0)}function O(t,n){x(),d&&(e._clearTimeoutOverride(d),d=null),f||E(St,t,n,!0)}function I(e,t,n){var r=S[t];r||(r=S[t=St]);var i=r.iKeyMap[e];return!i&&n&&(i=$t.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function N(t,n){o.canSendRequest()&&!y&&(a>0&&p>a&&(n=!0),n&&null==d&&e.flush(t,null,20))}function P(e,t){var n=I(e.iKey,e.latency,!0);return!!n.addEvents([e],t)&&(p++,t&&0===e.sendAttempt&&N(!e.sync,s>0&&n.count()>=s),!0)}function k(t,n,r){var i=!1;return!r||o.canSendRequest()?Ge(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=Et;n>=t;){var r=S[n];r&&r.batches&&(At(r.batches,(function(t){o.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),p-=t.count()})),r.batches=[],r.iKeyMap={}),n--}e.length>0&&F("eventsDiscarded",e,gt),i&&b>=t&&(b=-1,c=0)}),(function(){return{latency:t,sendReason:n}}),r):(b=b>=0?Math.min(b,t):t,c=Math.max(c,n)),i}function A(){(v={}).REAL_TIME=[2,1],v.NEAR_REAL_TIME=[6,3],v.BEST_EFFORT=[18,9]}function M(t,n){var r=e._notificationManager||{},i=r[t];if(i)try{i.apply(r,n)}catch(n){e.diagLog().throwInternal(ze.CRITICAL,_t.NotificationException,t+" notification failed: "+n)}}function F(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&M(e,[t].concat(n))}function D(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&At(t,(function(t){t&&t.count()>0&&M(e,[t.events()].concat(n))}))}function L(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,h/6)}A(),S[Et]={batches:[],iKeyMap:{}},S[bt]={batches:[],iKeyMap:{}},S[St]={batches:[],iKeyMap:{}},L(),o=new vn(500,2,1,{requeue:function(t,n){var i=[];At(t,(function(t){t&&t.count()>0&&At(t.events(),(function(t){t&&(t.sync&&(t.latency=Et,t.sync=!1),t.sendAttempt<6?(Xt(t,e.identifier),r(t,!1)):i.push(t))}))})),i.length>0&&F("eventsDiscarded",i,ht)},send:function(e,t,n){e&&e.length>0&&M("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])},sent:function(e,t){D("eventsSent",e,t),_()},drop:function(e,t){D("eventsDiscarded",e,t>=8e3&&t<=8999?t-8e3:pt)},rspFail:function(e){D("eventsDiscarded",e,ht),_()},oth:function(e,t){D("eventsDiscarded",e,pt),_()}}),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(r,s,c){Ge(s,(function(){return"PostChannel:initialize"}),(function(){var u=s;t.initialize(r,s,c),e.setInitialized(!1);var l=e._getTelCtx();r.extensionConfig[e.identifier]=r.extensionConfig[e.identifier]||{},n=l.getExtCfg(e.identifier),e._setTimeoutOverride=n.setTimeoutOverride?n.setTimeoutOverride:setTimeout.bind(gn),e._clearTimeoutOverride=n.clearTimeoutOverride?n.clearTimeoutOverride:clearTimeout.bind(gn);var d=u.getWParam;u.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|d()},n.eventsLimitInMem>0&&(h=n.eventsLimitInMem),n.autoFlushEventsLimit>0&&(a=n.autoFlushEventsLimit),L(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(i=n.httpXHROverride),zt(r.anonCookieName)&&o.addQueryStringParameter("anoncknm",r.anonCookieName),o.sendHook=n.payloadPreprocessor,o.sendListener=n.payloadListener;var f,p,v=n.overrideEndpointUrl?n.overrideEndpointUrl:r.endpointUrl;e._notificationManager=r.extensionConfig.NotificationManager,o.initialize(v,e.core,e,i),p=Qt("beforeunload",f=function(){O(2,!1)}),p=Qt("unload",f)||p,p=Qt("pagehide",f)||p,e.setInitialized(!0)}),(function(){return{coreConfig:r,core:s,extensions:c}}))},e.processTelemetry=function(t,i){Xt(t,e.identifier);var o=(i=e._getTelCtx(i)).getExtCfg(e.identifier),a=!!n.disableTelemetry;o&&(a=a||!!o.disableTelemetry);var s=t;a||u||(n.overrideInstrumentationKey&&(s.iKey=n.overrideInstrumentationKey),o&&o.overrideInstrumentationKey&&(s.iKey=o.overrideInstrumentationKey),r(s,!0),_()),e.processNext(s,i)},e.setEventQueueLimits=function(e,t){h=e>0?e:1e4,a=t>0?t:0,L();var n=p>e;if(!n&&s>0)for(var r=St;!n&&r<=Et;r++){var i=S[r];i&&i.batches&&At(i.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}N(!0,n)},e.teardown=function(){O(2,!1),u=!0,o.teardown()},e.pause=function(){x(),f=!0,o.pause()},e.resume=function(){f=!1,o.resume(),_()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){for(var t in x(),A(),g="REAL_TIME",_(),e)if(e.hasOwnProperty(t)){if(e[t].length<2)continue;if(e[t].splice(0,e[t].length-2),e[t][1]<0&&(e[t][0]=-1),e[t][1]>0&&e[t][0]>0){var n=e[t][0]/e[t][1];e[t][0]=Math.ceil(n)*e[t][1]}v[t]=e[t]}},e.flush=function(e,t,n){void 0===e&&(e=!0),f||(x(),n=n||1,e?(k(St,n,e),null==d?d=C((function(){!function e(t,n){E(St,n,!0),function e(t){o.isCompletelyIdle()?t():d=C((function(){e(t)}),250)}((function(){t&&t(),l.length>0?d=C((function(){return e(l.shift(),n)}),0):(d=null,w()&&_())}))}(t,n)}),0):l.push(t)):(E(St,n,!1),null!=t&&t()))},e.setMsaAuthTicket=function(e){o.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=w,e._setTransmitProfile=function(e){g!==e&&void 0!==v[e]&&(x(),g=e,_())},e._backOffTransmission=function(){y<4&&(y++,x(),_())},e._clearBackOff=function(){y&&(y=0,x(),_())}})),r}return __extends(t,e),t}(it),yn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yn(t,e),t.prototype.initialize=function(t,n){this._postChannel=new mn;var r=[];n&&(r=r.concat(n)),t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=t.channelConfiguration?t.channelConfiguration:{};try{e.prototype.initialize.call(this,t,r)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,r={};r.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.connectNotificationListener=function(e){e&&this.addNotificationListener(e)},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(Zt);!function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(ln||(ln={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(dn||(dn={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(fn||(fn={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(pn||(pn={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(hn||(hn={}));var Sn,bn,En=function(){function e(){this._fullEventsEnabled=!1}return e.prototype.processEvent=function(e){if(!this._fullEventsEnabled&&!e.eventFlags)throw new Error(e.eventName+" missing Event Flags");var t=this._fullEventsEnabled||!!e.eventFlags&&(e.eventFlags.diagnosticLevel===hn.BasicEvent||e.eventFlags.diagnosticLevel===hn.NecessaryServiceDataEvent||e.eventFlags.diagnosticLevel===hn.AlwaysOnNecessaryServiceDataEvent);return t||ie(Z.Info,$.Sink,(function(){return"1DS Data Classification Failed to Send: "+e.eventName})),t},e.prototype.setFullEventsEnabled=function(e){this._fullEventsEnabled=e},e}();!function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(Sn||(Sn={})),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Guid=4]="Guid"}(bn||(bn={}));function wn(e){return e?new Date(e):new Date}function _n(e,t,n){t&&t.forEach((function(t){if(!t.classification||t.classification===Sn.SystemMetadata||t.classification===Sn.EssentialServiceMetadata){var r,i;switch(r=n?"zC."===t.name.substr(0,3)?"zC.Data."+t.name.substr(3):"Data."+t.name:t.name,t.dataType){case bn.Double:i=wt.Double;break;case bn.Int64:i=wt.Int64;break;case bn.Guid:i=wt.Guid;break;case bn.Boolean:case bn.String:default:return void(e[r]=t.value)}var o={value:t.value,propertyType:i};e[r]=o}}))}var Cn,xn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),On=function(){return(On=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},In=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="PartAPlugin",t.priority=3,t._properties={},t}return xn(t,e),t.prototype.initialize=function(t,n,r){e.prototype.initialize.call(this,t,n,r)},t.prototype.processTelemetry=function(e,t){e.data=On(On({},e.data),this._properties);var n=this._getTelCtx(t);this.processNext(e,n)},t.prototype.addDataFields=function(e){_n(this._properties,e,!1)},t}(it),Nn=n(6);(Cn||(Cn={})).newGuid=function(){return Object(Nn.v4)()};var Pn=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),kn=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return"HttpManager:_sendBatches"===e||"HttpManager:_sendBatchesNotification"===e?new Pn(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case"HttpManager:_sendBatches":this.handleSendBatches(e);break;case"HttpManager:_sendBatchesNotification":this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var t=e.payload();if(t.batches&&t.reason&&t.reason>=1e3&&t.reason<=1999){var n=0;for(var r in t.batches)n+=t.batches[r].evts.length;this._callbacks.requestProcessingStats(0,n)}}},e}(),An=function(){function e(e,t){if(this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this._persistentDataFields=[],this._preprocessors=[],!t||!t.endpointUrl)throw new Error("Missing Endpoint Url");this._partADataFieldsPlugin=new In,this.setPersistentDataFields(e),this._oneDSSinkSessionId=Cn.newGuid(),this._epoch=(new Date).getTime().toString();var n=[this._partADataFieldsPlugin];t.plugins&&n.push.apply(n,t.plugins);var r={instrumentationKey:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",endpointUrl:t.endpointUrl,channelConfiguration:{eventsLimitInMem:t.eventsLimitInMem,httpXHROverride:t.httpXHROverride,setTimeoutOverride:t.setTimeoutOverride,clearTimeoutOverride:t.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0},disableCookiesUsage:!0};t.stats&&t.stats.networkStats&&r.channelConfiguration&&(r.channelConfiguration.payloadListener=function(e,n){var r,i=n||e;i.data&&(null===(r=t.stats)||void 0===r||r.networkStats(i.data.length))}),this._applicationInsights=new Tn,this._applicationInsights.initialize(r,n),this._applicationInsights.setUploadFrequency(t.uploadFrequency),this._applicationInsights.connectNotificationListener(t.notificationListener),t.stats&&this._applicationInsights.setPerfMgr(new kn(t.stats)),t.disableStatsTracking||this.hookUp1DSNotifications(this._applicationInsights),this._dataClassificationChecker=new En,this.addPreprocessor(this._dataClassificationChecker)}return e.prototype.sendTelemetryEvent=function(e,t){try{for(var n=0;n<this._preprocessors.length;n++)if(!this._preprocessors[n].processEvent(e))return;this.sendEventInternal(e,t)}catch(e){!function(e,t,n){ie(Z.Error,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}($.Sink,"1DS Sink",e)}},e.prototype.getPersistentDataFields=function(){return this._persistentDataFields},e.prototype.setPersistentDataFields=function(e){this._partADataFieldsPlugin.addDataFields(e),this._persistentDataFields=e},e.prototype.addPreprocessor=function(e){this._preprocessors.push(e)},e.prototype.setFullEventsEnabled=function(e){this._dataClassificationChecker.setFullEventsEnabled(e)},e.prototype.sendEventInternal=function(e,t){if(this.eventsProcessed++,!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");var n=function(e,t,n,r){var i,o,a={};return _n(a,e.dataFields,!0),a["Event.Sequence"]={value:n,propertyType:wt.Int64},a["Event.Name"]=e.eventName,a["Event.Source"]="OTelJS",a["Event.Time"]={value:(o=wn(r),o.getUTCFullYear()+"-"+Jt(o.getUTCMonth()+1)+"-"+Jt(o.getUTCDate())+"T"+Jt(o.getUTCHours())+":"+Jt(o.getUTCMinutes())+":"+Jt(o.getUTCSeconds())+"."+(i=o.getUTCMilliseconds(),(i<10?"00"+i:i<100?"0"+i:i.toString())+"Z")),propertyType:wt.DateTime},t&&(a["Event.Id"]=t+"."+n),e.eventContract&&(a["Event.Contract"]=e.eventContract.name,_n(a,e.eventContract.dataFields,!1)),a}(e,this._oneDSSinkSessionId,this.eventsProcessed,t);this._applicationInsights.track({iKey:e.telemetryProperties.ariaTenantToken,name:e.eventName,data:n,time:(new Date).toISOString(),baseType:"EventData",ext:{sdk:{seq:this.eventsProcessed,epoch:this._epoch}}})},e.prototype.hookUp1DSNotifications=function(e){var t=this;e.addNotificationListener({eventsSent:function(e){ie(Z.Info,$.Transport,(function(){return"Successfully sent "+e.length+" event(s)"})),ie(Z.Verbose,$.Transport,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),t.eventsSent+=e.length},eventsDiscarded:function(e,n){ie(Z.Error,$.Transport,(function(){return"Discarded "+e.length+" event(s) because "+n})),ie(Z.Verbose,$.Transport,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),t.eventsDiscarded+=e.length}})},e.prototype.flush=function(e){this._applicationInsights.flush(e)},e.prototype.shutdown=function(){try{this._applicationInsights.shutdown()}catch(e){ie(Z.Error,$.Transport,(function(){return"An error occurred on shutdown"}))}},e}();function Mn(e){return{name:"App",contract:{name:"App",dataFields:[Bn("Name",e.name),Bn("Platform",e.platform),Bn("Version",e.version)]}}}function Fn(e){return{name:"Session",contract:{name:"Session",dataFields:[Bn("Id",e.sessionId),Bn("ABFlights",e.flightsImpressionId)]}}}function Dn(e){return{name:"Release",contract:{name:"Release",dataFields:[Bn("AudienceGroup",e.audienceGroup)]}}}function Ln(e){return{name:"Browser",contract:{name:"Browser",dataFields:[Bn("Name",e.browserName),Bn("Version",e.browserVersion)]}}}function Un(e){return{name:"Culture",contract:{name:"Culture",dataFields:[Bn("UiLanguage",e.appLanguage)]}}}function Rn(e){return{name:"User",contract:{name:"User",dataFields:[Bn("PrimaryIdentityHash",e.loggableUserId),Bn("PrimaryIdentitySpace",e.loggableUserIdSpace),Bn("TenantId",e.omsTenantId),zn("IsAnonymous",e.isAnonymousUser)]}}}function Wn(e){return{name:"WAC",contract:{name:"WAC",dataFields:[Bn("Host",e.host),Bn("ServerDocId",e.serverDocId),Bn("Datacenter",e.datacenter),zn("IsSynthetic",e.isSynthetic),zn("IsBusinessUser",e.isBusinessUser),zn("IsEdu",e.isEduUser),Bn("ApplicationMode",e.applicationMode),Bn("ApplicationModeExtended",e.applicationModeExtended),Bn("BrowserLanguage",e.browserLanguage),Bn("ContentLanguage",e.contentLanguage),Bn("OsVersion",e.osVersion),Bn("Ring",e.ring),Bn("UiHost",e.uiHost),Bn("SessionOrigin",e.sessionOrigin)]}}}function Bn(e,t){return null==t?{name:e,string:""}:{name:e,string:t}}function zn(e,t){return null==t?{name:e,bool:!1}:{name:e,bool:t}}function Vn(e,t){var n=[];if(e)for(var r=0;r<e.length;r+=1)n.push.apply(n,jn(e[r],t));return n}function jn(e,t,n){if(!e.name)throw new Error("DataField is missing a name");var r=function(e){if(null!=e.string)return 2;if(null!=e.bool)return 1;if(null!=e.int64&&!isNaN(e.int64))return 3;if(null!=e.double&&!isNaN(e.double))return 4;if(null!=e.contract)return 6;if(null!=e.date&&!isNaN(e.date))return 5;return 0}(e),i=n?n+"."+e.name:e.name;switch(r){case 0:return[];case 1:return[b(i,e.bool)];case 2:return[_(i,e.string)];case 3:return[E(i,Math.floor(e.int64))];case 4:return[w(i,e.double)];case 5:return[_(i,new Date(e.date).toISOString())];case 6:return function(e,t,n){if(!t.name)throw new Error("Contract is missing a name");var r=[];if(t.dataFields)for(var i=0;i<t.dataFields.length;i+=1)r.push.apply(r,jn(t.dataFields[i],n,e));return r}(i,e.contract,t);default:throw new Error(r)}}function Hn(e,t){return{name:e,dataType:bn.String,value:t,classification:Sn.SystemMetadata}}var qn,Kn=function(){function e(e,t){this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._sinkName=e,this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={},this._oneDSSink=t}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){var t=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[e.eventName]=this._singleEventInLastInterval[e.eventName]+1||1,e.eventName in this._maxNamedEventsPerSecond?t=this.applyThrottle(this._singleEventInLastInterval[e.eventName],this._maxNamedEventsPerSecond[e.eventName],"MaxNamedEventsPerSecond",e.eventName):this._maxSingleEventPerSecond&&(t=this.applyThrottle(this._singleEventInLastInterval[e.eventName],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",e.eventName)),this._maxTotalEventsPerSecond&&(this._totalEventsInLastInterval++,t&&(t=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",e.eventName))),t},e.prototype.applyThrottle=function(e,t,n,r){if(e>t){if(e===t+1){var i={eventName:"Office.Telemetry.OTelJS.EventThrottled",telemetryProperties:{ariaTenantToken:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",nexusTenantToken:1723},dataFields:[Hn("SinkName",this._sinkName),Hn("ThrottledEvent.Name",r),(o=n,a=t,{name:o,dataType:bn.Int64,value:a,classification:Sn.SystemMetadata})]};this._oneDSSink.sendEventInternal(i)}return ie(Z.Info,$.Sink,(function(){return"1DS Sink Event Throttle: Exceeded "+t+" "+n+": "+r})),!1}var o,a;return!0},e}();!function(e){e.USGOV_DOD="https://pf.events.data.cloudapp.onecollector.akadns.net/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.cloudapp.onecollector.akadns.net/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/"}(qn||(qn={}));var Gn,Jn=function(){function e(e){this.stats=void 0,this.taskStats=void 0,this.config=e,this.resetStats()}return e.prototype.resetStats=function(){this.stats={processed:0,sent:0,throttled:0,dropped:0,droppedDetails:{},eventsProcessingTime:0,taskExecutionTime:0,taskExecutionCount:0,bytesOverWire:0,eventSerializationTime:0,eventTransmissionTime:0},this.taskStats={taskExecutionTimes:[],taskExecutionTimesDetails:[]}},e.prototype.logSessionStats=function(){this.computeSessionAverages(),c.sendTraceTag(this.config.tags.sessionStats,i.msoulscat_Wac_Telemetry,r.Info,JSON.stringify(this.stats))},e.prototype.computeSessionAverages=function(){this.stats.processed>0&&(this.stats.averageTimeCostPerEvent=+((this.stats.eventsProcessingTime+this.stats.taskExecutionTime)/this.stats.processed).toFixed(3),this.stats.averageProcessingTimeCostPerEvent=+(this.stats.eventsProcessingTime/this.stats.processed).toFixed(4),this.stats.averageTaskTimeCostPerEvent=+(this.stats.taskExecutionTime/this.stats.processed).toFixed(4),this.stats.averageNetworkCostPerEvent=+(this.stats.bytesOverWire/this.stats.processed).toFixed(0))},e.prototype.logAndClearTaskStats=function(){this.taskStats.taskExecutionTimes.length<=0||(c.sendTraceTag(this.config.tags.taskStats,i.msoulscat_Wac_Telemetry,r.Info,this.taskStats.taskExecutionTimes.join(",")),this.config.settings.reportTaskDetails&&c.sendTraceTag(this.config.tags.taskDetailsStats,i.msoulscat_Wac_Telemetry,r.Info,JSON.stringify(this.taskStats.taskExecutionTimesDetails)),this.taskStats={taskExecutionTimes:[],taskExecutionTimesDetails:[]})},e.prototype.recordUploadTaskDuration=function(e,t,n,o){if(e>this.config.settings.durationThreshold&&c.sendTraceTag(this.config.tags.taskDurationThresholdExceeded,i.msoulscat_Wac_Telemetry,r.Info,"Task took "+e+" ms"),this.stats.taskExecutionTime+=e,t>0){var a=+e.toFixed(3);this.stats.taskExecutionCount+=1,this.taskStats.taskExecutionTimes.push(a),this.stats.eventSerializationTime+=n||0,this.stats.eventTransmissionTime+=o||0,this.taskStats.taskExecutionTimesDetails.push({x:Date.now(),e:t,c:a,s:n,t:o}),this.taskStats.taskExecutionTimes.length>=this.config.settings.taskDurationLogFrequency&&this.logAndClearTaskStats()}},e.prototype.checkAndLogPipelineHealth=function(){var e=Date.now()-this.config.sdkInitializationTime;this.stats.processed>0&&0===this.stats.sent&&(this.stats.dropped>0||e>this.config.settings.sessionDurationCutoff)&&c.sendTraceTag(this.config.tags.sdkHealth,i.msoulscat_Wac_Telemetry,r.Warning,"Telemetry pipeline might be malfunctioning: Processed="+this.stats.processed+", Sent="+this.stats.sent+", Dropped="+this.stats.dropped+", SessionDuration="+e+" ms")},e}();function Xn(e,t,n){var o={endpointUrl:function(e){var t=qn[e];void 0===t&&(c.sendTraceTag(593597411,i.msoulscat_Wac_Telemetry,r.Error,"Unknown 1DS endpoint "+e+" - defaulting to Public one"),t=qn.PUBLIC);return t}(e.collectorEndpointEnum),notificationListener:new Zn(n),uploadFrequency:e.eventUploadFrequency,eventsLimitInMem:e.cacheMemorySizeLimitInNumberOfEvents,stats:{requestProcessingStats:function(e,t){n.recordUploadTaskDuration(e,t)},networkStats:function(e){n.stats.bytesOverWire+=e}},disableStatsTracking:!0};return new An(t||[],o)}function Qn(e){return new Kn("WACAriaSink",e)}!function(e){e[e.Unknown=0]="Unknown",e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.InvalidEvent=2]="InvalidEvent",e[e.SizeLimitExceeded=3]="SizeLimitExceeded",e[e.KillSwitch=4]="KillSwitch",e[e.QueueFull=5]="QueueFull"}(Gn||(Gn={}));var Zn=function(){function e(e){this.reporter=e}return e.prototype.eventsSent=function(e){this.reporter.stats.sent+=e.length},e.prototype.eventsDiscarded=function(e,t){var n=Gn[t]||t.toString();this.reporter.stats.droppedDetails[n]=this.reporter.stats.droppedDetails[n]+e.length||e.length,this.reporter.stats.dropped+=e.length},e}();function $n(e){return function(e){return new Yn({alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.transportSettings,throttlingSettings:e.throttlingSettings,stats:(t=e.statsSettings,n={settings:t,tags:{sessionStats:593597406,taskStats:593597407,taskDetailsStats:593597408,taskDurationThresholdExceeded:593597409,sdkHealth:593597410},sdkInitializationTime:Date.now()},new Jn(n)),createSinkFunc:Xn,createThrottlerFunc:Qn,collectorPingUrl:"https://browser.events.data.microsoft.com/ping"});var t,n}({alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.oneDsTransportSettings,throttlingSettings:e.throttlingSettings,statsSettings:e.statsSettings})}var Yn=function(){function e(e){this._processedEvent=new o,this._throttledEvent=new o,this._logger=new ne(void 0,void 0,{disableValidation:!0}),this._enabled=e.transportSettings.enabled,this._throttlingEnabled=e.throttlingSettings.enabled,this._reporter=e.stats,this._collectorPingUrl=e.collectorPingUrl;var t,n=Vn((t=e.alwaysOnMetadata)?[Mn,Fn,Dn,Ln,Un,Wn,Rn].map((function(e){return e(t)})):[],"AlwaysOnMetadata");this._sink=e.createSinkFunc(e.transportSettings,n,this._reporter),this._sink.setFullEventsEnabled(!0),this._eventThrottler=e.createThrottlerFunc(this._sink),function(e,t){if(e.setSingleEventThrottle(t.singleEventThrottlePerSec),e.setTotalEventThrottle(t.totalEventsThrottlePerSec),t.eventNamesToBeSuppressedCommaSeparated){t.eventNamesToBeSuppressedCommaSeparated.split(",").forEach((function(t){e.setNamedEventThrottle(t,0)}))}}(this._eventThrottler,e.throttlingSettings)}return e.prototype.pingCollectorPingUrl=function(){!function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!0),t.onreadystatechange=function(){4===t.readyState&&(200===t.status?t.responseText.toLowerCase().indexOf("ok")>-1?c.sendTraceTag(593597389,i.msoulscat_Wac_Telemetry,r.Info,"Collector ping 200 OK."):c.sendTraceTag(593597390,i.msoulscat_Wac_Telemetry,r.Warning,"Collector ping 200 OK but with invalid response."):c.sendTraceTag(593597391,i.msoulscat_Wac_Telemetry,r.Warning,"Collector ping returned with HTTP "+t.status.toString()))},t.send()}catch(e){c.sendTraceTag(593597392,i.msoulscat_Wac_Telemetry,r.Warning,"Collector ping failed with error: "+e.toString())}}(this._collectorPingUrl)},e.prototype.pingCollectorEndpoint=function(){},e.prototype.setTenantToken=function(e,t){t&&this._logger.setTenantToken(e,t,-1)},e.prototype.sendOtelTelemetryEvent=function(e,t){var n=!1,r=performance.now();this._logger.processTelemetryEvent(e),this._throttlingEnabled&&!this._eventThrottler.processEvent(e)&&(n=!0),this._enabled&&!n&&this._sink.sendTelemetryEvent(e,t),this._reporter.stats.eventsProcessingTime+=performance.now()-r,n?(this._reporter.stats.throttled+=1,this._throttledEvent.fireEvent(e)):(this._reporter.stats.processed+=1,this._processedEvent.fireEvent(e))},e.prototype.flush=function(e){this._sink instanceof An&&this._sink.flush(e)},e.prototype.shutdown=function(){this._enabled&&this._sink.shutdown(),this._reporter.logSessionStats(),this._reporter.logAndClearTaskStats(),this._reporter.checkAndLogPipelineHealth()},e.prototype.getStats=function(){return this._reporter},e.prototype.onProcessedEvent=function(){return this._processedEvent},e.prototype.onThrottledEvent=function(){return this._throttledEvent},e}();var er,tr,nr=[{id:1,namespace:"Office.Online",ariaTenant:"79b56d2f6f2444f1a3d7f7c7f12bcc0c-f47f5fe6-ed89-42f6-8a43-cea0f5930b17-7407"},{id:2,namespace:"Office.Word.Online.Data",ariaTenant:"7e7959aac92e41d6892c69a87259ed58-de5c63ef-10f5-45e1-bef2-d23e9cac2fab-6830"},{id:3,namespace:"Office.Excel.Online.Data",ariaTenant:"011776870b754a649aedc9456ac07a97-6bd8247c-11d3-4599-b599-ec9ef6d401f6-6722"},{id:4,namespace:"Office.PowerPoint.Online.Data",ariaTenant:"35612b11d234460da5c673d7b172fd93-f8762c6b-96cb-4e60-87fa-015aac0c2ff1-7212"},{id:4,namespace:"Office.OneNote.Online.Data",ariaTenant:"86258c80efed47d9b34bf77fc663b381-af82a060-b49f-448b-baf0-956ba7709592-7634"},{id:5,namespace:"Office.Visio.Online.Data",ariaTenant:"77fd25a525d24b7f9b924307de0cc70f-5f2b6ec0-f1d2-40dd-b875-e6bd2849e1eb-7539"},{id:6,namespace:"Office.Word.Online",ariaTenant:"ff7e2f12a4be407096fc01eeb760eda3-eeeb63cf-35d9-4734-ab45-66a873412359-7045"},{id:7,namespace:"Office.Excel.Online",ariaTenant:"fad3bd1d8e4b4c06894bd7bac80e4f02-67df67b4-f1fd-4ecd-9d55-4d41540b1757-7724"},{id:8,namespace:"Office.PowerPoint.Online",ariaTenant:"b664cab4b3f24a739be75b93b026749e-65c206a3-a985-48b4-8b50-36c56c3ce309-7201"},{id:9,namespace:"Office.OneNote.Online",ariaTenant:"1705ef36a51840648341da866d62baf8-ddbcd60b-4ce4-48da-96be-ad5f28b48954-8035"},{id:10,namespace:"Office.Visio.Online",ariaTenant:"a9b6cb604fe942a89c8671aab85364f6-af0f81b1-c5ce-419a-82d5-af38c33ebea3-7250"},{id:11,namespace:"Office.Word.Online.Health",ariaTenant:"e064ef4d9cdb454d9eddb2f7f7a94c83-89a6d9df-7218-4efd-bcd4-16ea059deea2-7672"},{id:12,namespace:"Office.Excel.Online.Health",ariaTenant:"e76e8055912d482eb56ea5dad2fd5a97-5552f2bb-d1eb-4843-95d7-3019215328a0-6899"},{id:13,namespace:"Office.PowerPoint.Online.Health",ariaTenant:"706f939c0d24440ba8dfb0838ed33611-d60b1956-db23-4410-a59d-e7fa08d4217f-7388"},{id:14,namespace:"Office.OneNote.Online.Health",ariaTenant:"c6393e4ed4b94e3baf9a46aa6585dce0-c1b3b0c6-b44c-4121-8eae-311d31e67bb6-7176"},{id:15,namespace:"Office.Visio.Online.Health",ariaTenant:"c4999163c49d49c99a1649b404873d24-a62a394b-ad47-45f0-92fa-fd4085dc8bb3-7324"},{id:16,namespace:"Office.Telemetry",ariaTenant:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405"},{id:17,namespace:"Office.System",ariaTenant:"cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521"},{id:18,namespace:"Office.TellMe",ariaTenant:"31d9dd3e4c7046a696537586281d7ed1-06d11dd6-a946-4281-8ac3-a7c2ab4776f5-7063"},{id:19,namespace:"Office.Voice",ariaTenant:"9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162"},{id:20,namespace:"Office.Insights",ariaTenant:"250a372c4a854d8fb120ef0366f9410c-dd39bcd8-3b38-4c6c-9f8d-3821e5c28b47-7487"},{id:21,namespace:"Office.Graphics",ariaTenant:"cfcfdb91c68c4329bb8b7cb7babb3cf7-e082c2f2-ef1d-427a-ac4d-b0b700afe7a7-7655"},{id:22,namespace:"Office.AugLoop",ariaTenant:"3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770"},{id:23,namespace:"Office.FileIO",ariaTenant:"d2b065c5ae634beb9cec4813140e22da-eda42ada-ffd9-4e26-92a1-e3b440eaf8bf-7717"},{id:24,namespace:"Office.Sandbox",ariaTenant:"1cd66059dc1d41f1887e3770ea8ba967-f1d0108c-8535-4cf9-bf23-ec8227f6afa7-6999"},{id:25,namespace:"Office.UX",ariaTenant:"c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879"}],rr={alwaysOnMetadata:void 0,useOneDsLogger:!0,logToUls:!1,logToExp:!1,oneDsTransportSettings:{enabled:!0,collectorEndpointEnum:"PUBLIC",eventUploadFrequency:2e3,cacheMemorySizeLimitInNumberOfEvents:1e4},expLoggerTransportSettings:{enabled:!1,endpointUrl:"",numEventsToTriggerUpload:200,timeToWaitBeforeAutoUploadingEvents:1e4,maxEventsPerRequest:500},throttlingSettings:{enabled:!0,totalEventsThrottlePerSec:100,singleEventThrottlePerSec:20,eventNamesToBeSuppressedCommaSeparated:""},statsSettings:{taskDurationLogFrequency:20,durationThreshold:100,reportTaskDetails:!1,sessionDurationCutoff:1e4}};function ir(e,t){return null==e?t:e}function or(e,t){return null==e?t:e}function ar(e,t){return null==e?t:e}!function(e){e[e.None=0]="None",e[e.Activity=2]="Activity",e[e.EssentialMetadata=4]="EssentialMetadata",e[e.CompleteEventNameAndTenantInfo=8]="CompleteEventNameAndTenantInfo",e[e.GDRPRelated=16]="GDRPRelated",e[e.ExpRelated=32]="ExpRelated"}(er||(er={})),function(e){e[e.TelemetryEvent=1]="TelemetryEvent",e[e.ULS=2]="ULS"}(tr||(tr={}));var sr={};function cr(e){return function(e){var t=(r=e.statsSettings,i={settings:r,tags:{sessionStats:593597393,taskStats:593597394,taskDetailsStats:593597395,taskDurationThresholdExceeded:593597396,sdkHealth:593597397},sdkInitializationTime:Date.now()},new Jn(i)),n=new ur(e,t);var r,i;return n.initialize(e.aom),n}({aom:e.alwaysOnMetadata||{},transportSettings:e.expLoggerTransportSettings,statsSettings:e.statsSettings})}var ur=function(){function e(e,t){this.protocolVersion="0.1",this.endpointUrl=e.transportSettings.endpointUrl+"?version="+this.protocolVersion,this.numEventsToTriggerUpload=e.transportSettings.numEventsToTriggerUpload,this.timeToWaitBeforeAutoUploadingEvents=e.transportSettings.timeToWaitBeforeAutoUploadingEvents,this.maxEventsPerRequest=e.transportSettings.maxEventsPerRequest,this.sendToCollector=e.sendToCollectorOverride||lr,this.alwaysOnMetadataSerializedPayload="",this.asyncFlushTimerId=0,this.periodicUploaderTimerId=0,this.events=[],this.reporter=t}return e.prototype.initialize=function(e){this.alwaysOnMetadataSerializedPayload=JSON.stringify(function(e){var t={},n={appLanguage:"a",applicationMode:"b",applicationModeExtended:"c",audienceGroup:"d",browserLanguage:"e",browserName:"f",browserVersion:"g",contentLanguage:"h",datacenter:"i",flightsImpressionId:"j",host:"k",isAnonymousUser:"l",isBusinessUser:"m",isEduUser:"n",isSynthetic:"o",loggableUserId:"p",loggableUserIdSpace:"q",name:"r",omsTenantId:"s",osBuild:"t",osVersion:"u",ring:"v",serverDocId:"w",sessionId:"x",uiHost:"y",version:"z",sessionOrigin:"aa"};for(var r in e){var i=n[r],o=e[r];i&&o&&(t[i]="boolean"==typeof o?1:o)}return t}(e)),this.schedulePeriodicUploadTimer()},e.prototype.sendOtelTelemetryEvent=function(e){var t=window.performance.now();try{var n=function(e){var t={},n=er.None;if(t.t=Date.now(),e.dataFields&&e.dataFields.length>0){for(var r={},i=0;i<e.dataFields.length;i+=1)r[e.dataFields[i].name]=e.dataFields[i].value;t.d=r}if(e.telemetryProperties&&e.telemetryProperties.ariaTenantToken){var o=sr[e.telemetryProperties.ariaTenantToken];if(o)t.n=e.eventName.substring(o.namespace.length+1),t.a=o.id;else{t.n=e.eventName;var a=e.telemetryProperties.ariaTenantToken.indexOf("-");t.a=-1!==a?e.telemetryProperties.ariaTenantToken.substring(0,a):e.telemetryProperties.ariaTenantToken,n|=er.CompleteEventNameAndTenantInfo}}else t.n=e.eventName;if(e.eventContract&&e.eventContract.dataFields){n|=er.Activity;for(i=0;i<e.eventContract.dataFields.length;i+=1){var s=e.eventContract.dataFields[i].value;switch(e.eventContract.dataFields[i].name){case"Activity.Duration":s&&(t.q=s);break;case"Activity.Success":s&&(t.r=!0);break;case"Activity.CV":s&&(t.s=s);break;case"Activity.AggMode":s>0&&(t.x=s);break;case"Activity.Count":s>1&&(t.y=s)}}}n&&(t.m=n);return t}(e);this.addEventToQueue(n)}catch(e){c.sendTraceTag(593597398,i.msoulscat_Wac_Telemetry,r.Warning,e.message)}this.reporter.stats.eventsProcessingTime+=window.performance.now()-t},e.prototype.sendEvent=function(e,t,n){var r=window.performance.now();this.addEventToQueue({t:Date.now(),n:t,a:e,d:n}),this.reporter.stats.eventsProcessingTime+=window.performance.now()-r},e.prototype.sendActivityEvent=function(e,t,n,r,i,o){var a=window.performance.now();this.addEventToQueue({t:Date.now(),n:t,a:e,d:n,q:r,r:i||void 0,s:o,m:er.Activity}),this.reporter.stats.eventsProcessingTime+=window.performance.now()-a},e.prototype.addEventToQueue=function(e){this.reporter.stats.processed+=1,this.events.push(e),this.events.length>=this.numEventsToTriggerUpload&&this.flush(!0)},e.prototype.flush=function(e){var t=this;if(!e)return this.cancelOutstandingFlushTimer(),void this.sendOutstandingTelemetryEvents();this.asyncFlushTimerId||(this.asyncFlushTimerId=window.setTimeout((function(){t.flushRoutine()}),0))},e.prototype.flushRoutine=function(){this.asyncFlushTimerId=0,this.sendOutstandingTelemetryEvents()},e.prototype.cancelOutstandingFlushTimer=function(){this.asyncFlushTimerId&&(window.clearTimeout(this.asyncFlushTimerId),this.asyncFlushTimerId=0)},e.prototype.shutdown=function(){this.sendOutstandingTelemetryEvents(!0),this.cancelOutstandingFlushTimer(),this.cancelPeriodicUploadTimer(),this.reporter.logSessionStats(),this.reporter.logAndClearTaskStats()},e.prototype.getStats=function(){return this.reporter},e.prototype.sendOutstandingTelemetryEvents=function(e){if(void 0===e&&(e=!1),this.schedulePeriodicUploadTimer(),!(this.events.length<=0)){try{for(var t=0;t<this.events.length;){var n=void 0,o=window.performance.now();n=this.events.length<this.maxEventsPerRequest?this.events:this.events.slice(t,t+this.maxEventsPerRequest),t+=this.maxEventsPerRequest;var a=JSON.stringify(n),s=this.alwaysOnMetadataSerializedPayload+"\n"+a,u=window.performance.now();this.sendToCollector(this.endpointUrl,s,e);var l=window.performance.now(),d=l-o,f=u-o,p=l-u;this.reporter.stats.sent+=n.length,this.reporter.recordUploadTaskDuration(d,n.length,f,p),this.reporter.stats.bytesOverWire+=s.length}}catch(e){c.sendTraceTag(593597399,i.msoulscat_Wac_Telemetry,r.Warning,e.message)}this.events=[]}},e.prototype.periodicUploaderRoutine=function(){this.periodicUploaderTimerId=0,this.sendOutstandingTelemetryEvents()},e.prototype.schedulePeriodicUploadTimer=function(){var e=this;this.cancelPeriodicUploadTimer(),this.periodicUploaderTimerId=window.setTimeout((function(){e.periodicUploaderRoutine()}),this.timeToWaitBeforeAutoUploadingEvents)},e.prototype.cancelPeriodicUploadTimer=function(){this.periodicUploaderTimerId&&(window.clearTimeout(this.periodicUploaderTimerId),this.periodicUploaderTimerId=0)},e}();function lr(e,t,n){if(n){if(void 0!==navigator.sendBeacon)try{navigator.sendBeacon(e,t)}catch(n){var r;(r=new XMLHttpRequest).open("POST",e),r.send(t)}}else(r=new XMLHttpRequest).open("POST",e),r.send(t)}var dr,fr,pr=!1,hr="",vr="",gr="unknown";function mr(e){if(pr)throw new Error("Telemetry is already initialized!");if(!e.ulsLogger)throw new Error("Must provide a ULS logger!");!function(e){if(!e)throw new Error("The 'logger' argument is missing");c.setLogger(e)}(e.ulsLogger),e.alwaysOnMetadata&&(gr=e.alwaysOnMetadata.name+", "+e.alwaysOnMetadata.applicationMode+", "+e.alwaysOnMetadata.applicationModeExtended),c.sendTraceTag(595947925,i.msoulscat_Wac_Telemetry,r.Info,"Initializing Otel library ["+gr+"] with settings "+function(e){return JSON.stringify(e,(function(e,t){if("alwaysOnMetadata"!==e)return t}))}(e)),function(e){e.alwaysOnMetadata&&(null==e.alwaysOnMetadata.name||""===e.alwaysOnMetadata.name?(hr="Office.Online.UserAction",vr="Office.Online.Data.Activity",c.sendTraceTag(595900060,i.msoulscat_Wac_Telemetry,r.Info,"Cannot determine the App for UserActionEvent, using generic UserAction event name.")):(hr="Office."+e.alwaysOnMetadata.name+".Online.UserAction.",vr="Office."+e.alwaysOnMetadata.name+".Online.Data.Activity."))}(e);var t=function(e){return{alwaysOnMetadata:e.alwaysOnMetadata||rr.alwaysOnMetadata,useOneDsLogger:ir(e.otelUseOneDsSink,rr.useOneDsLogger),logToUls:ir(e.sendToUls,rr.logToUls),logToExp:ir(e.sendToExpLogger,rr.logToExp),oneDsTransportSettings:{enabled:ir(e.sendToAria,rr.oneDsTransportSettings.enabled),collectorEndpointEnum:ar(e.ariaEndpointTarget,rr.oneDsTransportSettings.collectorEndpointEnum),eventUploadFrequency:or(e.eventUploadFrequency,rr.oneDsTransportSettings.eventUploadFrequency),cacheMemorySizeLimitInNumberOfEvents:or(e.cacheMemorySizeLimitInNumberOfEvents,rr.oneDsTransportSettings.cacheMemorySizeLimitInNumberOfEvents)},throttlingSettings:{enabled:ir(e.wacAriaThrottlingIsEnabled,rr.throttlingSettings.enabled),totalEventsThrottlePerSec:or(e.wacAriaTotalEventsThrottlePerSec,rr.throttlingSettings.totalEventsThrottlePerSec),singleEventThrottlePerSec:or(e.wacAriaSingleEventThrottlePerSec,rr.throttlingSettings.singleEventThrottlePerSec),eventNamesToBeSuppressedCommaSeparated:ar(e.otelEventNamesToBeSuppressedCommaSeparated,rr.throttlingSettings.eventNamesToBeSuppressedCommaSeparated)},expLoggerTransportSettings:{enabled:ir(e.sendToExpLogger,rr.expLoggerTransportSettings.enabled),endpointUrl:ar(e.expLoggerEndpointUrl,rr.expLoggerTransportSettings.endpointUrl),numEventsToTriggerUpload:or(e.expLoggerNumEventsToTriggerUpload,rr.expLoggerTransportSettings.numEventsToTriggerUpload),timeToWaitBeforeAutoUploadingEvents:or(e.expLoggerTimeToWaitBeforeAutoUploadingEvents,rr.expLoggerTransportSettings.timeToWaitBeforeAutoUploadingEvents),maxEventsPerRequest:or(e.expLoggerMaxEventsPerRequest,rr.expLoggerTransportSettings.maxEventsPerRequest)},statsSettings:{taskDurationLogFrequency:or(e.taskDurationLogFrequency,rr.statsSettings.taskDurationLogFrequency),durationThreshold:or(e.taskDurationLogThreshold,rr.statsSettings.durationThreshold),reportTaskDetails:ir(e.reportTaskDetails,rr.statsSettings.reportTaskDetails),sessionDurationCutoff:rr.statsSettings.sessionDurationCutoff}}}(e),n=$n(t);e.sendToUls&&(n.onProcessedEvent().addListener(br),n.onThrottledEvent().addListener(Er)),e.sendToExpLogger&&(nr.forEach((function(e){sr[e.ariaTenant]=e})),fr=cr(t),n.onProcessedEvent().addListener((function(e){fr.sendOtelTelemetryEvent(e)}))),T.addListener((function(t){!function(e,t){if(e.category===f.Transport&&!t)return;c.sendTraceTag(595947933,i.msoulscat_Wac_Telemetry,function(e){switch(e){case d.Verbose:return r.Verbose;case d.Info:return r.Info;case d.Warning:return r.Warning;case d.Error:return r.Error;default:throw new Error(e)}}(e.level),e.message())}(t,e.enableAdditionalDiagnosticTracing||!1)})),nr.forEach((function(e){n.setTenantToken(e.namespace,e.ariaTenant)})),e.pingCollectorPingUrl&&n.pingCollectorPingUrl(),e.pingCollectorEndpoint&&n.pingCollectorEndpoint(),dr=n,pr=!0,c.sendTraceTag(595947926,i.msoulscat_Wac_Telemetry,r.Info,"Successfully initialized Otel library")}function yr(e,t){wr();var n=function(e){if(!e.name)throw new Error("Event is missing a name");var t=Vn(e.dataFields,e.name);return{eventName:e.name,dataFields:t}}(e);dr.sendOtelTelemetryEvent(n,t)}function Tr(e,t){wr(),null!=e&&null!=e.name&&(e.name.indexOf("Office.")>=0||(e.name=vr+e.name));var n=function(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0),(null==e.count||isNaN(e.count))&&(e.count=1),null==e.aggMode&&(e.aggMode=0);var t=Math.floor(1e3*e.durationMs),n=Vn(e.dataFields,e.name),r=V.Office.System.Activity.getFields({cV:e.CV||void 0,duration:t,count:e.count,aggMode:e.aggMode,success:e.succeeded});return{eventName:e.name,eventContract:{name:V.Office.System.Activity.contractName,dataFields:r},dataFields:n}}(e);dr.sendOtelTelemetryEvent(n,t)}function Sr(e,t){wr(),null==e.name&&(e.name=hr,null!=e.actionName&&(e.name+=e.actionName));var n=function(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0);var t=Math.floor(1e3*e.durationMs);null==e.dataFields&&(e.dataFields=[]);var n=Vn(e.dataFields,e.name),r=V.Office.System.UserAction.getFields("UserAction",{id:null==e.actionId?void 0:e.actionId,name:null==e.actionName?void 0:e.actionName,commandSurface:null==e.commandSurface?void 0:e.commandSurface,parentName:null==e.parentName?void 0:e.parentName,triggerMethod:null==e.triggerMethod?void 0:e.triggerMethod,timeOffsetMs:null==e.timeOffsetMs?void 0:e.timeOffsetMs});n.push.apply(n,r);var i=V.Office.System.Activity.getFields({duration:t,count:1,aggMode:0,success:e.succeeded});return{eventName:e.name,eventContract:{name:V.Office.System.Activity.contractName,dataFields:i},dataFields:n}}(e);dr.sendOtelTelemetryEvent(n,t)}function br(e){c.sendTraceTag(595947932,i.msoulscat_Wac_Telemetry,r.Info,"Processed TelemetryEvent "+e.eventName+" :"+JSON.stringify(e))}function Er(e){c.sendTraceTag(593597440,i.msoulscat_Wac_Telemetry,r.Warning,"Throttled TelemetryEvent "+e.eventName+" :"+JSON.stringify(e))}function wr(){if(!pr)throw new Error("Telemetry is not initialized!")}function _r(e){switch(e.kind){case"event":try{yr(e.event)}catch(t){c.sendTraceTag(595947920,i.msoulscat_Wac_Telemetry,r.Error,"Error while processing TelemetryEvent "+e.event.name+" : "+Cr(t)+" \nEvent: "+JSON.stringify(e))}break;case"activity":try{Tr(e.event)}catch(t){c.sendTraceTag(595947921,i.msoulscat_Wac_Telemetry,r.Error,"Error while processing ActivityEvent "+e.event.name+" : "+Cr(t)+" \nEvent: "+JSON.stringify(e))}break;case"action":try{Sr(e.event)}catch(t){c.sendTraceTag(595928211,i.msoulscat_Wac_Telemetry,r.Error,"Error while processing UserActionEvent "+e.event.name+" : "+Cr(t)+" \nEvent: "+JSON.stringify(e))}break;case"otel":try{!function(e){var t;wr();var n=e.otelEvent;if(!n||!n.dataFields)throw new Error("Invalid Otel event");if(e.additionalDataFields){var r=Vn(e.additionalDataFields,n.eventName);(t=n.dataFields).push.apply(t,r)}dr.sendOtelTelemetryEvent(n)}(e.event)}catch(o){var t="",n=e.event;n&&(t=n.eventName),c.sendTraceTag(595947922,i.msoulscat_Wac_Telemetry,r.Error,"Error while processing OtelEvent "+t+" : "+Cr(o)+" \nEvent: "+JSON.stringify(e))}break;case"addNamespaceMapping":try{o=e.namespace,a=e.ariaTenantToken,wr(),dr.setTenantToken(o,a)}catch(t){c.sendTraceTag(595947923,i.msoulscat_Wac_Telemetry,r.Error,"Error while adding namespace mapping for "+e.namespace+" : "+Cr(t))}break;case"shutdown":try{wr(),c.sendTraceTag(595947931,i.msoulscat_Wac_Telemetry,r.Info,"Otel library shutdown triggered ["+gr+"]"),dr.shutdown(),fr&&fr.shutdown()}catch(e){c.sendTraceTag(595947924,i.msoulscat_Wac_Telemetry,r.Error,"Error while processing shutdown event")}break;default:throw new Error(e)}var o,a}function Cr(e){return e instanceof Error?e.message?e.message:"":null!=e.message?e.message:JSON.stringify(e)}var xr=new(function(){function e(){}return e.prototype.initialize=function(e){if(!e)throw new Error("Must supplied valid telemetry settings!");mr(e)},e.prototype.processTelemetryEvent=function(e){_r(e)},e}());n.d(t,"TelemetryFullGlobal",(function(){return xr})),n.d(t,"initializeEventProcessor",(function(){return mr})),n.d(t,"processEvent",(function(){return _r}))}]);
//# sourceMappingURL=otelFull.min.js.map