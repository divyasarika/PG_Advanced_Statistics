var sharedComments=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[19],{1026:function(e,t,n){n(1027),e.exports=n(341).Array.includes},1027:function(e,t,n){"use strict";var r=n(503),o=n(832)(!0);r(r.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(837)("includes")},1028:function(e,t,n){var r=n(1029),o=n(1030),i=n(1032),a=Object.defineProperty;t.f=n(505)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},1029:function(e,t,n){var r=n(504);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},1030:function(e,t,n){e.exports=!n(505)&&!n(506)((function(){return 7!=Object.defineProperty(n(1031)("div"),"a",{get:function(){return 7}}).a}))},1031:function(e,t,n){var r=n(504),o=n(429).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},1032:function(e,t,n){var r=n(504);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},1033:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},1034:function(e,t,n){var r=n(429),o=n(645),i=n(830),a=n(646)("src"),s=n(1035),c=(""+s).split("toString");n(341).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var d="function"==typeof n;d&&(i(n,"name")||o(n,"name",t)),e[t]!==n&&(d&&(i(n,a)||o(n,a,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},1035:function(e,t,n){e.exports=n(647)("native-function-to-string",Function.toString)},1036:function(e,t){e.exports=!1},1037:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},1038:function(e,t,n){var r=n(836),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):i(e,t)}},1039:function(e,t,n){n(1040),e.exports=n(341).String.trimRight},1040:function(e,t,n){"use strict";n(1041)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},1041:function(e,t,n){var r=n(503),o=n(649),i=n(506),a=n(1042),s="["+a+"]",c=RegExp("^"+s+s+"*"),d=RegExp(s+s+"*$"),u=function(e,t,n){var o={},s=i((function(){return!!a[e]()||"​"!="​"[e]()})),c=o[e]=s?t(l):a[e];n&&(o[n]=c),r(r.P+r.F*s,"String",o)},l=u.trim=function(e,t){return e=String(o(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(d,"")),e};e.exports=u},1042:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},1043:function(e,t,n){"use strict";var r=n(503),o=n(1044)(6),i="findIndex",a=!0;i in[]&&Array(1)[i]((function(){a=!1})),r(r.P+r.F*a,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(837)(i)},1044:function(e,t,n){var r=n(831),o=n(648),i=n(840),a=n(835),s=n(1045);e.exports=function(e,t){var n=1==e,c=2==e,d=3==e,u=4==e,l=6==e,f=5==e||l,m=t||s;return function(t,s,p){for(var g,h,C=i(t),y=o(C),v=r(s,p,3),b=a(y.length),T=0,I=n?m(t,b):c?m(t,0):void 0;b>T;T++)if((f||T in y)&&(h=v(g=y[T],T,C),e))if(n)I[T]=h;else if(h)switch(e){case 3:return!0;case 5:return g;case 6:return T;case 2:I.push(g)}else if(u)return!1;return l?-1:d||u?u:I}}},1045:function(e,t,n){var r=n(1046);e.exports=function(e,t){return new(r(e))(t)}},1046:function(e,t,n){var r=n(504),o=n(1047),i=n(838)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),r(t)&&null===(t=t[i])&&(t=void 0)),void 0===t?Array:t}},1047:function(e,t,n){var r=n(834);e.exports=Array.isArray||function(e){return"Array"==r(e)}},1048:function(e,t,n){var r=n(503);r(r.S+r.F,"Object",{assign:n(1049)})},1049:function(e,t,n){"use strict";var r=n(505),o=n(1050),i=n(1054),a=n(1055),s=n(840),c=n(648),d=Object.assign;e.exports=!d||n(506)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||Object.keys(d({},t)).join("")!=r}))?function(e,t){for(var n=s(e),d=arguments.length,u=1,l=i.f,f=a.f;d>u;)for(var m,p=c(arguments[u++]),g=l?o(p).concat(l(p)):o(p),h=g.length,C=0;h>C;)m=g[C++],r&&!f.call(p,m)||(n[m]=p[m]);return n}:d},105:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(95);function o(){return r.a.Web}},1050:function(e,t,n){var r=n(1051),o=n(1053);e.exports=Object.keys||function(e){return r(e,o)}},1051:function(e,t,n){var r=n(830),o=n(833),i=n(832)(!1),a=n(1052)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),c=0,d=[];for(n in s)n!=a&&r(s,n)&&d.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~i(d,n)||d.push(n));return d}},1052:function(e,t,n){var r=n(647)("keys"),o=n(646);e.exports=function(e){return r[e]||(r[e]=o(e))}},1053:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},1054:function(e,t){t.f=Object.getOwnPropertySymbols},1055:function(e,t){t.f={}.propertyIsEnumerable},1056:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifyType=void 0;var r=n(1057),o=n(652);function i(e){e&&o.CustomTypeRegistry.handleError("Type of property does not match type in CustomTypes definition.")}function a(e,t,n){for(var i=0,a=Object.keys(e);i<a.length;i++){var s=a[i],c=t[s];if(c){var d=r.readPropertyInfo(c)[1];e[s]=u(e[s],d,n)}else s.startsWith("$")||o.CustomTypeRegistry.handleError('Property "'+s+'" does not exist in CustomType definition.')}return e}function s(e,t){for(var n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];e[o]=u(e[o],t)}return e}function c(e,t,n){for(var o=0,i=Object.keys(t);o<i.length;o++){var a=i[o],s=r.readPropertyInfo(t[a]),c=s[0],u=s[1];if((e.hasOwnProperty(a)||!c)&&void 0===e[a]){var l=d(void 0,u,n);void 0!==l&&(e[a]=l)}}return e}function d(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!1),!n&&!r&&null==e)if("string"==typeof t)switch(t){case"$string":return"";case"$number":return 0;case"$boolean":return!1;case"$any":return;default:return c(e={},o.CustomTypeRegistry.getTypeInfo(t),n)}else{var i=t[0],a=t[1];switch(i){case"$array":return[];case"$indexer":return{};case"$union":return c(e={},o.CustomTypeRegistry.getTypeInfo(a[0]),n)}}return null!=e?e:void 0}function u(e,t,n){if(void 0===n&&(n=!1),null!=e)if("string"==typeof t)switch(t){case"$string":i("string"!=typeof e);break;case"$number":i("number"!=typeof e);break;case"$boolean":i("boolean"!=typeof e);break;case"$any":if("object"==typeof e)for(var r=0,l=Object.keys(e);r<l.length;r++){var f=l[r];e[f]=u(e[f],t,n)}break;default:var m=o.CustomTypeRegistry.getTypeInfo(t);return m?(a(e,m,n),c(e,m,n)):e}else{var p=t[0],g=t[1];switch(p){case"$array":var h=Array.isArray(e);return i(!h),h?s(e,g):e;case"$indexer":var C=!("object"==typeof e&&Array.isArray(e)||"object"!=typeof e);return i(!C),C?s(e,g):e;case"$union":var y=function(e,t,n){for(var r=0,i=Object.keys(t);r<i.length;r++){for(var a=i[r],s=!0,c=o.CustomTypeRegistry.getTypeInfo(t[a]),d=0,u=Object.keys(e);d<u.length;d++){if(!c[u[d]]){s=!1;break}}if(s)return c}}(e,g);return y?(a(e,y,n),c(e,y,n)):(o.CustomTypeRegistry.handleError("Json object is not assignable to any custom type in union."),e);case"$optional":return u(e,g),d(e,t,n,!0);case"$external":if("object"==typeof e){e=u(e,"$any",n);var v=o.CustomTypeRegistry.getExternalType(g);if(v&&v.parse)return v.parse(e)}}}else e=d(e,t,n);return e}t.verifyType=u},1057:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readPropertyInfo=void 0,t.readPropertyInfo=function(e){return Array.isArray(e)&&2===e.length&&"opt-field"===e[0]?[!0,e[1]]:[!1,e]}},1058:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 192 768 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1059:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850"}))}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1060:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 1920 128 v 1280 h -256 v 512 l -512 -512 h -1024 v -512 h 128 v 384 h 949 l 331 331 v -331 h 256 v -1024 h -1024 v -128 m 128 384 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1061:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 896 512 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 m 1024 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -640 h 128 v 512 h 256 v 331 l 331 -331 h 949 v -1024 h -1024 v -128 z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1062:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("path",{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:0}),r.createElement("path",{type:"path",className:"OfficeIconColors_m22",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:1})])}o.defaultProps={height:"100%",width:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1063:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M0,7.93,1.32,4,0,0,11.9,4ZM2,3.59H8.41L1.18,1.18ZM1.18,6.75,8.41,4.34H2Z"}))}o.defaultProps={viewBox:"-0.25 0.5 11.9 7.93",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1064:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M9.75,2.25H9v8.63a1,1,0,0,1-.09.43,1.1,1.1,0,0,1-.6.6,1,1,0,0,1-.43.09h-6a1,1,0,0,1-.44-.09,1.1,1.1,0,0,1-.6-.6,1,1,0,0,1-.09-.43V2.25H0V1.5H3V.75A.68.68,0,0,1,3.06.46.78.78,0,0,1,3.22.22.78.78,0,0,1,3.46.06.68.68,0,0,1,3.75,0H6a.68.68,0,0,1,.29.06.78.78,0,0,1,.24.16.78.78,0,0,1,.16.24.68.68,0,0,1,.06.29V1.5h3Zm-1.5,0H1.5v8.63a.38.38,0,0,0,.11.26.39.39,0,0,0,.27.11h6a.38.38,0,0,0,.37-.37Zm-4.5,7.5H3v-6h.75Zm0-8.25H6V.75H3.75Zm1.5,8.25H4.5v-6h.75Zm1.5,0H6v-6h.75Z"})))])}o.defaultProps={viewBox:"0 0 9.75 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1065:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M12,2a1.93,1.93,0,0,1-.15.75,1.87,1.87,0,0,1-.42.65L3.71,11.07,0,12,.93,8.29,8.64.57A1.87,1.87,0,0,1,9.29.15,1.93,1.93,0,0,1,10,0a1.79,1.79,0,0,1,.76.16,1.79,1.79,0,0,1,.62.42,1.79,1.79,0,0,1,.42.62A1.79,1.79,0,0,1,12,2ZM1,11,3,10.49A1.84,1.84,0,0,0,2.77,10a2.29,2.29,0,0,0-.32-.43A2.29,2.29,0,0,0,2,9.23,1.84,1.84,0,0,0,1.51,9Zm.88-2.6a2.64,2.64,0,0,1,1.72,1.72L10,3.75,8.25,2ZM10.5,3.22l.28-.28A2,2,0,0,0,11,2.67a1.34,1.34,0,0,0,.17-.31A1.14,1.14,0,0,0,11.25,2a1,1,0,0,0-.1-.47A1.2,1.2,0,0,0,10.5.85,1,1,0,0,0,10,.75a1.14,1.14,0,0,0-.39.06A1.34,1.34,0,0,0,9.33,1a2,2,0,0,0-.27.24l-.28.28Z"})))])}o.defaultProps={viewBox:"0 0 12 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1066:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M0,5,.53,4.5,3.64,7.61,11.25,0l.53.53L3.64,8.67Z"})))])}o.defaultProps={viewBox:"0 0 10 10",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1067:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 m 1547 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -73 -31 q -38 -14 -80 -22 l 75 -75 z",key:0}),r.createElement("path",{className:"reopenThreadIconShading",fillOpacity:"1.000",d:"M 1073 1344 h -203 l -422 422 v -422 h -256 v -561 l 384 385 l 195 -196 l -25 46 m 1110 -826 v 1152 h -723 l 105 -160 q 52 -79 79 -168 q 27 -90 27 -184 q 0 -115 -39 -220 q -40 -105 -109 -188 q -69 -84 -164 -141 q -95 -58 -206 -80 l 11 -11 z",key:1}),r.createElement("path",{className:"reopenThreadIconArrow",fillOpacity:"1.000",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -74 -31 q -38 -14 -79 -22 l 75 -75 z",key:2}),r.createElement("path",{className:"reopenThreadIconBubble",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 z",key:3})])}o.defaultProps={width:"14",height:"14",viewBox:"200,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1068:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("path",{className:"cls-1",d:"M7.5 0C8.19271 0 8.85677 0.0885417 9.49219 0.265625C10.1328 0.442708 10.7318 0.695312 11.2891 1.02344C11.8464 1.34635 12.3516 1.73698 12.8047 2.19531C13.263 2.64844 13.6536 3.15365 13.9766 3.71094C14.3047 4.26823 14.5573 4.86719 14.7344 5.50781C14.9115 6.14323 15 6.80729 15 7.5C15 8.19271 14.9115 8.85938 14.7344 9.5C14.5573 10.1354 14.3047 10.7318 13.9766 11.2891C13.6536 11.8464 13.263 12.3542 12.8047 12.8125C12.3516 13.2656 11.8464 13.6562 11.2891 13.9844C10.7318 14.3073 10.1328 14.5573 9.49219 14.7344C8.85677 14.9115 8.19271 15 7.5 15C6.80729 15 6.14062 14.9115 5.5 14.7344C4.86458 14.5573 4.26823 14.3073 3.71094 13.9844C3.15365 13.6562 2.64583 13.2656 2.1875 12.8125C1.73438 12.3542 1.34375 11.8464 1.01562 11.2891C0.692708 10.7318 0.442708 10.1354 0.265625 9.5C0.0885417 8.85938 0 8.19271 0 7.5C0 6.80729 0.0885417 6.14323 0.265625 5.50781C0.442708 4.86719 0.692708 4.26823 1.01562 3.71094C1.34375 3.15365 1.73438 2.64844 2.1875 2.19531C2.64583 1.73698 3.15365 1.34635 3.71094 1.02344C4.26823 0.695312 4.86458 0.442708 5.5 0.265625C6.14062 0.0885417 6.80729 0 7.5 0ZM7.5 14C8.09375 14 8.66667 13.9219 9.21875 13.7656C9.77604 13.6094 10.2943 13.3906 10.7734 13.1094C11.2578 12.8281 11.6979 12.4896 12.0938 12.0938C12.4896 11.6979 12.8281 11.2604 13.1094 10.7812C13.3906 10.2969 13.6094 9.77865 13.7656 9.22656C13.9219 8.67448 14 8.09896 14 7.5C14 6.90625 13.9219 6.33333 13.7656 5.78125C13.6094 5.22396 13.3906 4.70573 13.1094 4.22656C12.8281 3.74219 12.4896 3.30208 12.0938 2.90625C11.6979 2.51042 11.2578 2.17188 10.7734 1.89062C10.2943 1.60938 9.77604 1.39062 9.21875 1.23438C8.66667 1.07812 8.09375 1 7.5 1C6.90104 1 6.32552 1.07812 5.77344 1.23438C5.22135 1.39062 4.70312 1.60938 4.21875 1.89062C3.73958 2.17188 3.30208 2.51042 2.90625 2.90625C2.51042 3.30208 2.17188 3.74219 1.89062 4.22656C1.60938 4.70573 1.39062 5.22396 1.23438 5.78125C1.07812 6.33333 1 6.90625 1 7.5C1 8.09375 1.07812 8.66927 1.23438 9.22656C1.39062 9.77865 1.60938 10.2969 1.89062 10.7812C2.17188 11.2604 2.51042 11.6979 2.90625 12.0938C3.30208 12.4896 3.73958 12.8281 4.21875 13.1094C4.70312 13.3906 5.22135 13.6094 5.77344 13.7656C6.32552 13.9219 6.90104 14 7.5 14ZM7 4H8V9H7V4ZM7 10H8V11H7V10Z",fill:"#252423",key:1})])}o.defaultProps={width:"15",height:"15",viewBox:"0 0 15 15",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1069:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(0.000000, 0.648438)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Reassign",points:"7.52636719 0 13.9589844 6.43261719 7.52636719 12.8652344 6.91113281 12.25 12.2910156 6.87011719 0 6.87011719 0 5.99511719 12.2910156 5.99511719 6.91113281 0.615234375"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 14 14",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1070:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-32.000000, -2.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Resolve",points:"42.5673828 2.625 43.1826172 3.24023438 35.875 10.5546875 32.0673828 6.74023438 32.6826172 6.125 35.875 9.31054688"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 9",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1071:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-62.000000, -26.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Cancel",points:"73.5888672 27.0839844 68.8720703 31.8076172 73.5888672 36.53125 72.9736328 37.1464844 68.25 32.4296875 63.5263672 37.1464844 62.9111328 36.53125 67.6279297 31.8076172 62.9111328 27.0839844 63.5263672 26.46875 68.25 31.1855469 72.9736328 26.46875"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 11",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1072:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-30.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M44.625,27.0976562 C44.625,27.398439 44.5680344,27.6901028 44.4541016,27.9726562 C44.3401687,28.2552097 44.1738292,28.5058583 43.9550781,28.7246094 L34.9521484,37.7275391 L30.625,38.8076172 L31.7050781,34.4804688 L40.7080078,25.4775391 C40.9267589,25.258788 41.1774074,25.0924485 41.4599609,24.9785156 C41.7425144,24.8645828 42.0341782,24.8076172 42.3349609,24.8076172 C42.6494156,24.8076172 42.9456366,24.8680007 43.2236328,24.9887695 C43.501629,25.1095384 43.7443023,25.2735992 43.9516602,25.480957 C44.159018,25.6883148 44.3230788,25.9309882 44.4438477,26.2089844 C44.5646165,26.4869806 44.625,26.7832016 44.625,27.0976562 Z M32.8535156,34.5693359 C33.336591,34.7288419 33.7524397,34.9829084 34.1010742,35.331543 C34.4497088,35.6801775 34.7037752,36.0960262 34.8632812,36.5791016 L42.2529297,29.1826172 L40.25,27.1796875 L32.8535156,34.5693359 Z M31.828125,37.6044922 L34.0771484,37.0439453 C34.0315753,36.8343088 33.95752,36.6360686 33.8549805,36.4492188 C33.7524409,36.2623689 33.6282559,36.0960294 33.4824219,35.9501953 C33.3365878,35.8043612 33.1702483,35.6801763 32.9833984,35.5776367 C32.7965485,35.4750971 32.5983083,35.4010419 32.3886719,35.3554688 L31.828125,37.6044922 Z M42.875,28.5605469 C42.9889329,28.446614 43.0983068,28.3395187 43.203125,28.2392578 C43.3079432,28.1389969 43.4013668,28.0330409 43.4833984,27.9213867 C43.5654301,27.8097325 43.6303709,27.6889655 43.6782227,27.559082 C43.7260745,27.4291986 43.75,27.2776701 43.75,27.1044922 C43.75,26.9085277 43.7124027,26.7250985 43.637207,26.5541992 C43.5620113,26.3832999 43.4594733,26.2329108 43.3295898,26.1030273 C43.1997064,25.9731439 43.0493173,25.8706058 42.878418,25.7954102 C42.7075187,25.7202145 42.5240895,25.6826172 42.328125,25.6826172 C42.1549471,25.6826172 42.0034186,25.7065427 41.8735352,25.7543945 C41.7436517,25.8022463 41.6228847,25.8671871 41.5112305,25.9492188 C41.3995763,26.0312504 41.2936203,26.124674 41.1933594,26.2294922 C41.0930985,26.3343104 40.9860032,26.4436843 40.8720703,26.5576172 L42.875,28.5605469 Z",id:"Edit"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",x:"0",y:"0",viewBox:"0 0 15 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1073:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("path",{d:"M1 4L3.5 6.5L9 1"}))}o.defaultProps={viewBox:"0 0 10 8",focusable:"false",fill:"none",fillOpacity:"0.0"},e.exports=o,o.default=o},1074:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:0}),r.createElement("path",{fill:"currentColor",fillOpacity:"1.000",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:1})])}o.defaultProps={width:"12",height:"12",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1075:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"***-Symbols",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("path",{d:"M14.5,5 C14.703126,5 14.8958324,5.03906211 15.078125,5.1171875 C15.2604176,5.19531289 15.4205722,5.30208266 15.5585938,5.4375 C15.6966153,5.57291734 15.8046871,5.73176992 15.8828125,5.9140625 C15.9609379,6.09635508 16,6.29166562 16,6.5 C16,6.6666675 15.9739586,6.82552008 15.921875,6.9765625 L13.921875,12.9765625 C13.8697914,13.1276049 13.7968755,13.2669264 13.703125,13.3945312 C13.6093745,13.5221361 13.5,13.6302079 13.375,13.71875 C13.2499994,13.8072921 13.113282,13.8763018 12.9648438,13.9257812 C12.8164055,13.9752607 12.6614591,14 12.5,14 L8.5,14 C7.56770367,14 6.66927516,13.8203143 5.8046875,13.4609375 C5.42968563,13.3098951 5.0533873,13.1953129 4.67578125,13.1171875 C4.2981752,13.0390621 3.90625203,13 3.5,13 L0,13 L0,6 L3.2578125,6 C3.59635586,6 3.91536309,5.93750062 4.21484375,5.8125 C4.51432441,5.68749938 4.78385297,5.50520953 5.0234375,5.265625 L9.8828125,0.4140625 C10.0130215,0.283853516 10.1432285,0.182292031 10.2734375,0.109375 C10.4036465,0.0364579688 10.5624991,0 10.75,0 C10.9218759,0 11.0833326,0.0325517578 11.234375,0.09765625 C11.3854174,0.162760742 11.5182286,0.252603594 11.6328125,0.3671875 C11.7473964,0.481771406 11.8372393,0.614582578 11.9023438,0.765625 C11.9674482,0.916667422 12,1.07812414 12,1.25 C12,1.67187711 11.9531255,2.07421684 11.859375,2.45703125 C11.7656245,2.83984566 11.6276051,3.21874813 11.4453125,3.59375 C11.3411453,3.81770945 11.2526045,4.04557176 11.1796875,4.27734375 C11.1067705,4.50911574 11.0572918,4.74999875 11.03125,5 L14.5,5 Z M1,12 L3.5,12 C3.9734466,12 4.4332293,12.0458255 4.87838685,12.1379271 C5.31513303,12.2282884 5.74859274,12.3602761 6.18851278,12.5375318 C6.93158683,12.8463999 7.69958736,13 8.5,13 L12.5,13 C12.5548236,13 12.602973,12.9923123 12.648616,12.977098 C12.7042395,12.9585568 12.7526835,12.9341041 12.7969807,12.9027269 C12.8337665,12.8766702 12.8664285,12.8443971 12.8972432,12.8024548 C12.9312256,12.7562009 12.9571761,12.7066171 12.9731917,12.6603347 L14.976502,6.65057182 C14.9920216,6.60556505 15,6.55689677 15,6.5 C15,6.42541757 14.9877526,6.36418032 14.9636675,6.3079818 C14.9365874,6.244795 14.9025618,6.19478151 14.8582531,6.15130876 C14.8093393,6.10331783 14.7532414,6.06591924 14.6842057,6.03633253 C14.6271661,6.01188698 14.5685237,6 14.5,6 L9.92167262,6 L10.0366316,4.89639392 C10.0695629,4.58025353 10.1325645,4.27353503 10.2257814,3.97723847 C10.311817,3.70376821 10.4161404,3.43528887 10.5459446,3.15655729 C10.6976958,2.8443835 10.8114223,2.53217213 10.8880777,2.21916252 C10.9624237,1.91558304 11,1.59305299 11,1.25 C11,1.21274116 10.9946165,1.18603901 10.9840197,1.16145435 C10.9688056,1.12615764 10.9504819,1.09907042 10.9257057,1.07429428 C10.9009296,1.04951814 10.8738424,1.03119444 10.8385457,1.01598034 C10.813961,1.0053835 10.7872588,1 10.75,1 C10.7324276,1 10.7311357,0.999063781 10.7416579,0.993076126 L10.7490693,0.989479263 C10.7056707,1.01597571 10.651885,1.05920353 10.5893502,1.12173792 L5.73054428,5.97273178 C5.3997463,6.30352976 5.02122029,6.55953769 4.60002886,6.73533933 C4.17716132,6.91184057 3.72718088,7 3.2578125,7 L1,7 L1,12 Z",id:"icon_outlined",fill:"#2B5C9C",fillRule:"nonzero"})))}o.defaultProps={width:"16px",height:"14px",viewBox:"0 0 16 14",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1076:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"***-Symbols",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("path",{d:"M14.5,5 C14.703126,5 14.8958324,5.03906211 15.078125,5.1171875 C15.2604176,5.19531289 15.4205722,5.30208266 15.5585938,5.4375 C15.6966153,5.57291734 15.8046871,5.73176992 15.8828125,5.9140625 C15.9609379,6.09635508 16,6.29166563 16,6.5 C16,6.6666675 15.9739586,6.82552008 15.921875,6.9765625 L13.921875,12.9765625 C13.8697914,13.1276049 13.7968755,13.2669264 13.703125,13.3945312 C13.6093745,13.5221361 13.5,13.6302079 13.375,13.71875 C13.2499994,13.8072921 13.113282,13.8763018 12.9648438,13.9257812 C12.8164055,13.9752607 12.6614591,14 12.5,14 L8.5,14 C7.56770367,14 6.66927516,13.8203143 5.8046875,13.4609375 C5.42968563,13.3098951 5.0533873,13.1953129 4.67578125,13.1171875 C4.2981752,13.0390621 3.90625203,13 3.5,13 L0,13 L0,6 L3.2578125,6 C3.59635586,6 3.91536309,5.93750062 4.21484375,5.8125 C4.51432441,5.68749938 4.78385297,5.50520953 5.0234375,5.265625 L9.8828125,0.4140625 C10.0130215,0.283853516 10.1432285,0.182292031 10.2734375,0.109375 C10.4036465,0.0364579687 10.5624991,0 10.75,0 C10.9218759,0 11.0833326,0.0325517578 11.234375,0.09765625 C11.3854174,0.162760742 11.5182286,0.252603594 11.6328125,0.3671875 C11.7473964,0.481771406 11.8372393,0.614582578 11.9023438,0.765625 C11.9674482,0.916667422 12,1.07812414 12,1.25 C12,1.67187711 11.9531255,2.07421684 11.859375,2.45703125 C11.7656245,2.83984566 11.6276051,3.21874812 11.4453125,3.59375 C11.3411453,3.81770945 11.2526045,4.04557176 11.1796875,4.27734375 C11.1067705,4.50911574 11.0572918,4.74999875 11.03125,5 L14.5,5 Z",id:"icon_filled",fill:"#2B5C9C"})))}o.defaultProps={width:"16px",height:"14px",viewBox:"0 0 16 14",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1077:function(e){e.exports={SharedCommentsVersion:"2.58.36"}},108:function(e,t,n){"use strict";var r;function o(e){return e.actionType===r.CreateThread&&void 0!==e.content}function i(e){return e.actionType===r.CancelCreateThread}function a(e){return e.actionType===r.StartReplySession&&void 0!==e.threadId}function s(e){return e.actionType===r.CancelReplySession&&void 0!==e.threadId}function c(e){return e.actionType===r.PostReply&&void 0!==e.threadId&&void 0!==e.content}function d(e){return e.actionType===r.DeleteComment&&void 0!==e.commentId}function u(e){return e.actionType===r.DeleteThread&&void 0!==e.threadId}function l(e){return e.actionType===r.ResolveThread&&void 0!==e.threadId}function f(e){return e.actionType===r.ReopenThread&&void 0!==e.threadId}function m(e){return e.actionType===r.StartEditSession&&void 0!==e.commentId}function p(e){return e.actionType===r.CancelEditSession&&void 0!==e.commentId}function g(e){return e.actionType===r.PostEdit&&void 0!==e.commentId&&void 0!==e.content}function h(e){return e.actionType===r.SelectComment&&void 0!==e.commentId}function C(e){return e.actionType===r.ClosePane}function y(e){return e.actionType===r.ClickGhostCard}n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"p",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"k",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return u})),n.d(t,"m",(function(){return l})),n.d(t,"l",(function(){return f})),n.d(t,"o",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"j",(function(){return g})),n.d(t,"n",(function(){return h})),n.d(t,"f",(function(){return C})),n.d(t,"e",(function(){return y})),function(e){e.CreateThread="CreateThread",e.CancelCreateThread="CancelCreateThread",e.StartReplySession="StartReplySession",e.CancelReplySession="CancelReplySession",e.PostReply="PostReply",e.DeleteComment="DeleteComment",e.DeleteThread="DeleteThread",e.ResolveThread="ResolveThread",e.ReopenThread="ReopenThread",e.StartEditSession="StartEditSession",e.CancelEditSession="CancelEditSession",e.PostEdit="PostEdit",e.SelectComment="SelectComment",e.ClosePane="ClosePane",e.ClickGhostCard="ClickGhostCard"}(r||(r={}))},11:function(e,t,n){"use strict";n.d(t,"k",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"u",(function(){return l})),n.d(t,"n",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"j",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"o",(function(){return h})),n.d(t,"i",(function(){return C})),n.d(t,"r",(function(){return y})),n.d(t,"p",(function(){return v})),n.d(t,"m",(function(){return b})),n.d(t,"q",(function(){return T})),n.d(t,"c",(function(){return I})),n.d(t,"b",(function(){return O})),n.d(t,"f",(function(){return S})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return D})),n.d(t,"s",(function(){return w})),n.d(t,"z",(function(){return _})),n.d(t,"y",(function(){return P})),n.d(t,"x",(function(){return k})),n.d(t,"v",(function(){return R})),n.d(t,"l",(function(){return F})),n.d(t,"w",(function(){return N})),n.d(t,"t",(function(){return M}));var r=n(92),o=n(20),i=n(347),a=n(83),s=n(7),c=n(15),d=function(e){return e.commentState.contextState.isReadOnly},u=function(e){return e.commentState.atMentionState},l=function(e){return e.commentState.topVisibleThreadId},f=function(e){return e.commentState.personaIconPropertiesMap},m=function(e){return e.commentState.cardViewState},p=function(e){return e.commentState.highlightedCommentId},g=function(e){return e.commentState.commentData},h=function(e){return e.commentState.postViewState},C=function(e){return e.commentState.draftState},y=function(e){return Object(c.H)(C(e))},v=function(e){return e.commentState.selectedComment},b=function(e){return e.commentState.pendingCommentLoad},T=function(e){return e.commentState.selectedThreadIdBeforeCommentSession},I=function(e){return e.commentState.capabilities},O=function(e){return e.commentState.authToken},S=function(e){return e.commentState.contextState},j=function(e){return e.commentState.createdCommentLie},D=function(e){var t=j(e),n=C(e);return Object(c.M)(t,n)?t:void 0},w=function(e){var t=v(e),n=C(e);if(void 0!==t){var r=t.selectedCardId,o=n.cardIdToDraftIdMap[r];return n.drafts[o]}},_=function(){return Object(r.a)([v,g],(function(e,t){return e?{selectedComment:e,index:Object(c.n)(t,e)}:void 0}))},x={},E=function(e){return s.b()?e.taskState.tasks:x},P=function(){return Object(r.a)([g,E],a.l)},A=function(e,t){return t},k=function(e){return Object(r.a)([C,j,m,e,A],(function(e,t,n,r,s){return a.b(r,n,t,s.renderContextType!==o.a.HalfPane,Object(i.b)(e,s.renderContextType))}))},R=function(e){return e.commentState.virtualized},F=function(e){return e.commentState.modelCapabilities},N=function(){return Object(r.a)(C,(function(e){var t;return null===(t=Object(c.H)(e))||void 0===t?void 0:t.renderContextType}))},M=function(e){return e.commentState.suggestionsDetails}},110:function(e,t,n){"use strict";n.d(t,"h",(function(){return u})),n.d(t,"j",(function(){return f})),n.d(t,"i",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"c",(function(){return C})),n.d(t,"d",(function(){return y})),n.d(t,"a",(function(){return v})),n.d(t,"m",(function(){return b})),n.d(t,"l",(function(){return T})),n.d(t,"k",(function(){return I})),n.d(t,"b",(function(){return O}));var r=n(3),o=n(95),i=n(105),a=n(922),s=n(21),c=n(7);function d(e){return!!e&&void 0!==e.EmailAddresses}function u(e){return!!e&&void 0!==e.UserId}function l(e){return!!e&&void 0!==e.Id&&void 0!==e.Email}function f(e,t){return!(!e||!t)&&(e.UserId===t.UserId&&e.Provider===t.Provider)}function m(e,t){return u(e)&&u(t)?f(e,t):l(e)&&l(t)?function(e,t){return e.Id===t.Id&&e.Email===t.Email}(e,t):!(!d(e)||!d(t))&&function(e,t){return g(e)===g(t)&&e.Name===t.Name}(e,t)}function p(e){return e?d(e)?e.Name:e.DisplayName:""}function g(e){if(!e)return"";if(!d(e))return Object(r.g)().assertConditionTag(!c.G()||Object(a.b)(Object(i.a)()),"LPP feature gate should not be enabled",594392914),e.Email;if(e.UserPrincipalName.length>0)return e.UserPrincipalName;if(e.EmailAddresses.length>0&&e.EmailAddresses[0].length>0)return Object(r.g)().assertConditionTag(Object(i.a)()===o.a.Windows,"UserPrincipalName is not available, fallback to EmailAddresses",594401410),e.EmailAddresses[0];throw new s.a("UserPrincipalName and EmailAddresses, both not available",-2130957499)}function h(e){return void 0!==e.DisplayName?e.DisplayName:(Object(r.g)().assertConditionTag(!1,"user.DisplayName is not undefined",595133131),e.Email?e.Email:"")}function C(e){return e.author?e.author:{UserId:e.authorIdentity,Provider:"",DisplayName:e.authorName,Email:e.authorEmail,IsCurrentUser:!0,appAuthorId:e.appAuthorId,authorContextId:e.authorContextId}}function y(e){return 0===Object.keys(e).length&&Object(r.g)().assertConditionTag(!1,"MentioneeMap should not be empty",594641282),e[Object.keys(e)[0]].mentionee}function v(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!f(e[n],t[n]))return!1;return!0}function b(e,t){if(e.size!==t.size)return!0;var n=!1;return e.forEach((function(e){t.has(e)||(n=!0)})),n}function T(e,t){return e.filter((function(e){return!t.find((function(t){return f(e,t)}))}))}function I(e,t){return t.forEach((function(t){t.UserId&&e[t.UserId]?delete e[t.UserId]:t.Email&&e[t.Email]&&delete e[t.Email]})),e}function O(e){var t={};for(var n in e)e[n].stillInDraft&&(t[n]=e[n]);return t}},111:function(e,t,n){"use strict";var r=n(463),o=n(203);n.d(t,"i",(function(){return r.a})),n.d(t,"j",(function(){return r.c})),n.d(t,"l",(function(){return r.e})),n.d(t,"k",(function(){return r.d})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"c",(function(){return o.c})),n.d(t,"d",(function(){return o.e})),n.d(t,"g",(function(){return o.i})),n.d(t,"e",(function(){return o.f})),n.d(t,"f",(function(){return o.g})),n.d(t,"h",(function(){return o.j}))},113:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unhandled=0]="Unhandled",e[e.Handled=1]="Handled",e[e.Canceled=2]="Canceled",e[e.Failed=3]="Failed"}(r||(r={}))},114:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a}));var r="CREATE",o="EDIT",i="REPLY",a="METADATA"},115:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n(176),o=n(94),i=n(114);function a(e){return e.sessionType===i.a}function s(e){return e.sessionType===i.d&&void 0!==e.threadId}function c(e){return e.sessionType===i.b&&void 0!==e.commentId}var d={CREATE:0,REPLY:1,EDIT:2,METADATA:3},u={CREATE:o.a.Insert,REPLY:o.a.Insert,EDIT:o.a.Modify,METADATA:o.a.Modify};function l(e){return a(e)?r.a.InitCreateCommentSession:s(e)?r.a.InitReplyCommentSession:c(e)?r.a.InitEditCommentSession:r.a.Unknown}},117:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Placeholder=0]="Placeholder",e[e.Loaded=1]="Loaded",e[e.Loading=2]="Loading",e[e.Reloading=3]="Reloading",e[e.NeedsReload=4]="NeedsReload"}(r||(r={}))},120:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Closed=1]="Closed",e[e.Hidden=2]="Hidden",e[e.Visible=3]="Visible"}(r||(r={}))},122:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CommentContextChanged=0]="CommentContextChanged",e[e.LoadComments=1]="LoadComments",e[e.CommentContextReload=2]="CommentContextReload",e[e.CommentsInserted=3]="CommentsInserted",e[e.CommentsDeleted=4]="CommentsDeleted",e[e.CommentsUpdated=5]="CommentsUpdated",e[e.CommentSelected=6]="CommentSelected",e[e.CommentHighlighted=7]="CommentHighlighted",e[e.NextPopulatedContextDetailsUpdated=8]="NextPopulatedContextDetailsUpdated",e[e.CommentError=9]="CommentError",e[e.CommentsChanged=10]="CommentsChanged",e[e.CommentHostCapabilitiesChanged=11]="CommentHostCapabilitiesChanged",e[e.ModelCapabilitiesChanged=12]="ModelCapabilitiesChanged",e[e.UpdateDraftThread=13]="UpdateDraftThread",e[e.ReturnToDraftRequested=14]="ReturnToDraftRequested",e[e.SmartReplyPopulated=15]="SmartReplyPopulated"}(r||(r={}))},124:function(e,t,n){"use strict";var r,o;!function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Previous=2]="Previous"}(o||(o={}));var i=function(){function e(e){this.apiContext=e}return e.prototype.selectNextOrPreviousContent=function(e,t){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){},e}(),a=n(202),s=n(3),c=function(){function e(){}return e.prototype.selectNextOrPreviousContent=function(e,t){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){},e}(),d=void 0;function u(e,t){if(!d)throw new Error("Running in an invalid environment, window expected to exist.");Object(s.g)().assertConditionTag(void 0===d.ContentNavigationAPI,"Overriding already set ContentNavigationAPI.",591726551),d.ContentNavigationAPI=e}function l(e){if(Object(s.g)().assertConditionTag(e===a.a,"Unexpected API context received.",591726552),!d)throw new Error("Running in an invalid environment, window expected to exist.");return void 0===d.ContentNavigationAPI&&(Object(s.g)().assertConditionTag(!1,"GetContentNavigationAPI called prior to API being set, overriding with stub.",591726553),d.ContentNavigationAPI=new c),d.ContentNavigationAPI}function f(e){return Object(s.g)().assertConditionTag(e===a.a,"Unexpected API context received.",591726554),void 0!==d.ContentNavigationAPI}function m(e){Object(s.g)().assertConditionTag(e===a.a,"Unexpected API context received.",591726555),d.ContentNavigationAPI=void 0}"undefined"!=typeof window&&(d=window),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"c",(function(){return c}))},125:function(e,t,n){"use strict";var r=n(111),o=(n(721),n(213),n(465));n.d(t,"h",(function(){return r.i})),n.d(t,"k",(function(){return r.l})),n.d(t,"i",(function(){return r.k})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"f",(function(){return r.g})),n.d(t,"c",(function(){return r.e})),n.d(t,"e",(function(){return r.f})),n.d(t,"g",(function(){return r.h})),n.d(t,"d",(function(){return o.b})),n.d(t,"j",(function(){return o.d}))},131:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.NeedDrafting=1]="NeedDrafting",e[e.NeedNotDrafting=2]="NeedNotDrafting"}(r||(r={}))},135:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(20);function o(e){return e===r.a.FullPane||e===r.a.HalfPane}function i(e){return e===r.a.DiscreteIntegrated||e===r.a.DiscreteIsolated}},136:function(e,t,n){"use strict";var r,o=n(1),i=o.createContext(void 0);function a(e){return e&&e.getFocusState&&e.getId&&e.getData&&e.getNextTabTarget&&e.isTabbable&&e.getChildNodes&&e.addChildNode&&e.getDescendantById&&((t=e)&&t.focus&&t.blur);var t}!function(e){e[e.Forward=0]="Forward",e[e.Reverse=1]="Reverse"}(r||(r={}));var s=n(67),c=n(752),d=n(0);s.c.Tab,s.a.AtTarget,s.c.Tab,s.a.AtTarget;var u=n(322);function l(e){return e.isFocusOn?u.a.FocusOn:e.isFocusWithin?u.a.FocusWithin:u.a.Unfocused}n(809),function(){function e(e,t,n,r,i){this.nodeId=e,this.nodeData=t,this.tabbable=n,this.onFocusStateChange=r,this.focusState=i,this.registrationRef=o.createRef(),this.innerComponentRef=o.createRef()}e.prototype.onEffect=function(e,t,n,r){this.nodeData=e,this.tabbable=t,this.onFocusStateChange=n;var o=this.focusState;this.focusState=r,l(o)!==l(this.focusState)&&(this.onFocusStateChange&&this.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},e.prototype.getIterator=function(){return Object(d.__generator)(this,(function(e){switch(e.label){case 0:return[4,this];case 1:return e.sent(),[2]}}))},e.prototype.getId=function(){return this.nodeId||""},e.prototype.getData=function(){return this.nodeData?this.nodeData():this},e.prototype.getFocusState=function(){return l(this.focusState)},e.prototype.getNextTabTarget=function(){return this.getFocusState()===u.a.Unfocused&&this.isTabbable()?this:void 0},e.prototype.isTabbable=function(){return!!this.tabbable},e.prototype.getChildNodes=function(){return[]},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(){},e.prototype.focus=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.focus()},e.prototype.blur=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.blur()}}();!function(){function e(t){this.def=t,this.childNodes=[],this.focus=jest.fn(),this.blur=jest.fn(),this.childNodes=t.childNodes.map((function(t){return new e(t)}))}e.prototype.getId=function(){return this.def.id},e.prototype.getData=function(){},e.prototype.getFocusState=function(){return this.def.isFocused?s.b.FocusOn:this.childNodes.some((function(e){return e.getFocusState()!==s.b.Unfocused}))?s.b.FocusWithin:s.b.Unfocused},e.prototype.getNextTabTarget=function(e,t){return function(e,t,n){var o=e.getFocusState();if(o!==s.b.FocusOn||n||t!==r.Reverse){if((o===s.b.Unfocused||n)&&t===r.Forward&&e.isTabbable())return e;var i=e.getChildNodes();t===r.Reverse&&i.reverse();for(var a=n?0:i.findIndex((function(e){return e.getFocusState()!==s.b.Unfocused})),c=a>=0?a:0;c<i.length;++c){var d=i[c].getNextTabTarget(t,n);if(d)return d}return t===r.Reverse&&e.isTabbable()?e:void 0}}(this,e,t)},e.prototype.isTabbable=function(){return this.def.isTabbable},e.prototype.getChildNodes=function(){return this.childNodes.slice()},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(e){var t,n;try{for(var r=Object(d.__values)(this.childNodes),o=r.next();!o.done;o=r.next()){var i=o.value;if(i.getId()===e)return i;for(var a=i.getIterator(),s=void 0;!(s=a.next()).done;)if(s.value.getId()===e)return s.value}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.getIterator=function(){return e=this,function(){var t,n,r,o,i,a,s,c;return Object(d.__generator)(this,(function(u){switch(u.label){case 0:return[4,e];case 1:u.sent(),u.label=2;case 2:u.trys.push([2,8,9,10]),t=Object(d.__values)(e.getChildNodes()),n=t.next(),u.label=3;case 3:if(n.done)return[3,7];r=n.value,o=r.getIterator(),i=void 0,u.label=4;case 4:return(i=o.next()).done?[3,6]:[4,i.value];case 5:return u.sent(),[3,4];case 6:return n=t.next(),[3,3];case 7:return[3,10];case 8:return a=u.sent(),s={error:a},[3,10];case 9:try{n&&!n.done&&(c=t.return)&&c.call(t)}finally{if(s)throw s.error}return[7];case 10:return[2]}}))}();var e}}();var f=function(){var e=this;this.root=null,this.getRoot=function(){return e.root},this.setRoot=function(t){e.root=t}},m=(function(){function e(e){var t=this;this.viewTreeMap=new Map,e&&e.viewTreeMap.forEach((function(e,n){return t.viewTreeMap.set(n,e)}))}e.prototype.getOrCreateViewTreeById=function(e){var t=this.viewTreeMap.get(e);return t||(t=new f,this.viewTreeMap.set(e,t)),t},e.prototype.getViewTrees=function(){return this.viewTreeMap.values()},e.prototype.getDescendantById=function(e){var t,n,r;try{for(var o=Object(d.__values)(this.viewTreeMap.values()),i=o.next();!i.done;i=o.next()){var a=null===(r=i.value.getRoot())||void 0===r?void 0:r.getDescendantById(e);if(a)return a}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}}(),function(){function e(){var e=this;this.ref=o.createRef(),this.focus=function(){e.ref&&e.ref.current&&e.ref.current.focus()},this.blur=function(){e.ref&&e.ref.current&&e.ref.current.blur()},this.getFocusState=function(){return e.ref&&e.ref.current?e.ref.current.getFocusState():s.b.Unfocused},this.getNextTabTarget=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.getNextTabTarget(t,n)},this.isTabbable=function(){return!(!e.ref||!e.ref.current)&&e.ref.current.isTabbable()},this.getChildNodes=function(){return e.ref&&e.ref.current?e.ref.current.getChildNodes():[]},this.addChildNode=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.addChildNode(t,n)},this.getId=function(){return e.ref&&e.ref.current?e.ref.current.getId():""},this.getData=function(){if(e.ref&&e.ref.current)return e.ref.current.getData()},this.getDescendantById=function(t){if(e.ref&&e.ref.current)return e.ref.current.getDescendantById(t)},this.getIterator=function(){return e.ref&&e.ref.current?e.ref.current.getIterator():{next:function(){return{done:!0,value:e}}}}}Object.defineProperty(e.prototype,"disabled",{get:function(){return!(!this.ref.current||!this.ref.current.disabled)},enumerable:!1,configurable:!0})}(),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationToken=void 0,t.onFocusStateChange=function(e){t.registrationToken&&t.registrationToken.onFocusStateChange(e)},t}return Object(d.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.parentNode&&(this.registrationToken=this.props.parentNode.addChildNode(this.props.node,(function(){return e.props.position})))},t.prototype.componentWillUnmount=function(){this.registrationToken&&this.registrationToken.unregister(),this.registrationToken=void 0},t.prototype.render=function(){return o.Children.only(this.props.children)},t}(o.PureComponent));!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationHelperRef=o.createRef(),t.onFocusStateChange=function(e){t.registrationHelperRef.current&&t.registrationHelperRef.current.onFocusStateChange(e)},t}Object(d.__extends)(t,e),t.prototype.render=function(){var e=this;return o.createElement(i.Consumer,null,(function(t){return o.createElement(m,{parentNode:t,node:e.props.node,ref:e.registrationHelperRef,position:e.props.position},e.props.children)}))}}(o.PureComponent);n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return s.a})),n.d(t,"b",(function(){return s.c})),n.d(t,"c",(function(){return s.d})),n.d(t,"d",(function(){return c.a})),n.d(t,"f",(function(){return c.b}))},139:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InCard=1]="InCard",e[e.InChildPost=2]="InChildPost",e[e.InOtherCard=3]="InOtherCard",e[e.InOtherContextOfThisCard=4]="InOtherContextOfThisCard"}(r||(r={}))},14:function(e,t,n){"use strict";var r=n(16),o=n(8);n(532);function i(e,t){return Object(r.b)(o.a.AddToCurrentMentioneesType,{mentionee:t},e)}function a(e,t){return Object(r.b)(o.a.ApplyCommentChangesType,{changes:t},e)}var s=n(455);n(456),n(533),n(534),n(535);function c(e,t){return Object(r.b)(o.a.CancelCommentCreateThreadType,{closeOnDiscard:t},e)}function d(e,t,n){return Object(r.b)(o.a.CancelCommentPostEditType,{commentId:t,closeOnDiscard:n},e)}function u(e,t,n){return Object(r.b)(o.a.CancelCommentReplyType,{commentId:t,closeOnDiscard:n},e)}n(536);var l=n(537),f=n(538);function m(e){return Object(r.b)(o.a.ClearCommentsType,{},e)}var p=n(539);function g(e,t){return Object(r.b)(o.a.ClearPostErrorUIType,{commentId:t},e)}function h(e,t){return Object(r.b)(o.a.CommentContextChangedType,t,e)}var C=n(540);n(275);function y(e,t){return Object(r.b)(o.a.DispatchLoadThreadsType,t,e)}var v=n(323);function b(e,t,n){return Object(r.b)(o.a.DraftEmptinessChangedType,{isEmpty:t,draftId:n},e)}var T=n(292),I=(n(457),n(541));n(542),n(458),n(543);function O(e,t){return Object(r.b)(o.a.MoveFocusToCanvasType,{resource:t},e)}function S(e,t){return Object(r.b)(o.a.NextPopulatedContextDetailsUpdatedType,{nextPopulatedContextDetails:t},e)}function j(e,t){return Object(r.b)(o.a.OnInitialRenderType,t,e)}function D(e,t){return Object(r.b)(o.a.PopulateSmartReplyType,t,e)}function w(e,t){return Object(r.b)(o.a.QueueLoadThreadsType,t,e)}function _(e){return Object(r.b)(o.a.ReadyToRenderType,{},e)}var x=n(544);function E(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(r.b)(o.a.RemoveContentExtensionType,{renderModes:t},e)}function P(e){return Object(r.b)(o.a.RequestClosePaneType,{},e)}function A(e,t){return Object(r.b)(o.a.RequestDeletePostType,{commentId:t},e)}function k(e,t,n){return Object(r.b)(o.a.RequestDeleteThreadType,{commentId:t,isTask:n},e)}n(545);function R(e,t,n,i){return Object(r.b)(o.a.RequestModalConfirmationType,{onConfirm:t,onCancel:n,displayStrings:i},e)}function F(e,t,n){return Object(r.b)(o.a.RequestReopenThreadType,{commentId:t,isTask:n},e)}function N(e){return Object(r.b)(o.a.RequestShowPaneType,{},e)}function M(e,t,n){return Object(r.b)(o.a.RequestThreadResolveType,{commentId:t,isTask:n},e)}n(354);function V(e,t){return Object(r.b)(o.a.SaveDraftType,t,e)}var L=n(99);function U(e,t,n,i){return Object(r.b)(o.a.SelectContentType,{selectDirection:t,from:n,source:i},e)}function B(e){return Object(r.b)(o.a.SelectFirstThreadInNextCommentContextType,{},e)}function H(e){return Object(r.b)(o.a.SelectLastThreadInPreviousCommentContextType,{},e)}n(546);var z=n(547);function W(e,t){return Object(r.b)(o.a.ShowPostErrorUIType,{commentId:t},e)}n(548),n(549);function q(e,t){return Object(r.b)(o.a.UpdateCapabilitiesType,{capabilities:t},e)}n(550);function G(e,t){return Object(r.b)(o.a.UpdateCurrentMentioneesType,{users:t},e)}function Y(e,t,n){return Object(r.b)(o.a.UpdateDraftRenderContextType,{isClaimingLock:t,draftId:n},e)}function K(e,t){return Object(r.b)(o.a.UpdateDraftThreadType,t,e)}function J(e,t){return Object(r.b)(o.a.UpdateExtensionPriorityType,{updates:t},e)}function Q(e,t){return Object(r.b)(o.a.UpdateFocusTypeAfterContextChangeType,{focusTypeAfterContextChange:t},e)}function X(e,t){return Object(r.b)(o.a.UpdateMentioneesStillInDraftType,{emailsStillInDraft:t},e)}function Z(e,t,n){return Object(r.b)(o.a.UpdateModelCapabilitiesType,{modelCapabilityFlags:t,richTextCapabilityFlags:n},e)}function $(e,t){return Object(r.b)(o.a.UpdateSelectedTaskAssigneeType,{selectedAssignee:t},e)}var ee=n(551);function te(e,t){return Object(r.b)(o.a.ViewContainerChangedType,{viewContainer:t},e)}function ne(e,t){return Object(r.b)(o.a.ViewContainerFoldableLayoutStateChangedType,{foldableLayoutState:t},e)}function re(e,t){return Object(r.b)(o.a.ViewContainerVisibilityChangedType,{visibilityState:t},e)}n.d(t,"j",(function(){return r.a})),n.d(t,"a",(function(){return o.a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return s.a})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return u})),n.d(t,"k",(function(){return l.a})),n.d(t,"l",(function(){return f.a})),n.d(t,"n",(function(){return m})),n.d(t,"m",(function(){return p.a})),n.d(t,"o",(function(){return g})),n.d(t,"p",(function(){return h})),n.d(t,"q",(function(){return C.a})),n.d(t,"r",(function(){return y})),n.d(t,"s",(function(){return v.a})),n.d(t,"t",(function(){return b})),n.d(t,"b",(function(){return T.a})),n.d(t,"u",(function(){return I.a})),n.d(t,"v",(function(){return O})),n.d(t,"w",(function(){return S})),n.d(t,"x",(function(){return j})),n.d(t,"y",(function(){return D})),n.d(t,"z",(function(){return w})),n.d(t,"A",(function(){return _})),n.d(t,"B",(function(){return x.a})),n.d(t,"C",(function(){return E})),n.d(t,"D",(function(){return P})),n.d(t,"E",(function(){return A})),n.d(t,"F",(function(){return k})),n.d(t,"G",(function(){return R})),n.d(t,"H",(function(){return F})),n.d(t,"I",(function(){return N})),n.d(t,"J",(function(){return M})),n.d(t,"K",(function(){return V})),n.d(t,"c",(function(){return L.a})),n.d(t,"L",(function(){return L.b})),n.d(t,"M",(function(){return U})),n.d(t,"N",(function(){return B})),n.d(t,"O",(function(){return H})),n.d(t,"P",(function(){return z.a})),n.d(t,"Q",(function(){return W})),n.d(t,"R",(function(){return q})),n.d(t,"S",(function(){return G})),n.d(t,"T",(function(){return Y})),n.d(t,"U",(function(){return K})),n.d(t,"V",(function(){return J})),n.d(t,"W",(function(){return Q})),n.d(t,"X",(function(){return X})),n.d(t,"Y",(function(){return Z})),n.d(t,"Z",(function(){return $})),n.d(t,"ab",(function(){return ee.a})),n.d(t,"bb",(function(){return te})),n.d(t,"cb",(function(){return ne})),n.d(t,"db",(function(){return re}))},140:function(e,t,n){"use strict";var r;!function(e){e[e.CancelNewDraft=0]="CancelNewDraft",e[e.CancelReplyDraft=1]="CancelReplyDraft",e[e.CancelPostEdit=2]="CancelPostEdit",e[e.DeleteThread=3]="DeleteThread",e[e.ClosePaneDraft=4]="ClosePaneDraft"}(r||(r={})),t.a=r},1401:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"isChangeGateEnabledSample",(function(){return rt})),n.d(r,"isAnimationFrameForResizeObserverEnabled",(function(){return ot}));var o=n(0),i=n(264);n(1026),n(1039);n(125),n(839),n(841);var a=n(202),s=n(25),c=n(3),d=n(124),u=n(89),l=n(1),f=n(52),m=n(163),p=n(21),g=n(110),h=n(87),C=n(7),y=n(203),v=n(463),b=function(){function e(e,t,n,r,o){var i=this;this.hostCommentAPI=e,this.author=t,this._anchorHintText=n,this.sessionConfiguration=r,this._insertIndex=o,this._active=!0,this._propertiesToUpdate={},this.updateDraft=function(e){e.draftId===i.sessionConfiguration.draftId&&(e.anchorHintText&&(i._anchorHintText=e.anchorHintText),void 0!==e.insertIndex&&(i._insertIndex=e.insertIndex))},this.handleCommentEvents=function(e,t){C.zb()&&e===y.d.CommentContextChanged&&Object(v.b)(t)&&t.contextDrafts?t.contextDrafts.forEach((function(e){return i.updateDraft(e)})):e===y.d.UpdateDraftThread&&Object(v.f)(t)&&i.updateDraft(t)},this.hostCommentAPI.registerForCommentEvents(this.handleCommentEvents)}return Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchorHintText",{get:function(){return this._anchorHintText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"insertIndex",{get:function(){return this._insertIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertiesToUpdate",{get:function(){return this._propertiesToUpdate},enumerable:!1,configurable:!0}),e.prototype.updateProperties=function(e,t){this._propertiesToUpdate[e]=Object(o.__assign)({},t)},e.prototype.commit=function(e){if(!this.hostCommentAPI.commit)throw new p.a(h.i,-2130957526);if(!this._active)throw new p.a(h.c,-2130957525);var t=C.b()&&this.sessionConfiguration.sessionType===y.h;if(void 0===e&&!t||t&&void 0!==e)throw new p.a(h.d,-2130957507);return C.b()||C.a()?this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e,this._propertiesToUpdate):this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e)},e.prototype.endDrafting=function(){this._active=!1,this.hostCommentAPI.unregisterForCommentEvents(this.handleCommentEvents),this.hostCommentAPI.endCommentSession(this.sessionConfiguration.draftId)},e}(),T=function(){function e(){}return e.prototype.init=function(e){this.hostCommentAPI=e,this.loadThreads=e.loadThreads.bind(e),this.deleteComment=e.deleteComment.bind(e),this.selectComment=e.selectComment.bind(e),this.highlightComment=e.highlightComment.bind(e),this.setThreadResolvedState=e.setThreadResolvedState.bind(e),this.selectFirstThreadInNextCommentContext=e.selectFirstThreadInNextCommentContext.bind(e),this.selectLastThreadInPreviousCommentContext=e.selectLastThreadInPreviousCommentContext.bind(e),this.registerForCommentEvents=e.registerForCommentEvents.bind(e),this.unregisterForCommentEvents=e.unregisterForCommentEvents.bind(e),this.registerForAction=e.registerForAction.bind(e),this.unregisterForAction=e.unregisterForAction.bind(e),this.resolveSupported=e.resolveSupported.bind(e),this.checkAtMentionCapability=e.checkAtMentionCapability.bind(e),e.registerForInterruptableCommands&&(this.registerForInterruptableCommands=e.registerForInterruptableCommands.bind(e)),e.unregisterForInterruptableCommands&&(this.unregisterForInterruptableCommands=e.unregisterForInterruptableCommands.bind(e))},e.prototype.beginDraftingAsync=function(e){var t=this;if(!this.hostCommentAPI.beginDraftingAsync||!this.hostCommentAPI.commit)throw new p.a("Drafting APIs are undefined on Host Comment API",-2130957527);var n=Object(m.b)(),r=Object(o.__assign)(Object(o.__assign)({},e),{draftId:n});return this.hostCommentAPI.beginDraftingAsync(r).then((function(e){return new b(t.hostCommentAPI,Object(g.c)(e),e.anchorHintText,e.updatedDraftSessionConfiguration||r,e.insertIndex)}))},e}(),I=n(384),O=n(40),S={themeId:1,palette:{ApplePaneTopBorder:O.a.GRAY_C,ButtonBorder:O.a.GRAY_B,CardAccent:O.a.GRAY_B,CardBackground:O.a.WHITE,CardHoveredBackground:O.a.GRAY_20,CardDraftBoxBackgroundHovered:O.a.WHITE,CardDraftBoxBorderHovered:O.a.GRAY_160,CardDraftBoxBorder:O.a.GRAY_110,CardDraftBoxBackground_HalfPane:O.a.WHITE,CardDraftBoxBackground:O.a.GRAY_A,CardExpandButtonBorder:O.a.GRAY_B,CardHeroBarBackground_HalfPane:O.a.GRAY_A,CardHeroBarBackground:O.a.WHITE,CardReplyBackground_HalfPane:O.a.GRAY_A,CardReplyBackground:O.a.GRAY_A,CardReplyTopBorder:O.a.GRAY_B,CardSelectionColor:O.a.COMMENTS_PURPLE,CardShadowColor:O.a.BLACK,CardBorder:O.a.GRAY_B,CardBorderEmphasis:O.a.COMMENTS_PURPLE,CommandBarBorder:O.a.GRAY_B,CommandBarTopBorder:O.a.GRAY_B,GhostCommentWrapperBorder:O.a.GRAY_D,IconButtonDisabledTint:O.a.GRAY_C,IconButtonFocusedTint:O.a.GRAY_I,NavigationBarBackground:O.a.WHITE,NavigationBarBorder:O.a.GRAY_B,PaneBackground_HalfPane:O.a.WHITE,PaneBackground:O.a.GRAY_A,UnreadDotColor:O.a.DOT_BLUE,UnreadDotBorderColor:O.a.WHITE,ResolvedPersonaBackground:O.a.GRAY_A,ExpandButtonFocusBackground:"transparent",FocusBorderColor:O.a.GRAY_150,CardPlaceholderColor:O.a.GRAY_130,ResolvedCardBackground:O.a.GRAY_20}},j=function(){function e(){}return e.prototype.getTheme=function(){return Object(c.g)().assertConditionTag(!1,"Should not be called",592986821),S},e.prototype.registerForThemeChange=function(e){},e.prototype.unregisterForThemeChange=function(e){},e}(),D=n(233),w=n(270),_=n(177),x=n(12),E=Object(x.c)((function(){return{offscreenLiveRegion:{clip:"rect(1px, 1px, 1px, 1px)",height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1}}})),P=function(e){function t(t){var n=e.call(this,t)||this;return n.state={liveRegionUpdate:t.liveRegionUpdate,liveRegionCounter:0},n}return Object(o.__extends)(t,e),t.prototype.appendLiveRegionUpdate=function(e){var t=this,n=this.state.liveRegionCounter+1;this.setState({liveRegionUpdate:e,liveRegionCounter:n}),setTimeout((function(){t.state.liveRegionCounter===n&&t.setState({liveRegionUpdate:void 0,liveRegionCounter:0})}),1e3)},t.prototype.render=function(){var e=E();return l.createElement("span",{role:"region","aria-live":"assertive","aria-atomic":"true","aria-relevant":"additions",style:e.offscreenLiveRegion},this.state.liveRegionUpdate)},t}(l.PureComponent);function A(){var e=document.createElement("div");document.body.appendChild(e),f.render(l.createElement(P,{ref:R}),e),Object(_.c)({announceToScreenReader:function(e){k&&k.appendLiveRegionUpdate(e)}})}var k=void 0;function R(e){k=e}var F=n(618),N=n(346),M=n(572),V=n(453),L=n(9),U=n(303),B=n(68),H=n(245),z=n(199),W=n(120),q=n(175),G=function(){function e(e,t,n){var r=this;this.viewContainerBase=e,this.context=t,this.viewContainerProvider=n,this.lastRenderFailed=!1,this.processVisibilityEvent=function(e){switch(e.viewContainerVisibilityState){case W.a.Visible:r.viewContainerBase.identifier?r.rootNode=document.getElementById(r.viewContainerBase.identifier):Object(c.g)().assertConditionTag(!1,"View container base identifier expected",592241222),r.providerPromise.then((function(e){r.renderIntoView(e)})).catch((function(e){Object(p.b)(e)?Object(c.g)().assertConditionTag(!1,e.message,592241223):Object(c.g)().assertConditionTag(!1,"Unknown error in onViewEventReceived "+e,592241224)}));break;case W.a.Closed:r.viewContainerBase.identifier&&r.rootNode&&(Object(f.unmountComponentAtNode)(r.rootNode),r.rootNode=null);break;case W.a.Hidden:Object(c.g)().assertConditionTag(!1,"ViewContainerVisibilityState.Hidden is not currently supported for web.",592217540);break;default:Object(L.j)(e.viewContainerVisibilityState)}},this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.onViewEventReceived=this.onViewEventReceived.bind(this),this.onProviderStateChange=this.onProviderStateChange.bind(this);var o=Object(H.d)(H.a,t);C.q()&&this.viewContainerProvider&&(this.viewContainerProvider.registerForViewContainerEvents(this.onViewEventReceived),this.providerPromise=Object(U.b)().getComponent(o),this.providerPromise.then((function(e){e.onStateChanged.subscribe(r.onProviderStateChange)})).catch((function(e){Object(p.b)(e)?Object(c.g)().assertConditionTag(!1,e.message,595646038):Object(c.g)().assertConditionTag(!1,"Unknown error in ClientViewContainer constructor "+e,595646039)})))}return Object.defineProperty(e.prototype,"identifier",{get:function(){return this.viewContainerBase.identifier},enumerable:!1,configurable:!0}),e.prototype.renderIntoView=function(e){this.renderPane(e)},e.prototype.renderPane=function(e){var t=this,n=e.component,r=Object(c.g)().createActivityObject("RenderPaneIntoView",z.a.getTelemetryVisitor(this.context),c.a.None,c.b.NecessaryServiceDataEvent);if(!n)return this.lastRenderFailed&&r.failTag(595649617,-2130957502),void(this.lastRenderFailed=!0);Object(f.render)(l.createElement(n,{resource:{id:"CommentPane"}}),this.rootNode,(function(){var e=document.getElementById(B.w());e&&e.focus(),t.lastRenderFailed=!1})),r.successTag(595649618)},e.prototype.onProviderStateChange=function(e){var t=this;this.rootNode&&(e===U.a.Registered?this.providerPromise.then((function(e){t.renderIntoView(e)})).catch((function(e){Object(c.g)().assertConditionTag(!1,"Unexpected promise rejection from component provider promise",595899021)})):e===U.a.Unregistered&&Object(f.unmountComponentAtNode)(this.rootNode))},e.prototype.onViewEventReceived=function(e){var t;switch(e.eventType){case q.a.VisibilityChanged_deprecated:Object(c.g)().assertConditionTag(!1,"ViewContainerEventType.VisibilityChanged_deprecated should not be received here. Check logic in ViewContainerProvider.",590190289);break;case q.a.VisibilityChanged:this.processVisibilityEvent(e);break;case q.a.ViewContainerChanged:e.newViewContainer!==this&&(null===(t=this.viewContainerProvider)||void 0===t||t.unregisterForViewContainerEvents(this.onViewEventReceived));break;case q.a.FoldableLayoutStateChanged:case q.a.FocusTriggered:break;default:Object(L.j)(e)}},e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.closeView=function(){this.viewContainerBase.closeView()},e.prototype.moveFocusToCanvas_donotuse=function(){},e}(),Y=function(){function e(e,t,n){if(!n)throw new p.a("initialViewContainer must be provided at initialization for web ViewContainerProvider.",-2130957557);this._currentContainer=new G(n,t)}return e.prototype.getViewContainer=function(){return this._currentContainer},e.prototype.changeViewContainerType=function(e){},e.prototype.registerForViewContainerEvents=function(e){},e.prototype.unregisterForViewContainerEvents=function(e){},e}(),K=function(){function e(){this._listeners=[]}return e.prototype.add=function(e){this._listeners.push(e)},e.prototype.remove=function(e){var t=this._listeners.indexOf(e);t>=-1&&this._listeners.splice(t,1)},Object.defineProperty(e.prototype,"invoke",{get:function(){var e=this;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e._listeners.forEach((function(e){return e.apply(void 0,Object(o.__spread)(t))}))}},enumerable:!1,configurable:!0}),e}(),J=function(e){function t(t,n){var r=e.call(this)||this;return r.viewContainerProvider=n,r.processEvent=function(e){var t=e;if(e.eventType===q.a.VisibilityChanged_deprecated){var n=e.visible?W.a.Visible:W.a.Closed;t={eventType:q.a.VisibilityChanged,viewContainerVisibilityState:n}}r.fireEvent(t)},r.apiContext=t,n.registerForViewContainerEvents(r.processEvent),r}return Object(o.__extends)(t,e),t.prototype.getViewContainer=function(){return this.currentContainer||(this.currentContainer=new G(this.viewContainerProvider.getViewContainer(),this.apiContext,this)),this.currentContainer},t.prototype.changeViewContainerType=function(e){},t}(function(){function e(){this.changedEvent=new K}return e.prototype.registerForViewContainerEvents=function(e){this.changedEvent.add(e)},e.prototype.unregisterForViewContainerEvents=function(e){this.changedEvent.remove(e)},e.prototype.fireEvent=function(e){this.changedEvent.invoke(e)},e}());function Q(e,t,n,r){return new Y(t,e,r)}var X=n(531);function Z(e,t){var n=void 0,r=t();return Object(X.a)(r)?C.q()?function(e,t){return new J(e,t)}(e,r):(Object(c.g)().assertConditionTag(!1,"ViewContainerProvider code in the host is not properly gated",591729827),Q(e,(n=r.getViewContainer()).containerType,V.a.Indeterminate,n)):Q(e,(n=r).containerType,V.a.Indeterminate,n)}var $=n(5);function ee(e){var t=n(1058),r=n(1059),i=u.a()?n(1060):n(1061),a=n(1062),s=n(1063),c=n(1064),d=n(1065),f=n(1066),m=n(1067),p=n(1068),g={HintBarEllipses_16:l.createElement(t,null),CancelGlyph:l.createElement(r,null),NewComment:l.createElement(i,null),CancelGlyph_TaskPane:l.createElement(a,null),Send2_Fluent:l.createElement(s,null),Delete_Fluent:l.createElement(c,null),Edit_Fluent:l.createElement(d,null),Checkmark_Fluent:l.createElement(f,null),CommentReopen_Fluent:l.createElement(m,null),Error:l.createElement(p,null)};if(e||C.b()){var h=n(1069),y=n(1070),v=n(1071),b=n(1072),T=n(845),I=n(1073),O=n(1074);g=Object(o.__assign)(Object(o.__assign)({},g),{TaskAssign:l.createElement(h,null),TaskComplete:l.createElement(y,null),TaskDelete:l.createElement(v,null),TaskEdit:l.createElement(b,null),TaskReopen:l.createElement(T,null),TaskStatusCircleCheckmark:l.createElement(I,null),ChevronDown12:l.createElement(O,null)})}if(e||C.a()){var S=n(1075),j=n(1076);g=Object(o.__assign)(Object(o.__assign)({},g),{LikeEmpty:l.createElement(S,null),LikeSolid:l.createElement(j,null)})}if(e||C.R()){var D=n(845);g=Object(o.__assign)(Object(o.__assign)({},g),{ReopenThread:l.createElement(D,null)})}Object($.ib)({icons:g})}var te,ne={name:"OfficeSharedComments",version:n(846).a},re=n(790),oe=n(454),ie=n(907),ae=n(910);function se(e){if(void 0===e.hostCommentAPI)throw new p.a("'hostCommentAPI' was not supplied",-2130957511);if(void 0===e.peopleAPI)throw new p.a("'peopleAPI' was not supplied",-2130957511);if(void 0===e.viewContainerProvider)throw new p.a("'viewContainerProvider' was not supplied",-2130957511);var t=Object(d.f)(e.apiContext),n=Object(I.a)(),r=e.themeAPI||new j,o=e.hostCommentAPI;return(o=new T).init(e.hostCommentAPI),new ie.a({apiContext:e.apiContext,viewProvider:e.viewContainerProvider,commentAPI:o,peopleAPI:e.peopleAPI,localizationAPI:n,themeAPI:r,initializationReason:e.initializationReason,commentStore:Object(re.a)(o,e.viewContainerProvider,Object(oe.b)(e.viewContainerProvider.getViewContainer(),e.paneVisible,n.getLocaleInfo().appLocale,e.apiContext),z.a.getTelemetryVisitor(e.apiContext),t,n),viewStrategyFactory:new ae.a,initializeImmediately:e.initializeImmediately,mockUIDriver:e.mockDriver})}function ce(e,t,n,r,o,i,m,g,h,C){Object(z.b)(se),Object(s.b)({appSettings:g||{},mapping:M.a}),Object(c.i)(ne,n());var y=Object(I.b)(i);u.c(y.getLocaleInfo().isRightToLeft),ee(),Object(c.g)().assertConditionTag(!!g,"appSettings should not be undefined",591005569);var v,b=new T;b.init(t()),te=b,Object(D.b)(C),A(),Object(N.c)("CommentHost").then((function(t){v=t,Object(f.render)(l.createElement(v.default,{apiContext:a.a,getCommentAPI:de,viewContainerAPI:Z(a.a,o),peopleAPI:r?r():new F.a,contentNavigationAPI:new d.c,localizationAPI:y,themeAPI:new j,initializationReason:m||w.a.PaneOpen,useMockCommentPane:!1}),document.getElementById(e)),h&&h()})).catch((function(e){Object(p.b)(e)?Object(c.g)().assertConditionTag(!1,e.message,591005570):Object(c.g)().assertConditionTag(!1,"Unknown error in renderCommentPaneWithAppInfo on delayLoadSharedCommentsUI "+e,591005571)}))}function de(){return te}var ue=n(32),le=n(465);function fe(){if(!C.q())throw new p.a(h.p,-2130957516);return z.a.getViewManager(a.a)}function me(){fe().beginInitialization()}function pe(e,t,n,r,o,i,d,l){try{try{if(fe())return void Object(c.g)().assertConditionTag(!1,"View manager singleton cannot be instantiated more than once!",595891844)}catch(e){if(!Object(p.b)(e))throw e}if(Object(z.b)(se),Object(s.b)({appSettings:d||{},mapping:M.a}),Object(c.i)(ne,t),Object(c.g)().assertConditionTag(!!d,"appSettings should not be undefined",595616278),!C.q)throw Object(c.g)().assertConditionTag(!1,"Instantiate should only be used when DHCs are enabled!",595896459),new p.a(h.p,-2130957516);var f=Object(I.b)(o);u.c(f.getLocaleInfo().isRightToLeft),ee();var g=e,y=Z(a.a,(function(){return r})),v=Object(m.b)();z.a.ensureViewManager({apiContext:a.a,displayMode:le.c.FullPane,foldableLayoutState:le.a.Indeterminate,initializationReason:i||w.a.PaneOpen,correlationId:v,viewContainerProvider:y,peopleAPI:n,hostCommentAPI:g,paneVisible:!1,initializeImmediately:!1}),Object(D.b)(l),A(),Object(ue.e)().onExtensionFirstRequested.subscribe((function(e){e.contentType===ue.b.CommentThread&&me()}))}catch(e){throw Object(p.b)(e)?Object(c.g)().assertConditionTag(!1,e.message,594367139):Object(c.g)().assertConditionTag(!1,"Unknown error in ClientViewContainer constructor "+e,594367168),e}}Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r}),String.prototype.includes||(String.prototype.includes=function(e,t){if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return-1!==this.indexOf(e,void 0===t?0:t)});var ge,he,Ce,ye=n(279);function ve(e){switch(e){case 0:default:return ue.b.CommentThread}}!function(e){e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry"}(ge||(ge={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(he||(he={})),function(e){e[e.containerVirtualizationEnabled=0]="containerVirtualizationEnabled"}(Ce||(Ce={}));var be,Te,Ie=function(){function e(e,t,n){void 0===n&&(n=0),this.disableRepositioningAnimation=!1,this.positionFixed=!1,this.anchorLeft=0,this.shouldUpdatePositions=!1,this.aggregateHeight=0,this.possibleTopForNextContainer=0,this.renderMode=ue.d.Integrated,this.constructContainerId=e,this.ulsLogger=t,this.activeContainerAnchorLeft=n}return e.prototype.getAggregateHeight=function(){return this.aggregateHeight},e.prototype.calculateNewPositions=function(e,t,n){this.disableRepositioningAnimation=!!n&&!!n.disableRepositioningAnimation,this.positionFixed=!!n&&!!n.positionFixed,this.shouldUpdatePositions=!n||!1!==n.shouldUpdatePositions;var r=e[0];if(this.anchorLeft=r&&r.anchorLeft?r.anchorLeft:0,n&&n.activeContainerInfo){var o=n.activeContainerInfo;this.updateContainerPositionsAroundActiveContainer(e,t,o)}else{var i=n?n.topOfFirstContainer:void 0;this.setRestPositionOfContainers(e,t,i)}},e.prototype.updateContainersPositions=function(e,t,n){this.calculateNewPositions(e,t,n)},e.prototype.updateContainerPositionsAroundActiveContainer=function(e,t,n){var r=t[n.containerId];if(r){var i=r.floatingContainerRef,a=this.shouldUpdatePositions&&i?i.height():r.position.height;this.shouldUpdatePositions&&i&&(i.anchorPoint().y!==r.anchorTop||i.anchorPoint().x!==this.activeContainerAnchorLeft)&&i.updateContainerPosition({anchorPoint:{x:this.activeContainerAnchorLeft,y:r.anchorTop},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(t,n.containerId,Object(o.__assign)(Object(o.__assign)({},r.position),{x:this.activeContainerAnchorLeft,y:r.anchorTop})),this.updateContainerPositionsAboveActiveContainer(e,t,r.anchorTop,n.containerPositionIndex-1),this.possibleTopForNextContainer=this.getBottomPositionOfContainer(r,r.anchorTop,a),this.updateContainerPositionsDownwards(e,t,n.containerPositionIndex+1),this.aggregateHeight=n.containerPositionIndex===e.length-1?a+r.anchorTop:this.aggregateHeight}else this.ulsLogger.sendTraceTag(595358743,ge.msoulscat_Wac_Telemetry,he.Error,"Floating container info does not exist for the active container Id: "+n.containerId)},e.prototype.updateContainerPositionsDownwards=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=!1);for(var o={},i=n;i<e.length;i+=1){if((a=e[i])&&a.contentId){if(!(s=this.getFloatingContainerInfo(a,t)))continue;o[a.contentId]=this.shouldUpdatePositions&&s.floatingContainerRef?s.floatingContainerRef.height():s.position.height}}for(i=n;i<e.length;i+=1){var a,s=this.getFloatingContainerInfo(e[i],t),c=(a=e[i])&&a.contentId;if(void 0===s||!c)return;var d=this.updateFloatingContainerPosition(e[i],t,o[c]);if(i===e.length-1&&s&&(this.aggregateHeight=o[c]+s.position.y),r&&d)return}},e.prototype.updateContainerPositionsAboveActiveContainer=function(e,t,n,r){var i=e[0]?e[0].anchorTop:void 0;this.setRestPositionOfContainers(e.slice(0,r+1),t,i);for(var a=n,s=r;s>=0;s-=1){var c=this.getFloatingContainerInfo(e[s],t);if(void 0===c||this.getBottomPositionOfContainer(c)<=a)return;var d=c.floatingContainerRef,u=a-(this.shouldUpdatePositions&&d?d.height():c.position.height)-10;this.shouldUpdatePositions&&d&&d.updateContainerPosition({anchorPoint:{x:this.anchorLeft,y:u},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(t,this.getContainerId(e[s]),Object(o.__assign)(Object(o.__assign)({},c.position),{x:this.anchorLeft,y:u})),a=u}},e.prototype.setRestPositionOfContainers=function(e,t,n){var r;if(e.length>0){var o=this.getFloatingContainerInfo(e[0],t);if(void 0===o)return;var i=null===(r=o.floatingContainerRef)||void 0===r?void 0:r.anchorPoint().y,a=this.shouldUpdatePositions&&void 0!==i&&!this.positionFixed?i:o.position.y;this.possibleTopForNextContainer=null!=n?n:Math.max(o.anchorTop,a),this.updateContainerPositionsDownwards(e,t,0)}},e.prototype.getFloatingContainerInfo=function(e,t){return t[this.getContainerId(e)]},e.prototype.getContainerId=function(e){var t=e.contentId;return this.constructContainerId({contentId:t,contentType:ve(e.containerContentType),renderMode:this.renderMode})},e.prototype.updateFloatingContainerPosition=function(e,t,n){var r=this.getFloatingContainerInfo(e,t);if(void 0===r)return!1;var i=this.shouldUpdatePositions&&r.floatingContainerRef?r.floatingContainerRef.anchorPoint().y:r.position.y,a=Math.max(this.possibleTopForNextContainer,r.anchorTop);return a!==i&&(this.shouldUpdatePositions&&r.floatingContainerRef&&r.floatingContainerRef.updateContainerPosition({anchorPoint:{x:this.anchorLeft,y:a},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(t,this.getContainerId(e),Object(o.__assign)(Object(o.__assign)({},r.position),{x:this.anchorLeft,y:a}))),this.possibleTopForNextContainer=this.getBottomPositionOfContainer(r,a,n),a===i},e.prototype.getBottomPositionOfContainer=function(e,t,n){void 0===t&&(t=void 0),void 0===n&&(n=void 0);var r,o,i=e.floatingContainerRef,a=null==i?void 0:i.anchorPoint().y;return this.shouldUpdatePositions&&i&&void 0!==a?(r=a,o=i.height()):(r=e.position.y,o=e.position.height),(void 0!==t?t:r)+(void 0!==n?n:o)+10},e.prototype.updateFloatingContainerPositionInCache=function(e,t,n){e[t].position=n},e}(),Oe=n(954),Se=function(){function e(e){this.eventSink=e}return e.prototype.unsubscribe=function(){this.eventSink.unsubscribe(this)},e}(),je=function(){function e(){this.handlers=[]}return e.prototype.subscribe=function(e){var t=new Se(this);return this.handlers.push({subscription:t,handler:e}),t},e.prototype.unsubscribe=function(e){this.handlers=this.handlers.filter((function(t){return t.subscription!==e}))},e.prototype.trigger=function(e){this.handlers.forEach((function(t){return t.handler(e,t.subscription)}))},e}(),De=function(){function e(e){this.onContainerShouldBeCreated=new je,this.motionDuration=Oe.a.duration4,this.posUpdateAnimationsInProgress=!1,this.containerVirtualizationEnabled=!1,e&&(this.containerVirtualizationEnabled=!!e.containerVirtualizationEnabled)}return e.prototype.updateContainersVisibility=function(e,t,n,r,o){var i=this;if(void 0===n&&(n=!1),void 0===o&&(o=!1),t.height>0){var a={viewportTop:t.y-t.height/2,viewportBottom:t.y+1.5*t.height,containerIdToInfoMap:e,activeContainerId:r};if(!o&&!this.posUpdateAnimationsInProgress)return void this.handleContainerVirtualization(n,a);this.posUpdateAnimationsInProgress=!0,this.showContainersComingIntoViewport(a),setTimeout((function(){i.updatePositions(a,n),window.clearTimeout(i.hideContainersTimeout),i.hideContainersTimeout=window.setTimeout((function(){i.hideContainersOutsideViewport(a),i.posUpdateAnimationsInProgress=!1}),parseInt(i.motionDuration,10))}),0)}},e.prototype.handleContainerVirtualization=function(e,t){var n=this;Object.keys(t.containerIdToInfoMap).forEach((function(r){var o=n.extractContainerInfo(r,t);n.updateContainerVisibility(o,t.activeContainerId===r),n.updateContainerPosition(o,e)}))},e.prototype.showContainersComingIntoViewport=function(e){var t=this;Object.keys(e.containerIdToInfoMap).forEach((function(n){var r=t.extractContainerInfo(n,e);t.updateContainerVisibility(r,e.activeContainerId===n)}))},e.prototype.hideContainersOutsideViewport=function(e){var t=this;Object.keys(e.containerIdToInfoMap).forEach((function(n){var r=t.extractContainerInfo(n,e);t.updateContainerVisibility(r,e.activeContainerId===n)}))},e.prototype.updatePositions=function(e,t){var n=this;Object.keys(e.containerIdToInfoMap).forEach((function(r){var o=n.extractContainerInfo(r,e);n.updateContainerPosition(o,t)}))},e.prototype.updateContainerVisibility=function(e,t){e.containerRef&&e.containerElement&&(e.isContainerInViewport||t?"block"!==e.containerElement.style.display&&(e.containerElement.style.display="block",this.containerVirtualizationEnabled&&e.containerRef.updateContainerVirtualization(!1),t&&e.containerRef.setFocus()):!1===e.isContainerInViewport&&"none"!==e.containerElement.style.display&&(e.containerElement.style.display="none",this.containerVirtualizationEnabled&&e.containerRef.updateContainerVirtualization(!0)))},e.prototype.updateContainerPosition=function(e,t){var n=e.containerElement;n&&(n.style.top=e.containerPosition.y+"px",n.style.left=e.containerPosition.x+"px",n.style.transitionDuration=t?"0ms":this.motionDuration)},e.prototype.extractContainerInfo=function(e,t){var n,r=t.containerIdToInfoMap[e],o=r.floatingContainerRef,i=r.position,a={containerElement:void 0,isContainerInViewport:i.y+i.height>=t.viewportTop&&i.y<=t.viewportBottom,containerRef:void 0,containerPosition:i};return o&&(a.containerRef=o,a.containerElement=null===(n=document.getElementById(o.parentDivId()))||void 0===n?void 0:n.firstChild),a},e}(),we=n(81);function _e(){return be||(be=Object(s.a)())}function xe(){return _e().isChangeGateEnabled("FlattenComponentRegistryAPI",Object(s.c)(4387148))}!function(e){e[e.Unregistered=0]="Unregistered",e[e.Registered=1]="Registered"}(Te||(Te={}));var Ee,Pe=function(){function e(){this.onComponentStateChanged=new we.EventImpl((function(){})),this.onComponentCommand=new we.EventImpl((function(){}))}return e.prototype.initialize=function(){},e.prototype.registerComponent=function(e,t){return this.onComponentStateChanged.trigger({componentName:e,state:Te.Registered}),t},e.prototype.unregisterComponent=function(e){this.onComponentStateChanged.trigger({componentName:e,state:Te.Unregistered})},e}();function Ae(){return void 0===Ee&&(Ee=new Pe).initialize(),Ee}var ke=function(e,t){var n=this;this.componentName=e,this.onComponentCommandForwarded=t,this.onComponentCommand=new we.EventImpl((function(){})),xe()?this.onComponentCommandForwarded.subscribe((function(e){e.details.componentKey===n.componentName&&n.onComponentCommand.trigger(e)})):Ae().onComponentCommand.subscribe((function(e){e.details.componentKey===n.componentName&&n.onComponentCommand.trigger(e)}))},Re=function(){function e(e,t){var n=this;this._componentName=e,this._registryInstance=t,this.onStateChanged=new we.EventImpl((function(){})),(xe()?this._registryInstance.onComponentStateChanged:Ae().onComponentStateChanged).subscribe((function(e){e.componentName===n._componentName&&n.onStateChanged.trigger(e.state)}))}return Object.defineProperty(e.prototype,"component",{get:function(){return this._registryInstance.componentMap[this._componentName]},enumerable:!1,configurable:!0}),e}(),Fe=function(){function e(){if(this.componentMap={},this.onComponentStateChanged=new we.EventImpl((function(){})),this.onComponentCommand=new we.EventImpl((function(){})),xe())throw new Error("ComponentRegistryImpl_deprecated should never be instantiated when Microsoft.Office.Docs.ChangeGate.ComponentRegistry.JSGate.FlattenComponentRegistryAPI is enabled")}return e.prototype.initialize=function(){},e.prototype.registerComponent=function(e,t){var n=Ae().registerComponent(e,t);return this.componentMap[e]=n,new ke(e,this.onComponentCommand)},e.prototype.unregisterComponent=function(e){delete this.componentMap[e],Ae().unregisterComponent(e)},e.prototype.getComponent=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return[2,new Re(e,this)]}))}))},e}(),Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t}(function(){function e(){this.componentMap={},this.onComponentStateChanged=new we.EventImpl((function(){})),this.onComponentCommand=new we.EventImpl((function(){}))}return e.prototype.initialize=function(){},e.prototype.registerComponent=function(e,t){return this.onComponentStateChanged.trigger({componentName:e,state:Te.Registered}),this.componentMap[e]=t,new ke(e,this.onComponentCommand)},e.prototype.unregisterComponent=function(e){delete this.componentMap[e],this.onComponentStateChanged.trigger({componentName:e,state:Te.Unregistered})},e.prototype.getComponent=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return[2,new Re(e,this)]}))}))},e}()),Me=window;var Ve,Le=n(134),Ue=n(144);!function(e){e[e.Enablement=0]="Enablement",e[e.Focus=1]="Focus",e[e.Hover=2]="Hover",e[e.Resize=3]="Resize",e[e.Visibility=4]="Visibility"}(Ve||(Ve={}));var Be,He=n(138);function ze(e,t){return{type:e,payload:t}}!function(e){e.ChangeRenderedContentIdentifierType="CHANGE_RENDERED_CONTENT_IDENTIFIER",e.EmptyActionType="",e.RemoveVisibilityAnimationType="REMOVE_VISIBILITY_ANIMATION",e.RepositionType="REPOSITION_FLOATING_CONTAINER",e.SetContentType="SET_CONTENT",e.UpdateContainerDirectionType="UPDATE_FLOATING_CONTAINER_DIRECTION",e.UpdateContainerWidthType="UPDATE_FLOATING_CONTAINER_WIDTH",e.UpdateContentMaxDimensionsType="UPDATE_CONTENT_MAX_DIMENSIONS",e.UpdateContainerVisibilityType="UPDATE_FLOATING_CONTAINER_VISIBILITY",e.UpdateContainerVirtualizationType="UPDATE_FLOATING_CONTAINER_VIRTUALIZATION"}(Be||(Be={}));var We={anchorPoint:new function(e,t){this.x=e,this.y=t}(0,0),isAnchorPointOnRight:!1};function qe(e,t){return void 0===t&&(t=We),{anchorPoint:t.anchorPoint,contentIdentifier:e,disableRepositioningAnimation:!1,horizontalOffset:0,isAnchorPointOnRight:t.isAnchorPointOnRight,isVisible:!1,isVirtualized:!1,maxDimensions:t.maxDimensions||{},positionFixed:!1,useVisibilityAnimation:!1}}var Ge={contentId:"",contentType:ue.b.Empty};function Ye(e,t){switch(void 0===e&&(e=qe(Ge)),void 0===t&&(t=ze(Be.EmptyActionType,{})),t.type){case Be.ChangeRenderedContentIdentifierType:return function(e,t){if(e.contentIdentifier.contentId===t.payload.newContentIdentifier.contentId&&e.contentIdentifier.contentType===t.payload.newContentIdentifier.contentType)return e;return Object(o.__assign)(Object(o.__assign)({},e),{contentIdentifier:t.payload.newContentIdentifier})}(e,t);case Be.RemoveVisibilityAnimationType:return function(e){return Object(o.__assign)(Object(o.__assign)({},e),{useVisibilityAnimation:!1})}(e);case Be.RepositionType:return function(e,t){if(e.anchorPoint.x===t.payload.anchorPoint.x&&e.anchorPoint.y===t.payload.anchorPoint.y&&e.disableRepositioningAnimation===t.payload.disableRepositioningAnimation&&e.positionFixed===t.payload.positionFixed)return e;return Object(o.__assign)(Object(o.__assign)({},e),{anchorPoint:t.payload.anchorPoint,disableRepositioningAnimation:t.payload.disableRepositioningAnimation,positionFixed:t.payload.positionFixed})}(e,t);case Be.SetContentType:return function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{content:t.payload.content,isVisible:!!t.payload.content&&e.isVisible})}(e,t);case Be.UpdateContainerDirectionType:return function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{isAnchorPointOnRight:t.payload.isAnchorPointOnRight,horizontalOffset:t.payload.isAnchorPointOnRight?t.payload.currentWidth:0})}(e,t);case Be.UpdateContainerWidthType:return function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{horizontalOffset:e.isAnchorPointOnRight?t.payload.width:0})}(e,t);case Be.UpdateContentMaxDimensionsType:return function(e,t){if(e.maxDimensions.height===t.payload.maxDimensions.height&&e.maxDimensions.width===t.payload.maxDimensions.width)return e;return Object(o.__assign)(Object(o.__assign)({},e),{maxDimensions:t.payload.maxDimensions})}(e,t);case Be.UpdateContainerVisibilityType:return function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{isVisible:t.payload.isVisible,useVisibilityAnimation:t.payload.useVisibilityAnimation})}(e,t);case Be.UpdateContainerVirtualizationType:return function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{isVirtualized:t.payload.isVirtualized})}(e,t);default:return e}}function Ke(e){return ze(Be.SetContentType,{content:e})}var Je=function(e){return e.isVirtualized},Qe=n(208),Xe=Object(Qe.a)({from:{opacity:0,visibility:"visible"},to:{opacity:1}}),Ze=Object(Qe.a)({from:{opacity:1,visibility:"visible"},to:{opacity:0,visibility:"hidden"}}),$e=Object(x.c)((function(e,t,n,r){return{floatingContainerView:Object($.db)({animationName:t?e?Xe:Ze:void 0,animationDuration:"300ms",animationTimingFunction:Oe.b.decelerate,background:"transparent",position:r?"fixed":"absolute",transitionDuration:e&&!n?Oe.a.duration4:"0s",transitionProperty:"top, left",transitionTimingFunction:Oe.b.decelerate,visibility:e?"visible":"hidden"})}}));var et,tt=n(755);function nt(){return et||(et=Object(s.a)())}function rt(){return nt().isChangeGateEnabled("SampleChangeGate",Object(s.c)(1234567))}function ot(){return nt().isChangeGateEnabled("AnimationFrameForResizeObserver",Object(s.c)(4249231))}function it(e){return"floatingContainerView"+e.contentId+"Type"+e.contentType}var at=function(e){function t(t){var n=e.call(this,t)||this;return n.handleResizeUpdates=function(e){e.forEach((function(e){n.props.updateHorizontalOffset(e.contentRect.width),n.props.onContainerStateChanged.trigger({stateChangeType:Ve.Resize,contentIdentifier:n.props.contentIdentifier,contentRect:e.contentRect})}))},n.triggerVisibilityUpdateNotification=function(){n.props.onContainerStateChanged.trigger({stateChangeType:Ve.Visibility,contentIdentifier:n.props.contentIdentifier,isVisible:n.props.isVisible})},n.getHostedResource=function(e){return{id:e}},n.onFocusChange=function(e,t){var r=e.relatedTarget||document.activeElement;n.parentDivRef&&r instanceof HTMLElement&&n.parentDivRef.contains(r)||n.props.onContainerStateChanged.trigger({stateChangeType:Ve.Focus,contentIdentifier:n.props.contentIdentifier,isFocused:t})},n.onFocusOut=function(e){n.onFocusChange(e,!1)},n.onFocusIn=function(e){n.onFocusChange(e,!0)},n.onMouseEnter=function(){n.props.onContainerStateChanged.trigger({stateChangeType:Ve.Hover,contentIdentifier:n.props.contentIdentifier,isHovered:!0})},n.onMouseLeave=function(){n.props.onContainerStateChanged.trigger({stateChangeType:Ve.Hover,contentIdentifier:n.props.contentIdentifier,isHovered:!1})},n.setContentRef=function(e){n.contentRef=e},n.setParentDivRef=function(e){e!==n.parentDivRef&&(n.parentDivRef&&(n.resizeObserver.unobserve(n.parentDivRef),n.parentDivRef.removeEventListener("focusin",n.onFocusIn,!0),n.parentDivRef.removeEventListener("focusout",n.onFocusOut,!0)),e&&(n.resizeObserver.observe(e),e.addEventListener("focusin",n.onFocusIn,!0),e.addEventListener("focusout",n.onFocusOut,!0))),n.parentDivRef=e},n.contentRef=void 0,n.parentDivRef=void 0,n.resizeObserver=new tt.a((function(e){r.isAnimationFrameForResizeObserverEnabled()?window.requestAnimationFrame((function(){n.handleResizeUpdates(e)})):n.handleResizeUpdates(e)})),n.setContentRef=n.setContentRef.bind(n),n.setParentDivRef=n.setParentDivRef.bind(n),n.getHostedResource=Object(m.e)(n.getHostedResource.bind(n)),n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this.triggerVisibilityUpdateNotification()},t.prototype.componentDidUpdate=function(e){var t=this,n=!1;e.isVisible!==this.props.isVisible&&(this.props.useVisibilityAnimation&&!this.props.isVisible?n=!0:this.triggerVisibilityUpdateNotification()),this.props.useVisibilityAnimation&&setTimeout((function(){n&&t.triggerVisibilityUpdateNotification(),t.props.removeVisibilityAnimation()}),300)},t.prototype.height=function(){return this.parentDivRef?this.parentDivRef.clientHeight:0},t.prototype.width=function(){return this.parentDivRef?this.parentDivRef.clientWidth:0},t.prototype.setFocus=function(){this.contentRef&&this.contentRef.focus()},t.prototype.render=function(){if(!this.props.anchorPoint||void 0===this.props.anchorPoint.x||void 0===this.props.anchorPoint.y||!this.props.content)return null;var e=$e(this.props.isVisible,this.props.useVisibilityAnimation,this.props.disableRepositioningAnimation,this.props.positionFixed),t=this.props.content;return l.createElement("div",{key:it(this.props.contentIdentifier),id:it(this.props.contentIdentifier),ref:this.setParentDivRef,className:e.floatingContainerView,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,style:{left:this.props.anchorPoint.x-this.props.horizontalOffset,top:this.props.anchorPoint.y}},l.createElement(t,{componentRef:this.setContentRef,resource:this.getHostedResource(this.props.contentIdentifier.contentId),maximumDimensions:this.props.maxDimensions,isVirtualized:this.props.isVirtualized}))},t}(l.Component);var st,ct=Object(Ue.b)((function(e){return{anchorPoint:e.anchorPoint,content:e.content,contentIdentifier:e.contentIdentifier,disableRepositioningAnimation:e.disableRepositioningAnimation,horizontalOffset:e.horizontalOffset,isVisible:e.isVisible,isVirtualized:e.isVirtualized,maxDimensions:e.maxDimensions,positionFixed:e.positionFixed,useVisibilityAnimation:e.useVisibilityAnimation}}),(function(e,t){return{removeVisibilityAnimation:function(){e(ze(Be.RemoveVisibilityAnimationType,{}))},updateHorizontalOffset:function(t){e(function(e){return ze(Be.UpdateContainerWidthType,{width:e})}(t))}}}),void 0,{withRef:!0})(at),dt=function(){function e(e,t,n,r){var o;this.onContainerStateChanged=new je,this.floatingContainerRef=void 0,this.extensionUpdatedEventSubscription=void 0,this.unsubscribeStoreListener=function(){},this.canShow=!1,!1===r.isDraftContainer&&(this.floatingContainerCreationActivity=Object(c.g)().createActivityObject("FloatingContainerCreation",Object(c.h)(c.f.GlobalAPI),c.a.None,c.b.NecessaryServiceDataEvent)),this.store=(o=qe(n,r))?Object(He.createStore)(Ye,o):Object(He.createStore)(Ye),this.extensionProvider=t,this.setContentFromExtension(),this.parentDiv=document.createElement("div"),this.parentDiv.id=r.containerId||Object(Le.a)(),e.appendChild(this.parentDiv),this.observeStore=this.observeStore.bind(this),this.onUpdatedEventHandler=this.onUpdatedEventHandler.bind(this),this.setFloatingContainerRef=this.setFloatingContainerRef.bind(this),this.observeStore(n),this.render()}return e.prototype.anchorPoint=function(){return this.store.getState().anchorPoint},e.prototype.contentIdentifier=function(){return this.store.getState().contentIdentifier},e.prototype.height=function(){return this.floatingContainerRef?this.floatingContainerRef.height():0},e.prototype.width=function(){return this.floatingContainerRef?this.floatingContainerRef.width():0},e.prototype.isAnchorPointOnRight=function(){return this.store.getState().isAnchorPointOnRight},e.prototype.parentDivId=function(){return this.parentDiv.id},e.prototype.observeStore=function(e){var t=this;if(Object(ue.g)(this.extensionProvider)){var n=e;this.unsubscribeStoreListener=this.store.subscribe((function(){var e=t.contentIdentifier();n.contentId===e.contentId&&n.contentType===e.contentType||(n=e,t.removeExtensionUpdatedEventSubscription(),t.setContentFromExtension())}))}},e.prototype.setContentFromExtension=function(){var e=this,t=void 0;if(Object(ue.g)(this.extensionProvider)){if(t=this.extensionProvider.getExtension(this.contentIdentifier().contentId),this.extensionUpdatedEventSubscription||(this.extensionUpdatedEventSubscription=t.onUpdated.subscribe((function(t){e.onUpdatedEventHandler()}))),t.priority===ue.c.Disabled)return this.canShow=!1,void this.store.dispatch(Ke(void 0))}else t=this.extensionProvider.getExtension();this.canShow=!0,(void 0===Me.ComponentRegistryImpl&&(xe()?(Me.ComponentRegistryImpl=new Ne,Me.ComponentRegistryImpl.initialize()):Me.ComponentRegistryImpl=new Fe),Me.ComponentRegistryImpl).getComponent(t.componentKey).then((function(t){e.store.dispatch(Ke(t.component)),e.floatingContainerCreationActivity&&(e.floatingContainerCreationActivity.successTag(593872975),e.floatingContainerCreationActivity=void 0)})).catch((function(e){Object(c.g)().assertConditionTag(!1,"Error when registering component in setContentFromExtension "+e,595632583)}))},e.prototype.render=function(){var e={onContainerStateChanged:this.onContainerStateChanged};f.render(l.createElement(Ue.a,{store:this.store},l.createElement(ct,Object(o.__assign)({ref:this.setFloatingContainerRef},e))),this.parentDiv)},e.prototype.updateContainerPosition=function(e){var t,n,r;this.store.dispatch((t=e.anchorPoint,n=!!e.disableRepositioningAnimation,r=!!e.positionFixed,ze(Be.RepositionType,{anchorPoint:t,disableRepositioningAnimation:n,positionFixed:r})))},e.prototype.updateMaximumDimensions=function(e){this.store.dispatch(function(e){return ze(Be.UpdateContentMaxDimensionsType,{maxDimensions:e})}(e))},e.prototype.updateContainerVirtualization=function(e){e&&!Je(this.store.getState())?this.store.dispatch(ze(Be.UpdateContainerVirtualizationType,{isVirtualized:!0})):Je(this.store.getState())&&this.store.dispatch(ze(Be.UpdateContainerVirtualizationType,{isVirtualized:!1}))},e.prototype.showFloatingContainer=function(e){return!!this.canShow&&(this.store.dispatch(function(e){return ze(Be.UpdateContainerVisibilityType,{isVisible:!0,useVisibilityAnimation:e})}(!!e)),!0)},e.prototype.hideFloatingContainer=function(e){this.store.dispatch(function(e){return ze(Be.UpdateContainerVisibilityType,{isVisible:!1,useVisibilityAnimation:e})}(!!e))},e.prototype.destroyFloatingContainer=function(e){var t=this;this.unsubscribeStoreListener(),this.removeExtensionUpdatedEventSubscription(),this.hideFloatingContainer(e),e?setTimeout((function(){t.cleanupDomOnDestroy()}),300):this.cleanupDomOnDestroy()},e.prototype.cleanupDomOnDestroy=function(){f.unmountComponentAtNode(this.parentDiv),this.parentDiv.parentElement&&this.parentDiv.parentElement.removeChild(this.parentDiv)},e.prototype.isShowing=function(){return this.store.getState().isVisible},e.prototype.setDirection=function(e){this.store.dispatch(function(e,t){return ze(Be.UpdateContainerDirectionType,{isAnchorPointOnRight:e,currentWidth:t})}(e,this.width()||0))},e.prototype.setFocus=function(){this.floatingContainerRef&&this.floatingContainerRef.setFocus()},e.prototype.changeRenderedContentIdentifier=function(e){this.store.dispatch(function(e){return ze(Be.ChangeRenderedContentIdentifierType,{newContentIdentifier:e})}(e))},e.prototype.onUpdatedEventHandler=function(){var e=this.canShow;this.setContentFromExtension(),e!==this.canShow&&this.onContainerStateChanged.trigger({stateChangeType:Ve.Enablement,contentIdentifier:this.contentIdentifier(),isEnabled:this.canShow})},e.prototype.removeExtensionUpdatedEventSubscription=function(){this.extensionUpdatedEventSubscription&&(this.extensionUpdatedEventSubscription.unsubscribe(),this.extensionUpdatedEventSubscription=void 0)},e.prototype.setFloatingContainerRef=function(e){this.floatingContainerRef=e?e.getWrappedInstance():void 0},e}(),ut=new(function(){function e(){}return e.prototype.createFloatingContainer=function(e,t,n,r){return new dt(e,t,n,r)},e}()),lt=n(2);!function(e){e[e.DeselectionEnabled=0]="DeselectionEnabled",e[e.FloatingContainerVirtualizationEnabled=1]="FloatingContainerVirtualizationEnabled",e[e.ImproveJumpingFixEnabled=2]="ImproveJumpingFixEnabled",e[e.ShouldInitialize=3]="ShouldInitialize",e[e.ScrollingPerfImprovementEnabled=4]="ScrollingPerfImprovementEnabled",e[e.SynchronousContainerPositioningEnabled=5]="SynchronousContainerPositioningEnabled"}(st||(st={}));function ft(e){return e.contentId+"_"+e.contentType+"_"+e.renderMode}var mt={width:0,height:0,x:0,y:0};function pt(e){return void 0!==e.hasBeenRendered}var gt=function(){function e(e,t,n,r,o){var i=this;this.supportedContentTypes=[ue.b.CommentThread],this.getContentCardIndex=function(e,t){if(!i.containerIdToInfoMap[e])return i.ULS.sendTraceTag(595883362,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[getContentCardIndex]Container with id "+e+" does not exist."),-1;var n=i.containerIdToInfoMap[e].anchorTop;n=t?Math.max(n,t):n;for(var r=i.getContentCardInsertionPoint(n),o=r;o<i.contentAnchorPositions.length;o+=1)if(i.checkIfContainerIdCorrespondsToGivenPosition(e,o))return o;for(o=0;o<r;o+=1)if(i.checkIfContainerIdCorrespondsToGivenPosition(e,o))return o;return-1},this.initializeExtensionProviderCollection=function(e){i.extensionProviderCollection=i.contentExtensionHostAPIGetter().getExtensions(i.supportedContentTypes),i.updateContentTypeToExtensionProviderMap(e),i.extensionProviderCollection.onUpdated.subscribe((function(){return i.updateContentTypeToExtensionProviderMap(e)}))},this.getContentCardInsertionPoint=function(e){for(var t,n=0,r=i.contentAnchorPositions.length;n<r;){t=n+Math.floor((r-n)/2),i.contentAnchorPositions[t].anchorTop<e-4?n=t+1:r=t}return n},this.getContainerStateChangedCallback=function(e){return function(t,n){switch(t.stateChangeType){case Ve.Resize:e(t,n)}}},this.renderFloatingContainerAtAnchorPosition=function(e){var t=i.containerIdToInfoMap[e];t&&t.floatingContainerRef&&t.floatingContainerRef.showFloatingContainer(!0)},this.updateContentTypeToExtensionProviderMap=function(e){i.contentTypeToExtensionProviderMap.clear(),void 0!==i.extensionProviderCollection?(i.areCommentExtensionProvidersDefinedOnce||(i.areCommentExtensionProvidersDefinedOnce=0!==i.extensionProviderCollection.providers.filter((function(e){return e.scope.contentType===ue.b.CommentThread&&e.scope.renderMode===ue.d.Integrated})).length),i.extensionProviderCollection.providers.forEach((function(e){e.scope.renderMode===ue.d.Integrated&&i.contentTypeToExtensionProviderMap.set(e.scope.contentType,e)})),e()):i.ULS.sendTraceTag(595886287,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"extensionProviderCollection should not be null")},this.contentExtensionHostAPIGetter=e,this.dhcContainerPanel=t,this.isCommentPaneOpen=!1,this.areCommentExtensionProvidersDefinedOnce=!1,this.viewportInfo=o||mt,this.containerIdToInfoMap={},this.contentAnchorPositions=[],this.contentTypeToExtensionProviderMap=new Map,this.floatingContainerFactory=n,this.ULS=r}return e.prototype.addContentAnchorPosition=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=-1);var r=n>-1?n:this.getContentCardInsertionPoint(e.anchorTop)+t;return this.contentAnchorPositions.splice(r,0,e),r},e.prototype.getContainerIdToInfoMap=function(){return this.containerIdToInfoMap},e.prototype.getContentAnchorPositions=function(){return this.contentAnchorPositions},e.prototype.getContentAnchorPosition=function(e){var t=this.getContentCardIndex(e);if(t>-1)return this.contentAnchorPositions[t]},e.prototype.initializeAndRenderFloatingContainer=function(e,t,n,r,o){void 0===r&&(r=!0),void 0===o&&(o=!1);var i;return i=this.initializeFloatingContainerState(e,n,r,o),o&&this.renderFloatingContainerAtAnchorPosition(t),i},e.prototype.isContainerInViewPort=function(e){return e.anchorTop>this.viewportInfo.y-.5*this.viewportInfo.height&&e.anchorTop<this.viewportInfo.y+1.5*this.viewportInfo.height},e.prototype.removeContentAnchorPosition=function(e){var t=this.getContentCardIndex(e);return-1===t?(this.ULS.sendTraceTag(595736577,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[RemoveContentAnchorPosition]Content anchor position for id "+e+" does not exist."),-1):(this.contentAnchorPositions.splice(t,1),t)},e.prototype.checkIfContainerIdCorrespondsToGivenPosition=function(e,t){return e===this.getContainerIdUsingPositionalIndex(t)},e.prototype.getContainerIdUsingPositionalIndex=function(e){var t=this.contentAnchorPositions[e];return ft({contentId:t.contentId,contentType:ve(t.containerContentType),renderMode:ue.d.Integrated})},e.prototype.createFloatingContainer=function(e,t,n,r){if(this.dhcContainerPanel)return this.floatingContainerFactory.createFloatingContainer(this.dhcContainerPanel,e,{contentId:t.contentId,contentType:ve(t.containerContentType)},{anchorPoint:{x:0,y:n},isAnchorPointOnRight:!1,isDraftContainer:r});this.ULS.sendTraceTag(595883361,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[createFloatingContainer]dhcContainerPanel is not yet set.")},e.prototype.initializeFloatingContainerState=function(e,t,n,r){if(e){var i=this.contentTypeToExtensionProviderMap.get(ve(e.containerContentType));if(void 0===i)return this.ULS.sendTraceTag(595883363,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[initializeFCState]ExtensionProvider not found for contentType "+e.containerContentType),!1;var a=e.contentId;if(!a)return this.ULS.sendTraceTag(595883407,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[initializeFCState]ContentId is null or empty."),!1;var s=ft({contentId:a,contentType:ve(e.containerContentType),renderMode:ue.d.Integrated}),c=void 0;if(n){if(!(c=this.createFloatingContainer(i,{contentId:a,containerContentType:e.containerContentType},e.anchorTop,r)))return this.ULS.sendTraceTag(595886286,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[createFloatingContainer] Could not create fc for content id "+a),!1;c.onContainerStateChanged.subscribe(this.getContainerStateChangedCallback(t))}if(this.containerIdToInfoMap[s])this.containerIdToInfoMap[s].floatingContainerRef=c;else{var d=Object(o.__assign)(Object(o.__assign)({position:{height:0,width:0,x:0,y:e.anchorTop}},this.containerIdToInfoMap[s]),{anchorTop:e.anchorTop,floatingContainerRef:c,hasBeenRendered:!1});this.containerIdToInfoMap[s]=d}return!0}return!1},e}(),ht=function(){function e(e,t,n,r,o,i){var a=this;this.isInitialActiveIdSet=!1,this.inFixedMode=!1,this.firstContainerBeingRendered=!0,this.fcManagerInitialized=!1,this.pauseContainerCreation=!1,this.containerDelayTimeMs=10,this.containerCreationQueue=[],this.isContainerQueueInProgress=!1,this.timeoutsToCreateContainer={},this.containerCreationEnqueueTimes={},this.stallDetectorTimeoutId=0,this.stallDetectorUsed=!1,this.queueStallDetectionTimeMs=1e3,this.emitEvent=function(e,t){if(a.store.isCommentPaneOpen||!a.store.dhcContainerPanel||!a.store.areCommentExtensionProvidersDefinedOnce)return a.store.ULS.sendTraceTag(595886288,lt.a.msoulscat_Wac_Telemetry,lt.b.Warning,"FCM not handling the event. {\n          isCommentPaneOpen: "+a.store.isCommentPaneOpen+",\n          dhcContainerPanelNotDefined: "+!a.store.dhcContainerPanel+",\n          extensionProvidersNotDefined: "+!a.store.areCommentExtensionProvidersDefinedOnce+"\n        }"),void(t&&t.viewportInfo&&(a.store.viewportInfo=t.viewportInfo));switch(e){case 0:if(t&&t.contentAnchorPosition){var n=t.contentAnchorPosition.contentId,r=t.noOfPrecedingThreadsOnSameLine?t.noOfPrecedingThreadsOnSameLine:0;if(!n)return void a.store.ULS.sendTraceTag(595903774,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[AddContainer]ContentId is null.");var o=ft({contentId:n,contentType:ve(t.contentAnchorPosition.containerContentType),renderMode:ue.d.Integrated});if((m=a.store.getContainerIdToInfoMap()[o])&&m.floatingContainerRef)return void a.store.ULS.sendTraceTag(595097123,lt.a.msoulscat_Wac_Telemetry,lt.b.Warning,"[AddContainer]Container already exists.");if(a.store.initializeAndRenderFloatingContainer(t.contentAnchorPosition,o,a.onContainerResize,void 0,!0)){a.store.addContentAnchorPosition(t.contentAnchorPosition,r);var i={contentId:n,containerContentType:t.contentAnchorPosition.containerContentType};t.shouldSetFocus&&a.emitEvent(2,{containerContentDescriptor:i})}}break;case 1:if(t&&t.containerContentDescriptor){if(!t.containerContentDescriptor.contentId)return void a.store.ULS.sendTraceTag(595903775,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[DeleteContainer]ContentId is null.");o=ft({contentId:t.containerContentDescriptor.contentId,contentType:ve(t.containerContentDescriptor.containerContentType),renderMode:ue.d.Integrated});if(!(m=a.store.getContainerIdToInfoMap()[o]))return void a.store.ULS.sendTraceTag(595723333,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[DeleteContainer]Container info for id "+o+" does not exist.");var s=m.position.y,c=a.deleteContainer(o,!!t.animateOutOnDeletion);if(-1===c)return;a.store.activeContainerId&&a.store.activeContainerId!==o?a.positionFloatingContainers(a.store.getContentAnchorPositions(),void 0,a.store.activeContainerId):a.positionFloatingContainers(a.store.getContentAnchorPositions().slice(c),s)}break;case 2:if(t&&t.containerContentDescriptor){if(!t.containerContentDescriptor.contentId)return void a.store.ULS.sendTraceTag(595903777,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[FocusContainer]ContentId is null.");var d=ft({contentId:t.containerContentDescriptor.contentId,contentType:ve(t.containerContentDescriptor.containerContentType),renderMode:ue.d.Integrated});if(!a.store.getContainerIdToInfoMap()[d])return a.store.ULS.sendTraceTag(595903778,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[FocusContainer]Container with id "+d+" does not exist"),void a.setInitialActiveContainerId(t.containerContentDescriptor);a.store.activeContainerId!==d&&(a.clearSelection(!0),a.positionFloatingContainers(a.store.getContentAnchorPositions(),void 0,d,void 0,!0));var u=a.store.getContainerIdToInfoMap()[d].floatingContainerRef;t.shouldSetFocus&&u&&u.setFocus(),a.store.activeContainerId=d}break;case 3:t&&t.contentAnchorPositions&&a.processContentAnchorPositionsInView(t.contentAnchorPositions);break;case 4:t&&t.viewportInfo&&(a.store.viewportInfo=t.viewportInfo,a.featureSettings.SynchronousContainerPositioningEnabled||a.positionFloatingContainers());break;case 5:if(t&&t.infoToReplaceContent){var l=t.infoToReplaceContent.currentContentId,f=t.infoToReplaceContent.newContentId;if(!l||!f)return void a.store.ULS.sendTraceTag(595855174,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[ReplaceContainerContent]"+(l?"NewContentId":"CurrentContentId")+" is null.");var m,p=ft({contentId:l,contentType:ve(t.infoToReplaceContent.containerContentType),renderMode:ue.d.Integrated});if(!(m=a.store.getContainerIdToInfoMap()[p]))return void a.store.ULS.sendTraceTag(595855175,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[ReplaceContainerContent]ContainerInfo for id "+p+" does not exist");if(!m.floatingContainerRef)return void a.store.ULS.sendTraceTag(595855176,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[ReplaceContainerContent]FloatingContainerRef with id "+p+" does not exist");m.floatingContainerRef.changeRenderedContentIdentifier({contentId:f,contentType:ve(t.infoToReplaceContent.containerContentType)}),a.replacementContentId=f;var g=ft({contentId:f,contentType:ve(t.infoToReplaceContent.containerContentType),renderMode:ue.d.Integrated}),h=a.store.getContentCardIndex(p);if(-1===h)return void a.store.ULS.sendTraceTag(595855178,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[ReplaceContainerContent]Positional index for content id "+l+" should not be negative");a.store.activeContainerId=a.store.activeContainerId===p?g:a.store.activeContainerId,a.store.getContainerIdToInfoMap()[g]=m,delete a.store.getContainerIdToInfoMap()[p],a.store.getContentAnchorPositions()[h].contentId=f}break;case 6:a.positionFloatingContainers()}},this.getAreContainersEnabled=function(){return!a.store.isCommentPaneOpen&&a.store.areCommentExtensionProvidersDefinedOnce},this.getContentAnchorPosition=function(e){if(!e)return null;var t=ft({contentId:e,contentType:ue.b.CommentThread,renderMode:ue.d.Integrated}),n=a.store.getContentCardIndex(t);return-1!==n?a.store.getContentAnchorPositions()[n]:null},this.containerShouldBeCreatedEventHandler=function(e){var t=a.store.getContentCardIndex(e.containerId);a.store.initializeAndRenderFloatingContainer(a.store.getContentAnchorPositions()[t],e.containerId,a.onContainerResize)},this.updateCommentPaneState=function(){a.store.isCommentPaneOpen=!0,a.store.extensionProviderCollection&&(a.store.isCommentPaneOpen=0===a.store.extensionProviderCollection.providers.filter((function(e){return e.scope.contentType===ue.b.CommentThread&&e.scope.renderMode===ue.d.Integrated})).length),a.onCommentPaneStateChange()},this.onContainerResize=function(e){if(!a.store.isCommentPaneOpen&&e.stateChangeType===Ve.Resize&&0!==e.contentRect.height){var t=e.contentIdentifier,n=ft({contentId:t.contentId,contentType:t.contentType,renderMode:ue.d.Integrated}),r=a.store.getContainerIdToInfoMap()[n];if(r){var o=r.position.height!==e.contentRect.height;if(a.isInitialActiveIdSet&&a.store.activeContainerId===n&&r.floatingContainerRef&&(a.isInitialActiveIdSet=!1,r.floatingContainerRef.setFocus()),o){if(r.position.height=e.contentRect.height,r.position.width=e.contentRect.width,a.firstContainerBeingRendered){var i=window.performance&&window.performance.now?window.performance.now():Date.now();a.store.ULS.sendTraceTag(595718473,lt.a.msoulscat_Wac_Telemetry,lt.b.Info,i.toString()),wacBoot.WacSkeletalBoot.isSkeletalDeepLink()&&(Box4.FastViewExtensions.setDeepLinkComplete(),document.body.classList.remove("Deeplink"),Box4.FastViewExtensions.dismiss(),wacBoot.WacSkeletalBoot.setComponentReady("SkeletalPage")),a.firstContainerBeingRendered=!1}var s=void 0!==a.timeoutsToCreateContainer[n];a.featureSettings.DeselectionEnabled?a.positionContainersOnResize(n,r,s):a.positionFloatingContainers(a.store.getContentAnchorPositions(),void 0,a.store.activeContainerId,s),r.floatingContainerRef&&r.floatingContainerRef.showFloatingContainer(s),e.contentIdentifier.contentId===a.replacementContentId&&(a.replacementContentId=void 0),s&&(delete a.timeoutsToCreateContainer[n],a.stallDetectorUsed||(window.clearTimeout(a.stallDetectorTimeoutId),a.processContainerQueue()))}}else a.store.ULS.sendTraceTag(595646153,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[ContainerResize] ContainerInfo does not exist, id: "+n+", size: "+e.contentRect.height)}},this.store=n,this.floatingContainerPositioner=e,this.floatingContainerVirtualizer=t,this.paneClosedCallback=r,this.paneOpenedCallback=o,this.featureSettings=i,i.ShouldInitialize&&this.initialize()}return e.prototype.initialize=function(){this.fcManagerInitialized||(this.store.initializeExtensionProviderCollection(this.updateCommentPaneState),this.floatingContainerVirtualizer.onContainerShouldBeCreated.subscribe(this.containerShouldBeCreatedEventHandler),this.fcManagerInitialized=!0)},e.prototype.enterFixedPositionMode=function(){this.inFixedMode=!0},e.prototype.exitFixedPositionMode=function(){this.inFixedMode=!1},e.prototype.setContainerCreationPauseState=function(e){this.pauseContainerCreation=e,e&&(this.containerCreationEnqueueTimes={},this.isContainerQueueInProgress=!1)},e.prototype.clearSelection=function(e){if(void 0===e&&(e=!1),this.store.activeContainerId){var t=this.store.getContainerIdToInfoMap()[this.store.activeContainerId];if(this.store.activeContainerId=void 0,!t)return;if(t.position.x=0,e)return;this.positionFloatingContainers()}},e.prototype.setInitialActiveContainerId=function(e){this.isInitialActiveIdSet=!0,this.clearSelection(),e&&e.contentId&&(this.store.activeContainerId=ft({contentId:e.contentId,contentType:ve(e.containerContentType),renderMode:ue.d.Integrated}))},e.prototype.insertContentAnchorPosition=function(e,t,n){var r=n&&Math.abs(e.anchorTop-t)<=4?this.store.getContentCardIndex(n)+1:-1;this.store.addContentAnchorPosition(e,0,r)},e.prototype.processContentAnchorPositionsInView=function(e){var t=this,n=!1,r=void 0,o=void 0,i=0;if(e.forEach((function(e){if(e){var a=e.contentId;if(!a)return void t.store.ULS.sendTraceTag(595903808,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[processContentAnchorPosition]ContentId is null.");var s=ft({contentId:a,contentType:ve(e.containerContentType),renderMode:ue.d.Integrated}),c=t.store.getContainerIdToInfoMap()[s];if(!c){var d=t.store.initializeAndRenderFloatingContainer(e,s,t.onContainerResize,!1);return d&&(t.containerCreationQueue.push(s),t.containerCreationEnqueueTimes[s]=Date.now()),void(d&&(t.insertContentAnchorPosition(e,i,r),r=s,i=e.anchorTop))}var u=t.store.getContentCardIndex(s,e.anchorTop);if(-1===u)return void t.store.ULS.sendTraceTag(595883392,lt.a.msoulscat_Wac_Telemetry,lt.b.Error,"[processContentAnchorPosition]Container was supposed to be found.");var l=t.store.getContentAnchorPositions()[u],f=void 0!==o&&c.position.y>=o.position.y&&c.position.y<=o.position.y+o.position.height,m=Math.abs(l.anchorTop-e.anchorTop)>4;if(n=n||m||f,m){var p=ft({contentId:a,contentType:ve(e.containerContentType),renderMode:ue.d.Integrated});t.store.removeContentAnchorPosition(p),t.insertContentAnchorPosition(e,i,r)}r=s,i=e.anchorTop,c.anchorTop=e.anchorTop,o=c}})),this.isContainerQueueInProgress||this.processContainerQueue(),n||this.inFixedMode){var a=this.store.getContentAnchorPositions().length>0?this.store.getContentAnchorPositions()[0].anchorTop:void 0;this.positionFloatingContainers(this.store.getContentAnchorPositions(),a,this.store.activeContainerId)}},e.prototype.processContainerQueue=function(){var e=this;if(0===this.containerCreationQueue.length||this.pauseContainerCreation)this.isContainerQueueInProgress=!1;else{this.isContainerQueueInProgress=!0;var t=this.containerCreationQueue.shift(),n=this.store.getContentAnchorPosition(t);n&&(this.store.isContainerInViewPort(n)?this.timeoutsToCreateContainer[t]=window.setTimeout((function(){e.createContainer(n,t),e.setupStallDetector(t)}),this.containerDelayTimeMs):(this.deleteContainer(t),this.processContainerQueue()))}},e.prototype.setupStallDetector=function(e){var t=this;this.stallDetectorUsed=!1,this.stallDetectorTimeoutId=window.setTimeout((function(){t.stallDetectorUsed=!0,t.processContainerQueue(),t.store.ULS.sendTraceTag(593281990,lt.a.msoulscat_Wac_Telemetry,lt.b.Warning,"[CommentCreationQueueStallDetector]: Container "+e+" creation resize call not received or took too long")}),this.queueStallDetectionTimeMs)},e.prototype.createContainer=function(e,t){if(this.store.initializeAndRenderFloatingContainer(e,t,this.onContainerResize,!0)){if(this.containerCreationEnqueueTimes[t]){var n=Date.now();this.store.ULS.sendTraceTag(593891910,lt.a.msoulscat_Wac_Telemetry,lt.b.Info,"[DelayCreationPerfMetric]TimeToCreateCommentFromEnqueue:"+(n-this.containerCreationEnqueueTimes[t])),delete this.containerCreationEnqueueTimes[t]}}else this.deleteContainer(t),this.processContainerQueue()},e.prototype.onCommentPaneStateChange=function(){this.store.isCommentPaneOpen?(this.store.areCommentExtensionProvidersDefinedOnce&&this.destroyAllContainers(),this.paneOpenedCallback&&this.paneOpenedCallback()):this.paneClosedCallback&&this.paneClosedCallback()},e.prototype.deleteContainer=function(e,t){void 0===t&&(t=!1);var n=this.store.removeContentAnchorPosition(e);if(-1===n)return-1;var r=this.store.getContainerIdToInfoMap()[e].floatingContainerRef;if(r){r.destroyFloatingContainer(t),clearTimeout(this.timeoutsToCreateContainer[e]),delete this.timeoutsToCreateContainer[e];var o=this.containerCreationQueue.indexOf(e);o>-1&&this.containerCreationQueue.splice(o,1)}return delete this.store.getContainerIdToInfoMap()[e],delete this.containerCreationEnqueueTimes[e],n},e.prototype.destroyAllContainers=function(){var e=this;Object.keys(this.store.getContainerIdToInfoMap()).forEach((function(t){e.deleteContainer(t)})),this.isContainerQueueInProgress=!1,this.containerCreationEnqueueTimes={},this.timeoutsToCreateContainer={},this.containerCreationQueue=[]},e.prototype.positionFloatingContainers=function(e,t,n,r,o){if(void 0===r&&(r=!1),void 0===o&&(o=!1),e&&e.length>0){var i=n?{containerId:n,containerPositionIndex:this.store.getContentCardIndex(n)}:void 0;this.floatingContainerPositioner.calculateNewPositions(e,this.store.getContainerIdToInfoMap(),{activeContainerInfo:i,disableRepositioningAnimation:r||this.inFixedMode,topOfFirstContainer:t,shouldUpdatePositions:!1})}this.floatingContainerVirtualizer.updateContainersVisibility(this.store.getContainerIdToInfoMap(),this.store.viewportInfo,r||this.inFixedMode||void 0!==this.replacementContentId,this.store.activeContainerId,o)},e.prototype.positionContainersOnResize=function(e,t,n){var r=this.store.getContentCardIndex(e),o=this.store.activeContainerId?this.store.getContentCardIndex(this.store.activeContainerId):void 0;void 0!==o&&o>=r?this.positionFloatingContainers(this.store.getContentAnchorPositions(),void 0,this.store.activeContainerId,n):(r-=!(pt(t)&&t.hasBeenRendered)&&r>0?1:0,this.positionFloatingContainers(this.store.getContentAnchorPositions().slice(r)));pt(t)&&(t.hasBeenRendered=!0)},e}(),Ct=new(function(){function e(){}return e.prototype.getFCManagerInstance=function(e){if(void 0===this.floatingContainerManagerInstance){if(!e)throw new Error("Floating Container Manager creation arguments are missing!");e.ulsLogger&&lt.c.setLogger(e.ulsLogger);var t=function(e){var t=!!e.scrollingPerfImprovementEnabled;return{DeselectionEnabled:!!e.deselectionEnabled,FloatingContainerVirtualizationEnabled:!!e.floatingContainerVirtualizationEnabled,ImproveJumpingFixEnabled:!!e.improveJumpingFixEnabled,ShouldInitialize:!1!==e.shouldInitialize,ScrollingPerfImprovementEnabled:t,SynchronousContainerPositioningEnabled:!!e.synchronousContainerPositioningEnabled}}(e),n=e.isRtl?1:-1,r=e.canvasAndFcHostOffset?n*(e.canvasAndFcHostOffset-1):0,o=new Ie(ft,lt.c,r),i={containerVirtualizationEnabled:t.FloatingContainerVirtualizationEnabled},a=new De(i),s=new gt(ue.e,e.containerPanel,ut,lt.c,e.viewportInfo);this.floatingContainerManagerInstance=new ht(o,a,s,e.paneClosedCallback,e.paneOpenedCallback,t)}return this.floatingContainerManagerInstance},e}()),yt=n(729);function vt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];ce.apply(void 0,Object(o.__spreadArrays)(e,[Object(ye.a)()]))}function bt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];pe.apply(void 0,Object(o.__spreadArrays)(e,[Object(ye.a)()]))}n.d(t,"renderCommentPane",(function(){return vt})),n.d(t,"instantiate",(function(){return bt})),n.d(t,"initializeRuntime",(function(){return me})),n.d(t,"setWebpackPublicPath",(function(){return i.a})),n.d(t,"ScreenReaderNotifierManagerFactoryGlobal",(function(){return _.a})),n.d(t,"FactoryGlobal",(function(){return Ct})),n.d(t,"RichContentEditAPIFactoryGlobal",(function(){return yt.a}))},141:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Editor=1]="Editor",e[e.Card=2]="Card",e[e.Delete=3]="Delete"}(r||(r={}))},146:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoDraft=1]="NoDraft",e[e.CanAutoDiscard=2]="CanAutoDiscard",e[e.CannotAutoDiscard=3]="CannotAutoDiscard"}(r||(r={}))},147:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(21),o=n(393);function i(e,t){return Object(r.b)(e)?e.errorCode:Object(o.a)(e)?e.SDXHostAPIErrorCode:void 0===t?-2147467259:t}},148:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.AddComment=0]="AddComment",e[e.NextThread=1]="NextThread",e[e.PreviousThread=2]="PreviousThread",e[e.DeleteThread=3]="DeleteThread",e[e.BackKeyPressed=4]="BackKeyPressed",e[e.ShowHideCommentPane=6]="ShowHideCommentPane"}(r||(r={}))},15:function(e,t,n){"use strict";n.d(t,"P",(function(){return A})),n.d(t,"N",(function(){return k})),n.d(t,"t",(function(){return R})),n.d(t,"s",(function(){return F})),n.d(t,"i",(function(){return N})),n.d(t,"T",(function(){return M})),n.d(t,"h",(function(){return V})),n.d(t,"g",(function(){return L})),n.d(t,"J",(function(){return U})),n.d(t,"o",(function(){return B})),n.d(t,"q",(function(){return H})),n.d(t,"p",(function(){return z})),n.d(t,"S",(function(){return W})),n.d(t,"v",(function(){return q})),n.d(t,"x",(function(){return G})),n.d(t,"B",(function(){return Y})),n.d(t,"w",(function(){return K})),n.d(t,"y",(function(){return J})),n.d(t,"C",(function(){return Q})),n.d(t,"bb",(function(){return X})),n.d(t,"O",(function(){return Z})),n.d(t,"D",(function(){return $})),n.d(t,"Y",(function(){return ee})),n.d(t,"j",(function(){return te})),n.d(t,"k",(function(){return ne})),n.d(t,"L",(function(){return re})),n.d(t,"z",(function(){return oe})),n.d(t,"M",(function(){return ie})),n.d(t,"a",(function(){return ae})),n.d(t,"A",(function(){return se})),n.d(t,"I",(function(){return de})),n.d(t,"n",(function(){return ue})),n.d(t,"V",(function(){return me})),n.d(t,"ab",(function(){return pe})),n.d(t,"Z",(function(){return ge})),n.d(t,"E",(function(){return he})),n.d(t,"F",(function(){return ye})),n.d(t,"G",(function(){return ve})),n.d(t,"H",(function(){return be})),n.d(t,"r",(function(){return Te})),n.d(t,"X",(function(){return Ie})),n.d(t,"U",(function(){return Oe})),n.d(t,"W",(function(){return Se})),n.d(t,"R",(function(){return je})),n.d(t,"f",(function(){return De})),n.d(t,"b",(function(){return we})),n.d(t,"K",(function(){return _e})),n.d(t,"u",(function(){return xe})),n.d(t,"d",(function(){return Pe})),n.d(t,"Q",(function(){return Ae})),n.d(t,"e",(function(){return ke})),n.d(t,"c",(function(){return Re})),n.d(t,"m",(function(){return Fe})),n.d(t,"l",(function(){return Ne})),n.d(t,"cb",(function(){return Me}));var r=n(0),o=n(9),i=n(3),a=n(111),s=n(211),c=n(336),d=n(300),u=n(115),l=n(76),f=(n(110),n(120)),m=n(146),p=n(95),g=n(20),h=n(419),C=n(68),y=n(105),v=n(135),b=n(21),T=n(87),I=n(7),O=n(8),S=n(99),j=n(141),D=n(39),w=n(117),_=n(243),x=n(18),E=n(381),P=n(382);function A(e){return""===e||null===e?void 0:e}function k(e){return e.state===w.a.Placeholder||e.state===w.a.Loading}function R(e){for(var t={},n=0;n<e.length;++n)t[e[n].commentId]=F(e[n].displayDate,!1);return t}function F(e,t,n){return void 0===n&&(n=_.a.None),{displayDate:e,displayingErrorUI:t,pending:n}}function N(e,t,n){return t||(!e||isNaN(e.getDate())?"":h.a(e,n))}function M(e,t){var n=Object(r.__assign)({},e);return t.forEach((function(e){return delete n[e]})),n}function V(e,t){for(var n={},r=0;r<e.length;++r)""===e[r].parentId&&(n[e[r].commentId]=L(void 0,t));return n}function L(e,t){return B(e,t===w.a.Loading||t===w.a.Placeholder?{state:t,initialItemCount:1}:{state:null!=t?t:w.a.Loaded})}function U(e){var t,n,o={};try{for(var i=Object(r.__values)(e),a=i.next();!a.done;a=i.next()){var s=a.value;o[s.threadId]=B(void 0,{state:w.a.Placeholder,initialItemCount:s.itemCount})}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o}function B(e,t){return{loadState:null!=t?t:{state:w.a.Loaded},pending:j.a.None,alternateId:e}}function H(e){var t={};return t[e]={pending:_.a.Post,displayDate:void 0,displayingErrorUI:!1},t}function z(e){var t={};return t[e]={pending:j.a.Card,loadState:{state:w.a.Loaded},alternateId:e},t}function W(e,t){var n=Object(r.__assign)({},e);return t.forEach((function(e){return delete n[e]})),n}function q(e,t,n,r){if(e){var o=Object(x.d)(e.selectionDetails)?e.selectedCardId:e.selectionDetails.selectedPostId,i=t.findIndex((function(e){return e.commentId===o})),a=t.findIndex((function(t){return t.commentId===e.selectedCardId}));if(a>=n&&a<r)return;if(i>=n&&i<r){var s={expanded:!0,lowFidelityWarningType:void 0,editingSession_deprecated:x.a.None};return{selectedCardId:e.selectedCardId,selectionDetails:s}}}return e}function G(e,t){var n=!1;if(I.Hb()){var r=e.draftState.cardIdToDraftIdMap[t.parentId];n=e.draftState.drafts[r].forceCardExpanded}else{if(!e.selectedComment||!Object(x.d)(e.selectedComment.selectionDetails))throw Object(o.g)("Selection bug - selection is not on Card "+t.parentId+" after typing in the reply box"),new b.a(T.k,-2130957564);n=e.selectedComment.selectionDetails.expanded}var i={expanded:n,lowFidelityWarningType:void 0,editingSession_deprecated:x.a.None};return{selectedCardId:t.parentId,selectionDetails:i}}function Y(e){var t={lowFidelityWarningType:void 0,editingSession_deprecated:x.a.None,expanded:!e.parentId};return{selectedCardId:Object(l.b)(e),selectionDetails:t}}function K(e,t){var n=e.commentData.find((function(e){return e.commentId===t}));if(n){var r={lowFidelityWarningType:void 0,editingSession_deprecated:x.a.None,expanded:!0};return{selectedCardId:Object(l.b)(n),selectionDetails:r}}throw new b.a(T.j,-2130957563)}function J(e,t){return{selectedCardId:t,selectionDetails:{expanded:re(t,e),lowFidelityWarningType:void 0,editingSession_deprecated:x.a.None}}}function Q(e,t){switch(t.sessionConfiguration.sessionType){case"CREATE":return{selectedCardId:t.sessionConfiguration.draftId,selectionDetails:{expanded:!0,lowFidelityWarningType:void 0,editingSession_deprecated:I.qb()?x.a.None:x.a.Active}};case"EDIT":return function(e,t){var n=e.find((function(e){return e.commentId===t}));if(n){var r={selectedPostId:t,lowFidelityWarningType:void 0,editingSession_deprecated:I.qb()?x.a.None:x.a.Active};return{selectedCardId:Object(l.b)(n),selectionDetails:r}}throw new b.a(T.e,-2130957556)}(e,t.sessionConfiguration.commentId);case"REPLY":return function(e,t){var n=e.find((function(e){return e.commentId===t}));if(n&&""===n.parentId){var r={expanded:!1,lowFidelityWarningType:void 0,editingSession_deprecated:I.qb()?x.a.None:x.a.Active};return{selectedCardId:n.commentId,selectionDetails:r}}throw new b.a(T.e,-2130957556)}(e,t.sessionConfiguration.threadId);default:throw new b.a(T.d,-2130957532)}}function X(e,t,n){var r=!1,i=!1;switch(!I.qb()&&t&&t.selectedCardId===n.payload.selectedCard&&Object(D.d)(e,t)&&(Object(x.d)(t.selectionDetails)?r=!0:t.selectionDetails.selectedPostId===n.payload.selectedPost&&(i=!0)),n.payload.selectType){case S.a.ExpandCard:var a={expanded:!0,lowFidelityWarningType:void 0,editingSession_deprecated:r&&t?t.selectionDetails.editingSession_deprecated:x.a.None};return{selectedCardId:n.payload.selectedCard,selectionDetails:a};case S.a.CollapseCard:var s=!1;if(I.Gb()){var c=be(e);s=!!c&&c.forceCardExpanded&&c.threadId===n.payload.selectedCard}a={expanded:s,lowFidelityWarningType:void 0,editingSession_deprecated:r&&t?t.selectionDetails.editingSession_deprecated:x.a.None};return{selectedCardId:n.payload.selectedCard,selectionDetails:a};case S.a.SelectPost:var d={selectedPostId:n.payload.selectedPost,lowFidelityWarningType:void 0,editingSession_deprecated:i&&t?t.selectionDetails.editingSession_deprecated:x.a.None};return{selectedCardId:n.payload.selectedCard,selectionDetails:d};default:return Object(o.j)(n.payload),I.qb()?void 0:t}}function Z(e){return e===Object(C.v)()}function $(e,t,n){var r,o=t.payload.params,i=n,a=I.qb()?x.a.None:x.a.SessionRequestPending;return r=Object(u.f)(o)?{lowFidelityWarningType:void 0,editingSession_deprecated:a,expanded:re(o.threadId,e)}:Object(u.e)(o)?{lowFidelityWarningType:void 0,editingSession_deprecated:a,selectedPostId:o.commentId}:I.N()?{lowFidelityWarningType:void 0,editingSession_deprecated:a,expanded:re(i=e?e.selectedCardId:n,e)}:{lowFidelityWarningType:void 0,editingSession_deprecated:a,selectedPostId:Object(C.v)()},{selectedCardId:i,selectionDetails:r}}function ee(e,t,n){if(t&&n.type===O.a.ClearCommentSelectionType&&Object(D.l)(e,t))return!1;if(t&&Object(D.l)(e,t)&&n.type!==O.a.ClearCommentSelectionType){var r=n.payload.selectType===S.a.CollapseCard||n.payload.selectType===S.a.ExpandCard;return n.payload.selectedCard===t.selectedCardId&&Object(x.d)(t.selectionDetails)&&r}return!0}function te(e){var t={};return e.commentId&&(t[e.commentId]={pending:j.a.None,loadState:{state:w.a.Loaded},alternateId:e.commentId}),t}function ne(e){var t={};return e.commentId&&(t[e.commentId]={pending:_.a.None,displayDate:void 0,displayingErrorUI:!1}),t}function re(e,t){return!(!t||t.selectedCardId!==e)&&(!Object(x.d)(t.selectionDetails)||t.selectionDetails.expanded)}function oe(e,t){return e&&e.selectedCardId===t.payload.commentId?{selectedCardId:t.payload.commentId,selectionDetails:{lowFidelityWarningType:void 0,editingSession_deprecated:x.a.None,expanded:Ee(e)}}:e}function ie(e,t){return!!e&&(!t.drafts[e.draftId]||t.drafts[e.draftId].isInCurrentContext)}function ae(e,t,n,o,i){if(I.zb()&&!ie(e,o))return e;if(e&&n[e.newComment.commentId]&&(n[e.newComment.commentId].pending===j.a.None||!i)){var a=Object(r.__assign)({},e),s=t.length;if(a.index>=s)a.index=s;else if(a.index>=0&&t[a.index].parentId){var c=new d.a(t,a.index);c.next().done?a.index=s:a.index=c.currentIndex()}return a}}function se(e){return Object(r.__assign)(Object(r.__assign)({},e),{selectionDetails:{expanded:!1,lowFidelityWarningType:void 0,editingSession_deprecated:x.a.None}})}function ce(e,t,n){if(!t)return-1;var r=n?t.selectedCardId:Object(x.c)(t);return e.findIndex((function(e){return e.commentId===r}))}function de(e,t){return ce(e,t,!0)}function ue(e,t){return ce(e,t,!1)}function le(e,t){var n=Object(r.__assign)({},e);return n[t]&&delete n[t],n}function fe(e,t){if(void 0===t)return Object(i.g)().assertConditionTag(0===Object.keys(e).length,"Invalid number of drafts.",593762516),e;Object(i.g)().assertConditionTag(1===Object.keys(e).length,"Invalid number of drafts.",593762517),Object(i.g)().assertConditionTag(!!e[t.sessionConfiguration.draftId],"Draft is not in map",593762518);var n=Object(r.__assign)({},e);return delete n[t.sessionConfiguration.draftId],n}function me(e,t){return Object(E.a)(e,t)===m.a.CanAutoDiscard?Object(D.h)():e}function pe(e,t){if(!I.q())return e;var n=Object(r.__assign)({},e.drafts),o=!1;return Object.keys(n).forEach((function(e){var i=t(e);i!==n[e].renderContextType&&(n[e]=Object(r.__assign)(Object(r.__assign)({},n[e]),{renderContextType:i}),o=!0)})),o?Object(r.__assign)(Object(r.__assign)({},e),{drafts:n}):e}function ge(e,t){if(t===f.a.Closed){if(Object(v.b)(e))return g.a.None}else if(e===g.a.DiscreteIntegrated)return g.a.FullPane;return e}function he(e){var t=be(e);return t?t.commentDraft:void 0}function Ce(e){var t=Object.keys(e);if(t.length>1)throw Object(i.g)().assertConditionTag(!1,"Invalid number of drafts.",593762519),new b.a("Only a single draft is supported at this time.",-2130957551);if(0!==t.length)return t[0]}function ye(e){return Ce(e.cardIdToDraftIdMap)}function ve(e){return Ce(e.postIdToDraftIdMap)}function be(e){var t=e.drafts,n=Ce(t);return n?t[n]:void 0}function Te(e,t,n,r){var o=e&&Object(D.d)(r,e),i=e&&o?void 0:t.selectedCardId,a=Object(x.d)(t.selectionDetails)||n&&o?void 0:t.selectionDetails.selectedPostId;if(i&&r.cardIdToDraftIdMap[i])return Oe(r,i);if(a&&r.postIdToDraftIdMap[a])return Se(r,a);return r}function Ie(e){return{drafts:fe(e.drafts,he(e)),cardIdToDraftIdMap:{},postIdToDraftIdMap:{},pendingDraft:void 0}}function Oe(e,t){var n,o=I.qb()&&e.pendingDraft&&Object(u.f)(e.pendingDraft)&&e.pendingDraft.threadId===t,i=e.cardIdToDraftIdMap[t];return i?Object(r.__assign)(Object(r.__assign)({},e),{drafts:fe(e.drafts,null===(n=e.drafts[i])||void 0===n?void 0:n.commentDraft),cardIdToDraftIdMap:le(e.cardIdToDraftIdMap,t),pendingDraft:o?void 0:e.pendingDraft}):o?Object(r.__assign)(Object(r.__assign)({},e),{pendingDraft:void 0}):e}function Se(e,t){var n,o=I.qb()&&e.pendingDraft&&Object(u.e)(e.pendingDraft)&&e.pendingDraft.commentId===t,i=e.postIdToDraftIdMap[t];return i?Object(r.__assign)(Object(r.__assign)({},e),{drafts:fe(e.drafts,null===(n=e.drafts[i])||void 0===n?void 0:n.commentDraft),postIdToDraftIdMap:le(e.postIdToDraftIdMap,t),pendingDraft:o?void 0:e.pendingDraft}):o?Object(r.__assign)(Object(r.__assign)({},e),{pendingDraft:void 0}):e}function je(e,t,n){var o=Oe(e,t),i=ve(o);if(i){var a=o.postIdToDraftIdMap[i],s=o.drafts[a];s&&s.threadId===t&&(o=Se(o,i))}if(I.qb()&&o.pendingDraft&&Object(u.e)(o.pendingDraft)){var c=o.pendingDraft.commentId,d=n.find((function(e){return e.commentId===c}));d&&Object(l.b)(d)===t&&(o=Object(r.__assign)(Object(r.__assign)({},o),{pendingDraft:void 0}))}return o}function De(e,t){return Me(e.atMention===t.capability)||Object(i.g)().assertConditionTag(!1,"mismatch between received ModelCapabilities AtMention value and atMentionState",590120397),I.Q()?e.atMention:t.capability}function we(e){if(I.Q()&&(Object(y.a)()===p.a.Web||I.lb()&&Object(y.a)()===p.a.Windows)){if(e.tasks===c.a.Unknown){if(Object(y.a)()===p.a.Windows)return I.b();Object(i.g)().assertConditionTag(!1,"Tasks Model Capability state has not been sent by the app.",590144153)}return e.tasks===c.a.Enabled&&I.b()}return I.b()}function _e(e,t){return Me(e.virtualized===t)||Object(i.g)().assertConditionTag(!1,"mismatch between received ModelCapabilities virtualized value and virtualized state",590120398),I.Q()?e.virtualized:t}function xe(e,t){return Me(e.resolve===t)||Object(i.g)().assertConditionTag(!1,"mismatch between received ModelCapabilities resolve value and resolve state",590120399),I.Q()?e.resolve:t}function Ee(e){return!!e&&(!Object(x.d)(e.selectionDetails)||e.selectionDetails.expanded)}function Pe(e,t){return!(!t||!t.draftWarningState||e&&e.draftWarningState&&(!I.rb()||t.commentDraft.sessionConfiguration.draftId===e.commentDraft.sessionConfiguration.draftId)&&t.draftWarningState.warningCounter===e.draftWarningState.warningCounter)}function Ae(e,t,n){var r=e.pendingCommentLoad,i=void 0;if(e.pendingCommentLoad){var a=e.pendingCommentLoad.selectedThreadIndex;if(void 0!==a&&Object(P.a)({commentData:t,pendingCommentLoad:r,virtualized:n})){var s=t.filter(l.a);if(!(a>=0&&a<s.length))throw Object(o.g)("selectedThreadIndex out of bounds"),new b.a(T.m,-2130957565);i=function(e){return{selectedCardId:e,selectionDetails:{expanded:!0,lowFidelityWarningType:void 0,editingSession_deprecated:x.a.None}}}(s[a].commentId)}t.length===e.pendingCommentLoad.numberOfComments&&(r=void 0)}else Object(o.g)("LoadCommentAction dispatched without pending comment load");if(I.Hb()){var c=e.createdCommentLie;c&&e.selectedComment&&e.selectedComment.selectedCardId===c.newComment.commentId&&(i=e.selectedComment)}else e.selectedComment&&Object(D.d)(e.draftState,e.selectedComment)&&(i=e.selectedComment);return{pendingCommentLoad:r,selectedComment:i}}function ke(e,t){var n=e.find((function(e){return e.commentId===t}));return(null==n?void 0:n.author.DisplayName)&&(null==n?void 0:n.date)?{valid:!0,matchesCurrentUser:!!(null==n?void 0:n.author.IsCurrentUser),timeElapsed:(null==n?void 0:n.date)?Date.now()-n.date.getTime():0}:{valid:!1}}function Re(e,t){return t?e.filter((function(e){return""===e.parentId&&!(e.commentFlags&s.a.Resolved)})).length>0:e.length>0}function Fe(){return{atMention:a.b.Unknown,newThread:!1,resolve:!1,richTextCapabilities:void 0,tasks:c.a.Unknown,virtualized:!1}}function Ne(e,t){var n,o=e.cardIdToDraftIdMap[t.commentId],a=o?e.drafts[o].commentDraft:void 0;if(void 0===a)return Object(i.g)().assertConditionTag(0===Object.keys(e.drafts).length,"Could not find draft for adding smart replies",590202465),e;var s=t.smartReplies,c=a.sessionConfiguration.sessionType,d=s.length;return"REPLY"===c&&(d<=3&&d>0)?Object(r.__assign)(Object(r.__assign)({},e),{drafts:Object(r.__assign)(Object(r.__assign)({},e.drafts),(n={},n[o]=Object(r.__assign)(Object(r.__assign)({},e.drafts[o]),{smartReplies:s}),n))}):e}function Me(e){return!I.Q()||Object(y.a)()!==p.a.Web||e}},157:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.NoComments=1]="NoComments",e[e.AtStartNextCommentIsFirst=2]="AtStartNextCommentIsFirst",e[e.MoreCommentsUpcoming=3]="MoreCommentsUpcoming",e[e.AtFinishNextCommentIsFirst=4]="AtFinishNextCommentIsFirst",e[e.OnlyCommentsInCurrent=5]="OnlyCommentsInCurrent",e[e.DocumentHasComments=6]="DocumentHasComments"}(r||(r={}))},158:function(e,t,n){"use strict";function r(e){return!!e&&!!e.commentModel}function o(e){return!!e&&!!e.historyItem}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},159:function(e,t,n){"use strict";var r;function o(e){if(!e)return!1;var t=e;return void 0!==t.displayMode&&"string"==typeof t.displayMode}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.Normal="Normal",e.FullScreen="FullScreen",e.Variable="Variable"}(r||(r={}))},16:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(0);function o(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{trackback:t})}function i(e,t,n){return{type:e,payload:t,actionDetail:n}}},163:function(e,t,n){"use strict";var r=function(){function e(){this.valueStruct={hasValue:!1},this.callbacks=[]}return e.prototype.set=function(e){this.valueStruct={value:e,hasValue:!0},this.callbacks.forEach((function(t){return t(e)})),this.callbacks=[]},e.prototype.getValue=function(e){var t=this;if(this.valueStruct.hasValue)try{return Promise.resolve(e(this.valueStruct.value))}catch(e){return Promise.reject(e)}return new Promise((function(n,r){t.callbacks.push((function(t){try{n(e(t))}catch(e){r(e)}}))}))},e}();function o(e,t,n,r,o){var i,a=n(),s=function(){var e=t(a);e?(a=e,i=setTimeout(s,r)):(a=n(),i=void 0)},c=function(t){a=e(a,t),i||o||(i=setTimeout(s,0)),i||(i=setTimeout(s,o||r))};return c.reset=function(){void 0!==i&&(clearTimeout(i),a=n(),i=void 0)},c}var i=n(0);function a(e,t){var n,r,o=[];try{for(var a=Object(i.__values)(e),s=a.next();!s.done;s=a.next()){var c=t(s.value);void 0!==c&&o.push(c)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o}Boolean;var s=function(){var e=[],t={},n=[];return function(r,o){if(r===e&&o===t)return n;var i=r.map((function(r,i){return r===e[i]&&r.every((function(e){return o[e]===t[e]}))?n[i]:r.map((function(e){return o[e]}))}));return e=r,t=o,n=i,i}};function c(e){var t,n=[{}];return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n.every((function(e,t){return e===r[t]}))?t:(n=r,t=e.apply(void 0,Object(i.__spread)(r)))}}function d(e,t){var n=c(e);return function(){return n.apply(void 0,Object(i.__spread)(t()))}}function u(e){var t=e;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t&&t.apply(void 0,Object(i.__spread)(e)),t=void 0}}var l=n(249),f=n.n(l).a;function m(e){return e}n.d(t,"a",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"b",(function(){return f})),n.d(t,"g",(function(){return m}))},168:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CancelNewThreadDraft=1]="CancelNewThreadDraft",e[e.DeleteThread=2]="DeleteThread",e[e.RequestNewCommentFromHost=3]="RequestNewCommentFromHost",e[e.CancelReplyDraft=4]="CancelReplyDraft",e[e.ResolveThread=5]="ResolveThread"}(r||(r={}))},173:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),o=n(21),i=function(e){return function(t){Object(o.b)(t)?Object(r.g)().assertConditionTag(!1,t.message,e):Object(r.g)().assertConditionTag(!1,"Unknown error "+t,e)}}},175:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ViewContainerChanged=0]="ViewContainerChanged",e[e.VisibilityChanged_deprecated=1]="VisibilityChanged_deprecated",e[e.FocusTriggered=2]="FocusTriggered",e[e.VisibilityChanged=3]="VisibilityChanged",e[e.FoldableLayoutStateChanged=4]="FoldableLayoutStateChanged"}(r||(r={}))},176:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.GrantUsersAccessFailure=1]="GrantUsersAccessFailure",e[e.InitCreateCommentSession=2]="InitCreateCommentSession",e[e.InitEditCommentSession=3]="InitEditCommentSession",e[e.InitReplyCommentSession=4]="InitReplyCommentSession",e[e.NextThread=5]="NextThread",e[e.PreviousThread=6]="PreviousThread",e[e.SelectCard_deprecated=7]="SelectCard_deprecated",e[e.DeleteThread=8]="DeleteThread",e[e.CommitFailure=9]="CommitFailure",e[e.HostRequest=10]="HostRequest",e[e.GhostCard=11]="GhostCard"}(r||(r={}))},177:function(e,t,n){"use strict";var r=n(507),o=new r.a;n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return r.c})),n.d(t,"b",(function(){return r.b}))},178:function(e,t,n){"use strict";var r=n(9),o=n(3),i=n(177),a=n(125),s=n(211),c=n(113),d=n(110),u=n(159),l=n(28),f=n(173),m=n(21),p=n(7);function g(e,t,n,r,i){if(!p.Hb()&&p.fb()){var a=Object(o.g)().createActivityObject("SelectionAttemptWhileDrafting",n,o.a.None,o.b.NecessaryServiceDataEvent);a.addDataField(l.a.Trackback,r,o.c.SystemMetadata),a.addDataField(l.a.RenderContextType,i,o.c.SystemMetadata),a.addDataField(l.a.SelectionAttemptType,e,o.c.SystemMetadata),a.addDataField(l.a.IsDraftInCurrentContext,t.isInCurrentContext,o.c.SystemMetadata),a.addDataField(l.a.DraftId,t.commentDraft.sessionConfiguration.draftId,o.c.SystemMetadata),a.successTag(590206682)}}var h=n(14),C=n(37),y=n(276),v=n(189),b=n(15),T=n(39),I=n(176),O=n(18),S=n(139),j=n(847),D=n(146),w=n(140),_=n(20),x=n(168),E=n(186),P=n(355),A=n(68);var k=n(135),R=n(83);function F(e){var t=e.comment,n=e.threads,r=e.selectedComment,o=e.warningType,i=e.warningType_deprecated,a=!t.parentId,c=!!(t.commentFlags&s.a.LowFidelity);if(!r)return!(!a||(p.qb()?o!==O.b.DeleteThread:i!==O.a.LowFidelityWarningOnDeleteThread)||!c&&!R.j(n,t.commentId))||p.l()&&c&&a;var d=c||a&&(p.qb()?o===O.b.DeleteReply||o===O.b.DeleteThread:i===O.a.LowFidelityWarningOnDelete||i===O.a.LowFidelityWarningOnDeleteThread)&&R.j(n,t.commentId),u=Object(O.d)(r.selectionDetails)?r.selectedCardId:r.selectionDetails.selectedPostId;return!(!d||u===t.commentId&&(p.qb()?r.selectionDetails.lowFidelityWarningType===o:r.selectionDetails.editingSession_deprecated===i))}function N(e){var t=e.result,n=e.localizationAPI;p.m()&&t===v.a.Success&&Object(i.b)(n.getString(67))}function M(e){var t=e.trackback,n=e.id,a=e.data,s=e.selectedComment,c=e.renderContextType,d=e.actionDispatchers,u=e.telemetryVisitor,l=e.localizationAPI,f=R.a(a,n);f?F({comment:f,threads:a,selectedComment:s,warningType:O.b.DeleteReply,warningType_deprecated:O.a.LowFidelityWarningOnDelete})?d.showLowFidelityWarning({renderContextType:c,telemetryVisitor:u,trackback:r.d.reserveTag(593826118)},n,O.b.DeleteReply,O.a.LowFidelityWarningOnDelete):(Object(i.b)(l.getString(65)),d.requestDeleteComment({renderContextType:c,telemetryVisitor:u,trackback:t},n)):Object(o.g)().assertConditionTag(!1,"Comment not found",593826117)}function V(e){var t=e.trackback,n=e.id,r=e.data,i=e.renderContextType,a=e.actionDispatchers,s=e.telemetryVisitor,c=R.a(r,n);c?a.showPostErrorUI({renderContextType:i,telemetryVisitor:s,trackback:t},c.commentId):Object(o.g)().assertConditionTag(!1,"Comment not found",593875075)}function L(e){var t=e.trackback,n=e.id,r=e.data,i=e.renderContextType,a=e.actionDispatchers,s=e.telemetryVisitor,c=R.a(r,n);c?a.clearPostErrorUI({renderContextType:i,telemetryVisitor:s,trackback:t},c.commentId):Object(o.g)().assertConditionTag(!1,"Comment not found",593875076)}function U(e){var t=e.trackback,n=e.id,i=e.data,a=e.selectedComment,s=e.renderContextType,c=e.actionDispatchers,d=e.telemetryVisitor,u=R.a(i,n);u?F({comment:u,threads:i,selectedComment:a,warningType:O.b.Edit,warningType_deprecated:O.a.LowFidelityWarningOnEdit})?c.showLowFidelityWarning({renderContextType:s,telemetryVisitor:d,trackback:r.d.reserveTag(593826120)},n,O.b.Edit,O.a.LowFidelityWarningOnEdit):c.requestEditCommentSession({renderContextType:s,telemetryVisitor:d,trackback:t},n):Object(o.g)().assertConditionTag(!1,"Comment not found",593826119)}function B(e){var t=e.trackback,n=e.id,r=e.data,a=e.draftState,s=e.selectedComment_deprecated,c=e.contentPromise,d=e.atMentionsEnabled,u=e.componentTree,l=e.actionDispatchers,f=e.telemetryVisitor,g=e.localizationAPI;if(Object(T.i)(a,s))return Promise.resolve();if(p.qb()&&!a.postIdToDraftIdMap[n])return Object(o.g)().assertConditionTag(!1,"Post draft to commit not found",588853381),Promise.reject(new m.a("Post draft to commit not found",-2130957492));var h=R.a(r,n);return h?(p.m()||Object(i.b)(g.getString(67)),l.commitCommentAndFocus({renderContextType:u.renderContextType,telemetryVisitor:f,trackback:t},(function(){return c}),{commentId:n,type:"EDIT",previousCommentBody:h.commentBody},d,u).then((function(e){N({result:e,localizationAPI:g})})).catch((function(e){Object(m.b)(e)?Object(o.g)().assertConditionTag(!1,e.message,593826122):Object(o.g)().assertConditionTag(!1,"Unknown error in postOnCommit "+e,593826123)}))):(Object(o.g)().assertConditionTag(!1,"Comment not found in model",593826121),p.qb()?Promise.reject(new m.a("Comment not found in model",2130957505)):Promise.reject())}function H(e){var t=e.trackback,n=e.renderableItem,o=e.selectedComment,i=e.dispatchProps,a=e.telemetryVisitor,s=e.componentTree,c=e.draftState,d=e.shouldFocusAfter,u=R.i(n),l=R.e(n);return p.fb()||p.T()?i.discardDraftIfEmpty({renderContextType:s.renderContextType,telemetryVisitor:a,trackback:r.d.reserveTag(593237586)},C.a.SharedComments,void 0).then((function(e){if(p.fb())if(p.Hb()||e.draftDiscardBehavior!==D.a.CannotAutoDiscard||o&&!Object(O.d)(o.selectionDetails)&&o.selectionDetails.selectedPostId===l){var n=!o||o.selectedCardId!==u||Object(O.d)(o.selectionDetails)&&!o.selectionDetails.expanded;i.selectComment(s,{renderContextType:s.renderContextType,telemetryVisitor:a,trackback:t},Object(y.a)(u,C.a.SharedComments,n?{selectType:h.c.ExpandCard}:{selectType:h.c.SelectPost,selectedPost:l}),d).catch(Object(f.a)(r.d.reserveTag(590104649)))}else{var m=Object(b.H)(c);m&&g(2,m,a,r.d.reserveTag(590206683),s.renderContextType)}}),Object(f.a)(r.d.reserveTag(593032901))):(p.fb()||(!o||o.selectedCardId!==u||Object(O.d)(o.selectionDetails)&&!o.selectionDetails.expanded?i.selectCommentCardExpand_deprecated({renderContextType:s.renderContextType,telemetryVisitor:a,trackback:t},u,C.a.SharedComments):i.selectCommentPost_deprecated({renderContextType:s.renderContextType,telemetryVisitor:a,trackback:t},u,l,C.a.SharedComments)),Promise.resolve())}function z(e){var t=e.trackback,n=e.commentId,r=e.setContents,a=e.data,s=e.draftState,d=e.selectedComment_deprecated,u=e.shouldClosePaneAfterDiscardDraft,l=e.onWillDiscardCallback,f=e.renderContextType,g=e.dispatchProps,h=e.telemetryVisitor,y=e.localizationAPI,v=p.qb()?!!s.postIdToDraftIdMap[n]:!!d,b=R.a(a,n);v&&b?(Object(i.b)(y.getString(66)),g.discardDraftAsync({renderContextType:f,telemetryVisitor:h,trackback:t},C.a.SharedComments,u,l).then((function(e){e===c.a.Handled&&b&&r&&r(b.commentBody)})).catch((function(e){Object(m.b)(e)?Object(o.g)().assertConditionTag(!1,e.message,593826127):Object(o.g)().assertConditionTag(!1,"Unknown error in postOnCancel when calling discardDraftAsync "+e,593826128)}))):Object(o.g)().assertConditionTag(!1,"Cannot find comment post to cancel '"+n+"'",593826126)}function W(e){var t=e.cardProps,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardMounted(n,t)}))}function q(e){var t=e.cardId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardEditorMounted(n,t)}))}function G(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostEditorMounted(n,t)}))}function Y(e){var t=e.trackback,n=e.threadId,r=e.renderContextType,o=e.dispatchProps,i=e.telemetryVisitor;o.requestReplyCommentSession({renderContextType:r,telemetryVisitor:i,trackback:t},n)}function K(e){var t=e.trackback,n=e.commentCardRef,o=e.dispatchProps,i=e.telemetryVisitor,a=e.selectRootPost,s=e.relativeDraftingState,c=e.componentTree,d=e.draftState,u=e.shouldFocusAfter,l=n.getId(),m=!!s;if(o.discardDraftIfEmpty({renderContextType:c.renderContextType,telemetryVisitor:i,trackback:r.d.reserveTag(593052049)},C.a.SharedComments,p.fb()||s!==S.a.InOtherCard?void 0:I.a.SelectCard_deprecated).then((function(e){if(e.draftDiscardBehavior===D.a.CannotAutoDiscard&&s===S.a.InOtherCard){var t=Object(b.H)(d);t&&g(1,t,i,r.d.reserveTag(590206684),c.renderContextType)}})).catch(Object(f.a)(r.d.reserveTag(593032903))),p.fb()){var v=Object(y.a)(l,C.a.SharedComments,a&&!m?{selectType:h.c.SelectPost,selectedPost:l}:{selectType:h.c.ExpandCard});o.selectComment(c,{renderContextType:c.renderContextType,telemetryVisitor:i,trackback:t},v,u).catch(Object(f.a)(r.d.reserveTag(590104650)))}else!a||m?o.selectCommentCardExpand_deprecated({renderContextType:c.renderContextType,telemetryVisitor:i,trackback:t},l,C.a.SharedComments):o.selectCommentPost_deprecated({renderContextType:c.renderContextType,telemetryVisitor:i,trackback:t},l,l,C.a.SharedComments)}function J(e){var t=e.trackback,n=e.commentCardRef,o=e.renderContextType,i=e.dispatchProps,a=e.telemetryVisitor,s=e.componentTree;p.fb()?i.selectComment(s,{renderContextType:o,telemetryVisitor:a,trackback:t},{selectType:h.c.CollapseCard,selectedCard:n.getId(),source:C.a.SharedComments},!1).catch(Object(f.a)(r.d.reserveTag(590104651))):i.selectCommentCardCollapse_deprecated({renderContextType:o,telemetryVisitor:a,trackback:t},n.getId(),C.a.SharedComments)}function Q(e){var t=e.trackback,n=e.commentCardRef,r=e.renderContextType,i=e.dispatchProps,a=e.telemetryVisitor,s=e.shouldHighlightCard;p.j()?void 0!==n?s?i.highlightComment({renderContextType:r,telemetryVisitor:a,trackback:t},n.getId()):i.clearCommentHighlight({renderContextType:r,telemetryVisitor:a,trackback:t},n.getId()):Object(o.g)().assertConditionTag(!1,"CommentCardRef should not be undefined.",578586752):void 0===n?i.clearCommentHighlight_deprecated({renderContextType:r,telemetryVisitor:a,trackback:t}):i.highlightComment({renderContextType:r,telemetryVisitor:a,trackback:t},n.getId())}function X(e){var t=e.trackback,n=e.cardId,r=e.isCardLie,i=e.newHeight,a=e.renderContextType,s=e.draftState_deprecated,c=e.selectedComment,d=e.dispatchProps,l=e.telemetryVisitor;if(a===_.a.HalfPane){if(void 0===i)return Object(o.g)().assertConditionTag(!1,"Height should not be undefined in half-pane mode",593826129);c&&c.selectedCardId===n&&r&&(p.rb()?!Object(b.O)(n):Object(T.c)(s,c))&&d.requestDisplayConfiguration({renderContextType:a,telemetryVisitor:l,trackback:t},{displayMode:u.a.Variable,desiredHeight:i}).catch((function(e){Object(m.b)(e)?Object(o.g)().assertConditionTag(!1,e.message,593826130):Object(o.g)().assertConditionTag(!1,"Unknown error in cardOnDraftingInputSizeChange when calling requestDisplayConfiguration "+e,593826131)}))}}function Z(e){var t=e.trackback,n=e.id,r=e.draftState,o=e.renderContextType,i=e.dispatchProps,s=e.telemetryVisitor;if(!p.T()){var c=r.drafts[r.cardIdToDraftIdMap[n]];c&&c.isDraftEmpty&&c.commentDraft.sessionConfiguration.sessionType===a.f&&i.discardDraftAsync({renderContextType:o,telemetryVisitor:s,trackback:t},C.a.SharedComments,!1)}}function $(e){var t,n=e.trackback,r=e.selectedComment_deprecated,s=e.showDiscardDialog,d=e.invokeModalDialog,u=e.componentTree,l=e.dispatchProps,f=e.closeOnDiscard,g=e.cardId,h=e.draftId_deprecated,y=e.draftState,v=e.telemetryVisitor,b=e.localizationAPI,T=e.focusHandlerRegistry,I=e.isNewCommentButtonFocusable,O=e.lieIndex,S=p.qb()?y.cardIdToDraftIdMap[g]:h;if(!p.qb()||S){var j=void 0;s&&(j=Object(P.a)(y,u,d,r));var D=(p.v()||!!r)&&!!S&&(null===(t=y.drafts[S])||void 0===t?void 0:t.commentDraft.sessionConfiguration.sessionType)===a.f,w=function(e){var t=e.componentTree,n=e.focusHandlerRegistry,r=e.isNewCommentButtonFocusable,o=e.lieIndex,i=e.cardId,a=e.isReplyDraft,s=e.discardCallback,d=e.selectedComment_deprecated;return function(e,u){if(s){return s((function(){return n.onUserAction(t,{userAction:x.a.CancelNewThreadDraft,threadIndex:o,isNewCommentButtonFocusable:r}),e?e():c.a.Unhandled}),u)}return e?(p.v()&&a?n.onUserAction(t,{userAction:x.a.CancelReplyDraft,selectedCardId:p.qb()?i:null==d?void 0:d.selectedCardId}):n.onUserAction(t,{userAction:x.a.CancelNewThreadDraft,threadIndex:o,isNewCommentButtonFocusable:r}),Promise.resolve(e())):Promise.resolve(c.a.Unhandled)}}({componentTree:u,focusHandlerRegistry:T,isNewCommentButtonFocusable:I,lieIndex:O,cardId:g,isReplyDraft:D,discardCallback:j,selectedComment_deprecated:r});Object(i.b)(b.getString(D?64:103)),l.discardDraftAsync({renderContextType:u.renderContextType,telemetryVisitor:v,trackback:n},C.a.SharedComments,f,w).then((function(e){e!==c.a.Handled||!p.x()&&D||(D?T.onUserAction(u,{userAction:x.a.CancelReplyDraft,selectedCardId:g}):T.onUserAction(u,{userAction:x.a.CancelNewThreadDraft,isNewCommentButtonFocusable:I,threadIndex:O}))}),(function(e){Object(m.b)(e)?Object(o.g)().assertConditionTag(!1,e.message,592840735):Object(o.g)().assertConditionTag(!1,"Unknown error thrown from cardOnDraftingCancel: "+e,592840736)}))}else Object(o.g)().assertConditionTag(!1,"Card draft to cancel not found",588853382)}function ee(e){var t=e.trackback,n=e.commentCardRef,r=e.draftState,a=e.selectedComment_deprecated,s=e.areMentionsEnabled,c=e.session,d=e.componentTree,u=e.dispatchProps,l=e.telemetryVisitor,f=e.localizationAPI,g=e.selectedTaskAssignee;if(Object(T.i)(r,a))return Promise.resolve();if(p.qb()&&!r.cardIdToDraftIdMap[n.getId()])return Object(o.g)().assertConditionTag(!1,"Card draft to commit not found",588853383),Promise.reject(new m.a("Card draft to commit not found",-2130957492));var h=void 0;return p.b()&&g&&(h={Task:{type:"Task",assignee:g}}),p.m()||Object(i.b)(f.getString(67)),u.commitCommentAndFocus({trackback:t,telemetryVisitor:l,renderContextType:d.renderContextType},n.getContentsAsync,c,s,d,h).then((function(e){N({result:e,localizationAPI:f})})).catch((function(e){Object(m.b)(e)?Object(o.g)().assertConditionTag(!1,e.message,593826134):Object(o.g)().assertConditionTag(!1,"Unknown error in cardOnCommit "+e,593826135)}))}function te(e){var t=e.trackback,n=e.id,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor,s=e.localizationAPI,c=e.isTask;Object(i.b)(s.getString(125)),o.requestReopenThread({renderContextType:r,telemetryVisitor:a,trackback:t},n,c)}function ne(e){var t=e.componentTree,n=e.focusHandlerRegistry,r=e.trackback,o=e.id,a=e.renderContextType,s=e.dispatchProps,c=e.telemetryVisitor,d=e.localizationAPI,u=e.isTask;Object(i.b)(d.getString(124)),n.onUserAction(t,{userAction:x.a.ResolveThread,selectedCardId:o}),s.requestResolveThread({renderContextType:a,telemetryVisitor:c,trackback:r},o,u)}function re(e){var t=e.trackback,n=e.id,a=e.data,s=e.selectedComment,d=e.componentTree,u=e.invokeModalDialog,l=e.dispatchProps,f=e.telemetryVisitor,p=e.localizationAPI,g=e.focusHandlerRegistry,h=e.isTask,C=e.isNewCommentButtonFocusable,y=e.threadIndex;if(e.shouldCheckForLowFidelity){var v=R.a(a,n);if(!v)return void Object(o.g)().assertConditionTag(!1,"Comment not found",593605342);if(F({comment:v,threads:a,selectedComment:s,warningType:O.b.DeleteThread,warningType_deprecated:O.a.LowFidelityWarningOnDeleteThread}))return void l.selectCommentCardAndShowLowFidelityWarning({renderContextType:d.renderContextType,telemetryVisitor:f,trackback:r.d.reserveTag(593605343)},v.commentId,O.b.DeleteThread,O.a.LowFidelityWarningOnDeleteThread)}if(d.renderContextType===_.a.HalfPane&&u){u(w.a.DeleteThread,(function(){return g.onUserAction(d,{userAction:x.a.DeleteThread,isNewCommentButtonFocusable:C,threadIndex:y}),function(e){var t=e.dispatchProps,n=e.componentTree,i=e.selectedComment,a=e.telemetryVisitor;if(i)return t.requestDeleteThread({renderContextType:n.renderContextType,telemetryVisitor:a,trackback:r.d.reserveTag(592840775)},i.selectedCardId),c.a.Handled;return Object(o.g)().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",592840776),c.a.Unhandled}({dispatchProps:l,componentTree:d,selectedComment:s,telemetryVisitor:f})}),(function(){return c.a.Canceled})).catch((function(e){Object(m.b)(e)?Object(o.g)().assertConditionTag(!1,e.message,595632546):Object(o.g)().assertConditionTag(!1,"Unknown error in cardOnDelete when calling invokeModalDialog "+e,595632547)}))}else Object(i.b)(p.getString(63)),g.onUserAction(d,{userAction:x.a.DeleteThread,isNewCommentButtonFocusable:C,threadIndex:y}),Object(k.a)(d.renderContextType)?setTimeout((function(){l.requestDeleteThread({renderContextType:d.renderContextType,telemetryVisitor:f,trackback:t},n,h)}),100):l.requestDeleteThread({renderContextType:d.renderContextType,telemetryVisitor:f,trackback:t},n,h)}function oe(e){var t=e.componentTree,n=e.focusHandlerRegistry,r=e.trackback,o=e.id,i=e.taskState,a=e.renderContextType,s=e.dispatchProps,c=e.telemetryVisitor,d=e.localizationAPI;100!==i.completion?ne({componentTree:t,focusHandlerRegistry:n,trackback:r,id:o,renderContextType:a,dispatchProps:s,telemetryVisitor:c,localizationAPI:d,isTask:!0}):te({trackback:r,id:o,renderContextType:a,dispatchProps:s,telemetryVisitor:c,localizationAPI:d,isTask:!0})}function ie(e){var t=e.failTag,n=e.successTag,r=e.person,i=e.dispatchProps,a=e.telemetryVisitor,s=e.renderContextType,c=e.trackback,u=Object(o.g)().createActivityObject("CheckUserAccess",a,o.a.None,o.b.NecessaryServiceDataEvent),f={UserId:Object(d.f)(r),Provider:E.b,DisplayName:Object(d.e)(r),Email:Object(d.f)(r)};i.checkUserAccess(f).then((function(e){var t;u.addDataField(l.a.UserCanWrite,e.UserCanWrite,o.c.SystemMetadata),u.addDataField(l.a.UserCanReview,null!==(t=null==e?void 0:e.UserCanReview)&&void 0!==t&&t,o.c.SystemMetadata),u.successTag(n)}),(function(e){u.failTag(t,-2130957562)})),p.S()&&i.addToCurrentMentionees({telemetryVisitor:a,trackback:c,renderContextType:s},r)}function ae(e){var t=e.filter,n=e.limit,r=e.searchGraph;return e.dispatchProps.getUserContacts(t,n,r)}function se(e){var t=e.trackback,n=e.contentId,r=e.isEmpty,o=e.renderContextType,i=e.draftIdMap,a=e.actionDispatchers,s=e.telemetryVisitor,c=i[n];c&&a.draftEmptinessChanged({renderContextType:o,telemetryVisitor:s,trackback:t},c,r)}function ce(e){var t=e.trackback,n=e.id,o=e.editor,i=e.renderContextType,a=e.draftIdMap,s=e.draftMap,c=e.actionDispatchers,d=e.telemetryVisitor,u=a[n];if(u){if(p.ib()){var l=s[u];if(Object(r.k)(l,"Draft should be defined if draftId exists!"),l.pendingState!==T.a.None)return}c.saveDraft({renderContextType:i,telemetryVisitor:d,trackback:t},u,{editorContent:o.getContentsAsync(),editorCursorPosition:o.getCursorPositionAsync()})}}function de(e,t,n,r,o){r.updateCurrentMentionees_deprecated({renderContextType:n,telemetryVisitor:o,trackback:e},t)}function ue(e){var t=e.trackback,n=e.emailsStillInDraft,r=e.renderContextType,o=e.dispatchProps,i=e.telemetryVisitor;o.updateMentioneesStillInDraft({renderContextType:r,telemetryVisitor:i,trackback:t},n)}function le(e){var t=e.trackback,n=e.renderContextType,r=e.dispatchProps,o=e.telemetryVisitor,i=e.selectedAssignee;r.updateSelectedTaskAssignee({renderContextType:n,telemetryVisitor:o,trackback:t},i)}function fe(e){var t=e.selectedState,n=e.renderContextType,i=e.dispatchProps,a=e.telemetryVisitor,s=e.componentTree;if(t&&Object(O.k)(t)){var c=t.selectedCardId;p.fb()?i.selectComment(s,{renderContextType:n,telemetryVisitor:a,trackback:r.d.reserveTag(590123735)},Object(y.a)(c,C.a.SharedComments,{selectType:Object(b.L)(c,t)?h.c.ExpandCard:h.c.CollapseCard}),!1).catch(Object(f.a)(r.d.reserveTag(590104652))):Object(b.L)(c,t)?i.selectCommentCardExpand_deprecated({renderContextType:n,telemetryVisitor:a,trackback:r.d.reserveTag(593846659)},c,C.a.SharedComments):i.selectCommentCardCollapse_deprecated({renderContextType:n,telemetryVisitor:a,trackback:r.d.reserveTag(593846660)},c,C.a.SharedComments)}else Object(o.g)().assertConditionTag(!1,"onLowFidelityWarningCancel called unexpectedly",593846658)}function me(e){var t=e.selectedState,n=e.onCardDelete,r=e.onPostDelete,i=e.onPostEdit;if(t)if(Object(O.d)(t.selectionDetails)||Object(O.f)(t)){if(Object(O.g)(t))return void n(a=t.selectedCardId);if(Object(O.h)(t))return void Object(o.g)().assertConditionTag(!1,"Unexpected LowFidelityWarningOnEdit with card selection",593846662)}else{var a=t.selectionDetails.selectedPostId;if(Object(O.e)(t))return void r(a);if(Object(O.h)(t))return void i(a)}else Object(o.g)().assertConditionTag(!1,"onLowFidelityWarningConfirm called unexpectedly",593846661)}function pe(e){var t=e.ownProps,n=e.dispatchProps,i=e.componentTree,a=e.draftState,s=e.selectedComment_deprecated,d=e.invokeModalDialog;if(i.renderContextType!==_.a.HalfPane&&Object(T.b)(a,s)&&!p.q()){n.discardDraftAsync({renderContextType:i.renderContextType,telemetryVisitor:t.telemetryVisitor,trackback:r.d.reserveTag(592840770)},C.a.SharedComments,!0,Object(P.a)(a,i,d,s,w.a.ClosePaneDraft)).then((function(e){var t;e===c.a.Canceled?(t=document.getElementById(A.w()))&&t.focus():e===c.a.Unhandled&&Object(o.g)().assertConditionTag(e!==c.a.Unhandled,"Unhandled request to discard on close pane",592840769)})).catch((function(e){Object(m.b)(e)?Object(o.g)().assertConditionTag(!1,e.message,592840771):Object(o.g)().assertConditionTag(!1,"Unknown error in closePane when calling discardDraftAsync "+e,592840772)}))}else!function(e){var t=e.dispatchProps,n=e.componentTree,i=e.telemetryVisitor,a=Object(o.g)().createActivityObject("ClosePane",i,o.a.None,o.b.NecessaryServiceDataEvent);a.addDataField(l.a.PaneCloseResult,j.a.NoDialog,o.c.SystemMetadata),a.successTag(592840773),t.requestClosePane({renderContextType:n.renderContextType,telemetryVisitor:i,trackback:r.d.reserveTag(592840774)})}({dispatchProps:n,componentTree:i,telemetryVisitor:t.telemetryVisitor})}function ge(e,t,n,o,i){n.selectComment(i,{renderContextType:i.renderContextType,telemetryVisitor:o,trackback:e},{selectType:h.c.CollapseCard,selectedCard:R.i(t),source:C.a.SharedComments},!1).catch(Object(f.a)(r.d.reserveTag(589940443)))}function he(e,t,n,r,o,i,a){o.requestUpdateCommentReactions({renderContextType:r,telemetryVisitor:i,trackback:e},t,a,n)}n.d(t,"I",(function(){return F})),n.d(t,"D",(function(){return M})),n.d(t,"G",(function(){return V})),n.d(t,"A",(function(){return L})),n.d(t,"E",(function(){return U})),n.d(t,"C",(function(){return B})),n.d(t,"H",(function(){return H})),n.d(t,"z",(function(){return z})),n.d(t,"i",(function(){return W})),n.d(t,"g",(function(){return q})),n.d(t,"F",(function(){return G})),n.d(t,"a",(function(){return Y})),n.d(t,"m",(function(){return K})),n.d(t,"l",(function(){return J})),n.d(t,"h",(function(){return Q})),n.d(t,"e",(function(){return X})),n.d(t,"f",(function(){return Z})),n.d(t,"d",(function(){return $})),n.d(t,"b",(function(){return ee})),n.d(t,"j",(function(){return te})),n.d(t,"k",(function(){return ne})),n.d(t,"c",(function(){return re})),n.d(t,"n",(function(){return oe})),n.d(t,"t",(function(){return ie})),n.d(t,"q",(function(){return ae})),n.d(t,"p",(function(){return se})),n.d(t,"w",(function(){return ce})),n.d(t,"x",(function(){return de})),n.d(t,"u",(function(){return ue})),n.d(t,"y",(function(){return le})),n.d(t,"r",(function(){return fe})),n.d(t,"s",(function(){return me})),n.d(t,"o",(function(){return pe})),n.d(t,"B",(function(){return ge})),n.d(t,"v",(function(){return he}))},18:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"j",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"m",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"l",(function(){return h}));var r,o,i=n(7);function a(e){return e===o.LowFidelityWarningOnDelete||e===o.LowFidelityWarningOnDeleteThread||e===o.LowFidelityWarningOnEdit}function s(e){return i.qb()?e.selectionDetails.lowFidelityWarningType===r.Edit:e.selectionDetails.editingSession_deprecated===o.LowFidelityWarningOnEdit}function c(e){return i.qb()?e.selectionDetails.lowFidelityWarningType===r.DeleteReply:e.selectionDetails.editingSession_deprecated===o.LowFidelityWarningOnDelete}function d(e){return i.qb()?e.selectionDetails.lowFidelityWarningType===r.DeleteThread:e.selectionDetails.editingSession_deprecated===o.LowFidelityWarningOnDeleteThread}function u(e){return c(e)||d(e)}function l(e){return!!e&&(s(e)||c(e))}function f(e){return!!e&&(u(e)||s(e))}function m(e){return void 0!==e.expanded}function p(e){return void 0!==e.selectedPostId}function g(e){return m(e.selectionDetails)?e.selectedCardId:e.selectionDetails.selectedPostId}function h(e,t){return!!t&&!m(t.selectionDetails)&&t.selectionDetails.selectedPostId===e.commentId&&f(t)}!function(e){e[e.Edit=1]="Edit",e[e.DeleteReply=2]="DeleteReply",e[e.DeleteThread=3]="DeleteThread"}(r||(r={})),function(e){e[e.None=0]="None",e[e.SessionRequestPending=1]="SessionRequestPending",e[e.Active=2]="Active",e[e.LowFidelityWarningOnEdit=3]="LowFidelityWarningOnEdit",e[e.LowFidelityWarningOnDelete=4]="LowFidelityWarningOnDelete",e[e.LowFidelityWarningOnDeleteThread=5]="LowFidelityWarningOnDeleteThread",e[e.CommitPending=6]="CommitPending",e[e.DiscardPending=7]="DiscardPending"}(o||(o={}))},185:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.HalfPane="half-pane",e.FullPane="full-pane"}(r||(r={})),t.b=r},187:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReturnToDraft=1]="ReturnToDraft",e[e.GrantAccessFailedSilently=2]="GrantAccessFailedSilently",e[e.CommitFailed=3]="CommitFailed"}(r||(r={}))},189:function(e,t,n){"use strict";var r;!function(e){e[e.Success=0]="Success",e[e.CommitPending=1]="CommitPending",e[e.ShareFailed=2]="ShareFailed",e[e.CommitFailed=3]="CommitFailed"}(r||(r={})),t.a=r},199:function(e,t,n){"use strict";n.d(t,"b",(function(){return h}));var r=n(3),o=n(124),i=n(413),a=n(844),s=n(530),c=n(185),d=n(270),u=n(28),l=n(21),f=n(7),m=function(e,t){var n=this;this.commentViewManager=e,this.correlationId=t,this.visit=function(e){e.attachContext(n.commentViewManager.apiContext),n.correlationId&&e.addDataField(u.a.InstanceCorrelationId,n.correlationId,r.c.SystemMetadata)}};function p(e){return new m(g(e),e.correlationId)}var g=function(){throw new Error("ViewManagerFactory not set")};function h(e){g=e}var C=new(function(){function e(){this.instanceMap=new Map,this.initialized=!1}return e.prototype.getTelemetryVisitor=function(e){var t=this,n=this.instanceMap.get(e);return n||{visit:function(n){var o=t.instanceMap.get(e);if(!o)return n.attachContext(e),void n.addDataField(u.a.MissingInstanceTelemetry,!0,r.c.SystemMetadata);o.visit(n)}}},e.prototype.closeViewManager=function(e){var t=this.instanceMap.get(e);t&&(t.commentViewManager.teardown(),this.instanceMap.delete(e))},e.prototype.doesViewManagerExist=function(e){return this.instanceMap.has(e)},e.prototype.ensureViewManager=function(e){var t=e.apiContext,n=e.displayMode,r=e.contentNavigationAPI;this.initialized||this.ensureInitialized();var o=this.instanceMap.get(t);return o?this.updateInstanceObject(o,n):(this.initializeContentNavigationAPI(t,r),o=p(e),this.instanceMap.set(t,o)),o.commentViewManager},e.prototype.getCorrelationId=function(e){var t=this.instanceMap.get(e);return t&&t.correlationId},e.prototype.getStore=function(e){var t=this.instanceMap.get(e);if(!t)throw new l.a("Instance is not initialized",-2130957512);return t.commentViewManager.getCommentStore()},e.prototype.getViewManager=function(e){var t=this.tryGetViewManager(e);if(!t)throw new l.a("Instance is not initialized",-2130957512);return t},e.prototype.tryGetViewManager=function(e){var t;return null===(t=this.instanceMap.get(e))||void 0===t?void 0:t.commentViewManager},e.prototype.ensureInitialized=function(){var e=this;f.B()&&i.a.onStartEvent.subscribe((function(t){e.initializeContentNavigationAPI(t.context,void 0),e.initializeViewManager(t.context,t.correlationId,t.useMockMode)})),i.a.onStopEvent.subscribe((function(t){e.closeViewManager(t.context),Object(o.e)(t.context)})),this.initialized=!0},e.prototype.initializeViewManager=function(e,t,n){var o=this.instanceMap.get(e);if(o)o.correlationId=t;else{var i=void 0;n&&f.q()&&(Object(r.g)().createActivityObject("OnMockUIDriverCreated",this.getTelemetryVisitor(e),r.a.None,r.b.FullEvent).successTag(592511450),i=new a.a(e)),this.instanceMap.set(e,p({apiContext:e,correlationId:t,initializationReason:d.a.PaneOpen,displayMode:c.b.FullPane,foldableLayoutState:s.a.Indeterminate,paneVisible:!1,initializeImmediately:!0,mockDriver:i}))}},e.prototype.updateInstanceObject=function(e,t){var n=e.commentViewManager.viewProvider;n.getViewContainer().containerType!==t&&n.changeViewContainerType(t)},e.prototype.initializeContentNavigationAPI=function(e,t){Object(o.g)(e)||Object(o.h)(t||new o.b(e),e)},e}());t.a=C},20:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.FullPane=1]="FullPane",e[e.HalfPane=2]="HalfPane",e[e.ModalDraft=3]="ModalDraft",e[e.DiscreteIntegrated=4]="DiscreteIntegrated",e[e.DiscreteIsolated=5]="DiscreteIsolated"}(r||(r={})),t.a=r},200:function(e,t,n){"use strict";function r(e){return void 0!==e.sessionConfiguration&&void 0!==e.author&&void 0!==e.insertIndex&&"function"==typeof e.commit&&"function"==typeof e.endDrafting}n.d(t,"a",(function(){return r}))},202:function(e,t,n){"use strict";n.d(t,"a",(function(){return"Default_7210d794-9f0f-4d0a-805c-964303b2676b"}))},203:function(e,t,n){"use strict";var r,o=n(321),i=n(529),a=n(94);!function(e){e[e.FailedToCommit=0]="FailedToCommit"}(r||(r={}));var s,c=n(122),d=n(211),u=n(114),l=n(148);!function(e){e[e.Unknown=0]="Unknown",e[e.UserAction=1]="UserAction",e[e.Suspend=2]="Suspend"}(s||(s={}));var f=n(113),m=(n(157),n(750));n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return i.a})),n.d(t,"c",(function(){return a.a})),n.d(t,"d",(function(){return c.a})),n.d(t,"e",(function(){return d.a})),n.d(t,"i",(function(){return u.d})),n.d(t,"h",(function(){return u.c})),n.d(t,"f",(function(){return l.a})),n.d(t,"g",(function(){return f.a})),n.d(t,"j",(function(){return m.a}))},211:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReadOnly=1]="ReadOnly",e[e.LowFidelity=2]="LowFidelity",e[e.Locked=4]="Locked",e[e.Resolved=8]="Resolved",e[e.EditRestricted=16]="EditRestricted",e[e.IsNew=32]="IsNew"}(r||(r={}))},219:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFormattingType=void 0,function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Image=2]="Image",e[e.Table=4]="Table",e[e.Weight=8]="Weight",e[e.Underline=16]="Underline",e[e.Strikethrough=32]="Strikethrough",e[e.Italic=64]="Italic",e[e.Mention=128]="Mention",e[e.Hyperlink=256]="Hyperlink",e[e.Color=512]="Color",e[e.Highlight=1024]="Highlight",e[e.FontSize=2048]="FontSize",e[e.FontFamily=4096]="FontFamily",e[e.AltText=8192]="AltText",e[e.Optional=16384]="Optional",e[e.Paragraph=32768]="Paragraph",e[e.BadMentionFormat=134217728]="BadMentionFormat",e[e.UnknownAttribute=268435456]="UnknownAttribute",e[e.Unsupported=536870912]="Unsupported",e[e.Unknown=1073741824]="Unknown",e[e.TextAndMentions=129]="TextAndMentions",e[e.TextAndParagraph=32769]="TextAndParagraph",e[e.AllFormatting=65535]="AllFormatting",e[e.InvalidFormatting=2013265920]="InvalidFormatting"}(t.DeltaFormattingType||(t.DeltaFormattingType={}))},22:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r,o=n(25),i=n(21);function a(){if(!r)try{r=Object(o.a)()}catch(e){throw new i.a("FeatureGateAPI not initialized",-2130957531)}return r}},224:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));n(136);var r=n(7),o=n(68),i=n(35);function a(e){switch(e){case i.a.ClosePaneButton:return o.l();case i.a.NextCommentButton:return o.C();case i.a.PreviousCommentButton:return o.J();case i.a.GhostCard:return r.Cb()?o.x():o.y();case i.a.NewCommentButton:return o.B();case i.a.PaneRoot:return o.w()}}function s(e){switch(e.componentType){case i.a.Card:return o.h(e,!1);case i.a.DraftCard:return o.h(e,!0);case i.a.PostEditor:return o.t(o.D(e));case i.a.CardEditor:return o.t(o.e(e));case i.a.Post:return o.G(e);case i.a.DiscreteHostedCommentRoot:return o.p(e);case i.a.ReopenThreadButton:return o.c(e,o.L())}}function c(e,t){return!1===e?i.a.Card:!0===e||t&&t.newComment.commentId===e?i.a.DraftCard:i.a.Card}},233:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r,o=n(3),i=n(21);function a(e){if(r)throw Object(o.g)().assertConditionTag(!1,"WebAppColors cannot be re-initialized.",578647955),new i.a("WebAppColors cannot be re-initialized.",-2130957508);r=e}function s(){if(!r)throw Object(o.g)().assertConditionTag(!1,"WebAppColors is not initialized",578647956),new i.a("WebAppColors is not initialized",-2130957509);return r}},238:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Undo=-1]="Undo",e[e.Unknown=0]="Unknown",e[e.Create=1]="Create",e[e.Assign=2]="Assign",e[e.Unassign=3]="Unassign",e[e.UnassignAll=4]="UnassignAll",e[e.Schedule=5]="Schedule",e[e.Progress=6]="Progress",e[e.Delete=7]="Delete",e[e.Restore=8]="Restore",e[e.SetTitle=9]="SetTitle",e[e.Priority=10]="Priority"}(r||(r={}))},243:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Post=1]="Post",e[e.Delete=2]="Delete"}(r||(r={}))},245:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a}));var r="SharedCommentPane",o="DiscreteIntegratedCommentCard",i="DiscreteIsolatedCommentCard";function a(e,t){return e+"-"+t}},25:function(e,t,n){"use strict";var r=n(0),o=n(9),i="$officeonline_globalapi_cache",a=void 0;"undefined"!=typeof window&&(a=window),a[i]||(a[i]={});var s=function(){function e(e,t){var n=this;this.apiName=e,this.DefaultCtor=t,this.reset=function(){n.instance=void 0,n.ctorStack=void 0}}return e.prototype.getAndInitialize=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.instance)throw new Error("'"+this.apiName+"' singleton is already initialized");return this.ctorStack=Object(o.e)(),this.instance=new((e=this.DefaultCtor).bind.apply(e,Object(r.__spread)([void 0],t)))},e.prototype.getInstanceOrThrow=function(){var e=this.instance;if(!e)throw new Error("'"+this.apiName+"' singleton has not been initialized");return e},e.prototype.getInstance=function(){return this.instance},e.prototype.injectImplementation=function(e){if(this.getInstance())throw new Error("API has already been initialized.\nFirst initialization: "+this.ctorStack);this.DefaultCtor=e},e}();var c,d,u,l=function(){function e(e){if(!e)throw new Error("Missing required arguments in FeatureGateAPIImpl!");this.appSettings=e.appSettings,this.gateMapping=e.mapping}return e.prototype.isTrue=function(e){return!!this.appSettings[e]&&"true"===this.appSettings[e]},e.prototype.isFeatureEnabled=function(e){if(!this.appSettings||!this.gateMapping)throw new Error("FeatureGate API not initialized!");var t=this.gateMapping[e].webSettingName;return!!t&&this.isTrue(t)},e.prototype.isChangeGateEnabled=function(e,t){if(!this.appSettings||!this.gateMapping)throw new Error("FeatureGate API not initialized!");var n=this.disabledChangeGates;return!n||n.split(",").indexOf(e)<0},Object.defineProperty(e.prototype,"disabledChangeGates",{get:function(){return this.appSettings.DisabledChangeGates},enumerable:!1,configurable:!0}),e}(),f=(c="FeatureGate",d=l,(u=a[i])[c]||(u[c]=new s(c,d)),u[c]);function m(e){return e}function p(e){return f.getAndInitialize(e)}function g(){return f.getInstanceOrThrow()}n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return g}))},253:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.AtMentionKnown=1]="AtMentionKnown",e[e.AtMentionEnabled=2]="AtMentionEnabled",e[e.NewThread=4]="NewThread",e[e.Resolve=8]="Resolve",e[e.Virtualized=16]="Virtualized",e[e.TasksKnown=32]="TasksKnown",e[e.TasksEnabled=64]="TasksEnabled"}(r||(r={}))},270:function(e,t,n){"use strict";var r;!function(e){e.PaneOpen="Read",e.NewThread="NewThread",e.InitRuntime="InitRuntime"}(r||(r={})),t.a=r},274:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(114);function o(e){return e.sessionType===r.a}function i(e){return e.sessionType===r.d&&void 0!==e.threadId}function a(e){return e.sessionType===r.b&&void 0!==e.commentId}},275:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e){return Object(r.b)(o.a.CommitFailureType,{},e)}},276:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var r=n(0),o=n(3),i=n(35),a=n(18),s=n(11),c=n(16),d=n(8),u=n(99);function l(e,t,n,r){return function(l,f){l(Object(c.b)(d.a.SelectCommentType,n,t));var m=f(),p=Object(s.p)(m);return r&&p&&p.selectedCardId===n.selectedCard&&(n.selectType!==u.a.SelectPost||!Object(a.d)(p.selectionDetails)&&p.selectionDetails.selectedPostId===n.selectedPost)?e?new Promise((function(n){return setTimeout((function(){var r;r=Object(a.d)(p.selectionDetails)?{componentType:i.a.Card,id:p.selectedCardId,renderContextType:t.renderContextType}:{componentType:i.a.Post,id:p.selectionDetails.selectedPostId,renderContextType:t.renderContextType};var s=e.getComponentById(r);s?s.focus():Object(o.g)().assertConditionTag(!1,"Couldn't find focus target after select: "+JSON.stringify(r),590104655),n()}))})):(Object(o.g)().assertConditionTag(!1,"Expected componentTree to be set",579744148),Promise.resolve()):Promise.resolve()}}function f(e,t,n){return Object(r.__assign)({selectedCard:e,source:t},n)}},28:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.NumberOfCandidatesRequested="NumberOfCandidatesRequested",e.SearchGraph="SearchGraph",e.NumberOfCandidatesReceived="NumberOfCandidatesReceived",e.ServiceId="ServiceId",e.AtMentionsEnabled="AtMentionsEnabled",e.PaneCloseResult="PaneCloseResult",e.UserCanWrite="UserCanWrite",e.UserCanReview="UserCanReview",e.SwipeDirection="SwipeDirection",e.SwipeAcrossContext="SwipeAcrossContext",e.ModalDialogMode="ModalDialogMode",e.Trackback="Trackback",e.SessionType="SessionType",e.ActiveSessionType="ActiveSessionType",e.NumberOfMentionsAdded="NumberOfMentionsAdded",e.AllUsersGrantedAccess="AllUsersGrantedAccess",e.ShareDialogCanceled="ShareDialogCanceled",e.DiscardDialogShown="DiscardDialogShown",e.CancelledByUser="CancelledByUser",e.DiscardUnnecessary="DiscardUnnecessary",e.SessionAlreadyRequested="SessionAlreadyRequested",e.OperationType="OperationType",e.ExceptionType="ExceptionType",e.EventType="EventType",e.HalfPaneDisplayModeType="DisplayMode",e.PaneCorrelationId="PaneCorrelationId",e.SharedCommentsVersion="SharedCommentsVersion",e.CommentId="CommentId",e.NumberOfComments="NumberOfComments",e.NumberOfThreads="NumberOfThreads",e.RenderContextType="RenderContextType",e.MentionTokenState="MentionTokenState",e.CommitPendingAttemptedCancel="CommitPendingAttemptedCancel",e.FeatureGateState="FeatureGateState",e.DisabledChangeGates="DisabledChangeGates",e.IsNewFeatureGateAPI="IsNewFeatureGateAPI",e.SelectType="SelectType",e.ActionSource="ActionSource",e.IsCurrentCard="IsCurrentCard",e.DidDraftLockUpdate="DidDraftLockUpdate",e.IsClaimingDraftLock="IsClaimingDraftLock",e.IsUpdatingAllDraftLocks="IsUpdatingAllDraftLocks",e.MapStateToPropsDuration="MapStateToPropsDuration",e.InstanceCorrelationId="InstanceCorrelationId",e.MissingInstanceTelemetry="MissingInstanceTelemetry",e.ContainerName="ContainerName",e.DelayLoadRetryCount="DelayLoadRetryCount",e.AffectingTaskMetadata="AffectingTaskMetadata",e.AssociatedCommentId="AssociatedCommentId",e.IsPaneVisible="IsPaneVisible",e.DraftWarningType="DraftWarningType",e.CreateThreadWithMentions="CreateThreadWithMentions",e.CreateReplyWithMentions="CreateReplyWithMentions",e.CreateThreadWithTaskAssigned="CreateThreadWithTaskAssigned",e.CreateReplyWithTaskAssigned="CreateReplyWithTaskAssigned",e.CreateCommentWithRichFormatting="CreateCommentWithRichFormatting",e.ResolveThreadWithTask="ResolveThreadWithTask",e.ReopenThreadWithTask="ReopenThreadWithTask",e.DeleteThreadWithTask="DeleteThreadWithTask",e.DraftWarningReason="DraftWarningReason",e.DiscardDraftIfEmptyResult="DiscardDraftIfEmptyResult",e.MatchesCommentAuthor="MatchesCommentAuthor",e.CommentCreationTimeDeltaMs="ThreadCreationDeltaMs",e.CardDisplayMode="CardDisplayMode",e.ScrollOffset="ScrollOffset",e.IsHorizontal="IsHorizontal",e.ContentHeight="ContentHeight",e.Duration="Duration",e.NumRescrolls="NumberOfRescrolls",e.EndReason="EndReason",e.IsPreExistingTask="IsPreExistingTask",e.TaskCreationTimeDeltaMs="TaskCreationTimeDeltaMs",e.DraftDiscardBehavior="DraftDiscardBehavior",e.NumberOfHyperlinks="NumberOfHyperlinks",e.IsCardExpanded="IsCardExpanded",e.ExpandedCardHeight="ExpandedCardHeight",e.IsDraftInCurrentContext="IsDraftInCurrentContext",e.CommentIsNew="CommentIsNew",e.DraftId="DraftId",e.SelectionAttemptType="SelectionAttemptType",e.PickerSession="PickerSession",e.NumberOfResults="NumberOfResults",e.QueryLength="QueryLength",e.Succeeded="Succeeded",e.StatusCode="StatusCode",e.SearchDurationMS="SearchDurationMS",e.WasSelectionMade="WasSelectionMade",e.SelectedIndex="SelectedIndex",e.PostEditedType="PostEditedType",e.ClickPosition="ClickPosition",e.SmartReplyLength="SmartReplyLength"}(r||(r={}))},292:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(9),o=n(3),i=n(20),a=n(16),s=n(8);var c,d=(c={renderContextType:i.a.None,telemetryVisitor:Object(o.h)(o.f.ReviewedAsNotNecessary),trackback:r.d.reserveTag(595735680)},Object(a.b)(s.a.EmptyActionType,{},c))},293:function(e,t,n){"use strict";var r;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(r||(r={})),t.a=r},296:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(185);function o(e){return e.containerType===r.b.HalfPane}},297:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var r=n(9),o=n(3),i=n(111),a=n(114),s=n(115),c=n(200),d=n(110),u=n(146),l=n(20),f=n(28),m=n(346),p=n(21),g=n(147),h=n(87),C=n(605),y=n(7),v=n(15),b=n(39),T=n(11),I=n(58),O=n(16),S=n(37),j=n(455),D=n(456),w=n(292),_=n(546),x=n(394),E=n(327);function P(e,t,n,P,A,k){return function(R,F){var N=F(),M=Object(o.g)().createActivityObject("RequestInitCommentSession",e.telemetryVisitor,o.a.None,o.b.NecessaryServiceDataEvent),V=s.b[n.sessionType],L=e.renderContextType!==l.a.None||!I.b(N)&&y.q()?e.renderContextType:I.c(N).renderContextType;return M.addDataField(f.a.SessionType,V,o.c.SystemMetadata),M.addDataField(f.a.Trackback,e.trackback,o.c.SystemMetadata),M.addDataField(f.a.RenderContextType,L,o.c.SystemMetadata),M.addDataField(f.a.IsPaneVisible,I.b(N),o.c.SystemMetadata),y.b()||n.sessionType!==a.c?(Object(v.f)(T.l(N),T.a(N))===i.b.Enabled&&Object(m.a)().catch((function(e){Object(p.b)(e)?Object(o.g)().assertConditionTag(!1,e.message,591397600):Object(o.g)().assertConditionTag(!1,"Unknown error in beginDraftingThunk "+e,591397601)})),R(Object(x.a)(e,S.a.SharedComments,s.c(n))).catch((function(e){return Object(C.a)(e,r.d.reserveTag(591397602)),{draftDiscardResult:i.f.Unhandled,draftDiscardBehavior:u.a.CannotAutoDiscard}})).then((function(i){M.addDataField(f.a.DraftDiscardBehavior,i.draftDiscardBehavior,o.c.SystemMetadata);var a=F(),u=T.i(a),l=T.p(a);return Object(b.d)(u,l)||T.g(a)&&s.d(n)||!y.rb()&&T.r(a)?(M.addDataField(f.a.SessionAlreadyRequested,!0,o.c.SystemMetadata),M.successTag(591397633),Promise.resolve(R(w.a))):(M.addDataField(f.a.SessionAlreadyRequested,!1,o.c.SystemMetadata),R(Object(_.a)(Object(O.a)(e,r.d.reserveTag(591397634)),n,P)),t.beginDraftingAsync(n).then((function(t){var i=Object(c.a)(t)?t.sessionConfiguration:t.updatedSessionParams?function(e,t){if(e.sessionType!==t.sessionType){if(!s.d(e))return void Object(o.g)().assertConditionTag(!1,"Invalid session conversion",591397645);if(!(s.d(t)||s.e(t)||s.f(t)))return void Object(o.g)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit",591397646)}switch(t.sessionType){case"CREATE":case"EDIT":case"REPLY":return t;default:return}}(n,t.updatedSessionParams):n;if(void 0===i)throw new p.a(h.d,-2130957532);s.d(n)&&y.V()&&R(Object(E.a)(Object(O.a)(e,r.d.reserveTag(591397635)),[],[],A,Object(c.a)(t)?Object(d.g)(t.author):Object(d.g)(Object(d.c)(t))));var a=Object(c.a)(t)?t:i;return y.fb()&&Object(c.a)(t)&&M.addDataField(f.a.DraftId,t.sessionConfiguration.draftId,o.c.SystemMetadata),k?k().then((function(){return M.successTag(591397636),R(Object(D.a)(Object(O.a)(e,r.d.reserveTag(591397637)),a,L))})).catch((function(t){return M.failTag(591397638,Object(g.a)(t)),Object(c.a)(a)&&a.endDrafting(),R(Object(j.a)(Object(O.a)(e,r.d.reserveTag(591397639)),n,t))})):(M.successTag(591397640),R(Object(D.a)(Object(O.a)(e,r.d.reserveTag(591397641)),a,L)))})).catch((function(t){return(t.message||t).includes("LegacyConvertDialog")?M.successTag(591397643):M.failTag(591397642,Object(g.a)(t)),R(Object(j.a)(Object(O.a)(e,r.d.reserveTag(591397644)),n,t))})))}))):(M.failTag(591397599,-2130957513),Promise.resolve(R(w.a)))}}},3:function(e,t,n){"use strict";var r,o,i,a,s,c;function d(e,t){return{visit:function(){}}}!function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(r||(r={})),function(e){e[e.GlobalAPI=0]="GlobalAPI",e[e.ReviewedAsNotNecessary=1]="ReviewedAsNotNecessary",e[e.Test=2]="Test",e[e.Todo=3]="Todo"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Always=1]="Always",e[e.OnSuccess=2]="OnSuccess"}(i||(i={})),function(e){e[e.None=0]="None",e[e.BasicEvent=1]="BasicEvent",e[e.FullEvent=2]="FullEvent",e[e.NecessaryServiceDataEvent=3]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=4]="AlwaysOnNecessaryServiceDataEvent"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Required=1]="Required",e[e.Basic=2]="Basic",e[e.All=3]="All"}(s||(s={})),function(e){e[e.Normal=0]="Normal",e[e.Critical=1]="Critical"}(c||(c={}));var u=n(9),l=u.d.reserveTag(590899029),f=u.d.reserveTag(590899030),m=u.d.reserveTag(590899031),p=u.d.reserveTag(590899032),g=u.d.reserveTag(590899033),h=n(0),C=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.errorCode=n,o.errorTag=r,o}return Object(h.__extends)(t,e),t}(Error);var y,v,b=function(){function e(){this.isInitialized=!1,this.deferredInitializationCallbacks=[]}return e.prototype.init=function(e){var t=this;this.isInitialized?this.assertConditionTag(!1,"ClientTelemetryAPI init called twice!",595644941):(this.hostAPI=e,this.isInitialized=!0,this.deferredInitializationCallbacks.map((function(e){return e(t)})),this.deferredInitializationCallbacks=[])},e.prototype.onInitialized=function(e){this.isInitialized?e(this):this.deferredInitializationCallbacks.push(e)},e.prototype.createActivityObject=function(e,t,n,r,o){return void 0===o&&(o=!1),this.checkIsInitialized(),Object(u.k)(e[0]>="A"&&e[0]<="Z","Activity name should start with a capital letter."),Object(u.k)(this.hostAPI,"Host API must be defined"),this.hostAPI.createActivityObject(e,t,n,r,o)},e.prototype.assertCondition=function(e,t){this.checkIsInitialized(),this.assertConditionTag(e,t,m)},e.prototype.assertConditionTag=function(e,t,n){this.checkIsInitialized(),e||(Object(u.h)("*ASSERT* 0x"+n.toString(16)+" : "+t),Object(u.k)(this.hostAPI,"Host API must be defined"),this.hostAPI.logErrorData(n,t))},e.prototype.getMetadata=function(){return Object(u.k)(this.hostAPI,"Host API must be defined"),this.hostAPI.getMetadata()},e.prototype.checkIsInitialized=function(){if(!this.isInitialized||!this.hostAPI)throw new C("ClientTelemetryAPI is not initialized",-2130957548)},e.prototype.logFloodgateActivity=function(e){this.checkIsInitialized(),Object(u.k)(this.hostAPI,"Host API must be defined"),this.hostAPI.logFloodgateActivity&&this.hostAPI.logFloodgateActivity(e)},e}(),T=void 0;function I(e){return!0===e.testOnly}function O(e){if(T){if(I(T))return void(I(e)&&(T=e));if(y)throw new C(["'getTelemetryAPI' was called before a stub API was injected.","First call to getTelemetryAPI originated from:",y].join("\n"),-2130957506);throw new C("ClientTelemetryAPI cannot be re-initialized.\nFirst intialized from "+v,-2130957506)}v||(v=Object(u.e)()),T=e}function S(){if(y||(y=Object(u.e)()),!T){var e=new b;return O(e),e}return T}var j,D,w,_,x,E,P,A=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),k=new A;function R(e,t,n){k.fireEvent({level:e,category:t,message:n})}function F(e,t){return{name:e,dataType:x.Boolean,value:t,classification:P.SystemMetadata}}function N(e,t){return{name:e,dataType:x.Int64,value:t,classification:P.SystemMetadata}}function M(e,t){return{name:e,dataType:x.String,value:t,classification:P.SystemMetadata}}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(j||(j={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(D||(D={})),function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(w||(w={})),function(e){var t={},n={},r={};function o(e){if("object"!=typeof e)throw new Error("tokenTree must be an object");r=function e(t,n){if("object"!=typeof n)return n;for(var r=0,o=Object.keys(n);r<o.length;r++){var i=o[r];i in t&&(t[i],1)?t[i]=e(t[i],n[i]):t[i]=n[i]}return t}(r,e)}function i(e){if(t[e])return t[e];var n=s(e,w.Aria);return"string"==typeof n?(t[e]=n,n):void 0}function a(e){if(n[e])return n[e];var t=s(e,w.Nexus);return"number"==typeof t?(n[e]=t,t):void 0}function s(e,t){var n=e.split("."),o=r,i=void 0;if(o){for(var a=0;a<n.length-1;a++)o[n[a]]&&(o=o[n[a]],t===w.Aria&&"string"==typeof o.ariaTenantToken?i=o.ariaTenantToken:t===w.Nexus&&"number"==typeof o.nexusTenantToken&&(i=o.nexusTenantToken));return i}}e.setTenantToken=function(e,t,n){var r=e.split(".");if(r.length<2||"Office"!==r[0])R(j.Error,D.Core,(function(){return"Invalid namespace: "+e}));else{var i=Object.create(Object.prototype);t&&(i.ariaTenantToken=t),n&&(i.nexusTenantToken=n);var a,s=i;for(a=r.length-1;a>=0;--a){var c=Object.create(Object.prototype);c[r[a]]=s,s=c}o(s)}},e.setTenantTokens=o,e.getTenantTokens=function(e){var t=i(e),n=a(e);if(!n||!t)throw new Error("Could not find tenant token for "+e);return{ariaTenantToken:t,nexusTenantToken:n}},e.getAriaTenantToken=i,e.getNexusTenantToken=a,e.clear=function(){t={},n={},r={}}}(_||(_={})),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Guid=4]="Guid"}(x||(x={})),function(e){var t=/^[A-Z][a-zA-Z0-9]*$/,n=/^[a-zA-Z0-9_\.]*$/;function r(e){return void 0!==e&&n.test(e)}function o(e){if(!((t=e.name)&&r(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===x.Int64&&i(e.value)}function i(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var n=e.split("."),r=n[n.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(n)&&(o=r,void 0!==o&&t.test(o));var o}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!r(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var n=0;n<e.dataFields.length;n++)o(e.dataFields[n])},e.validateInt=i}(E||(E={})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(P||(P={}));var V,L=function(){return(L=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},U=function(){function e(e,t,n){var r,o;this.onSendEvent=new A,this.persistentDataFields=[],this.config=n||{},e?(this.onSendEvent=e.onSendEvent,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=L(L({},e.getConfig()),this.config)):this.persistentDataFields.push(M("OTelJS.Version","3.1.57")),t&&(o=this.persistentDataFields).push.apply(o,t)}return e.prototype.sendTelemetryEvent=function(e){var t;try{if(0===this.onSendEvent.getListenerCount())return void R(j.Warning,D.Core,(function(){return"No telemetry sinks are attached."}));t=this.cloneEvent(e),this.processTelemetryEvent(t)}catch(e){return void function(e,t,n){R(j.Error,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}(D.Core,"SendTelemetryEvent",e)}try{this.onSendEvent.fireEvent(t)}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t;e.telemetryProperties||(e.telemetryProperties=_.getTenantTokens(e.eventName)),e.dataFields&&this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields),this.config.disableValidation||E.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.onSendEvent.addListener((function(t){return e.sendTelemetryEvent(t)}))},e.prototype.setTenantToken=function(e,t,n){_.setTenantToken(e,t,n)},e.prototype.setTenantTokens=function(e){_.setTenantTokens(e)},e.prototype.cloneEvent=function(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return e.telemetryProperties&&(t.telemetryProperties={ariaTenantToken:e.telemetryProperties.ariaTenantToken,nexusTenantToken:e.telemetryProperties.nexusTenantToken}),e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t},e.prototype.getConfig=function(){return this.config},e}();!function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new r(t,++n)},e.getNextChild=function(e){return new r(e.getString(),++e.nextChild)};var r=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=r}(V||(V={}));var B=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},H=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},z=function(){return 1e3*Date.now()};"object"==typeof window.performance&&"now"in window.performance&&(z=function(){return 1e3*Math.floor(window.performance.now())});var W,q,G,Y,K,J,Q,X,Z,$=function(){function e(e,t,n){this._optionalEventFlags={},this._ended=!1,this._telemetryLogger=e,this._activityName=t,this._cv=n?V.getNextChild(n._cv):V.getNext(),this._dataFields=[],this._success=void 0,this._startTime=z()}return e.createNew=function(t,n){return new e(t,n)},e.prototype.createChildActivity=function(t){return new e(this._telemetryLogger,t,this)},e.prototype.setEventFlags=function(e){this._optionalEventFlags=e},e.prototype.addDataField=function(e){this._dataFields.push(e)},e.prototype.addDataFields=function(e){var t;(t=this._dataFields).push.apply(t,e)},e.prototype.setSuccess=function(e){this._success=e},e.prototype.setResult=function(e,t,n){this._result={code:e,type:t,tag:n}},e.prototype.endNow=function(){if(!this._ended){void 0===this._success&&void 0===this._result&&R(j.Warning,D.Core,(function(){return"Activity does not have success or result set"}));var e=z()-this._startTime;this._ended=!0;var t={duration:e,count:1,aggMode:0,cV:this._cv.getString(),success:this._success,result:this._result};return this._telemetryLogger.sendActivity(this._activityName,t,this._dataFields,this._optionalEventFlags)}R(j.Error,D.Core,(function(){return"Activity has already ended"}))},e.prototype.executeAsync=function(e){return B(this,void 0,void 0,(function(){var t=this;return H(this,(function(n){return[2,e(this).then((function(e){return t.endNow(),e})).catch((function(e){throw t.endNow(),e}))]}))}))},e.prototype.executeSync=function(e){try{var t=e(this);return this.endNow(),t}catch(e){throw this.endNow(),e}},e.prototype.executeChildActivityAsync=function(e,t){return B(this,void 0,void 0,(function(){return H(this,(function(n){return[2,this.createChildActivity(e).executeAsync(t)]}))}))},e.prototype.executeChildActivitySync=function(e,t){return this.createChildActivity(e).executeSync(t)},e}();function ee(e,t,n){e.push(M("zC."+t,n))}(W||(W={})).getFields=function(e,t){var n=[];return n.push(N(e+".Code",t.code)),void 0!==t.type&&n.push(M(e+".Type",t.type)),void 0!==t.tag&&n.push(N(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push(F(e+".IsExpected",t.isExpected)),ee(n,e,"Office.System.Result"),n},(G=q||(q={})).contractName="Office.System.Activity",G.getFields=function(e){var t=[];return void 0!==e.cV&&t.push(M("Activity.CV",e.cV)),t.push(N("Activity.Duration",e.duration)),t.push(N("Activity.Count",e.count)),t.push(N("Activity.AggMode",e.aggMode)),void 0!==e.success&&t.push(F("Activity.Success",e.success)),void 0!==e.result&&t.push.apply(t,W.getFields("Activity.Result",e.result)),ee(t,"Activity",G.contractName),t},(Y||(Y={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(M(e+".Id",t.id)),void 0!==t.version&&n.push(M(e+".Version",t.version)),void 0!==t.sessionId&&n.push(M(e+".SessionId",t.sessionId)),ee(n,e,"Office.System.Host"),n},(K||(K={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(M(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push(M(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(M(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(M(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push(M(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push(F(e+".IsAnonymous",t.isAnonymous)),ee(n,e,"Office.System.User"),n},(J||(J={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(M(e+".Id",t.id)),void 0!==t.version&&n.push(M(e+".Version",t.version)),void 0!==t.instanceId&&n.push(M(e+".InstanceId",t.instanceId)),void 0!==t.name&&n.push(M(e+".Name",t.name)),void 0!==t.marketplaceType&&n.push(M(e+".MarketplaceType",t.marketplaceType)),void 0!==t.sessionId&&n.push(M(e+".SessionId",t.sessionId)),void 0!==t.browserToken&&n.push(M(e+".BrowserToken",t.browserToken)),void 0!==t.osfRuntimeVersion&&n.push(M(e+".OsfRuntimeVersion",t.osfRuntimeVersion)),void 0!==t.officeJsVersion&&n.push(M(e+".OfficeJsVersion",t.officeJsVersion)),void 0!==t.hostJsVersion&&n.push(M(e+".HostJsVersion",t.hostJsVersion)),void 0!==t.assetId&&n.push(M(e+".AssetId",t.assetId)),void 0!==t.providerName&&n.push(M(e+".ProviderName",t.providerName)),void 0!==t.type&&n.push(M(e+".Type",t.type)),ee(n,e,"Office.System.SDX"),n},(Q||(Q={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(M(e+".Name",t.name)),void 0!==t.state&&n.push(M(e+".State",t.state)),ee(n,e,"Office.System.Funnel"),n},(X||(X={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(N(e+".Id",t.id)),void 0!==t.name&&n.push(M(e+".Name",t.name)),void 0!==t.commandSurface&&n.push(M(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push(M(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push(M(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(N(e+".TimeOffsetMs",t.timeOffsetMs)),ee(n,e,"Office.System.UserAction"),n},function(e){e.getFields=function(e,t){var n=[];return n.push(M(e+".ErrorGroup",t.errorGroup)),n.push(N(e+".Tag",t.tag)),void 0!==t.code&&n.push(N(e+".Code",t.code)),void 0!==t.id&&n.push(N(e+".Id",t.id)),void 0!==t.count&&n.push(N(e+".Count",t.count)),ee(n,e,"Office.System.Error"),n}}(Z||(Z={}));var te,ne=q,re=W,oe=Z,ie=Q,ae=Y,se=J,ce=X,de=K;!function(e){!function(e){!function(e){e.Activity=ne,e.Result=re,e.Error=oe,e.Funnel=ie,e.Host=ae,e.SDX=se,e.User=de,e.UserAction=ce}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(te||(te={}));var ue,le,fe=(ue=function(e,t){return(ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}ue(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),me=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},pe=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fe(t,e),t.prototype.executeActivityAsync=function(e,t){return me(this,void 0,void 0,(function(){return pe(this,(function(n){return[2,this.createNewActivity(e).executeAsync(t)]}))}))},t.prototype.executeActivitySync=function(e,t){return this.createNewActivity(e).executeSync(t)},t.prototype.createNewActivity=function(e){return $.createNew(this,e)},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:te.Office.System.Activity.contractName,dataFields:te.Office.System.Activity.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){var t=te.Office.System.Error.getFields("Error",e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t}(U),he=function(){function e(){this.EMPTY_IMPL=!0}return e.prototype.success=function(){},e.prototype.successTag=function(e){},e.prototype.fail=function(e){},e.prototype.failTag=function(e,t){},e.prototype.addDataField=function(e,t,n){},e.prototype.addDocumentMetadata=function(e){},e.prototype.attachContext=function(e){},e.prototype.isEnded=function(){return!1},e}(),Ce=function(){function e(e){this._visitor=e,this._ended=!1}return e.prototype.finalize=function(){return this._ended?(Object(u.f)("ActivityObject has already been ended"),!1):(this._visitor&&this._visitor.visit(this),this._ended=!0,!0)},e.prototype.success=function(){this.successTag(0)},e.prototype.fail=function(e){this.failTag(0,e)},e.prototype.isEnded=function(){return this._ended},e}();!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam",e[e.ShiftFactor=1e3]="ShiftFactor"}(le||(le={}));var ye=function(e){function t(t,n,r,o,i){var a=e.call(this,o)||this;return a.activityNamespace=t,a.activityName=n,a.fullActivityName=a.activityNamespace+"."+a.activityName,a.activityScope=r.createNewActivity(a.fullActivityName),a.hostTelemetrySupport=i,a}return Object(h.__extends)(t,e),t.prototype.successTag=function(e){this.finalize()&&(this.activityScope.setSuccess(!0),this.activityScope.setResult(0,void 0,e),this.activityScope.endNow(),this.hostTelemetrySupport.recordActivity&&this.hostTelemetrySupport.recordActivity(this.activityName))},t.prototype.failTag=function(e,t){this.finalize()&&(this.activityScope.setSuccess(!1),this.activityScope.setResult(t,void 0,e),void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(e,201,le.Error,this.fullActivityName+" Failed"),this.activityScope.endNow())},t.prototype.addDataField=function(e,t,n,o){if(!this.isEnded()&&n===r.SystemMetadata){var i,a,s,c=n||P.SystemMetadata;switch(typeof t){case"boolean":(i=F(e,t)).classification=c;break;case"number":(i=function(e,t){return{name:e,dataType:x.Double,value:t,classification:P.SystemMetadata}}(e,t)).classification=c;break;case"string":(i=M(e,t)).classification=c;break;default:throw new Error("Unknown type")}this.activityScope.addDataField(i),o&&(a=i,(s=this.hostTelemetrySupport).recordActivity&&s.recordActivity(a.name))}},t.prototype.attachContext=function(e){},t.prototype.addDocumentMetadata=function(e){},t}(Ce);var ve={appName:"TestHost",appVersion:"1.0",releaseAudience:"Internal",releaseChannel:"Insiders",sessionId:"D9430514-C886-445F-891C-6C0E7F774EF7"};var be=function(){function e(e,t){void 0===t&&(t=ve),this.sdxMetadata=e,this.hostTelemetrySupport=t}return e.prototype.getMetadata=function(){var e=this.hostTelemetrySupport;return{appName:e.appName,appVersion:e.appVersion,dataCenter:e.dataCenter,releaseAudience:e.releaseAudience,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,ring:e.ring,sessionId:e.sessionId}},e}(),Te=function(){function e(e){this.hostTelemetrySupport=e}return e.prototype.sendTelemetryEvent=function(e,t){if(void 0!==this.hostTelemetrySupport.sendOtelEvent){this.hostTelemetrySupport.sendOtelEvent({otelEvent:e});try{if(this.hostTelemetrySupport.recordPerfData&&e.eventContract&&e.dataFields){if("Activity.Duration"!==e.eventContract.dataFields[1].name)return;var n=+e.eventContract.dataFields[1].value;if(isNaN(n))return;var r=n/1e3;if("Office.Docs.SharedComments.RenderPaneIntoView"===e.eventName)this.hostTelemetrySupport.recordPerfData("RenderPaneIntoView",r);else if("Office.Docs.SharedComments.E2EPerfTracker"===e.eventName&&"OperationType"===e.dataFields[0].name)switch(e.dataFields[0].value){case"REPLY":this.hostTelemetrySupport.recordPerfData("SharedCommentsCommentReply",r);break;case"CREATE":this.hostTelemetrySupport.recordPerfData("SharedCommentsCreateThread",r);break;case"EDIT":this.hostTelemetrySupport.recordPerfData("SharedCommentsEditComment",r)}}}catch(e){return void(void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(f,201,le.Error,"Error recording performance data: "+e.message))}}else void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(f,201,le.Error,"sendOtelEvent API undefined")},e}();function Ie(e,t,n){e.persistentDataFields=function(e,t){var n=[];return n.push(M("SDX.Name",e.name)),n.push(M("SDX.Version",e.version)),n}(t),e.addSink(new Te(n))}var Oe=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.sdxMetadata=t,r.namespaceString="Office.Docs.SharedComments",r.ariaTenantToken="c274b3e05ac5448dae8fbb7466da6acb-fd6dc8de-18b7-409c-a696-4bd66f7a5322-7902",r.disableUpload=u.b,r.telemetryLogger=new ge,r.isFloodgateServiceEnabled=!1,r.initialize(),r}return Object(h.__extends)(t,e),t.prototype.initialize=function(){var e=this;void 0!==this.hostTelemetrySupport.disableUpload&&(this.disableUpload=this.hostTelemetrySupport.disableUpload),this.disableUpload||(k.addListener((function(t){void 0===e.hostTelemetrySupport.sendULSTrace||t.level!==j.Error&&t.level!==j.Warning||e.hostTelemetrySupport.sendULSTrace(l,201,le.Error,"OTel Notification - Level: "+t.level+", Category: "+t.category+", Message: "+t.message())})),this.telemetryLogger.setTenantToken(this.namespaceString,this.ariaTenantToken,-1),Ie(this.telemetryLogger,this.sdxMetadata,this.hostTelemetrySupport))},t.prototype.createActivityObject=function(e,t,n){return this.disableUpload?new he:function(e,t,n,r,o){return new ye(e,t,n,o,r)}(this.namespaceString,e,this.telemetryLogger,this.hostTelemetrySupport,(o=this,void 0===(r=t)?o:{visit:function(e){r.visit(e),o.visit(e)}}));var r,o},t.prototype.logErrorData=function(e,t){this.disableUpload||(void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(e,201,le.Error,t),this.createActivityObject("LogError",(o.ReviewedAsNotNecessary,{visit:function(){}}),i.None).failTag(e,-2130957533))},t.prototype.logFloodgateActivity=function(e){!this.disableUpload&&window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate&&this.ensureFloodgateServiceEnabled().then((function(){var t=OfficeBrowserFeedback.floodgate.getEngine();if(t){var n=t.getActivityListener();n&&n.logActivity(e)}return Promise.resolve()})).catch((function(){}))},t.prototype.ensureFloodgateServiceEnabled=function(){var e=this;return this.isFloodgateServiceEnabled?Promise.resolve():window.OfficeBrowserFeedback.floodgate.initialize().then((function(){return window.OfficeBrowserFeedback.floodgate.start().then((function(){return e.isFloodgateServiceEnabled=!0,Promise.resolve()})).catch((function(e){return S().assertConditionTag(!1,"floodgate.start() failed: "+e.message,p),Promise.reject()}))})).catch((function(e){return S().assertConditionTag(!1,"floodgate.initialize() failed: "+e.message,g),Promise.reject()}))},t.prototype.visit=function(e){},t}(be);function Se(e,t){S().init(new Oe(e,t))}var je;!function(){function e(){this.testOnly=!0,this.getMetadata=function(){return{appName:"",releaseAudience:"",appVersion:"",releaseChannel:"",sessionId:"0000"}}}e.prototype.init=function(e){},e.prototype.onInitialized=function(e){},e.prototype.createActivityObject=function(e,t,n,r,o){return new he},e.prototype.assertCondition=function(e,t){},e.prototype.assertConditionTag=function(e,t,n){}}();!function(e){e[e.None=0]="None",e[e.Errors=1]="Errors",e[e.Info=2]="Info",e[e.All=3]="All"}(je||(je={}));var De=function(e){function t(t,n,r){var o=e.call(this,r)||this;return o.name=t,o.loggingMask=n,o.EMPTY_IMPL=!0,o.dataFields={},o}return Object(h.__extends)(t,e),t.prototype.successTag=function(e){this.finalize()&&this.loggingMask&je.Info&&Object(u.g)({activityName:this.name,endTag:e,dataFields:this.dataFields})},t.prototype.failTag=function(e,t){this.finalize()&&this.loggingMask&je.Errors&&Object(u.f)({activityName:this.name,endTag:e,errorCode:t,dataFields:this.dataFields})},t.prototype.addDataField=function(e,t,n){this.dataFields[e]=[t,r[n]]},t.prototype.addDocumentMetadata=function(e){},t.prototype.attachContext=function(e){},t}(Ce);!function(){function e(e,t){this.assertWhitelist=e,this.showAlert=t,this.getMetadata=function(){return{appName:"",releaseAudience:"",appVersion:"",releaseChannel:"",sessionId:"0000"}}}e.prototype.createActivityObject=function(t,n,r,o){return new De(t,e.loggingMask,n)},e.prototype.logErrorData=function(t,n){var r,o;e.loggingMask&je.Errors&&(Object(u.f)({details:n,tagID:t}),this.showAlert&&!this.assertWhitelist.has(t)&&(r=t,o=n,window.alert("Assert Tag 0x"+r.toString(16)+"\n"+o+"\n"+(new Error).stack)))},e.loggingMask=je.Errors}();var we,_e=function(){function e(){this.addDataField=jest.fn(),this.addDocumentMetadata=jest.fn(),this.attachContext=jest.fn(),this.isEnded=jest.fn(),this.fail=jest.fn(),this.success=jest.fn()}return e.prototype.successTag=function(e){this.success()},e.prototype.failTag=function(e,t){this.fail(t)},e}();!function(){function e(){this.testOnly=!0,this.init=jest.fn(),this.onInitialized=jest.fn(),this.assertCondition=jest.fn(),this.createActivityObject=jest.fn((function(){return new _e})),this.getMetadata=function(){return{appName:"",releaseAudience:"",appVersion:"",releaseChannel:"",sessionId:"0000"}},this.reset(),e.currentInstance=this}e.prototype.reset=function(){this.init=jest.fn(),this.onInitialized=jest.fn(),this.createActivityObject=jest.fn((function(){return new _e})),this.assertCondition=jest.fn()},e.prototype.assertConditionTag=function(){this.assertCondition()},e.prototype.getCreatedActivities=function(){return this.createActivityObject.mock.results.map((function(e){return e.value}))}}();!function(e){e[e.Stub=0]="Stub",e[e.Fake=1]="Fake"}(we||(we={})),n.d(t,"g",(function(){return S})),n.d(t,"i",(function(){return Se})),n.d(t,"f",(function(){return o})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c}))},300:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(203),o=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startThreadIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.next=function(){var e=this.pointer;if(this.pointer<this.model.length-1)do{++this.pointer}while(this.pointer<this.model.length&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&r.e.Resolved));return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&e<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&r.e.Resolved));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}()},303:function(e,t,n){"use strict";var r,o,i=n(0),a=n(81),s=n(25);function c(){return r||(r=Object(s.a)())}function d(){return c().isChangeGateEnabled("FlattenComponentRegistryAPI",Object(s.c)(4387148))}!function(e){e[e.Unregistered=0]="Unregistered",e[e.Registered=1]="Registered"}(o||(o={}));var u,l=function(){function e(){this.onComponentStateChanged=new a.EventImpl((function(){})),this.onComponentCommand=new a.EventImpl((function(){}))}return e.prototype.initialize=function(){},e.prototype.registerComponent=function(e,t){return this.onComponentStateChanged.trigger({componentName:e,state:o.Registered}),t},e.prototype.unregisterComponent=function(e){this.onComponentStateChanged.trigger({componentName:e,state:o.Unregistered})},e}();function f(){return void 0===u&&(u=new l).initialize(),u}var m=function(e,t){var n=this;this.componentName=e,this.onComponentCommandForwarded=t,this.onComponentCommand=new a.EventImpl((function(){})),d()?this.onComponentCommandForwarded.subscribe((function(e){e.details.componentKey===n.componentName&&n.onComponentCommand.trigger(e)})):f().onComponentCommand.subscribe((function(e){e.details.componentKey===n.componentName&&n.onComponentCommand.trigger(e)}))},p=function(){function e(e,t){var n=this;this._componentName=e,this._registryInstance=t,this.onStateChanged=new a.EventImpl((function(){})),(d()?this._registryInstance.onComponentStateChanged:f().onComponentStateChanged).subscribe((function(e){e.componentName===n._componentName&&n.onStateChanged.trigger(e.state)}))}return Object.defineProperty(e.prototype,"component",{get:function(){return this._registryInstance.componentMap[this._componentName]},enumerable:!1,configurable:!0}),e}(),g=function(){function e(){if(this.componentMap={},this.onComponentStateChanged=new a.EventImpl((function(){})),this.onComponentCommand=new a.EventImpl((function(){})),d())throw new Error("ComponentRegistryImpl_deprecated should never be instantiated when Microsoft.Office.Docs.ChangeGate.ComponentRegistry.JSGate.FlattenComponentRegistryAPI is enabled")}return e.prototype.initialize=function(){},e.prototype.registerComponent=function(e,t){var n=f().registerComponent(e,t);return this.componentMap[e]=n,new m(e,this.onComponentCommand)},e.prototype.unregisterComponent=function(e){delete this.componentMap[e],f().unregisterComponent(e)},e.prototype.getComponent=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return[2,new p(e,this)]}))}))},e}(),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t}(function(){function e(){this.componentMap={},this.onComponentStateChanged=new a.EventImpl((function(){})),this.onComponentCommand=new a.EventImpl((function(){}))}return e.prototype.initialize=function(){},e.prototype.registerComponent=function(e,t){return this.onComponentStateChanged.trigger({componentName:e,state:o.Registered}),this.componentMap[e]=t,new m(e,this.onComponentCommand)},e.prototype.unregisterComponent=function(e){delete this.componentMap[e],this.onComponentStateChanged.trigger({componentName:e,state:o.Unregistered})},e.prototype.getComponent=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return[2,new p(e,this)]}))}))},e}()),C=window;function y(){return void 0===C.ComponentRegistryImpl&&(d()?(C.ComponentRegistryImpl=new h,C.ComponentRegistryImpl.initialize()):C.ComponentRegistryImpl=new g),C.ComponentRegistryImpl}n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return o}))},32:function(e,t,n){"use strict";var r,o=n(9),i=n(81);!function(e){e[e.Modify=1]="Modify",e[e.Remove=2]="Remove",e[e.Add=3]="Add",e[e.ReQuery=4]="ReQuery"}(r||(r={}));var a,s,c,d,u=n(0),l=n(249),f=n.n(l);function m(e){return e.scope.renderMode===d.Isolated}function p(e){return e===a.Enabled_Default||e===a.Enabled_ForcePrimary}!function(e){e[e.Invalid=0]="Invalid",e[e.Disabled=1]="Disabled",e[e.Enabled_Default=2]="Enabled_Default",e[e.Enabled_ForcePrimary=3]="Enabled_ForcePrimary"}(a||(a={})),function(e){e[e.Empty=0]="Empty",e[e.CommentThread=1]="CommentThread"}(s||(s={})),function(e){e[e.Disabled=0]="Disabled",e[e.Primary=1]="Primary",e[e.Secondary=2]="Secondary"}(c||(c={})),function(e){e[e.Integrated=0]="Integrated",e[e.Isolated=1]="Isolated"}(d||(d={}));var g,h=function(){function e(){this.store=new Map}return e.prototype.getInstanceIdForExtensionKey=function(e){var t;return this.store.forEach((function(n,r){if(n.has(e)){if(t)throw new Error("Double registration across instances for an extension key.");t=r}})),t},e.prototype.insertExtension=function(e,t){var n=t.instanceId;this.store.has(n)||this.store.set(n,new Map);var r=this.store.get(n);if(r.has(e.extensionKey))throw new Error("Duplicate Registration in same instance.");this.store.forEach((function(t,r){if(r!==n&&t.has(e.extensionKey))throw new Error("Duplicate Registration in different instance.")})),r.set(e.extensionKey,t)},e.prototype.updateExtension=function(e,t){var n=this.getInstanceIdForExtensionKey(e);if(n){var r=this.store.get(n);if(r){var o=r.get(e);if(o)return o=Object(u.__assign)(Object(u.__assign)({},o),t),r.set(e,o),o}}},e.prototype.removeExtension=function(e){var t=this.getInstanceIdForExtensionKey(e);if(t){var n=this.store.get(t);if(n){var r=n.get(e);return n.delete(e),r}}},e.prototype.getExtension=function(e){var t=this.getInstanceIdForExtensionKey(e);if(t){var n=this.store.get(t);if(n)return n.get(e)}},e.prototype.getExtensionsByInstance=function(e){return this.store.get(e)},e}(),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(u.__extends)(t,e),t.prototype.initialize=function(){},t}(function(){function e(){var e=this;this.onExtensionUpdated=new i.EventImpl((function(){})),this.extensionStore=new h,this.getExtensionsInternal=function(t,n){var r=e.extensionStore.getExtensionsByInstance(n);if(!r)return[];var o=[];return r.forEach((function(e,n){e.contentType===t&&o.push({state:e,id:n})})),o}}return e.prototype.triggerExtensionUpdated=function(e,t){this.onExtensionUpdated.trigger({extension:e,updateType:t})},e.prototype.registerExtension=function(e,t,n){var o=f()(),i=void 0!==n.priority?n.priority:c.Primary,a={extensionKey:o,instanceId:n.instanceId},s=n.renderMode===d.Isolated?{componentKey:t,contentType:e,priority:i,isContentAvailable:n.isContentAvailable,renderMode:n.renderMode,instanceId:n.instanceId,componentDimensions:n.componentDimensions}:{componentKey:t,contentType:e,priority:i,renderMode:n.renderMode,instanceId:n.instanceId,componentDimensions:n.componentDimensions};this.extensionStore.insertExtension(a,s);var u={id:o,state:s};return this.triggerExtensionUpdated(u,r.Add),u},e.prototype.unregisterExtension=function(e){var t=this.extensionStore.removeExtension(e);t&&this.triggerExtensionUpdated({id:e,state:t},r.Remove)},e.prototype.updateExtension=function(e,t){var n=this,o=function(t,r){t&&n.triggerExtensionUpdated({id:e,state:t},r)};t?o(this.extensionStore.updateExtension(e,t),r.Modify):o(this.extensionStore.getExtension(e),r.ReQuery)},e.prototype.getExtensions=function(e,t){return this.getExtensionsInternal(e,t)},e.prototype.getExtension=function(e){var t=this.extensionStore.getExtension(e);if(void 0!==t)return{id:e,state:t}},e}());function y(){if(void 0===g){var e=new C;e.initialize(),g=e}return g}var v=["SDX::ContentExtension::ContentExtensionHostModule",{initializeExtensionModule:["FireAndForgetMethod",[]],onExtensionUpdate:["FireAndForgetMethod",[["$union",["SDX::ContentExtension::ExtensionRemovedEventArgs","SDX::ContentExtension::ExtensionModifiedEventArgs","SDX::ContentExtension::ExtensionAddedEventArgs"]]]]}],b=(i.RekaServiceRegistry.getNativeService(v),function(){function e(){}e.prototype.initializeExtensionModule=function(){},e.prototype.onExtensionUpdate=function(e){},e.ServiceInfo=v}(),n(3)),T=function(){function e(e,t){this.extensionKey=e,this.scope=t}return e.prototype.getExtension=function(){var e=y().getExtension(this.extensionKey);if(!e||e.state.renderMode!==d.Integrated)throw Object(b.g)().assertConditionTag(!!e,"No extension data in provider. Querying a removed extension.",592316051),Object(b.g)().assertConditionTag((null==e?void 0:e.state.renderMode)===d.Integrated,"Extension data is not for the Integrated Render Mode.",592316052),new Error("Unable to query extension data within provider.");return{contentType:e.state.contentType,renderMode:e.state.renderMode,instanceId:e.state.instanceId,componentKey:e.state.componentKey,priority:e.state.priority,componentDimensions:e.state.componentDimensions,type:"Integrated"}},e}();function I(e,t){var n=e.isContentAvailable(t),r=function(e,t){switch(e){case c.Primary:case c.Secondary:switch(t){case a.Invalid:case a.Disabled:return c.Disabled;case a.Enabled_Default:return e;case a.Enabled_ForcePrimary:return c.Primary}case c.Disabled:return e}}(e.priority,n),o=n!==a.Invalid;return{contentType:e.contentType,renderMode:e.renderMode,instanceId:e.instanceId,componentKey:e.componentKey,componentDimensions:e.componentDimensions,priority:r,contentId:t,isContentIdValid:o,type:"Isolated"}}var O=function(){function e(e,t){var n=this;this.extensionKey=e,this.scope=t,this.cachedExtensions={},this.onExtensionUpdate=function(e){e.updateType!==r.Remove?e.extension.id===n.extensionKey&&n.updateCachedExtensions():n.teardown()},this.teardown=function(){n.cachedExtensions={},n.subscription.unsubscribe()},this.subscription=y().onExtensionUpdated.subscribe(this.onExtensionUpdate)}return e.prototype.getExtension=function(e){var t=this,n=this.cachedExtensions[e];if(n)return n.extension;var r=y().getExtension(this.extensionKey);if(!r||r.state.renderMode!==d.Isolated)throw Object(b.g)().assertConditionTag(!!r,"No extension data in provider. Querying a removed extension.",592316053),Object(b.g)().assertConditionTag((null==r?void 0:r.state.renderMode)===d.Isolated,"Extension data is not for the Isolated Render Mode.",592316054),new Error("Unable to query extension data within provider.");var o=I(r.state,e),a=Object(u.__assign)(Object(u.__assign)({},o),{onUpdated:new i.EventImpl((function(n){var r=t.cachedExtensions[e];r&&(n?r.hasListener=!0:delete t.cachedExtensions[e])}))});return this.cachedExtensions[e]={extension:a,hasListener:!1},a},e.prototype.updateCachedExtensions=function(){var e=this,t=y().getExtension(this.extensionKey);if(!t||t.state.renderMode!==d.Isolated)return Object(b.g)().assertConditionTag(!!t,"No extension data in provider. Querying a removed extension.",592314635),void Object(b.g)().assertConditionTag((null==t?void 0:t.state.renderMode)===d.Isolated,"Extension data is not for the Isolated Render Mode.",592314636);var n=t.state;Object.keys(this.cachedExtensions).forEach((function(t){var r=e.cachedExtensions[t],o=null==r?void 0:r.extension;if(o&&r){var i=I(n,t);(o.priority!==i.priority||o.isContentIdValid!==i.isContentIdValid)&&(o.priority=i.priority,o.isContentIdValid=i.isContentIdValid,o.onUpdated.trigger({})),r.hasListener||i.isContentIdValid||delete e.cachedExtensions[t]}else Object(b.g)().assertConditionTag(!1,"Trying to access extension before it has been cached.",591152983)}))},e}(),S=function(){function e(e){this._detached=!1,this._id=e.id;var t={contentType:e.state.contentType,renderMode:e.state.renderMode,instanceId:e.state.instanceId};this._extensionProvider=e.state.renderMode===d.Isolated?new O(this._id,t):new T(this._id,t)}return e.prototype.triggerUpdate=function(){y().updateExtension(this._id,void 0)},e.prototype.unregisterExtension=function(){this._detached=!0,y().unregisterExtension(this._id)},e.prototype.updateState=function(e){var t=y().getExtension(this._id);if(void 0===t)throw Object(b.g)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005410),new Error("ExtensionController with id "+this._id+" does not correspond to a cached ExtensionState");1===Object.keys(e).length&&void 0!==e.priority&&t.state.priority===e.priority?this.triggerUpdate():y().updateExtension(this._id,e)},Object.defineProperty(e.prototype,"priority",{get:function(){var e=y().getExtension(this._id);if(void 0===e)throw Object(b.g)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",595620259),new Error("ExtensionController with id "+this._id+" does not correspond to a cached ExtensionState");return e.state.priority},set:function(e){this._detached||this.updateState({priority:e})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"componentDimensions",{get:function(){var e=y().getExtension(this._id);if(void 0===e)throw Object(b.g)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005411),new Error("ExtensionController with id "+this._id+" does not correspond to a cached ExtensionState");return e.state.componentDimensions},set:function(e){this._detached||this.updateState({componentDimensions:e})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"detached",{get:function(){return this._detached},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"provider",{get:function(){return this._extensionProvider},enumerable:!1,configurable:!0}),e}(),j=function(){function e(e,t){var n=this;this.contentTypes=e,this.host=t,this.onUpdated=new i.EventImpl((function(){})),y().onExtensionUpdated.subscribe((function(t){e.find((function(e){return e===t.extension.state.contentType}))&&t.updateType!==r.ReQuery&&n.onUpdated.trigger({})}))}return Object.defineProperty(e.prototype,"providers",{get:function(){var e=[],t=function(t){var r=n.host.extensions[t];r.priority!==c.Disabled&&n.contentTypes.find((function(e){return e===r.provider.scope.contentType}))&&e.push(r.provider)},n=this;for(var r in this.host.extensions)t(r);return e},enumerable:!1,configurable:!0}),e}(),D=function(){function e(){var e=this;this.contentTypeRegistrationInfo={},this.extensions={},this.onExtensionFirstRequested=new i.EventImpl((function(){})),y().onExtensionUpdated.subscribe((function(t){switch(t.updateType){case r.ReQuery:break;case r.Remove:delete e.extensions[t.extension.id];break;case r.Add:case r.Modify:e.ensureExtensionCached(t.extension.id,t.extension.state);break;default:Object(o.j)(t.updateType)}}))}return e.prototype.registerExtension=function(e,t,n){var r=y().registerExtension(e,t,n);return this.ensureExtensionCached(r.id,r.state),Promise.resolve(this.extensions[r.id])},e.prototype.getExtensions=function(e){var t=this,n=new j(e,this);return e.forEach((function(e){y().getExtensions(e,"Default_7210d794-9f0f-4d0a-805c-964303b2676b").forEach((function(e){t.ensureExtensionCached(e.id,e.state)})),t.contentTypeRegistrationInfo[e]||(t.contentTypeRegistrationInfo[e]=!0,t.onExtensionFirstRequested.trigger({contentType:e}))})),n},e.prototype.ensureExtensionCached=function(e,t){void 0===this.extensions[e]&&(this.extensions[e]=new S({id:e,state:t}))},e}(),w=void 0;function _(){if(!w)throw new Error("Running in an invalid environment, window expected to exist.");return void 0===w.ContentExtensionHostAdapter&&(w.ContentExtensionHostAdapter=new D),w.ContentExtensionHostAdapter}"undefined"!=typeof window&&(w=window),n.d(t,"e",(function(){return _})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return p}))},321:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Execute=0]="Execute",e[e.CheckEnabled=1]="CheckEnabled",e[e.CheckToggled=2]="CheckToggled"}(r||(r={}))},322:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unfocused=0]="Unfocused",e[e.FocusOn=1]="FocusOn",e[e.FocusWithin=2]="FocusWithin"}(r||(r={}))},323:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t){return Object(r.b)(o.a.DisplayDraftWarningType,e,t)}},324:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=function(e){return e.taskState},o=function(e){return e.taskState.tasks}},327:function(e,t,n){"use strict";var r=n(3),o=n(21),i=n(0),a=n(110),s=n(40);function c(e,t,n){void 0!==t[e]||n.has(e)||n.add(e)}function d(e){var t,n,r={};try{for(var o=Object(i.__values)(e),a=o.next();!a.done;a=o.next()){var s=a.value;r[s.authorName]=s}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}var u=n(11),l=n(458);function f(e,t,n,i,f){return function(m,p){var g=function(e,t,n,r){var o=new Set;e.forEach((function(e){return c(Object(a.g)(e.author),n,o)})),t&&t.forEach((function(e){return e.history.forEach((function(e){return c(Object(a.g)(e.records[0].user),n,o)}))})),r&&c(r,n,o);var i=[];return o.forEach((function(e){return i.push({UserId:"",Provider:"",DisplayName:e})})),i}(t,n,u.n(p()),f);if(i.getPersonaIconPropertiesArray)i.getPersonaIconPropertiesArray(g).then((function(t){m(Object(l.a)(e,d(t)))})).catch((function(e){Object(o.b)(e)?Object(r.g)().assertConditionTag(!1,e.message,595645964):Object(r.g)().assertConditionTag(!1,"Unknown error in loadPersonaIconPropertiesThunk "+e,595645965)}));else{var h=function(e){var t=[];return e.forEach((function(e){t.push({authorName:e.DisplayName||"",authorId:"",authorColor:s.a.COMMENTS_PURPLE,authorImageURL:""})})),t}(g);m(Object(l.a)(e,d(h)))}return Promise.resolve()}}n.d(t,"a",(function(){return f}))},330:function(e,t,n){"use strict";var r=n(68),o=n(224),i=n(35),a=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e[n]);return t},s=function(){function e(e,t,n){this.renderContextType=e,this.contextIdentifier=t}return e.prototype.getComponent=function(t){return e.domGetElementById(Object(o.c)(t))},e.prototype.getComponentById=function(t){return e.domGetElementById(Object(o.a)(t))},e.prototype.isEventTarget=function(e,t){return e===t},e.prototype.isFocusOn=function(t){var n=e.getActiveElement(t);return e.hasFocus(n)},e.prototype.isFocusWithin=function(t){var n=e.getActiveElement(t);return e.containsFocus(n)},e.prototype.isFocusWithinAny=function(t){var n=void 0;switch(t){case i.a.Card:n=a(document.querySelectorAll("[id*='"+r.h({id:"",renderContextType:this.renderContextType},!1)+"']"));break;case i.a.DraftCard:n=a(document.querySelectorAll("[id*='"+r.h({id:"",renderContextType:this.renderContextType},!0)+"']"));break;case i.a.PostEditor:n=a(document.querySelectorAll("[id*='"+r.t(r.D({id:"",renderContextType:this.renderContextType}))+"']"));break;case i.a.CardEditor:n=a(document.querySelectorAll("[id*='"+r.t(r.e({id:"",renderContextType:this.renderContextType}))+"']"));break;case i.a.Post:n=a(document.querySelectorAll("[id*='"+r.G({id:"",renderContextType:this.renderContextType})+"']"))}if(n)for(var o=0;o<n.length;++o){var s=n[o];if(e.containsFocus(s))return!0}return!1},e.prototype.isFocusWithinPane=function(){var t=document.getElementById(r.w());return e.containsFocus(t)},e.prototype.getCurrentlyFocused=function(){return this.isFocusWithinPane()?[document.activeElement]:[]},e.getActiveElement=function(t){var n;return Object(i.c)(t)?n=e.domGetElementById(Object(o.a)(t)):t.componentType!==i.a.Unknown&&(n=e.domGetElementById(Object(o.c)(t.componentType))),n},e.hasFocus=function(e){var t=document.activeElement;return!!e&&t===e},e.containsFocus=function(e){var t=document.activeElement;return!!e&&(t&&e.contains(t)||t===document.body||null===t||0===Object.keys(t).length)},e.domGetElementById=function(e){return document.getElementById(e)||void 0},e}();t.a=s},336:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},341:function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},346:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return d}));var r=n(3),o=n(28),i=n(21),a=!1;function s(){return Promise.all([n.e(0),n.e(1),n.e(4)]).then(n.bind(null,1531)).then((function(e){return e})).catch((function(e){}))}function c(){var e;return a||(e=Object(r.g)().createActivityObject("AtMentionLazyLoad",Object(r.h)(r.f.GlobalAPI),r.a.None,r.b.NecessaryServiceDataEvent),a=!0),Promise.all([n.e(0),n.e(1),n.e(3)]).then(n.bind(null,1532)).then((function(t){return e&&e.successTag(591677089),t})).catch((function(t){e.failTag(595895121,-2130957515),a=!1}))}function d(e){var t,a=Object(r.g)().createActivityObject("SharedCommentsUILazyLoad",Object(r.h)(r.f.GlobalAPI),r.a.None,r.b.NecessaryServiceDataEvent);switch(a.addDataField(o.a.ContainerName,e,r.c.SystemMetadata),e){case"CommentPaneContainer":t=u((function(){return Promise.all([n.e(0),n.e(1),n.e(20)]).then(n.bind(null,1478))}),a);break;case"CommentHost":t=u((function(){return Promise.all([n.e(0),n.e(1),n.e(20)]).then(n.bind(null,1536))}),a);break;case"HostableCommentCardRendererContainer":t=u((function(){return Promise.all([n.e(0),n.e(1),n.e(20)]).then(n.bind(null,1537))}),a);break;default:return a.failTag(595731076,-2130957503),Promise.reject(new i.a("Invalid container name",-2130957503))}return t.then((function(e){return a.successTag(595731075),e}),(function(e){a.failTag(595734544,-2130957504)}))}function u(e,t,n){void 0===n&&(n=3);return new Promise((function(i,a){e().then((function(e){t.addDataField(o.a.DelayLoadRetryCount,n,r.c.SystemMetadata),i(e)}),(function(r){setTimeout((function(){1!==n?u(e,t,n-1).then(i,a):a(r)}),500)}))}))}},347:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var r=n(114),o=n(7),i=n(15),a=JSON.stringify({ops:[{insert:""}]}),s={UserId:"",Provider:"",DisplayName:""};function c(e){var t,n=e.newComment.commentBody;return{commentBody:void 0!==n?n:a,commentId:e.newComment.commentId||"",author:null!==(t=e.newComment.author)&&void 0!==t?t:s,parentId:"",commentFlags:0,date:e.newComment.date||new Date,anchorHintText:e.newComment.anchorHintText?e.newComment.anchorHintText:void 0}}function d(e,t){if(!o.q())return!1;var n=Object(i.H)(e);return void 0!==n&&n.renderContextType!==t&&n.commentDraft.sessionConfiguration.sessionType===r.a}},35:function(e,t,n){"use strict";var r;function o(e){return e===r.ClosePaneButton||e===r.NextCommentButton||e===r.PreviousCommentButton||e===r.GhostCard||e===r.NewCommentButton||e===r.PaneRoot}function i(e){return(t=e.componentType)===r.CardEditor||t===r.PostEditor||t===r.Card||t===r.Post||t===r.DraftCard||t===r.DiscreteHostedCommentRoot||t===r.ReopenThreadButton;var t}function a(e){switch(e){case r.CardEditor:case r.Card:case r.DraftCard:case r.DiscreteHostedCommentRoot:case r.ReopenThreadButton:return!0;case r.PostEditor:case r.Post:return!1}}function s(e,t){return i(e)&&i(t)?e.componentType===t.componentType&&e.id===t.id&&e.renderContextType===t.renderContextType:e.componentType===t.componentType}n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return s})),function(e){e[e.Unknown=0]="Unknown",e[e.ClosePaneButton=1]="ClosePaneButton",e[e.CardEditor=2]="CardEditor",e[e.PostEditor=3]="PostEditor",e[e.Card=4]="Card",e[e.Post=5]="Post",e[e.NextCommentButton=6]="NextCommentButton",e[e.PreviousCommentButton=7]="PreviousCommentButton",e[e.GhostCard=8]="GhostCard",e[e.NewCommentButton=9]="NewCommentButton",e[e.PaneRoot=10]="PaneRoot",e[e.DraftCard=11]="DraftCard",e[e.DiscreteHostedCommentRoot=12]="DiscreteHostedCommentRoot",e[e.ReopenThreadButton=13]="ReopenThreadButton"}(r||(r={}))},351:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventImpl=void 0;var r=function(){function e(e){this.event=e}return e.prototype.unsubscribe=function(){this.event.unsubscribe(this)},e}(),o=function(){function e(e){this.listenerUpdate=e,this.handlers=new Map,this.hasListener=!1}return e.prototype.subscribe=function(e){var t=new r(this);return this.handlers.set(t,e),this.hasListener||this.sendUpdate(!0),t},e.prototype.unsubscribe=function(e){this.handlers.delete(e),this.hasListener&&0===this.handlers.size&&this.sendUpdate(!1)},e.prototype.unsubscribeAll=function(){this.handlers.clear(),this.hasListener&&this.sendUpdate(!1)},e.prototype.trigger=function(e){this.handlers.forEach((function(t,n){return t(e,n)}))},e.prototype.sendUpdate=function(e){this.hasListener=e,this.listenerUpdate(e)},e}();t.EventImpl=o},354:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t,n){return Object(r.b)(o.a.ResolveAtMentionCapabilityType,{capability:t,authToken:n},e)}},355:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var r=n(7),o=n(381),i=n(146),a=n(20),s=n(848),c=function(e,t,n,r,o){return!!e&&((null==n?void 0:n.selectedCardId)===(null==r?void 0:r.draftId)&&t===a.a.HalfPane&&void 0===o)},d=function(e,t,n,a,c){if((r.rb()||a)&&n&&Object(o.a)(e,a)===i.a.CannotAutoDiscard){var d=null!=c?c:Object(s.a)(e,t.renderContextType,a);return function(e,t){return n(d,e,t)}}}},358:function(e,t,n){"use strict";var r=n(3),o=n(159),i=n(296),a=n(21),s=n(7),c=n(58),d=n(545),u=n(16),l=n(8);function f(e,t){return function(n,f){if(s.z()){var m=c.d(f());return Object(i.a)(m)&&Object(o.b)(t)?m.setDisplayConfiguration(t).then((function(t){return n(function(e,t){return Object(u.b)(l.a.ViewContainerDisplayConfigurationChangedType,{displayConfiguration:t},e)}(e,t)),Promise.resolve(t)})).catch((function(e){return function(e){Object(a.b)(e)?Object(r.g)().assertConditionTag(!1,e.message,578426816):Object(r.g)().assertConditionTag(!1,"Unknown error in requestDisplayConfigurationThunk when setting HalfPane display mode "+e,578426817);return Promise.resolve(void 0)}(e)})):Promise.reject(new a.a("Not half pane or half pane configuration",-2130957557))}var p=Object(d.a)(e,t);return n(p),p.payload.completion||Promise.reject(new a.a("requestDisplayConfiguration was not provided a completion from middleware.",-2130957557))}}n.d(t,"a",(function(){return f}))},37:function(e,t,n){"use strict";var r;!function(e){e[e.SharedComments=0]="SharedComments",e[e.Canvas=1]="Canvas"}(r||(r={})),t.a=r},381:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(111),o=n(146),i=n(7),a=n(39),s=n(18),c=n(15);function d(e,t){if(i.rb()){if(!Object(a.c)(e,t))return o.a.NoDraft;if(!u(e,t))return o.a.CannotAutoDiscard}else{if(void 0===t||!Object(a.c)(e,t))return o.a.NoDraft;if(!u(e,t)||Object(s.m)(t.selectionDetails))return o.a.CannotAutoDiscard}var n=Object(c.H)(e);return n&&Object(r.j)(n.commentDraft.sessionConfiguration)?o.a.CannotAutoDiscard:o.a.CanAutoDiscard}function u(e,t){if(!i.rb()){if(!t)return!1;var n=e.drafts[e.cardIdToDraftIdMap[t.selectedCardId]];return!!(null==n?void 0:n.isDraftEmpty)}var r=Object(c.F)(e),o=r?e.drafts[e.cardIdToDraftIdMap[r]]:void 0;return!!(null==o?void 0:o.isDraftEmpty)}},382:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(76);function o(e){return!e.pendingCommentLoad||e.pendingCommentLoad.numberOfComments===e.commentData.length||!!e.virtualized&&(0!==e.commentData.length&&(void 0===e.pendingCommentLoad.selectedThreadIndex||e.pendingCommentLoad.selectedThreadIndex>=e.pendingCommentLoad.numberOfThreads||e.pendingCommentLoad.selectedThreadIndex<e.commentData.filter(r.a).length))}},384:function(e,t,n){"use strict";var r=n(3),o=n(21),i=n(87),a=n(0),s=function(){function e(e){this.localizationDetails=e}return e.prototype.isMac=function(){return window&&window.navigator&&window.navigator.userAgent.indexOf("Macintosh")>0},e.prototype.getLocaleInfo=function(){return{isRightToLeft:this.localizationDetails.isRightToLeft||!1,appLocale:this.localizationDetails.appLocale||"en-us"}},e.prototype.getString=function(e){var t=this.getStringOrUndefined(e);if(void 0===t)throw new o.a(i.l,-2130957554);return t},e.prototype.getStringOrUndefined=function(e){switch(e){case 1:return CommentPaneStrings.EditButtonText;case 2:return CommentPaneStrings.DeleteButtonText;case 120:return CommentPaneStrings.ContextMenuEditButtonText;case 121:return CommentPaneStrings.ContextMenuDeleteButtonText;case 3:return CommentPaneStrings.ResolveThreadButtonText;case 4:return CommentPaneStrings.ReopenThreadButtonText;case 5:return CommentPaneStrings.DeleteThreadButtonText;case 6:return CommentPaneStrings.GoToFirstCommentGhostCardText;case 7:return CommentPaneStrings.GoToNextCommentGhostCardText;case 8:return CommentPaneStrings.ReturnToFirstCommentGhostCardText;case 9:return CommentPaneStrings.View1MoreReplyExpandButtonText;case 10:return CommentPaneStrings.ViewNMoreRepliesExpandButtonText;case 106:return CommentPaneStrings.OneMoreReplyExpandButtonText;case 107:return CommentPaneStrings.NMoreRepliesExpandButtonText;case 11:return CommentPaneStrings.ReplyBoxPlaceholderText;case 12:return CommentPaneStrings.ReplyBoxPlaceholderTextNoMentions;case 13:return CommentPaneStrings.EmptyPaneMessage;case 14:return CommentPaneStrings.SaveButtonText;case 15:return CommentPaneStrings.CancelButtonText;case 16:return CommentPaneStrings.NewThreadPlaceholderText;case 17:return CommentPaneStrings.NewThreadPlaceholderTextNoMentions;case 21:return CommentPaneStrings.NormalPostA11yLabel;case 145:return CommentPaneStrings.NewNormalPostA11yLabel;case 122:return CommentPaneStrings.NormalPostBodyA11yLabel;case 22:return CommentPaneStrings.ResolvedPostA11yLabel;case 136:return CommentPaneStrings.NewResolvedPostA11yLabel;case 23:return CommentPaneStrings.EditingPostA11yLabel;case 24:return CommentPaneStrings.NewPostA11yLabel;case 25:return CommentPaneStrings.ReadOnlyPostA11yLabel;case 137:return CommentPaneStrings.NewReadOnlyPostA11yLabel;case 26:return CommentPaneStrings.LowFidelityWarningPostA11yLabel;case 27:return CommentPaneStrings.NormalCardA11yLabel;case 29:return CommentPaneStrings.ResolvedCardA11yLabel;case 30:return CommentPaneStrings.ReadOnlyCardA11yLabel;case 28:return CommentPaneStrings.DraftCardA11yLabel;case 31:return CommentPaneStrings.PaneA11yLabel;case 32:return CommentPaneStrings.ListA11yLabel;case 33:return CommentPaneStrings.EditorA11yLabel;case 18:return CommentPaneStrings.PaneHeaderLabel;case 19:return CommentPaneStrings.CloseButtonTitle;case 20:return CommentPaneStrings.ClosePaneA11yLabel;case 35:return CommentPaneStrings.LowFidelityWarningOnEdit;case 36:return CommentPaneStrings.LowFidelityWarningOnDelete;case 37:return CommentPaneStrings.ProceedButtonText;case 38:return CommentPaneStrings.PostSaveA11yLabel;case 39:return CommentPaneStrings.PostCancelEditA11yLabel;case 40:return CommentPaneStrings.PostEditA11yLabel;case 41:return CommentPaneStrings.PostDeleteA11yLabel;case 42:return CommentPaneStrings.PostProceedEditA11yLabel;case 43:return CommentPaneStrings.PostCancelDeleteA11yLabel;case 45:return CommentPaneStrings.CardContextMenuA11yLabel;case 123:return CommentPaneStrings.PostContextMenuA11yLabel;case 46:return CommentPaneStrings.CardCancelDraftA11yLabel;case 47:return CommentPaneStrings.PostCancelDraftA11yLabel;case 48:return CommentPaneStrings.SendButtonText;case 49:return CommentPaneStrings.CardSendReplyA11yLabel;case 83:return CommentPaneStrings.CardPostCommentA11yLabel;case 50:return CommentPaneStrings.ReplyBoxContainerA11yLabel;case 55:return CommentPaneStrings.ReplyBoxA11yDescription;case 56:return CommentPaneStrings.EditorBoxA11yDescription;case 57:return CommentPaneStrings.PeoplePickerSearching;case 58:return CommentPaneStrings.PeoplePickerTypeToSearch;case 59:return CommentPaneStrings.PeoplePickerSearchDirectory;case 60:return CommentPaneStrings.PeoplePickerTopNResults;case 61:return CommentPaneStrings.PeoplePickerNoResultsFound;case 62:return CommentPaneStrings.PeoplePickerSuggestedContactsHeader;case 73:return CommentPaneStrings.PeoplePickerLoading;case 63:return CommentPaneStrings.DeleteCommentThreadA11yUpdate;case 64:return CommentPaneStrings.CancelledReplyA11yUpdate;case 103:return CommentPaneStrings.CancelledCommentDraftA11yUpdate;case 65:return CommentPaneStrings.DeletedCommentPostA11yUpdate;case 66:return CommentPaneStrings.CancelledEditingA11yUpdate;case 67:return CommentPaneStrings.SavedCommentA11yUpdate;case 124:return CommentPaneStrings.ResolveCommentThreadA11yUpdate;case 125:return CommentPaneStrings.ReopenCommentThreadA11yUpdate;case 68:return CommentPaneStrings.DiscardDialogTitle;case 69:return CommentPaneStrings.DiscardDialogBody;case 70:return CommentPaneStrings.DiscardDialogAbandon;case 71:return CommentPaneStrings.DiscardDialogResume;case 88:return CommentPaneStrings.EditCommentEditorA11yLabel;case 89:return CommentPaneStrings.ReplyCommentEditorA11yLabel;case 90:return CommentPaneStrings.NewCommentEditorA11yLabel;case 91:return CommentPaneStrings.NewCommentButtonText;case 92:return CommentPaneStrings.NewCommentButtonA11yLabel;case 108:return CommentPaneStrings.ReplyBoxDisabledPlaceholderText;case 109:return CommentPaneStrings.FinishEditingCommentText;case 110:return this.isMac()?CommentPaneStrings.PostDraftWarningText_Mac:CommentPaneStrings.PostDraftWarningText;case 111:return CommentPaneStrings.TaskHeaderAssignedToText;case 112:return CommentPaneStrings.TaskFooterAssignText;case 113:return CommentPaneStrings.TaskFooterReassignText;case 114:return CommentPaneStrings.TaskItemAssignedToText;case 115:return CommentPaneStrings.TaskItemReassignedToText;case 116:return CommentPaneStrings.TaskItemCompletedText;case 117:return CommentPaneStrings.TaskItemReopenedText;case 118:return CommentPaneStrings.TaskItemScheduleText;case 119:return CommentPaneStrings.TaskItemUnknownText;case 184:return CommentPaneStrings.RetryButtonText;case 183:return CommentPaneStrings.ContentErrorMessage;case 126:return CommentPaneStrings.ResolveTaskButtonText;case 127:return CommentPaneStrings.TaskHeaderAssignedToYouText;case 128:return CommentPaneStrings.TaskAssignerPeoplePickerA11yLabel;case 129:return CommentPaneStrings.TaskHeaderCheckboxA11yLabel;case 130:return CommentPaneStrings.TaskHeaderResolvedCheckboxA11yLabel;case 131:return CommentPaneStrings.TaskHeaderAssignedToYouCheckboxA11yLabel;case 132:return CommentPaneStrings.TaskHeaderAssignedToYouResolvedCheckboxA11yLabel;case 133:return CommentPaneStrings.TaskHeaderUnassigned;case 135:return CommentPaneStrings.CommitErrorMessage;case 165:return CommentPaneStrings.NormalCardTaskToYouA11yLabel;case 166:return CommentPaneStrings.ReadOnlyCardTaskToYouA11yLabel;case 167:return CommentPaneStrings.ResolvedCardResolvedTaskToYouA11yLabel;case 168:return CommentPaneStrings.CardResolvedTaskToYouA11yLabel;case 160:return CommentPaneStrings.NormalCardTaskA11yLabel;case 161:return CommentPaneStrings.ReadOnlyCardTaskA11yLabel;case 162:return CommentPaneStrings.DraftCardTaskA11yLabel;case 163:return CommentPaneStrings.ResolvedCardResolvedTaskA11yLabel;case 164:return CommentPaneStrings.CardResolvedTaskA11yLabel;case 169:return CommentPaneStrings.NormalCardTaskUnassignedA11yLabel;case 170:return CommentPaneStrings.ReadOnlyCardTaskUnassignedA11yLabel;case 171:return CommentPaneStrings.ResolvedCardResolvedTaskUnassignedA11yLabel;case 172:return CommentPaneStrings.CardResolvedTaskUnassignedA11yLabel;case 173:return this.isMac()?CommentPaneStrings.PostCommentTooltip_Mac:CommentPaneStrings.PostCommentTooltip;case 174:return this.isMac()?CommentPaneStrings.SendButtonTooltip_Mac:CommentPaneStrings.SendButtonTooltip;case 175:return CommentPaneStrings.CancelButtonTooltip;case 176:return CommentPaneStrings.ReopenTaskTooltip;case 177:return CommentPaneStrings.NewCommentButtonTooltip;case 178:return CommentPaneStrings.CommitButtonAssignTooltip;case 179:return CommentPaneStrings.ReplyButtonReassignTooltip;case 180:return CommentPaneStrings.TaskAssignedToYouTooltip;case 181:return CommentPaneStrings.TaskUnassignedTooltip;case 182:return CommentPaneStrings.TaskAssignerChevronTooltip;case 203:return CommentPaneStrings.SmartReplyPickerHeader;case 204:return CommentPaneStrings.TaskUnassignedHistoryString;case 202:return CommentPaneStrings.TaskHeaderResolved;case 197:return CommentPaneStrings.ResolvedCommentCardLabel;case 206:return CommentPaneStrings.DeleteTaskButtonText;default:return}},e.prototype.getStringWithStandardPlaceholders=function(e){return this.getString(e)},e.prototype.getStringWithStandardPlaceholdersOrUndefined=function(e){return this.getStringOrUndefined(e)},e.prototype.formatString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.toFormattedString(!1,Object(a.__spread)([this.getString(e)],t))},e.prototype.toFormattedString=function(e,t){for(var n="",r=t[0],o=0;;){var i=r.indexOf("{",o),a=r.indexOf("}",o);if(i<0&&a<0){n+=r.slice(o);break}if(a>0&&(a<i||i<0))n+=r.slice(o,a+1),o=a+2;else if(n+=r.slice(o,i),o=i+1,"{"!==r.charAt(o)){if(a<0)break;var s=r.substring(o,a),c=s.indexOf(":"),d=parseInt(c<0?s:s.substring(0,c),10)+1,u=c<0?"":s.substring(c+1),l=t[d];null==l&&(l=""),n+=l.toFormattedString?l.toFormattedString(u):e&&l.localeFormat?l.localeFormat(u):l.format?l.format(u):l.toString(),o=a+1}else n+="{",o++}return n},e}();n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var c=void 0;function d(){if(!c)throw new o.a(i.h,-2130957552);return c}function u(e){return Object(r.g)().assertConditionTag(void 0===c,"LocalizationAPI has already been initialized",595870274),void 0===c&&(c=new s(e)),c}},39:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"l",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"i",(function(){return C})),n.d(t,"j",(function(){return y})),n.d(t,"m",(function(){return v}));var r,o=n(0),i=n(7),a=n(18);function s(e){return{forceCardExpanded:e.forceCardExpanded,isDraftEmpty:e.isDraftEmpty,savedDraftContent:e.savedDraftContent,draftWarningState:e.draftWarningState,currentMentionees_deprecated:e.currentMentionees_deprecated,currentMentionees:e.currentMentionees,selectedTaskAssignee:e.selectedTaskAssignee,smartReplies:e.smartReplies}}function c(e){return Object.keys(e.drafts)}function d(e){if(!i.rb())return c(e).length;var t=0;for(var n in e.drafts)e.drafts.hasOwnProperty(n)&&++t;return t}function u(){return{drafts:{},cardIdToDraftIdMap:{},postIdToDraftIdMap:{},pendingDraft:void 0}}function l(e,t){return i.rb()?d(e)>0:!(!t||t.selectionDetails.editingSession_deprecated!==a.a.CommitPending&&t.selectionDetails.editingSession_deprecated!==a.a.Active&&t.selectionDetails.editingSession_deprecated!==a.a.DiscardPending)}function f(e,t){return l(e,t)||p(e,t)}function m(e,t){return!i.Hb()&&f(e,t)}function p(e,t){return i.qb()?void 0!==e.pendingDraft:!!t&&t.selectionDetails.editingSession_deprecated===a.a.SessionRequestPending}function g(e,t){var n,r;try{for(var i=Object(o.__values)(c(e)),a=i.next();!a.done;a=i.next()){var s=a.value;if(e.drafts[s].pendingState===t)return!0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1}function h(e,t){return i.qb()?g(e,r.None):!!t&&t.selectionDetails.editingSession_deprecated===a.a.Active}function C(e,t){return i.qb()?g(e,r.Commit):!!t&&t.selectionDetails.editingSession_deprecated===a.a.CommitPending}function y(e,t){return i.qb()?g(e,r.Discard):!!t&&t.selectionDetails.editingSession_deprecated===a.a.DiscardPending}function v(e,t,n,r){return i.qb()?y(e)&&h(t):!(!n||!r)&&(n.selectionDetails.editingSession_deprecated===a.a.DiscardPending&&r.selectionDetails.editingSession_deprecated===a.a.Active)}!function(e){e[e.None=0]="None",e[e.Discard=1]="Discard",e[e.Commit=2]="Commit"}(r||(r={}))},392:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(185),o=n(20);function i(e){switch(e){case r.b.HalfPane:return o.a.HalfPane;case r.b.FullPane:default:return o.a.FullPane}}},393:function(e,t,n){"use strict";function r(e){return"object"==typeof e&&void 0!==e.message&&void 0!==e.SDXHostAPIErrorCode}n.d(t,"a",(function(){return r}))},394:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(9),o=n(3),i=n(113),a=n(146),s=n(28),c=n(381),d=n(39),u=n(187),l=n(11),f=n(16),m=n(323),p=n(606);function g(e,t,n){return function(g,h){var C=h(),y=l.i(C),v=l.p(C),b=Object(o.g)().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,o.a.None,o.b.NecessaryServiceDataEvent),T=Object(d.i)(y,v);b.addDataField(s.a.Trackback,e.trackback,o.c.SystemMetadata),b.addDataField(s.a.RenderContextType,e.renderContextType,o.c.SystemMetadata),b.addDataField(s.a.CommitPendingAttemptedCancel,T,o.c.SystemMetadata),b.addDataField(s.a.ActionSource,t,o.c.SystemMetadata);var I=Object(c.a)(y,v);return I===a.a.CanAutoDiscard?g(Object(p.a)(e,t,!1)).then((function(e){return{draftDiscardResult:e,draftDiscardBehavior:I}})):(void 0!==n&&I===a.a.CannotAutoDiscard&&g(Object(m.a)({draftWarningType:u.a.ReturnToDraft,draftWarningReason:n},Object(f.a)(e,r.d.reserveTag(591728722)))),Promise.resolve({draftDiscardResult:i.a.Canceled,draftDiscardBehavior:I}))}}},40:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o={WHITE:"#FFFFFF",GRAY_A:"#F3F3F3",GRAY_B:"#E6E6E6",GRAY_C:"#D2D2D2",GRAY_C2:"#C6C6C6",GRAY_C3:"#B1B1B1",GRAY_D:"#969696",GRAY_E:"#666666",GRAY_F:"#505050",GRAY_H:"#363636",GRAY_H2:"#333333",GRAY_I:"#262626",GRAY_J:"#0A0A0A",BLACK:"#000000",GRAY_20:"#F3F2F1",GRAY_30:"#EDEBE9",GRAY_40:"#E1DFDD",GRAY_50:"#D2D0CE",GRAY_60:"#C8C6C4",GRAY_70:"#BEBBB8",GRAY_100:"#979593",GRAY_110:"#8A8886",GRAY_130:"#605E5C",GRAY_140:"#484644",GRAY_150:"#3B3A39",GRAY_160:"#323130",GRAY_180:"#252423",GRAY_200:"#1B1A19"},i={FIRST_RUN_GRAY:"#f7f7f7",COMMENTS_PURPLE:"#9C44A6",COMMENTS_GRAY:"#EAEAEA",FLUENT_RESOLVED:"#7E7969",DOT_BLUE:"#006BFF",WARNING_RED:"#A80000",CHECKBOX_GREEN:"#31752F",CHECKBOX_HOVERED_GREEN:"#255924",COLLAPSED_RESOLVED_BODY:o.GRAY_20,RESOLVED_TEXT:o.GRAY_110,ACTIVE_COMMENT_TEXT:o.GRAY_H2},a=Object(r.__assign)(Object(r.__assign)({},o),i)},403:function(e,t,n){"use strict";var r=n(0),o=n(84);var i=n(435);n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a,s={parentId:"",commentId:"",author:{UserId:"",Provider:"",DisplayName:void 0,Email:void 0,IsCurrentUser:void 0},anchorHintText:"",commentFlags:0,commentBody:(a=new i.a,a.insert(""),a.toJSON())};function c(e,t){for(var n=null==t?void 0:t(),r=[],i=0,a=void 0;i<e.length;){if(e[i].type===o.a.Thread){var s=e[i].id;a=s,r.push(u(s,void 0,n))}else r.push(u(e[i].id,a,n));i++}return r}function d(e){return e.map((function(e){return u(e,void 0,void 0)}))}function u(e,t,n){var o=void 0;n&&(o=n.commentData.find((function(t){return t.commentId===e})));return o||Object(r.__assign)(Object(r.__assign)({},s),{commentId:e,parentId:t||""})}},410:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(9),o=n(605),i=n(14),a=n(297);function s(e,t,n,s,c,d,u){n(Object(a.a)(d,e,s,c,t,void 0)).catch((function(e){Object(o.a)(e,r.d.reserveTag(591397647)),n(Object(i.f)(u,s,e))}))}},411:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e,t){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),e&&(this.mockId=e),t&&(this.mockContents=t)}return e.prototype.getId=function(){return this.mockId},e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e}()},413:function(e,t,n){"use strict";var r,o=n(351);!function(e){e[e.Invalid=0]="Invalid",e[e.DataReceived=1]="DataReceived"}(r||(r={})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var i={sendCodeMarker:function(e){},onStartEvent:new o.EventImpl((function(){})),onStopEvent:new o.EventImpl((function(){}))}},419:function(e,t,n){"use strict";var r=n(163),o=n(3),i=n(157),a=n(110),s=n(21),c=n(87),d=n(7),u=n(187),l=n(18),f=n(424),m=n(139);n(140),n(20);function p(e,t,n){var r=n&&d.ab()?t-1:t-2;if(r<1)throw new s.a(c.g,-2130957559);var o=d.l();return 1===r?o?e.getString(106):e.getString(9):o?e.formatString(107,String(r)):e.formatString(10,String(r))}function g(e,t,n){if(t<2)throw new s.a(c.g,-2130957559);return t-1==1?e.formatString(200,n):e.formatString(201,n,String(t-1))}function h(e,t){switch(t){case i.a.AtFinishNextCommentIsFirst:return e.getString(8);case i.a.AtStartNextCommentIsFirst:return e.getString(6);case i.a.MoreCommentsUpcoming:case i.a.DocumentHasComments:return e.getString(7);case i.a.NoComments:case i.a.Unknown:default:return""}}function C(e,t,n,r){return n?t?e.getString(16):e.getString(17):d.O()&&void 0!==r&&r!==m.a.InCard?e.getString(108):t?e.getString(11):e.getString(12)}function y(e,t){switch(t){case u.a.ReturnToDraft:return e.getString(110);case u.a.GrantAccessFailedSilently:return e.getString(134);case u.a.CommitFailed:return e.getString(135);case u.a.None:return Object(o.g)().assertConditionTag(!1,"Invalid DraftWarningType: "+t,595686755),""}}function v(e){return e.getString(112)}function b(e){return e.getString(113)}function T(e,t){return void 0===t&&(t=!0),t?e.getStringWithStandardPlaceholders(112):e.getStringWithStandardPlaceholders(113)}function I(e,t){return t?Object(l.h)(t)?e.getString(35):Object(l.e)(t)?e.getString(36):"":""}n.d(t,"u",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"g",(function(){return C})),n.d(t,"f",(function(){return y})),n.d(t,"l",(function(){return v})),n.d(t,"m",(function(){return b})),n.d(t,"o",(function(){return T})),n.d(t,"i",(function(){return I})),n.d(t,"a",(function(){return S})),n.d(t,"e",(function(){return j})),n.d(t,"j",(function(){return D})),n.d(t,"b",(function(){return w})),n.d(t,"k",(function(){return _})),n.d(t,"p",(function(){return x})),n.d(t,"q",(function(){return E})),n.d(t,"t",(function(){return P})),n.d(t,"s",(function(){return A})),n.d(t,"d",(function(){return k})),n.d(t,"n",(function(){return R})),n.d(t,"r",(function(){return F}));var O=Object(r.e)((function(){try{(new Date).toLocaleDateString("i")}catch(e){return"RangeError"===e.name}return!1}));function S(e,t){var n=O();try{if(n){var r={hour:"numeric",minute:"2-digit",day:"numeric",month:"long",year:"numeric",timeZone:void 0};return e.toLocaleDateString(t,r)}return Object(o.g)().assertConditionTag(!1,"The locale and options arguments are not supported",595882385),e.toLocaleDateString()}catch(r){return Object(o.g)().assertConditionTag(!1,"LocaleDateString conversion failed: "+r.name+", locale: "+t+", areLocaleAndOptionsArgumentsSupported: "+n+", Date: "+e.toString(),595953050),""}}function j(e){return{body:e.getString(69),title:e.getString(68),confirmButton:e.getString(70),cancelButton:e.getString(71)}}function D(e){return d.G()?{loading:e.getString(94),error:e.getString(95),limitedResults:e.getString(96),emptyResults:e.getString(93),suggestionsAnnouncement:e.getString(97),pickerModePlaceholderText:" ",useThisAddress:"",selectedSuggestionAccessibilityLabel:e.getStringOrUndefined(198)||"",selectedSuggestionNumberAccessibilityLabel:e.getStringOrUndefined(199)||""}:{isRTL:e.getLocaleInfo().isRightToLeft,noResultsFound:e.getString(61),searchDirectory:e.getString(59),searching:e.getStringWithStandardPlaceholders(57),suggestedContactsHeader:e.getString(62),topNResults:e.getStringWithStandardPlaceholders(60),typeToSearch:e.getString(58),loading:e.getString(73),accessibilityOnShowAnnouncement:e.getStringOrUndefined(74),a11yLabelForSuggestion:e.getStringWithStandardPlaceholdersOrUndefined(86)}}function w(e,t){var n="";switch(e){case f.a.Draft:case f.a.DraftPreCommitPending:n=t.getString(90);break;default:n=t.getString(89)}return n}function _(e){return e.getString(122)}function x(e,t){return e.IsCurrentUser?t.getString(127):t.formatString(111,Object(a.g)(e))}function E(e,t,n){return e.IsCurrentUser?t?n.getString(132):n.getString(131):t?n.formatString(130,Object(a.g)(e)):n.formatString(129,Object(a.g)(e))}function P(e){return e.formatString(111,e.getString(133))}function A(e,t){return e?t.formatString(130,t.getString(133)):t.formatString(129,t.getString(133))}var k=Object(r.e)((function(e,t,n,r){var o=t===f.a.Draft||t===f.a.DraftPreCommitPending,i=Object(a.e)(r);return i?o?e.formatString(178,i):n?e.formatString(179,i):e.formatString(178,i):o?e.getString(173):e.getString(174)}));function R(e,t){return e?t.getString(176):t.getString(126)}function F(e,t,n){return e?n.getString(180):(null==t?void 0:t.DisplayName)?n.formatString(114,t.DisplayName):n.getString(181)}},424:function(e,t,n){"use strict";var r;!function(e){e[e.Draft=0]="Draft",e[e.Normal=1]="Normal",e[e.Reply=2]="Reply",e[e.ReadOnly=3]="ReadOnly",e[e.ReplyPostCommitPending=4]="ReplyPostCommitPending",e[e.ReplySessionRequestPending=5]="ReplySessionRequestPending",e[e.CardPostCommitPending=6]="CardPostCommitPending",e[e.DraftPreCommitPending=7]="DraftPreCommitPending",e[e.ReplyPreCommitPending=8]="ReplyPreCommitPending",e[e.Resolved=9]="Resolved",e[e.Loading=10]="Loading",e[e.LowFidelityWarningOnDeleteThread=11]="LowFidelityWarningOnDeleteThread"}(r||(r={})),t.a=r},429:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},435:function(e,t,n){"use strict";var r=n(0);!function(e){function t(t,n){var r,o=this,i="Error "+("0x"+((r=n)<0?4294967295+r+1:r).toString(16)+": ")+t+"\nStack:\n"+(new Error).stack;return(o=e.call(this,i)||this).errorCode=n,o}Object(r.__extends)(t,e)}(Error);n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c}));var o,i=function(){function e(){this.ops=[]}return e.prototype.insert=function(e,t,n){return this.ops.push({insert:e,attributes:t,optional:n}),this},e.prototype.toDelta=function(){return{ops:this.ops}},e.prototype.toJSON=function(){return JSON.stringify(this.toDelta())},e}();function a(e,t,n){return{fullName:e,email:t,resolveState:n}}function s(e){return c(JSON.parse(e))}function c(e){return e.ops?e.ops.map((function(e){return e.insert})).join(""):""}!function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"}(o||(o={}))},453:function(e,t,n){"use strict";var r=n(530);n.d(t,"a",(function(){return r.a}))},454:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));var r=n(529),o=n(157),i=n(120),a=n(293),s=n(330),c=n(392),d=n(15),u=n(602),l=n(620),f=n(39);function m(e){return{commentData:[],cardViewState:{},postViewState:{},selectedComment:void 0,pendingCommentLoad:void 0,contextState:{nextPopulatedContextDetails:o.a.Unknown,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:0},highlightedCommentId:void 0,topVisibleThreadId:void 0,createdCommentLie:void 0,virtualized:!1,selectedThreadIdBeforeCommentSession:void 0,personaIconPropertiesMap:{},draftState:Object(f.h)(),atMentionState:{capability:r.a.Unknown,authToken:void 0},wasDataReceived_deprecated:!1,capabilities:{resolve:!0},authToken:void 0,modelCapabilities:Object(d.m)(),appLocale:e,suggestionsDetails:void 0}}function p(e,t,n,r){return function(e,t,n,r){return{paneState:{viewContainer:e,componentTree:new s.a(Object(c.a)(e.containerType),r),visibilityState:t?i.a.Visible:i.a.Closed,initializationStatus:a.a.NotInitialized,focusTypeAfterContextChange:void 0,viewContainerDisplayConfiguration:void 0},contentExtensions:Object(u.b)(),taskState:Object(l.a)(),commentState:m(n)}}(e,t,n,r)}},455:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t,n){return Object(r.b)(o.a.BeginDraftingFailureType,{beginDraftingParams:t,errorInfo:n},e)}},456:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t,n){return Object(r.b)(o.a.BeginDraftingSuccessType,{draftDetails:t,draftRenderContextType:n},e)}},457:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e){return Object(r.b)(o.a.EndViewInitialization,{},e)}},458:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t){return Object(r.b)(o.a.LoadPersonaIconPropertiesType,{personaIconPropertiesMap:t},e)}},463:function(e,t,n){"use strict";n(90);n(200);var r=n(84),o=n(76),i=n(274);n(238);n.d(t,"b",(function(){return r.b})),n.d(t,"f",(function(){return r.o})),n.d(t,"a",(function(){return o.b})),n.d(t,"c",(function(){return i.a})),n.d(t,"e",(function(){return i.c})),n.d(t,"d",(function(){return i.b}))},464:function(e,t,n){"use strict";var r=n(0),o=n(9),i=n(3),a=n(213),s=n(173),c=n(14),d=n(37),u=n(297),l=n(147);var f,m=n(114),p=n(115);!function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.FailedSilently=2]="FailedSilently",e[e.DialogCanceled=3]="DialogCanceled"}(f||(f={}));var g=n(186),h=function(){function e(e){this.rawDelta=e,this._deserializedDelta=void 0,this._NumHyperlinks=0,this._hasRichTextFormatting=!1,this._users=[]}return Object.defineProperty(e.prototype,"NumHyperlinks",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._NumHyperlinks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Mentions",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._users},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HasRichTextFormatting",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._hasRichTextFormatting},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.rawDelta},e.prototype.parseDelta=function(){var e,t,n=this;this._deserializedDelta=JSON.parse(this.rawDelta),null===(t=null===(e=this._deserializedDelta)||void 0===e?void 0:e.ops)||void 0===t||t.forEach((function(e){var t;if(null==e?void 0:e.attributes){e.attributes.link&&(n._NumHyperlinks+=1);var r=e.attributes.atmention,o=e.optional;!r||void 0!==o&&void 0!==o.atmention||null===(t=n._users)||void 0===t||t.push({UserId:r.email,Provider:g.b}),(e.attributes.weight||e.attributes.italic||e.attributes.underline)&&(n._hasRichTextFormatting=!0)}}))},e}(),C=n(28),y=n(21),v=n(393),b=n(7),T=n(189),I=n(15),O=n(39),S=n(176),j=n(187),D=n(18),w=n(11),_=n(533),x=n(275),E=n(323);function P(e,t,n,r,a,s){return function(d,u){var l=Object(i.g)().createActivityObject("CommitComment",e.telemetryVisitor,i.a.None,i.b.NecessaryServiceDataEvent);l.addDocumentMetadata(i.e.Basic);var g=p.b[a.type],y=u(),v=u().taskState,P=w.r(y);if(void 0===P||P.commentDraft.sessionConfiguration.sessionType!==a.type)return l.failTag(593278784,-2130957522),Promise.resolve(T.a.CommitFailed);var k="",R=!1;switch(a.type){case m.b:k=a.commentId;break;case m.d:k=a.parentId,R=!0;break;case m.a:P&&(k=P.commentDraft.sessionConfiguration.draftId||"")}var F=w.p(y),N=!R||!!F&&(!Object(D.d)(F.selectionDetails)||(null==F?void 0:F.selectionDetails.expanded));if(l.addDataField(C.a.IsCardExpanded,N,i.c.SystemMetadata),(null==s?void 0:s.Task)&&!Object(I.b)(y.commentState.modelCapabilities)&&(Object(i.g)().assertConditionTag(!1,"Unexpected task assignment when Task Capability is disabled'",590435658),s.Task=void 0),(b.b()&&a.type===m.a||b.c()&&a.type===m.d)&&(l.addDataField(C.a.IsPreExistingTask,!!v.tasks[k],i.c.SystemMetadata,i.d.Critical),l.addDataField(C.a.AffectingTaskMetadata,!!(null==s?void 0:s.Task),i.c.SystemMetadata,i.d.Critical)),l.addDataField(C.a.SessionType,g,i.c.SystemMetadata),a.type!==m.a){var M=Object(I.e)(w.e(y),k);M.valid&&(l.addDataField(C.a.MatchesCommentAuthor,M.matchesCurrentUser,i.c.SystemMetadata),l.addDataField(C.a.CommentCreationTimeDeltaMs,M.timeElapsed,i.c.SystemMetadata))}l.addDataField(C.a.AssociatedCommentId,k,i.c.SystemMetadata),l.addDataField(C.a.AtMentionsEnabled,n,i.c.SystemMetadata),l.addDataField(C.a.Trackback,e.trackback,i.c.SystemMetadata),l.addDataField(C.a.RenderContextType,e.renderContextType,i.c.SystemMetadata);var V=w.i(y);return Object(O.i)(V,F)?Promise.resolve(T.a.CommitPending):(d(Object(_.a)(c.j(e,o.d.reserveTag(593278785)))),r().then((function(r){if(!n){var u=A(d,a,r,0,l,o.d.reserveTag(593278786),o.d.reserveTag(593278787),e,s);return Promise.resolve(u)}var m=new h(r),p=m.Mentions;l.addDataField(C.a.NumberOfMentionsAdded,p.length,i.c.SystemMetadata);var g=Object(i.g)();if(b.h()&&p.length>0&&g.logFloodgateActivity&&g.logFloodgateActivity("Office_Docs_SharedComments_CommitComment"),l.addDataField(C.a.NumberOfHyperlinks,m.NumHyperlinks,i.c.SystemMetadata),l.addDataField(C.a.CreateCommentWithRichFormatting,m.HasRichTextFormatting,i.c.SystemMetadata),!p.length){u=A(d,a,r,0,l,o.d.reserveTag(593278788),o.d.reserveTag(593278789),e,s);return Promise.resolve(u)}return t.grantUsersAccess(p).then((function(t){var n=function(e){var t=e.OperationResult;return"boolean"==typeof t?t:t===f.Success}(t),u=function(e){return!!e.Details&&e.Details.Canceled}(t);if(l.addDataField(C.a.AllUsersGrantedAccess,n,i.c.SystemMetadata),l.addDataField(C.a.ShareDialogCanceled,u,i.c.SystemMetadata),t.OperationResult===f.FailedSilently)return Object(o.g)("Check Access Phase failed - share dialog not shown"),l.failTag(593278790,-2130957561),d(Object(x.a)(c.j(e,o.d.reserveTag(593278791)))),d(Object(E.a)({draftWarningType:j.a.GrantAccessFailedSilently,draftWarningReason:S.a.GrantUsersAccessFailure},c.j(e,o.d.reserveTag(593278792)))),Promise.resolve(T.a.ShareFailed);if(u)return Object(o.g)("Share dialog was canceled by user"),l.successTag(593278793),d(Object(x.a)(c.j(e,o.d.reserveTag(593278794)))),Promise.resolve(T.a.ShareFailed);if(!n)return Object(o.g)("Not all users have been granted access - going back to initial state"),l.successTag(593278795),d(Object(x.a)(c.j(e,o.d.reserveTag(593278796)))),Promise.resolve(T.a.ShareFailed);var m=A(d,a,r,p.length,l,o.d.reserveTag(593278797),o.d.reserveTag(593278798),e,s);return Promise.resolve(m)}),(function(t){return l.failTag(593278799,-2130957561),Object(o.g)("Grant Users Access has failed",t),d(Object(x.a)(c.j(e,o.d.reserveTag(593278800)))),Promise.resolve(T.a.ShareFailed)}))}),(function(t){return l.failTag(593278801,-2130957539),d(Object(x.a)(c.j(e,o.d.reserveTag(593278802)))),Object(o.g)("getCommentBody failed",t),b.m()&&d(Object(E.a)({draftWarningReason:S.a.CommitFailure,draftWarningType:j.a.CommitFailed},c.j(e,o.d.reserveTag(593278803)))),Promise.resolve(T.a.CommitFailed)})))}}function A(e,t,n,r,a,s,d,u,f){var p=function(e,t,n,r,a){try{switch(t.type){case"CREATE":e(c.q(c.j(r,o.d.reserveTag(593278804)),{sessionType:t.type,data:{commentBody:n},metadataUpdates:a}));break;case"EDIT":e(c.q(c.j(r,o.d.reserveTag(593278805)),{sessionType:t.type,data:{commentBody:n,commentId:t.commentId}}));break;case"REPLY":e(c.q(c.j(r,o.d.reserveTag(593278806)),{sessionType:t.type,data:{commentBody:n,parentId:t.parentId},metadataUpdates:a}));break;default:return Object(i.g)().assertConditionTag(!1,"Unexpected session type '"+t.type+"'",593278807),e(Object(x.a)(c.j(r,o.d.reserveTag(593278808)))),-2130957532}}catch(t){if(!Object(y.b)(t)&&!Object(v.a)(t))throw t;return e(Object(x.a)(c.j(r,o.d.reserveTag(593278809)))),b.m()&&e(Object(E.a)({draftWarningReason:S.a.CommitFailure,draftWarningType:j.a.CommitFailed},c.j(r,o.d.reserveTag(593278810)))),Object(l.a)(t)}return}(e,t,n,u,f);return p?(a.failTag(d,p),T.a.CommitFailed):r?(t.type===m.a?(a.addDataField(C.a.CreateThreadWithMentions,!0,i.c.SystemMetadata,i.d.Critical),f&&f.Task&&a.addDataField(C.a.CreateThreadWithTaskAssigned,!0,i.c.SystemMetadata,i.d.Critical)):t.type===m.d&&(a.addDataField(C.a.CreateReplyWithMentions,!0,i.c.SystemMetadata,i.d.Critical),f&&f.Task&&a.addDataField(C.a.CreateReplyWithTaskAssigned,!0,i.c.SystemMetadata,i.d.Critical)),a.successTag(s),T.a.Success):(a.successTag(s),T.a.Success)}var k=n(394),R=n(606),F=n(159),N=n(270),M=n(20),V=n(535),L=n(457),U=n(358);var B=n(99),H=n(547);var z=n(276),W=n(410);function q(e,t){return{requestDeleteComment:function(t,n){e(c.E(t,n))},requestDeleteThread:function(t,n,r){e(c.F(t,n,r))},selectCommentCardExpand_deprecated:function(t,n,r){e(c.L(t,n,void 0,c.c.ExpandCard,r))},selectCommentCardCollapse_deprecated:function(t,n,r){e(c.L(t,n,void 0,c.c.CollapseCard,r))},selectCommentPost_deprecated:function(t,n,r,o){e(c.L(t,n,r,c.c.SelectPost,o))},requestReopenThread:function(t,n,r){e(c.H(t,n,r))},requestResolveThread:function(t,n,r){e(c.J(t,n,r))},requestEditCommentSession:function(n,r){Object(W.a)(t.commentAPI,t.peopleAPI,e,{sessionType:"EDIT",commentId:r},!1,n,c.j(n,o.d.reserveTag(593265930)))},requestReplyCommentSession:function(n,r){Object(W.a)(t.commentAPI,t.peopleAPI,e,{sessionType:"REPLY",threadId:r},!1,n,c.j(n,o.d.reserveTag(593265931)))},commitCommentAndFocus:function(n,r,o,i,a,s){return e(P(n,t.peopleAPI,i,r,o,s)).then((function(e){return e===T.a.ShareFailed&&t.focusManager.focusActiveEditor(o,a),e}))},discardDraftAsync:function(t,n,r,o){return e(Object(R.a)(t,n,r,o))},discardDraftIfEmpty:function(t,n,r){return e(Object(k.a)(t,n,r))},showLowFidelityWarning:function(t,n,r,o){e(c.P(t,n,r,o))},saveDraft:function(t,n,r){e(c.K(t,{draftId:n,draftContent:r}))},clearCommentHighlight:function(t,n){e(c.k(t,d.a.SharedComments,n))},clearCommentHighlight_deprecated:function(t){e(c.l(t,d.a.SharedComments))},getUserContacts:function(e,n,r){return t.peopleAPI.capabilities&a.a.GetContactsForMentions?t.peopleAPI.getContactsForMentions(e,n,r):(Object(i.g)().assertConditionTag(!1,"Attempted to retrieve contacts on API without capability.",593265932),Promise.resolve([]))},checkUserAccess:function(e){return t.peopleAPI.checkUserAccess(e)},updateCurrentMentionees_deprecated:function(t,n){e(c.S(t,n))},updateMentioneesStillInDraft:function(t,n){e(c.X(t,n))},addToCurrentMentionees:function(t,n){e(c.d(t,n))},updateSelectedTaskAssignee:function(t,n){e(c.Z(t,n))},displayDraftWarning:function(t,n,r){e(c.s({draftWarningType:n,draftWarningReason:r},t))},showPostErrorUI:function(t,n){e(c.Q(t,n))},clearPostErrorUI:function(t,n){e(c.o(t,n))},selectCommentCardAndShowLowFidelityWarning:function(t,n,r,o){e(function(e,t,n,r){return function(o,i){var a,s=i();(null===(a=w.p(s))||void 0===a?void 0:a.selectedCardId)!==t&&o(Object(B.b)(e,t,void 0,B.a.ExpandCard,d.a.SharedComments)),o(Object(H.a)(e,t,n,r))}}(t,n,r,o))},draftEmptinessChanged:function(t,n,r){e(c.t(t,r,n))},selectComment:function(t,n,r,o){return e(Object(z.b)(t,n,r,o))},requestUpdateCommentReactions:function(n,r,o,a){e(function(e,t,n,r,o){return function(){var a=Object(i.g)().createActivityObject("CommentReaction",e.telemetryVisitor,i.a.None,i.b.NecessaryServiceDataEvent);t.beginDraftingAsync(n).then((function(e){e.updateProperties("Reaction",{type:"Reaction",reactionType:r,isActive:o}),e.commit(),e.endDrafting(),a.successTag(587317280)})).catch((function(e){a.failTag(587317281,Object(l.a)(e))}))}}(n,t.commentAPI,{sessionType:"METADATA",threadId:r},o,a))}}}function G(e,t){return Object(r.__assign)(Object(r.__assign)({},q(e,t)),{cancelCommentPostEdit_deprecated:function(t,n,r){e(c.h(t,n,r))},cancelCommentReply_deprecated:function(t,n,r){e(c.i(t,n,r))},clearCurrentComments:function(t){e(c.n(t))},highlightComment:function(t,n){e(c.u(t,n,d.a.SharedComments))},requestCreateCommentSession:function(n){Object(W.a)(t.commentAPI,t.peopleAPI,e,{sessionType:"CREATE"},!1,n,c.j(n,o.d.reserveTag(593265933)))},discardDraftAndStartNewCommentSession:function(n){e(Object(u.a)(n,t.commentAPI,{sessionType:"CREATE"},!1,t.peopleAPI,void 0)).catch(Object(s.a)(o.d.reserveTag(592314377)))},commitComment_Deprecated:function(n,r,o,i){return e(P(n,t.peopleAPI,i,r,o))},queueLoadThreads:function(t,n){e(c.z(t,{threadIds:n}))},selectFirstThreadInNextCommentContext:function(t){e(c.N(t))},selectLastThreadInPreviousCommentContext:function(t){e(c.O(t))},nextPopulatedContextDetailsUpdated:function(t,n){e(c.w(t,n))},requestClosePane:function(t){e(c.D(t))},requestDisplayConfiguration:function(t,n){return e(Object(U.a)(t,n))},readyToRender:function(t){e(c.A(t))},requestModalConfirmation:function(t,n,r,o){e(c.G(t,n,r,o))},initializeView:function(n){e(function(e,t,n,r,a){return function(s){return s(Object(V.a)({renderContextType:e,trackback:o.d.reserveTag(595899542),telemetryVisitor:a})),t===N.a.NewThread?(e===M.a.HalfPane&&s(Object(U.a)({renderContextType:e,trackback:o.d.reserveTag(595899543),telemetryVisitor:a},{displayMode:F.a.Variable,desiredHeight:0})).catch((function(e){Object(y.b)(e)?Object(i.g)().assertConditionTag(!1,e.message,595645966):Object(i.g)().assertConditionTag(!1,"Unknown error in initializeViewThunk "+e,595645967)})),s(Object(u.a)({renderContextType:e,trackback:o.d.reserveTag(595898586),telemetryVisitor:a},n,{sessionType:"CREATE"},!1,r,void 0)).then((function(){s(Object(L.a)({renderContextType:e,trackback:o.d.reserveTag(595899545),telemetryVisitor:a}))}))):s(Object(L.a)({renderContextType:e,trackback:o.d.reserveTag(595899546),telemetryVisitor:a}))}}(n,t.initializationReason,t.commentAPI,t.peopleAPI,t.telemetryVisitor))},updateFocusTypeAfterContextChange:function(t,n){e(c.W(t,n))},updateRenderLocksForAllDrafts:function(t,n){e(c.T(t,n))}})}function Y(e,t){return Object(r.__assign)(Object(r.__assign)({},q(e,t)),{updateRenderLockForDraft:function(t,n,r){e(c.T(t,n,r))},highlightComment:function(n){e(c.u(n,t.resource.id,d.a.SharedComments))},requestDisplayConfiguration:function(n,r){return t.componentTree.renderContextType!==M.a.HalfPane?Promise.resolve(void 0):e(Object(U.a)(n,r))}})}n.d(t,"b",(function(){return G})),n.d(t,"a",(function(){return Y}))},465:function(e,t,n){"use strict";var r=n(453),o=(n(296),n(531),n(159)),i=(n(175),n(185));n.d(t,"a",(function(){return r.a})),n.d(t,"c",(function(){return i.a})),n.d(t,"b",(function(){return o.a})),n.d(t,"d",(function(){return o.b}))},476:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n(157),o=n(15),i=n(39),a=n(11),s=n(58),c=n(7);function d(e,t,n){return!!c.O()||!Object(i.d)(e,t)&&!n}function u(e){return!!e.selectedComment&&f(e.draftState,e.selectedComment)}function l(e){return function(e){var t=c.q()&&!s.b(e);return a.f(e).nextPopulatedContextDetails!==r.a.NoComments||Object(o.c)(a.e(e),t)}(e)&&f(a.i(e),a.p(e))}function f(e,t){return c.O()||!Object(i.d)(e,t)}},503:function(e,t,n){var r=n(429),o=n(341),i=n(645),a=n(1034),s=n(831),c=function(e,t,n){var d,u,l,f,m=e&c.F,p=e&c.G,g=e&c.S,h=e&c.P,C=e&c.B,y=p?r:g?r[t]||(r[t]={}):(r[t]||{}).prototype,v=p?o:o[t]||(o[t]={}),b=v.prototype||(v.prototype={});for(d in p&&(n=t),n)l=((u=!m&&y&&void 0!==y[d])?y:n)[d],f=C&&u?s(l,r):h&&"function"==typeof l?s(Function.call,l):l,y&&a(y,d,l,e&c.U),v[d]!=l&&i(v,d,f),h&&b[d]!=l&&(b[d]=l)};r.core=o,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},504:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},505:function(e,t,n){e.exports=!n(506)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},506:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},507:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r,o=n(3);function i(e){r=e}function a(e){r?r.announceToScreenReader(e):Object(o.g)().assertConditionTag(!1,"announceToScreenReader not registered",595632534)}var s=function(){function e(){}return e.prototype.setScreenReaderNotifier=function(e){e&&i(e)},e}(),c=function(){function e(){this.screenReaderNotifierManagerInstance=void 0}return e.prototype.getScreenReaderNotifierManagerInstance=function(){return this.screenReaderNotifierManagerInstance||(this.screenReaderNotifierManagerInstance=new s),this.screenReaderNotifierManagerInstance},e}()},508:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));n(95),n(105);var r="sharedcommentsdemo"===Object({NODE_ENV:"production"}).TEST_PAGE,o=!1,i=!1},529:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},530:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Indeterminate=1]="Indeterminate",e[e.SinglePortrait=2]="SinglePortrait",e[e.DoublePortrait=3]="DoublePortrait",e[e.SingleLandscape=4]="SingleLandscape",e[e.DoubleLandscape=5]="DoubleLandscape"}(r||(r={}))},531:function(e,t,n){"use strict";function r(e){return"function"==typeof e.getViewContainer}n.d(t,"a",(function(){return r}))},532:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t){return Object(r.b)(o.a.AddContentExtensionType,{extension:t},e)}},533:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e){return Object(r.b)(o.a.BeginProcessingCommitType,{},e)}},534:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e){return Object(r.b)(o.a.BeginProcessingDiscardType,{},e)}},535:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e){return Object(r.b)(o.a.BeginViewInitialization,{},e)}},536:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e){return Object(r.b)(o.a.CancelDiscardType,{},e)}},537:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t,n){return Object(r.b)(o.a.ClearCommentHighlightType,{actionSource:t,commentId:n},e)}},538:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t){return Object(r.b)(o.a.ClearCommentHighlightType_deprecated,{actionSource:t},e)}},539:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e){return Object(r.b)(o.a.ClearCommentSelectionType,{},e)}},540:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(16),o=n(8);function i(e,t){return Object(r.b)(o.a.CommitDraftType,t,e)}function a(e){switch(e.sessionType){case"CREATE":return"Create";case"REPLY":return"Reply";case"EDIT":return"Edit"}}},541:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t,n){return Object(r.b)(o.a.HighlightCommentType,{commentId:t,actionSource:n},e)}},542:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t,n){return Object(r.b)(o.a.LoadCommentType,{commentData:t,tasks:n},e)}},543:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t){return Object(r.b)(o.a.LoadVirtualizedCommentsType,{threadInfo:t},e)}},544:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t){return Object(r.b)(o.a.ReloadCommentsType,t,e)}},545:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t){return Object(r.b)(o.a.RequestDisplayConfigurationType,{displayConfig:t,completion:void 0},e)}},546:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t,n){return Object(r.b)(o.a.SessionRequestStartedAndLockSelectionType,{params:t,captureSelectedThreadIdBeforeSession:n},e)}},547:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t,n,i){return Object(r.b)(o.a.ShowLowFidelityWarningType,{commentId:t,lowFidelityWarningType:n,commentSessionState_deprecated:i},e)}},548:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t){return Object(r.b)(o.a.TopVisibleThreadChangedType,{threadId:t},e)}},549:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t){return Object(r.b)(o.a.UpdateAtMentionAuthTokenType,{authToken:t},e)}},550:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t){return Object(r.b)(o.a.UpdateContextStateType,{contextState:t},e)}},551:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(8);function i(e,t){return Object(r.b)(o.a.UpdateSuggestionsDetailsType,{details:t},e)}},572:function(e,t,n){"use strict";var r=n(22),o={LivePersonaPicker:{webSettingName:"LivePersonaPicker"},PersonaFeature:{webSettingName:"PersonaColor"},NewCommentButton:{webSettingName:"NewCommentButton"},DiscreteHostedComments:{webSettingName:"DiscreteHostedComments"},CommentsFluentUI:{webSettingName:"CommentsFluentUI"},RenderDHCInPane:{},CommentTasks:{webSettingName:"CommentTasks"},NoDiscardOnFocusLoss:{webSettingName:"NoDiscardOnFocusLoss"},NewDraftingUI:{webSettingName:"DiscreteHostedComments"},CommentsFluentUIV2:{webSettingName:"CommentsFluentUIV2"},TaskPaneWithNewInfrastructure:{webSettingName:"TaskPaneWithNewInfrastructure"},CommentTasksFromReply:{webSettingName:"CommentTasksFromReply"},NewModelState:{webSettingName:"NewModelState"},HeadlessBoot:{},HyperlinksInComments:{webSettingName:"HyperlinksInComments"},HyperlinksWithDisplayText:{webSettingName:"HyperlinksWithDisplayText"},ContentNavigation:{webSettingName:"ContentNavigation"},AtMentionFloodgateSurvey:{webSettingName:"AtMentionFloodgateSurvey"},NewTaskAssigneePayload:{webSettingName:"NewTaskAssigneePayload"},ExtendedDrafting:{},RichTextFormattingInWeb:{webSettingName:"RichTextFormattingInWeb"},SmartReplies:{webSettingName:"SmartReplies"},LogDraftCommentIdPair:{webSettingName:"LogDraftCommentIdPair"},CommentContextMenu:{webSettingName:"CommentContextMenu"},RichContentEditIntegrationInWeb:{webSettingName:"RichContentEditIntegration"},NewResolvedCardDesignInWeb:{webSettingName:"NewResolvedCardDesignInWeb"},NewSelectionInteractions:{},CommentReactions:{webSettingName:"CommentReactions"}};n.d(t,"b",(function(){return r.a})),n.d(t,"a",(function(){return o}))},58:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c}));var r=n(120),o=function(e){return e.paneState.visibilityState===r.a.Visible},i=function(e){return e.paneState.visibilityState!==r.a.Closed},a=function(e){return e.paneState.visibilityState},s=function(e){return e.paneState.componentTree},c=function(e){return e.paneState.viewContainer}},601:function(e,t,n){"use strict";function r(e){if(e){var t={};if(void 0!==e.isReadOnly&&(t.isReadOnly=e.isReadOnly),void 0!==e.nextPopulatedContextDetails&&(t.nextPopulatedContextDetails=e.nextPopulatedContextDetails),void 0!==e.commentThreadCounts&&(t.commentThreadCounts=e.commentThreadCounts||void 0),Object.keys(t).length)return t}}n.d(t,"a",(function(){return r}))},602:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(0),o=n(3),i=n(14);function a(){return{extensions:{}}}function s(e,t){switch(void 0===e&&(e={extensions:{}}),void 0===t&&(t=i.b),t.type){case i.a.AddContentExtensionType:return function(e,t){var n;Object(o.g)().assertConditionTag(void 0===e[t.payload.extension.provider.scope.renderMode],"Attempting to register extension on surface where extension is already registered. Overwriting previous registration.",594834317);var i=t.payload.extension;return Object(r.__assign)(Object(r.__assign)({},e),{extensions:Object(r.__assign)(Object(r.__assign)({},e.extensions),(n={},n[t.payload.extension.provider.scope.renderMode]={controller:i,priority:i.priority},n))})}(e,t);case i.a.RemoveContentExtensionType:return function(e,t){var n,o,i=Object(r.__assign)({},e.extensions);try{for(var a=Object(r.__values)(t.payload.renderModes),s=a.next();!s.done;s=a.next()){var c=s.value;delete i[c]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return Object(r.__assign)(Object(r.__assign)({},e),{extensions:i})}(e,t);case i.a.UpdateExtensionPriorityType:return function(e,t){var n=Object(r.__assign)({},e.extensions);for(var o in t.payload.updates)n[o]&&(n[o]=Object(r.__assign)(Object(r.__assign)({},n[o]),{priority:t.payload.updates[o]}));return Object(r.__assign)(Object(r.__assign)({},e),{extensions:n})}(e,t);default:return e}}},603:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(32),o=function(e){return e.contentExtensions.extensions},i=function(e,t){var n;return t.renderMode===r.d.Integrated?void 0!==(n=o(e)[t.renderMode])&&n.priority!==r.c.Disabled:t.renderMode===r.d.Isolated&&(void 0!==(n=o(e)[t.renderMode])&&n.controller.provider.getExtension(t.threadId).priority!==r.c.Disabled)}},604:function(e,t,n){"use strict";n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return C}));var r=n(3),o=n(32),i=n(300),a=n(76),s=n(21),c=n(87),d=n(7),u=n(15),l=n(39),f=n(139),m=n(20),p=n(347);function g(e,t,n){for(var r,o,a=new i.a(t,-1);!(o=a.next()).done;){var s=o.value.commentId,c=n[s];if((null==c?void 0:c.alternateId)===e||s===e)break}return null===(r=o.value)||void 0===r?void 0:r.commentId}function h(e,t,n,o,i){if(d.xb()){if(o&&(o.newComment.commentId===e||o.draftId===e))return{thread:[Object(p.a)(o)],isDraftThread:!0,draftThreadState:i};Object(r.g)().assertConditionTag(!i||!i.isInCurrentContext||"CREATE"!==i.commentDraft.sessionConfiguration.sessionType,"Bad Store State, missing lie for new draft requested.",579372370);var u=n||e;return{thread:t.filter((function(e){return Object(a.b)(e)===u})),isDraftThread:!1,draftThreadState:void 0}}var l=n||e,f=t.filter((function(e){return Object(a.b)(e)===l})),m=i,g=!1;if(!o||o.newComment.commentId!==e&&o.draftId!==e){if(m&&m.isInCurrentContext)throw Object(r.g)().assertConditionTag(!1,"Bad Store State, missing lie for new draft requested.",593786640),new s.a(c.b,-2130957556);m=void 0}else f=[Object(p.a)(o)],g=!0;return{thread:f,isDraftThread:g,draftThreadState:m}}function C(e,t,n,r,i,a){if(t.draftThreadState)return t.draftThreadState.renderContextType===m.a.None||t.draftThreadState.renderContextType===i?o.a.Enabled_ForcePrimary:o.a.Disabled;if(t.isDraftThread||t.thread.length>0)return a===f.a.InCard||a===f.a.InChildPost?o.a.Enabled_ForcePrimary:o.a.Enabled_Default;if(Object(l.k)(n,r))return o.a.Disabled;if(d.vb()){var s=Object(u.H)(n);if(s&&s.threadId===e)return o.a.Disabled}return o.a.Invalid}},605:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),o=n(21);function i(e,t){Object(o.b)(e)?Object(r.g)().assertConditionTag(!1,e.message,t):Object(r.g)().assertConditionTag(!1,"Unknown error in dispatch of discardDraftIfEmpty",t)}},606:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(9),o=n(3),i=n(14),a=n(114),s=n(113),c=n(28),d=n(39),u=n(18),l=n(11),f=n(16),m=n(534),p=n(536);function g(e,t,n,g){return function(h,C){var y=C(),v=Object(o.g)().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,o.a.None,o.b.NecessaryServiceDataEvent),b=l.i(y),T=l.p(y),I=Object(d.i)(b,T);v.addDataField(c.a.Trackback,e.trackback,o.c.SystemMetadata),v.addDataField(c.a.RenderContextType,e.renderContextType,o.c.SystemMetadata),v.addDataField(c.a.CommitPendingAttemptedCancel,I,o.c.SystemMetadata),v.addDataField(c.a.ActionSource,t,o.c.SystemMetadata);var O=function(e,t,n){var s=l.r(e),c=l.p(e);if(!s)return c&&Object(u.m)(c.selectionDetails)&&Object(u.k)(c)?{cancelAction:i.h(Object(f.a)(n,r.d.reserveTag(593278744)),c.selectionDetails.selectedPostId,t),sessionType:a.b}:-2130957522;var d=s.commentDraft.sessionConfiguration.sessionType;switch(s.commentDraft.sessionConfiguration.sessionType){case"CREATE":return{cancelAction:i.g(Object(f.a)(n,r.d.reserveTag(593278745)),t),sessionType:d};case"REPLY":return{cancelAction:i.i(Object(f.a)(n,r.d.reserveTag(593278746)),s.commentDraft.sessionConfiguration.threadId,t),sessionType:d};case"EDIT":return{cancelAction:i.h(Object(f.a)(n,r.d.reserveTag(593278747)),s.commentDraft.sessionConfiguration.commentId,t),sessionType:d};default:return Object(o.g)().assertConditionTag(!1,"Unexpected draft type",593278748),-2130957551}}(y,n,e);if("number"==typeof O)return v.failTag(r.d.reserveTag(593278749),O),Promise.resolve(s.a.Handled);var S=O.sessionType,j=O.cancelAction;return v.addDataField(c.a.ActiveSessionType,S,o.c.SystemMetadata),I||!Object(d.b)(b,T)&&!Object(u.i)(T)?(v.addDataField(c.a.DiscardUnnecessary,!0,o.c.SystemMetadata),v.successTag(593278755),Promise.resolve(s.a.Unhandled)):(v.addDataField(c.a.DiscardUnnecessary,!1,o.c.SystemMetadata),h(Object(m.a)(Object(f.a)(e,r.d.reserveTag(593278750)))),v.addDataField(c.a.DiscardDialogShown,!!g,o.c.SystemMetadata),g?g((function(){return h(j),v.addDataField(c.a.CancelledByUser,!1,o.c.SystemMetadata),v.successTag(593278751),s.a.Handled}),(function(){return v.addDataField(c.a.CancelledByUser,!0,o.c.SystemMetadata),v.successTag(593278752),h(Object(p.a)(Object(f.a)(e,r.d.reserveTag(593278753)))),s.a.Canceled})):(h(j),v.successTag(593278754),Promise.resolve(s.a.Handled)))}}},620:function(e,t,n){"use strict";var r=n(0),o=n(3),i=n(111),a=n(7),s=n(14),c=n(238);function d(){return{tasks:{}}}function u(e,t){if(void 0===e&&(e={tasks:{}}),void 0===t&&(t=s.b),!a.b())return e;switch(t.type){case s.a.LoadCommentType:return function(e,t){var n,o;if(!t.payload.tasks)return e;var i={};try{for(var a=Object(r.__values)(t.payload.tasks),s=a.next();!s.done;s=a.next()){var c=s.value;i[c.commentId]=c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return Object(r.__assign)(Object(r.__assign)({},e),{tasks:i})}(e,t);case s.a.ReloadCommentsType:return function(e,t){var n,o;if(!t.payload.tasks)return e;var i={};try{for(var a=Object(r.__values)(t.payload.tasks),s=a.next();!s.done;s=a.next()){var c=s.value;i[c.commentId]=c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return Object(r.__assign)(Object(r.__assign)({},e),{tasks:i})}(e,t);case s.a.CommentContextChangedType:return function(e){return Object(r.__assign)(Object(r.__assign)({},e),{tasks:{}})}(e);case s.a.ApplyCommentChangesType:return function(e,t){var n=Object(r.__assign)({},e.tasks);return t.payload.changes.forEach((function(e){if(e.type!==i.c.Unknown){var t=e.model.commentId;switch(e.type){case i.c.Delete:delete n[t];break;case i.c.Load:case i.c.Insert:case i.c.Modify:Object(o.g)().assertConditionTag(e.type===i.c.Modify||!n[e.model.commentId],"Task should not already be populated on initial load",593875215);var r=e.task;if(r){if(!function(e){return 0===e.history.length||e.history[0].records.length>0&&e.history[0].records[0].type===c.a.Create}(r))return void Object(o.g)().assertConditionTag(!1,"Invalid task payload - dropping task data",593875213);n[t]=r}else""===e.model.parentId&&n[t]&&delete n[t]}}else Object(o.g)().assertConditionTag(!1,"Unknown change type",593875214)})),Object(r.__assign)(Object(r.__assign)({},e),{tasks:n})}(e,t);default:return e}}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}))},645:function(e,t,n){var r=n(1028),o=n(1033);e.exports=n(505)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},646:function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},647:function(e,t,n){var r=n(341),o=n(429),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(1036)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},648:function(e,t,n){var r=n(834);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},649:function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},650:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RekaInstance=void 0;var r=n(651),o=function(){function e(){this.services={},this.factories={},this.nextNativePromiseId=0,this.nativePromises={},this.nativeBridge=void 0}return e.prototype.initBridge=function(e,t){this.nativeBridge=e,r.registerClasses.apply(void 0,t),this.nativeBridge.invokeNative({serviceName:"$RekaBridge",methodName:"init",value:"",promiseId:0})},e.prototype.getConstantJson=function(e,t){this.verifyNativeBridgePresent();var n=this.nativeBridge.RekaConstants;if(void 0!==n){var r=n[e];if(void 0!==r){var o=r[t];if(void 0!==o)return o}}throw new Error('Reka native service "'+e+'" must be registered before accessing it\'s constant property "'+t+'". This error also happens when the service implementation does not use the generated code from the correct (usually the latest) version of Reka service definition.')},e.prototype.InvokeNative=function(e,t,n){this.verifyNativeBridgePresent(),this.nativeBridge.invokeNative({serviceName:e,methodName:t,value:n,promiseId:0})},e.prototype.InvokeNativeAndReturn=function(e,t,n){var r=this;return new Promise((function(o,i){var a=++r.nextNativePromiseId;r.nativePromises[a]={onSuccess:function(e){return o(e)},onFailure:function(e){return i(e)}},r.nativeBridge?r.nativeBridge.invokeNative({serviceName:e,methodName:t,value:n,promiseId:a}):i("Native bridge is not initialized.")}))},e.prototype.RegisterService=function(e,t){this.factories[e]=t},e.prototype.invokeJavaScript=function(e){var t=this,n=e.serviceName,r=void 0===n?"":n,o=e.methodName,i=void 0===o?"":o,a=e.value,s=void 0===a?"":a,c=e.promiseId,d=void 0===c?0:c;if("$RekaBridge"===r)return this.invokeJavaScriptBridge(i,s,d);var u=(this.services[r]||(this.services[r]=this.factories[r]())).Invoke(i,s);this.nativeBridge&&u&&u.then&&u.then((function(e){return t.invokeNativeBridge("onSuccess",e,d)}),(function(e){return t.invokeNativeBridge("onFailure",e,d)}))},e.prototype.invokeNativeBridge=function(e,t,n){this.nativeBridge.invokeNative({serviceName:"$RekaBridge",methodName:e,value:t,promiseId:n})},e.prototype.invokeJavaScriptBridge=function(e,t,n){var r=this.nativePromises[n];r&&(delete this.nativePromises[n],r[e](t))},e.prototype.verifyNativeBridgePresent=function(){if(!this.nativeBridge)throw new Error("Native bridge is not initialized.")},e}();t.RekaInstance=new o},651:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerClasses=t.registerClass=t.RekaServiceRegistry=t.stringifyJson=t.parseJson=void 0;var r=n(652),o=n(650),i=n(351);function a(e,t){var n=e?JSON.parse(e):[];if(Array.isArray(n))return t?r.CustomTypeRegistry.validateParsedObj(n,t):n;throw new Error("Everything should be an array")}function s(e,t){if("object"==typeof t)for(var n=r.CustomTypeRegistry.getExternalTypeInfos(),o=0,i=Object.keys(n);o<i.length;o++){var a=n[i[o]];if(t instanceof a.typeConstructor){a.stringify&&(t=a.stringify(t));break}}return t}function c(e){if(Array.isArray(e))return 0===e.length?"":JSON.stringify(e,s);throw new Error("Everything should be an array")}function d(e){var t,n,r;if("string"!=typeof e){switch(e[0]){case"FireAndForgetMethod":return[(t=e)[0],void 0,t[1]];case"ReturnsPromiseMethod":return[(n=e)[0],[n[1]],n[2]];case"Event":case"Constant":return[(r=e)[0],[r[1]],void 0]}}return[e,void 0,void 0]}t.parseJson=a,t.stringifyJson=c;var u=function(){function e(e,t){this.service=e,this.methodInfos=t}return e.prototype.Invoke=function(e,t){var n,r=d(this.methodInfos[e])[2],o=(n=this.service)[e].apply(n,a(t,r));if(o&&o.then)return o.then((function(e){return c([e])}))},e}(),l=function(){function e(e,t){this.service=e,this.methodInfos=t}return e.prototype.Invoke=function(e,t){var n=d(this.methodInfos[e])[1];this.service[e].trigger(a(t,n)[0])},e}(),f=function(){function e(){this.nativeServices={}}return e.prototype.registerService=function(e){var t=e.serviceInfo,n=t[0],r=t[1],i=e.factory;o.RekaInstance.RegisterService(n,(function(){return new u(i(),r)}))},e.prototype.getNativeService=function(e){var t=e[0],n=e[1],r=this.nativeServices[t];if(!r){this.nativeServices[t]=r={};for(var s=!1,u={},f=function(e){var l=d(n[e]),f=l[0],m=l[1];switch(f){case"ReturnsPromiseMethod":r[e]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return o.RekaInstance.InvokeNativeAndReturn(t,e,c(n)).then((function(e){return a(e,m)[0]}))};break;case"FireAndForgetMethod":r[e]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return o.RekaInstance.InvokeNative(t,e,c(n))};break;case"Event":r[e]=new i.EventImpl((function(t){return r.updateEventListeners(e,t)})),s=!0;break;case"Constant":Object.defineProperty(r,e,{configurable:!1,enumerable:!0,get:function(){return void 0===u[e]&&(u[e]=a(o.RekaInstance.getConstantJson(t,e),m)[0]),u[e]}})}},m=0,p=Object.keys(n);m<p.length;m++){f(p[m])}s&&(r.updateEventListeners=function(e,n){o.RekaInstance.InvokeNative(t,e,n?"1":"0")},o.RekaInstance.RegisterService(t,(function(){return new l(r,n)})))}return r},e}();function m(e){t.RekaServiceRegistry.registerService({serviceInfo:e.ServiceInfo,factory:function(){return new e}})}t.RekaServiceRegistry=new f,t.registerClass=m,t.registerClasses=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach((function(e){return m(e)}))}},652:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomTypeRegistry=void 0;var r=n(1056),o=function(){function e(){this.typeInfos={},this.typeInfosCache=[],this.externalTypes={}}return e.prototype.constuctor=function(e){void 0===e&&(e=!1),this.throwOnError=e},e.prototype.registerTypeInfos=function(e){if(-1===this.typeInfosCache.indexOf(e)){this.typeInfosCache.push(e);for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],o=this.typeInfos[r];o?o!==e[r]&&this.handleError("There are two definitions of the same namespace and interface: "+r):this.typeInfos[r]=e[r]}}},e.prototype.getTypeInfo=function(e){var t=this.typeInfos[e];if(t)return t;this.handleError('CustomTypeInfo "'+e+'" not registered as a custom types.')},e.prototype.registerExternalTypeInfos=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];this.externalTypes[r]?this.handleError('The external type "'+r+'" is already defined.'):this.externalTypes[r]=e[r]}},e.prototype.getExternalType=function(e){return this.externalTypes[e]},e.prototype.getExternalTypeInfos=function(){return this.externalTypes},e.prototype.validateParsedObj=function(e,t){for(var n=0,o=Object.keys(t);n<o.length;n++){var i=o[n];e[i]=r.verifyType(e[i],t[i])}return e},e.prototype.setThrowOnError=function(e){this.throwOnError=e},e.prototype.handleError=function(e){if(this.throwOnError)throw new Error(e)},e}();t.CustomTypeRegistry=new o},67:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"}(r||(r={}));var o,i=n(322),a=n(751);!function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.Delete=46]="Delete",e[e.a=65]="a",e[e.b=66]="b",e[e.c=67]="c",e[e.d=68]="d",e[e.e=69]="e",e[e.f=70]="f",e[e.g=71]="g",e[e.h=72]="h",e[e.i=73]="i",e[e.j=74]="j",e[e.k=75]="k",e[e.l=76]="l",e[e.m=77]="m",e[e.n=78]="n",e[e.o=79]="o",e[e.p=80]="p",e[e.q=81]="q",e[e.r=82]="r",e[e.s=83]="s",e[e.t=84]="t",e[e.u=85]="u",e[e.v=86]="v",e[e.w=87]="w",e[e.x=88]="x",e[e.y=89]="y",e[e.z=90]="z",e[e.F6=117]="F6"}(o||(o={})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i.a})),n.d(t,"c",(function(){return a.a})),n.d(t,"d",(function(){return o}))},68:function(e,t,n){"use strict";n(3);var r=n(7);n(20);function o(e){return"_"+e.renderContextType+"_"+e.id}function i(e){return"cardEditor"+o(e)}function a(e){return"postEditor"+o(e)}function s(e){return"editorRoot_"+e}function c(e){return"postRoot"+o(e)}function d(e,t){return t?"draftCardRoot"+o(e):"cardRoot"+o(e)}function u(e){return e||"GhostCard"}function l(e){return"replyBoxDescription"+o(e)}function f(e){return"editorBoxDescription"+o(e)}function m(e){return"sendReplyButton"+o(e)}function p(e){return"cancelReplyButton"+o(e)}function g(e){return r.Cb()||r.l()?"cardContextMenu"+o(e):"lastCardElementRef"+o(e)}function h(e){return"postContextMenu"+o(e)}function C(e){return"renderableItemList"+o(e)}function y(e,t){return"actionBarButton_"+t+o(e)}function v(e){return"editorFocusContainer_"+e}function b(e){return"draftCancelButton"+o(e)}function T(e){return"innerReplyBoxContainer"+o(e)}function I(){return"firstPaneElement5F6E8B9B-F2EF-4238-B749-89D6F5F132DD"}function O(){return"closePaneButton2F313A40-4603-41E4-90DD-12E000896375"}function S(){return"lastPaneElement027D6A54-A6AB-4E26-B513-B6C202372EB7"}function j(){return"postFocusBar"}function D(e){return"viewMoreReply"+o(e)}function w(e){return"postTimeStamp"+o(e)}function _(e,t){return""+t.replace(/\s/g,"")+o(e)}function x(e){return"suggestionsList"+e}function E(e,t){return""+t.replace(/\s/g,"")+o(e)}function P(e){return"anchorHintText"+o(e)}function A(e){return"lowFidelityWarning"+o(e)}function k(){return"CommentsListScrollView"}function R(e){return"cardSideBar"+o(e)}function F(){return"EmptyCreatedCommentLie"}function N(){return"NewCommentButton"}function M(e){return"taskAssignerCheckbox"+o(e)}function V(e){return"cardTaskFooterPickerButton"+o(e)}function L(e){return"cardTaskTopperCheckbox"+o(e)}function U(e){return"cardTaskTopperDiv"+o(e)}function B(e){return"taskAssignerDiv"+o(e)}function H(){return"TaskChevronIcon"}function z(e){return"postWarning"+o(e)}function W(e){return"draftWarning"+o(e)}function q(e){return"truncationOverlay"+e}function G(){return"next-thread-button"}function Y(){return"previous-thread-button"}function K(e){return"loadingPlaceholder"+o(e)}function J(e){return"DiscreteHostedCommentRoot"+o(e)}function Q(e){return"CommentLikeButton"+o(e)}function X(){return"ReopenThread"}n.d(t,"e",(function(){return i})),n.d(t,"D",(function(){return a})),n.d(t,"u",(function(){return s})),n.d(t,"G",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"x",(function(){return u})),n.d(t,"N",(function(){return l})),n.d(t,"s",(function(){return f})),n.d(t,"O",(function(){return m})),n.d(t,"M",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"F",(function(){return h})),n.d(t,"K",(function(){return C})),n.d(t,"a",(function(){return y})),n.d(t,"t",(function(){return v})),n.d(t,"q",(function(){return b})),n.d(t,"g",(function(){return T})),n.d(t,"w",(function(){return I})),n.d(t,"l",(function(){return O})),n.d(t,"y",(function(){return S})),n.d(t,"E",(function(){return j})),n.d(t,"U",(function(){return D})),n.d(t,"H",(function(){return w})),n.d(t,"o",(function(){return _})),n.d(t,"A",(function(){return x})),n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return P})),n.d(t,"z",(function(){return A})),n.d(t,"n",(function(){return k})),n.d(t,"i",(function(){return R})),n.d(t,"v",(function(){return F})),n.d(t,"B",(function(){return N})),n.d(t,"P",(function(){return M})),n.d(t,"R",(function(){return V})),n.d(t,"j",(function(){return L})),n.d(t,"k",(function(){return U})),n.d(t,"Q",(function(){return B})),n.d(t,"S",(function(){return H})),n.d(t,"I",(function(){return z})),n.d(t,"r",(function(){return W})),n.d(t,"T",(function(){return q})),n.d(t,"C",(function(){return G})),n.d(t,"J",(function(){return Y})),n.d(t,"f",(function(){return K})),n.d(t,"p",(function(){return J})),n.d(t,"m",(function(){return Q})),n.d(t,"L",(function(){return X}))},680:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e.prototype.setContents=function(e){this.mockContents=e},e.prototype.getId=function(){return this.mockId},e}()},7:function(e,t,n){"use strict";n.d(t,"G",(function(){return i})),n.d(t,"V",(function(){return a})),n.d(t,"N",(function(){return s})),n.d(t,"q",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"Db",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"T",(function(){return f})),n.d(t,"O",(function(){return m})),n.d(t,"m",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"Q",(function(){return h})),n.d(t,"B",(function(){return C})),n.d(t,"d",(function(){return y})),n.d(t,"Fb",(function(){return v})),n.d(t,"h",(function(){return b})),n.d(t,"S",(function(){return T})),n.d(t,"t",(function(){return I})),n.d(t,"cb",(function(){return O})),n.d(t,"H",(function(){return S})),n.d(t,"hb",(function(){return j})),n.d(t,"bb",(function(){return D})),n.d(t,"f",(function(){return w})),n.d(t,"R",(function(){return _})),n.d(t,"Hb",(function(){return x})),n.d(t,"a",(function(){return E})),n.d(t,"F",(function(){return P})),n.d(t,"nb",(function(){return A})),n.d(t,"eb",(function(){return k})),n.d(t,"fb",(function(){return R})),n.d(t,"jb",(function(){return F})),n.d(t,"M",(function(){return N})),n.d(t,"lb",(function(){return M})),n.d(t,"W",(function(){return V})),n.d(t,"ob",(function(){return L})),n.d(t,"r",(function(){return U})),n.d(t,"mb",(function(){return B})),n.d(t,"gb",(function(){return H})),n.d(t,"Cb",(function(){return z})),n.d(t,"s",(function(){return W})),n.d(t,"Eb",(function(){return q})),n.d(t,"n",(function(){return G})),n.d(t,"v",(function(){return Y})),n.d(t,"rb",(function(){return K})),n.d(t,"I",(function(){return J})),n.d(t,"p",(function(){return Q})),n.d(t,"Ib",(function(){return X})),n.d(t,"sb",(function(){return Z})),n.d(t,"qb",(function(){return $})),n.d(t,"L",(function(){return ee})),n.d(t,"J",(function(){return te})),n.d(t,"Z",(function(){return ne})),n.d(t,"ib",(function(){return re})),n.d(t,"wb",(function(){return oe})),n.d(t,"ub",(function(){return ie})),n.d(t,"Gb",(function(){return ae})),n.d(t,"A",(function(){return se})),n.d(t,"K",(function(){return ce})),n.d(t,"kb",(function(){return de})),n.d(t,"yb",(function(){return ue})),n.d(t,"k",(function(){return le})),n.d(t,"e",(function(){return fe})),n.d(t,"Y",(function(){return me})),n.d(t,"o",(function(){return pe})),n.d(t,"g",(function(){return ge})),n.d(t,"X",(function(){return he})),n.d(t,"ab",(function(){return Ce})),n.d(t,"zb",(function(){return ye})),n.d(t,"P",(function(){return ve})),n.d(t,"pb",(function(){return be})),n.d(t,"vb",(function(){return Te})),n.d(t,"Bb",(function(){return Ie})),n.d(t,"U",(function(){return Oe})),n.d(t,"xb",(function(){return Se})),n.d(t,"D",(function(){return je})),n.d(t,"w",(function(){return De})),n.d(t,"y",(function(){return we})),n.d(t,"x",(function(){return _e})),n.d(t,"u",(function(){return xe})),n.d(t,"Jb",(function(){return Ee})),n.d(t,"C",(function(){return Pe})),n.d(t,"j",(function(){return Ae})),n.d(t,"E",(function(){return ke})),n.d(t,"z",(function(){return Re})),n.d(t,"tb",(function(){return Fe})),n.d(t,"i",(function(){return Ne})),n.d(t,"Ab",(function(){return Me})),n.d(t,"db",(function(){return Ve}));var r=n(25),o=n(22);function i(){return Object(o.a)().isFeatureEnabled("LivePersonaPicker")}function a(){return Object(o.a)().isFeatureEnabled("PersonaFeature")}function s(){return Object(o.a)().isFeatureEnabled("NewCommentButton")}function c(){return m()&&Object(o.a)().isFeatureEnabled("DiscreteHostedComments")}function d(){return Object(o.a)().isFeatureEnabled("CommentsFluentUI")}function u(){return Object(o.a)().isFeatureEnabled("RenderDHCInPane")}function l(){return d()&&Object(o.a)().isFeatureEnabled("CommentTasks")}function f(){return Object(o.a)().isFeatureEnabled("NoDiscardOnFocusLoss")}function m(){return Object(o.a)().isFeatureEnabled("NewDraftingUI")}function p(){return d()&&Object(o.a)().isFeatureEnabled("CommentsFluentUIV2")}function g(){return l()&&Object(o.a)().isFeatureEnabled("CommentTasksFromReply")}function h(){return Object(o.a)().isFeatureEnabled("NewModelState")}function C(){return Object(o.a)().isFeatureEnabled("HeadlessBoot")}function y(){return Object(o.a)().isFeatureEnabled("HyperlinksInComments")}function v(){return Object(o.a)().isFeatureEnabled("ContentNavigation")}function b(){return Object(o.a)().isFeatureEnabled("AtMentionFloodgateSurvey")}function T(){return l()&&Object(o.a)().isFeatureEnabled("NewTaskAssigneePayload")}function I(){return m()&&Object(o.a)().isFeatureEnabled("ExtendedDrafting")}function O(){return Object(o.a)().isFeatureEnabled("RichTextFormattingInWeb")}function S(){return Object(o.a)().isFeatureEnabled("LogDraftCommentIdPair")}function j(){return Object(o.a)().isFeatureEnabled("CommentContextMenu")}function D(){return h()&&Object(o.a)().isFeatureEnabled("RichContentEditIntegrationInWeb")}function w(){return Object(o.a)().isFeatureEnabled("SmartReplies")}function _(){return me()&&Ne()&&Object(o.a)().isFeatureEnabled("NewResolvedCardDesignInWeb")}function x(){return ie()&&ae()&&Object(o.a)().isFeatureEnabled("NewSelectionInteractions")}function E(){return Object(o.a)().isFeatureEnabled("CommentReactions")}function P(){return Object(o.a)().isFeatureEnabled("HyperlinksWithDisplayText")}function A(){return Object(o.a)().isChangeGateEnabled("UseAriaPlaceholder",Object(r.c)(4178140))}function k(){return Object(o.a)().isChangeGateEnabled("SaveDraftOnPending",Object(r.c)(4275061))}function R(){return Object(o.a)().isChangeGateEnabled("SelectWhileDraftingCrawl",Object(r.c)(4293379))}function F(){return Object(o.a)().isChangeGateEnabled("TaskAssignerAdjustmentFix",Object(r.c)(4234604))}function N(){return Object(o.a)().isChangeGateEnabled("NewCommentButtonDisabledFocusFix2",Object(r.c)(4361561))}function M(){return Object(o.a)().isChangeGateEnabled("TaskEnablementChangesWin32",Object(r.c)(4478381))}function V(){return Object(o.a)().isChangeGateEnabled("PlaceHolderHCFix",Object(r.c)(4260210))}function L(){return Object(o.a)().isChangeGateEnabled("UseClosePaneCallbackHelperForWeb",Object(r.c)(4293942))}function U(){return Object(o.a)().isChangeGateEnabled("DraftAnnotationId",Object(r.c)(4429154))}function B(){return Object(o.a)().isChangeGateEnabled("TelemetryContext",Object(r.c)(4357164))}function H(){return Object(o.a)().isChangeGateEnabled("ShowHiddenPaneFix",Object(r.c)(4314805))}function z(){return Object(o.a)().isChangeGateEnabled("RemoveLastElementId",Object(r.c)(4311404))}function W(){return Object(o.a)().isChangeGateEnabled("ExpandCollapseOnCardInvoke",Object(r.c)(4321579))}function q(){return z()&&Object(o.a)().isChangeGateEnabled("SuppressKeyboardingFromGhost",Object(r.c)(4297066))}function G(){return Object(o.a)().isChangeGateEnabled("ContextMenuTaskResolveFix",Object(r.c)(4321345))}function Y(){return Object(o.a)().isChangeGateEnabled("FixMobileFullPaneCancelReplyFocus",Object(r.c)(4334185))}function K(){return Object(o.a)().isChangeGateEnabled("CheckDraftStateForSessionInfo",Object(r.c)(4348517))}function J(){return Object(o.a)().isChangeGateEnabled("LossyWarningA11yFix",Object(r.c)(4369216))}function Q(){return J()&&d()}function X(){return Object(o.a)().isChangeGateEnabled("NewSingleDraftSelector",Object(r.c)(4348518))}function Z(){return Object(o.a)().isChangeGateEnabled("ContentNavigationBringsAllSelectsIntoView",Object(r.c)(4356544))}function $(){return K()&&Object(o.a)().isChangeGateEnabled("BreakApartCommentSessionState",Object(r.c)(4376349))}function ee(){return Object(o.a)().isChangeGateEnabled("NativeHeaderRefactor",Object(r.c)(4314052))&&d()&&Object(o.a)().isChangeGateEnabled("FluentTextNative",Object(r.c)(4382060))&&Object(o.a)().isChangeGateEnabled("NewCardResolvedDesign",Object(r.c)(4382063))}function te(){return Object(o.a)().isChangeGateEnabled("MentionMutationMitigation",Object(r.c)(4398415))}function ne(){return Object(o.a)().isChangeGateEnabled("ReplyBoxFocusIndicator",Object(r.c)(4390077))}function re(){return Object(o.a)().isChangeGateEnabled("SuppressSaveDraftOnUnmount",Object(r.c)(4396791))}function oe(){return Object(o.a)().isChangeGateEnabled("FixDeleteAPIDraftCheck",Object(r.c)(4398682))}function ie(){return $()&&Object(o.a)().isChangeGateEnabled("FixCardReplyModeLogic",Object(r.c)(4399065))}function ae(){return Object(o.a)().isChangeGateEnabled("UseForceExpandedOnDraft",Object(r.c)(4399067))}function se(){return Object(o.a)().isChangeGateEnabled("HeaderContrastFix",Object(r.c)(4395430))}function ce(){return!1}function de(){return T()&&Object(o.a)().isChangeGateEnabled("TaskAssignerUIRefresh",Object(r.c)(4375082))}function ue(){return Object(o.a)().isChangeGateEnabled("FixUpDownArrowing",Object(r.c)(4416906))}function le(){return Object(o.a)().isChangeGateEnabled("CommentViewerA11yLabel",Object(r.c)(4417012))}function fe(){return Object(o.a)().isChangeGateEnabled("NewTooltipTextForPostAndCancelButtons",Object(r.c)(4424725))}function me(){return Object(o.a)().isChangeGateEnabled("RefactorWebRenderPosts",Object(r.c)(4445201))}function pe(){return Object(o.a)().isChangeGateEnabled("ConvertSelectAction",Object(r.c)(4470863))}function ge(){return Object(o.a)().isChangeGateEnabled("AlwaysUpdateEditorAriaAttributes",Object(r.c)(4437300))}function he(){return Object(o.a)().isChangeGateEnabled("PolishEditBox",Object(r.c)(4478046))}function Ce(){return ee()&&Object(o.a)().isChangeGateEnabled("ResolvedCardExpandChange",Object(r.c)(4461869))}function ye(){return Object(o.a)().isChangeGateEnabled("IgnoreLieIndexUpdatesForOtherContext",Object(r.c)(4458443))}function ve(){return Object(o.a)().isChangeGateEnabled("NewEditPostIcon",Object(r.c)(4482225))}function be(){return Object(o.a)().isChangeGateEnabled("NoHoverEllipsisInCollapsedDHC",Object(r.c)(4470730))}function Te(){return Object(o.a)().isChangeGateEnabled("FixContentStateForExtendedDrafts",Object(r.c)(4478257))}function Ie(){return Object(o.a)().isChangeGateEnabled("RemoveContentsTabHandler",Object(r.c)(4484753))}function Oe(){return Object(o.a)().isChangeGateEnabled("PPTCloseDraftFocusFix",Object(r.c)(4481270))}function Se(){return Object(o.a)().isChangeGateEnabled("FixDraftLogicInGetThreadWithCommentDraft",Object(r.c)(4497231))}function je(){return Object(o.a)().isChangeGateEnabled("HyperlinkDetectionFix",Object(r.c)(4347304))}function De(){return Object(o.a)().isChangeGateEnabled("FixMockComponentTreeQuery",Object(r.c)(4503964))}function we(){return Object(o.a)().isChangeGateEnabled("FocusHandlerSkipNewCommentWhenNotExpected",Object(r.c)(4507524))}function _e(){return Object(o.a)().isChangeGateEnabled("FocusHandlerRegistryOnUserActionNative",Object(r.c)(4519117))}function xe(){return Object(o.a)().isChangeGateEnabled("FixCardPostEditorFocus",Object(r.c)(4512720))}function Ee(){return Object(o.a)().isChangeGateEnabled("UseThreadIndexInThreadNav",Object(r.c)(4523426))}function Pe(){return Object(o.a)().isChangeGateEnabled("HyperlinkCaseInsensitiveFix",Object(r.c)(4347304))}function Ae(){return Object(o.a)().isChangeGateEnabled("ClearHighlightFix",Object(r.c)(4525963))}function ke(){return Object(o.a)().isChangeGateEnabled("HyperlinkResolvedStylingFix",Object(r.c)(4526580))}function Re(){return Object(o.a)().isChangeGateEnabled("FocusOnHalfpaneTransition",Object(r.c)(4533651))}function Fe(){return Object(o.a)().isChangeGateEnabled("DeferHostableComponentFocus",Object(r.c)(4533915))}function Ne(){return Object(o.a)().isChangeGateEnabled("CardStylesRefactorAndInheritColor",Object(r.c)(4496704))}function Me(){return Object(o.a)().isChangeGateEnabled("RemountCardOnThemeChange",Object(r.c)(4536947))}function Ve(){return Object(o.a)().isChangeGateEnabled("SafelinkHandlerForHyperlinkClick",Object(r.c)(4540336))}},721:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.MSGraph=1]="MSGraph",e[e.Loki=2]="Loki"}(r||(r={}))},729:function(e,t,n){"use strict";var r,o,i=n(219);!function(e){e[e.Enabled=0]="Enabled",e[e.Execute=1]="Execute",e[e.Query=2]="Query"}(o||(o={}));var a=((r={})[0]=i.DeltaFormattingType.Weight,r[1]=i.DeltaFormattingType.Highlight,r[2]=i.DeltaFormattingType.Hyperlink,r[3]=i.DeltaFormattingType.Italic,r[4]=i.DeltaFormattingType.Strikethrough,r[5]=i.DeltaFormattingType.Underline,r),s=n(3),c=function(){function e(){var e=this;this.selectionChangedHandlers=[],this.keypressHandlers=[],this.onHyperlinkClick=function(t){return!!e.hyperlinkNavigator&&e.hyperlinkNavigator(t)},this.onSelectionChangeHandler=function(){e.invokeHandlers(e.selectionChangedHandlers)},this.onKeypressHandler=function(t){e.invokeHandlers(e.keypressHandlers,t)}}return e.prototype.executeCommand=function(e,t,n){var r,o,a,s;if(!this.richContentEditorActor)return 1;if(0===t)return this.isRootCommandEnabled(e)?2:0;if(this.isRootCommandEnabled(e)){if(2===t&&n){var c=this.richContentEditorActor.getFormattingAtCurrentSelection();switch(e){case 0:n.bold=c.bold;break;case 3:n.italic=c.italic;break;case 5:n.underline=c.underline;break;case 4:n.strikethrough=c.strikethrough}return 2}var d=void 0,u=void 0;switch(e){case 0:d={type:i.DeltaFormattingType.Weight};break;case 3:d={type:i.DeltaFormattingType.Italic};break;case 5:d={type:i.DeltaFormattingType.Underline};break;case 4:d={type:i.DeltaFormattingType.Strikethrough};break;case 2:if(null===(r=null==n?void 0:n.hyperlinkData)||void 0===r?void 0:r.link){var l=null===(o=null==n?void 0:n.hyperlinkData)||void 0===o?void 0:o.link,f=null!==(s=null===(a=null==n?void 0:n.hyperlinkData)||void 0===a?void 0:a.text)&&void 0!==s?s:l;u={type:i.DeltaFormattingType.Hyperlink,data:{text:f,link:l}}}}return d&&this.richContentEditorActor.applyFormattingToCurrentSelection(d),u&&this.richContentEditorActor.addContent(u),2}return 0},e.prototype.getSelection=function(){return this.richContentEditorActor?{text:this.richContentEditorActor.getSelection().text}:{text:""}},e.prototype.initRichContentEditor=function(e){Object(s.g)().assertConditionTag(!this.richContentEditorActor,"[initRichContentEditor] RichContentEditor already set",590141192),this.richContentEditorActor=e,this.richContentEditorActor.registerSelectionChangeHandler(this.onSelectionChangeHandler),this.richContentEditorActor.registerKeypressHandler(this.onKeypressHandler)},e.prototype.registerSelectionChangeHandler=function(e){e&&this.selectionChangedHandlers.push(e)},e.prototype.registerKeypressHandler=function(e){e&&this.keypressHandlers.push(e)},e.prototype.registerSafelinksNavigator=function(e){e&&(this.hyperlinkNavigator=e)},e.prototype.setFocus=function(){this.richContentEditorActor&&this.richContentEditorActor.setFocus()},e.prototype.isRootCommandEnabled=function(e){return!!this.richContentEditorActor&&this.richContentEditorActor.isFormatEnabled(a[e])},e.prototype.invokeHandlers=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e)for(var r=0;r<e.length;r++)e[r].apply(e,t)},e}(),d=void 0;function u(){if(!d)throw new Error("Running in an invalid environment, window expected to exist.");return void 0===d.RichContentEditAPI&&(d.RichContentEditAPI=new c),d.RichContentEditAPI}"undefined"!=typeof window&&(d=window);var l=new(function(){function e(){}return e.prototype.getRichContentEditAPI=function(){return u()},e}());n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}))},750:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Like=1]="Like"}(r||(r={}))},751:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.Backspace="Backspace",e.Control="Control",e.Delete="Delete",e.Enter="Enter",e.Escape="Escape",e.Meta="Meta",e.Tab="Tab",e.Home="Home",e.End="End",e.F6="F6",e.F12="F12",e.Space=" "}(r||(r={}))},752:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(67);function o(e,t){if(!t)return e;switch(e){case r.c.ArrowLeft:return r.c.ArrowRight;case r.c.ArrowRight:return r.c.ArrowLeft;default:return e}}function i(e){switch(e){case"Down":return r.c.ArrowDown;case"Up":return r.c.ArrowUp;case"Left":return r.c.ArrowLeft;case"Right":return r.c.ArrowRight;case"OS":return r.c.Meta;case"Del":return r.c.Delete;case"Spacebar":return" ";case"Esc":return r.c.Escape;case"Ctrl":case"Ctl":return r.c.Control;case"F6":return r.c.F6;case"F12":return r.c.F12;default:return e}}},753:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(7),o=n(15),i=n(39),a=n(18),s=n(139);function c(e,t,n,c){if(r.rb()){if(!(d=Object(o.H)(n)))return;return d.threadId!==e?s.a.InOtherCard:r.q()&&d.renderContextType!==t?s.a.InOtherContextOfThisCard:"EDIT"===d.commentDraft.sessionConfiguration.sessionType?s.a.InChildPost:s.a.InCard}if(c&&Object(i.c)(n,c)){if(c.selectedCardId===e){var d;if(r.q()&&n)if((d=Object(o.H)(n))&&d.renderContextType!==t)return s.a.InOtherContextOfThisCard;return Object(a.d)(c.selectionDetails)?s.a.InCard:s.a.InChildPost}return s.a.InOtherCard}}},754:function(e,t,n){"use strict";function r(e){return void 0!==e.getContentsAsync&&void 0!==e.getCursorPositionAsync&&void 0!==e.setContents}n.d(t,"a",(function(){return r}))},76:function(e,t,n){"use strict";function r(e){return""===e.parentId?e:void 0}function o(e){return e.parentId||e.commentId}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},790:function(e,t,n){"use strict";var r=n(138),o=n(443),i=n(52),a=function(){return function(e){return function(t){return Object(i.unstable_batchedUpdates)((function(){return e(t)}))}}},s=n(9),c=function(){return function(e){return function(t){var n="string"==typeof t.type?t.type:t.name||"Unknown Action",r=Object(s.i)(s.c.Redux,n),o=e(t);return null==r||r.end(),o}}},d=n(508),u=n(292),l=n(0),f=n(3),m=n(111),p=n(94),g=n(211),h=n(157),C=n(336),y=n(115),v=n(200),b=n(76),T=n(274),I=n(253),O=n(110),S=n(120),j=n(95),D=n(20),w=n(68),_=n(105),x=n(392),E=n(135),P=n(403),A=n(435),k=n(21),R=n(87),F=n(7),N=n(8),M=n(28),V=n(39),L=n(18);function U(e,t,n,r,o,i){var a;if(F.qb())a=Object(V.e)(t)<Object(V.e)(e);else{if(!n)return;if(n.selectionDetails.editingSession_deprecated!==L.a.Active)return;a=!r||r.selectionDetails.editingSession_deprecated!==L.a.Active}if(a){var s=Object(f.g)().createActivityObject("SilentDiscardOnMerge",Object(f.h)(f.f.GlobalAPI),f.a.None,f.b.NecessaryServiceDataEvent);s.addDataField("DiscardReason",o,f.c.SystemMetadata),s.addDataField("MergeSource",i,f.c.SystemMetadata),s.successTag(592007882)}}function B(e,t,n){if(F.qb()?Object(V.e)(t)<Object(V.e)(e):Object.keys(t.drafts).length<Object.keys(e.drafts).length){var r=Object(f.g)().createActivityObject("SilentDiscardOnViewChange",Object(f.h)(f.f.GlobalAPI),f.a.None,f.b.NecessaryServiceDataEvent);r.addDataField("ViewChangeSource",n,f.c.SystemMetadata),r.successTag(591661013)}}function H(e,t,n){if(F.H()){var r=Object(f.g)().createActivityObject("MarkCommentCreation",n,f.a.None,f.b.NecessaryServiceDataEvent);r.addDataField(M.a.DraftId,e,f.c.SystemMetadata),r.addDataField(M.a.CommentId,t,f.c.SystemMetadata),r.addDocumentMetadata(f.e.Basic),r.successTag(591152859)}}var z=n(15),W=n(141),q=n(601),G=n(117),Y=n(243),K=n(454);function J(e,t){switch(void 0===e&&(e=Object(K.a)("")),void 0===t&&(t=u.a),t.type){case N.a.HighlightCommentType:return function(e,t){var n=z.P(t.payload.commentId);if(n===e.highlightedCommentId)return e;return Object(l.__assign)(Object(l.__assign)({},e),{highlightedCommentId:n})}(e,t);case N.a.ApplyCommentChangesType:return function(e,t){var n,r,o;if(!t.payload.changes.length)return e;var i={commentData:Object(l.__spread)(e.commentData),cardViewState:Object(l.__assign)({},e.cardViewState),postViewState:Object(l.__assign)({},e.postViewState),highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,selectedComment:e.selectedComment,selectedThreadIdBeforeCommentSession:e.selectedThreadIdBeforeCommentSession,draftState:e.draftState,wasDataReceived_deprecated:e.wasDataReceived_deprecated},a=e.createdCommentLie,c=!F.zb()||z.M(a,e.draftState),d=null==a?void 0:a.index;try{for(var u=Object(l.__values)(t.payload.changes),m=u.next();!m.done;m=u.next()){var h=m.value;if(h.type===p.b.Load&&(h=void 0!==i.postViewState[h.model.commentId]?Object(l.__assign)(Object(l.__assign)({},h),{type:p.b.Modify}):Object(l.__assign)(Object(l.__assign)({},h),{type:p.b.Insert})),h.type===p.b.Insert){if((v=h.model.parentId)&&(i.cardViewState[v]=Object(l.__assign)(Object(l.__assign)({},i.cardViewState[v]),{pending:W.a.None})),i.commentData.splice(h.index,0,h.model),h.tempId){if(!v)(y={})[h.model.commentId]=z.g(h.tempId),i.cardViewState=Object(l.__assign)(Object(l.__assign)({},z.S(i.cardViewState,[h.tempId])),y);if(i.postViewState=Object(l.__assign)(Object(l.__assign)({},z.T(i.postViewState,[h.tempId])),z.t([h.model])),a&&a.newComment.commentId===h.tempId&&(d=void 0),i.selectedComment&&i.selectedComment.selectedCardId===h.tempId){var C=i.selectedComment;i.selectedComment=z.B(h.model),F.qb()||U(i.draftState,i.draftState,C,i.selectedComment,4,2)}}else{var y;Object(f.g)().assertConditionTag(!i.postViewState[h.model.commentId],"Received insert for existing comment "+h.model.commentId,594122589),(y={})[h.model.commentId]=z.g(void 0),i.cardViewState=Object(l.__assign)(Object(l.__assign)({},i.cardViewState),y),i.postViewState=Object(l.__assign)(Object(l.__assign)({},i.postViewState),z.t([h.model]))}c&&void 0!==d&&h.index<=d&&d++}else if(h.type===p.b.Modify){if((O=i.commentData[h.index]).commentId===h.model.commentId){i.commentData[h.index]=h.model;var v=Object(b.b)(h.model);i.cardViewState[v]=Object(l.__assign)(Object(l.__assign)({},i.cardViewState[v]),{pending:W.a.None,loadState:{state:G.a.Loaded}}),e.cardViewState[v]&&e.cardViewState[v].loadState.state!==G.a.Loaded&&(i.wasDataReceived_deprecated=!0);var T=O.displayDate===h.model.displayDate&&O.date===h.model.date?i.postViewState[h.model.commentId].displayDate:z.i(h.model.date,h.model.displayDate,e.appLocale);if(i.postViewState=Object(l.__assign)(Object(l.__assign)({},i.postViewState),((o={})[h.model.commentId]=Object(l.__assign)(Object(l.__assign)({},i.postViewState[h.model.commentId]),{pending:Y.a.None,displayDate:T}),o)),h.model.commentFlags&g.a.Resolved){var I=i.draftState;(S=i.selectedComment)&&S.selectedCardId===h.model.commentId&&(i.selectedComment=z.A(S),F.rb()||(i.draftState=z.r(i.selectedComment,S,!0,i.draftState))),F.rb()&&(i.draftState=z.R(i.draftState,h.model.commentId,i.commentData)),U(I,i.draftState,S,i.selectedComment,1,2)}}else Object(f.g)().assertConditionTag(!1,"Found changeIndex mismatch",593762526),Object(s.g)("changeIndex did not match comment for "+h.model.commentId)}else if(h.type===p.b.Delete){I=i.draftState;var O,S=i.selectedComment;if(i.selectedComment=z.v(i.selectedComment,i.commentData,h.index,h.index+1),(O=i.commentData[h.index]).commentId===h.model.commentId&&i.commentData.splice(h.index,1),i.highlightedCommentId===h.model.commentId&&(i.highlightedCommentId=void 0),i.topVisibleThreadId===h.model.commentId&&(i.topVisibleThreadId=void 0),i.draftState=z.U(i.draftState,h.model.commentId),i.draftState=z.W(i.draftState,h.model.commentId),U(I,i.draftState,S,i.selectedComment,""===O.parentId?3:2,2),i.cardViewState=Object(l.__assign)({},z.S(i.cardViewState,[h.model.commentId])),i.postViewState=Object(l.__assign)({},z.T(i.postViewState,[h.model.commentId])),h.model.commentId===i.selectedThreadIdBeforeCommentSession){var j=h.index;i.commentData.length?(j>=i.commentData.length&&(j=i.commentData.length-1),i.selectedThreadIdBeforeCommentSession=Object(b.b)(i.commentData[j])):i.selectedThreadIdBeforeCommentSession=void 0}c&&void 0!==d&&h.index<d&&d--}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}c&&(void 0===d?a=void 0:a&&d!==a.index&&(a=Object(l.__assign)(Object(l.__assign)({},a),{index:d})));return Object(l.__assign)(Object(l.__assign)({},e),{createdCommentLie:a,draftState:i.draftState,selectedComment:i.selectedComment,commentData:i.commentData,cardViewState:i.cardViewState,postViewState:i.postViewState,highlightedCommentId:i.highlightedCommentId,topVisibleThreadId:i.topVisibleThreadId,selectedThreadIdBeforeCommentSession:i.selectedThreadIdBeforeCommentSession,wasDataReceived_deprecated:i.wasDataReceived_deprecated})}(e,t);case N.a.LoadCommentType:return function(e,t){var n,r=Object(l.__spread)(e.commentData,t.payload.commentData),o=z.K(e.modelCapabilities,e.virtualized),i=z.Q(e,r,o),a=i.pendingCommentLoad,s=i.selectedComment;return n=z.h(t.payload.commentData,o?G.a.Placeholder:G.a.Loaded),Object(l.__assign)(Object(l.__assign)({},e),{commentData:r,pendingCommentLoad:a,selectedComment:s,appLocale:e.appLocale,cardViewState:Object(l.__assign)(Object(l.__assign)({},e.cardViewState),n),postViewState:Object(l.__assign)(Object(l.__assign)({},e.postViewState),z.t(t.payload.commentData)),wasDataReceived_deprecated:!o||e.wasDataReceived_deprecated})}(e,t);case N.a.LoadVirtualizedCommentsType:return function(e,t){var n=Object(P.b)(t.payload.threadInfo.map((function(e){return e.threadId}))),r=Object(l.__spread)(e.commentData,n);if(!z.K(e.modelCapabilities,e.virtualized))throw new k.a("virtualizeCommentsReducer requires virtualization",-2130957500);var o=z.Q(e,r,!0),i=o.pendingCommentLoad,a=o.selectedComment;return Object(l.__assign)(Object(l.__assign)({},e),{commentData:r,pendingCommentLoad:i,selectedComment:a,cardViewState:Object(l.__assign)(Object(l.__assign)({},e.cardViewState),z.J(t.payload.threadInfo)),postViewState:Object(l.__assign)(Object(l.__assign)({},e.postViewState),z.t(n)),wasDataReceived_deprecated:e.wasDataReceived_deprecated,appLocale:e.appLocale})}(e,t);case N.a.CancelCommentCreateThreadType:return function(e,t){if(!e.createdCommentLie)return e;var n,r=e.createdCommentLie.draftId,o=z.S(e.cardViewState,[r]),i=z.T(e.postViewState,[r]);e.selectedThreadIdBeforeCommentSession&&(n={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{expanded:!0,lowFidelityWarningType:void 0,editingSession_deprecated:L.a.None}});return Object(l.__assign)(Object(l.__assign)({},e),{createdCommentLie:void 0,selectedComment:n,cardViewState:o,postViewState:i,selectedThreadIdBeforeCommentSession:void 0,draftState:F.qb()?z.U(e.draftState,e.createdCommentLie.draftId):z.X(e.draftState)})}(e);case N.a.CancelCommentPostEditType:return function(e,t){var n=z.w(e,t.payload.commentId);return Object(l.__assign)(Object(l.__assign)({},e),{selectedComment:n,selectedThreadIdBeforeCommentSession:void 0,draftState:z.W(e.draftState,t.payload.commentId)})}(e,t);case N.a.CancelCommentReplyType:return function(e,t){var n=z.y(e.selectedComment,t.payload.commentId);return Object(l.__assign)(Object(l.__assign)({},e),{selectedComment:n,selectedThreadIdBeforeCommentSession:void 0,draftState:F.qb()?z.U(e.draftState,t.payload.commentId):z.X(e.draftState)})}(e,t);case N.a.SelectCommentType:return function(e,t){var n,r=!1,o=e.draftState,i=e.selectedComment;if(!z.Y(o,i,t))return e;if(!t.payload.selectedCard)throw new k.a(R.e,-2130957536);var a=void 0,s=z.bb(o,i,t);if(s){if(e.commentData.filter((function(e){return Object(b.b)(e)===s.selectedCardId})).forEach((function(t){e.postViewState[t.commentId].displayDate||(a||(a=Object(l.__assign)({},e.postViewState)),a[t.commentId]=z.s(e.postViewState[t.commentId].displayDate||z.i(t.date,t.displayDate,e.appLocale),e.postViewState[t.commentId].displayingErrorUI),r=!0)})),F.Gb()){var c=z.H(o);if(c&&!c.forceCardExpanded&&c.threadId===s.selectedCardId&&(!Object(L.d)(s.selectionDetails)||s.selectionDetails.expanded)){var d=c.commentDraft.sessionConfiguration.draftId;o=Object(l.__assign)(Object(l.__assign)({},o),{drafts:(n={},n[d]=Object(l.__assign)(Object(l.__assign)({},o.drafts[d]),{forceCardExpanded:!0}),n)})}}}return Object(l.__assign)(Object(l.__assign)({},e),{draftState:o,selectedComment:s,postViewState:r&&a?a:e.postViewState})}(e,t);case N.a.RequestThreadResolveType:return function(e,t){var n;return Object(l.__assign)(Object(l.__assign)({},e),{cardViewState:Object(l.__assign)(Object(l.__assign)({},e.cardViewState),(n={},n[t.payload.commentId]=Object(l.__assign)(Object(l.__assign)({},e.cardViewState[t.payload.commentId]),{pending:W.a.Card,loadState:{state:G.a.Loaded}}),n)),selectedComment:z.z(e.selectedComment,t)})}(e,t);case N.a.ReloadCommentsType:return function(e,t){var n,r,o={},i={},a=e.selectedComment,s=a&&!Object(L.d)(a.selectionDetails),c=!1,d=!1,u=!1,m=e.selectedThreadIdBeforeCommentSession,p=e.draftState,h=z.K(e.modelCapabilities,e.virtualized),C=F.rb()?null===(n=z.H(p))||void 0===n?void 0:n.threadId:void 0,y={};e.commentData.forEach((function(e){y[e.commentId]=e}));var v=!1,T=!1;if(t.payload.comments.forEach((function(n){if(n.commentId===e.highlightedCommentId&&(v=!0),n.commentId===e.topVisibleThreadId&&(T=!0),n.commentId in y){if(""===n.parentId){e.cardViewState[n.commentId]&&Object(f.g)().assertConditionTag(e.cardViewState[n.commentId].pending!==W.a.Delete,"Card pending delete remained after a reload.",593762527);var r=e.cardViewState[n.commentId];if(!r||r.pending!==W.a.None||h){var s=null==r?void 0:r.loadState;i[n.commentId]=Object(l.__assign)(Object(l.__assign)({},r),{pending:W.a.None,loadState:s&&s.state===G.a.Placeholder?{state:G.a.Placeholder,initialItemCount:s.initialItemCount}:{state:G.a.NeedsReload}})}else i[n.commentId]=r}if(e.postViewState[n.commentId]&&Object(f.g)().assertConditionTag(e.postViewState[n.commentId].pending!==Y.a.Delete,"Post pending delete remained after a reload.",593762528),e.postViewState[n.commentId]&&e.postViewState[n.commentId].pending===Y.a.None?o[n.commentId]=e.postViewState[n.commentId]:o[n.commentId]=Object(l.__assign)(Object(l.__assign)({},e.postViewState[n.commentId]),{pending:Y.a.None}),a){if(a.selectedCardId===n.commentId&&(d=!0,n.commentFlags&g.a.Resolved)){var I=a;a=z.A(a),F.qb()||U(p,p,I,a,1,1)}a.selectedCardId!==Object(b.b)(n)||Object(L.d)(a.selectionDetails)||a.selectionDetails.selectedPostId!==n.commentId||(c=!0)}if(n.commentId===C&&n.commentFlags&g.a.Resolved){var O=p;p=z.R(p,n.commentId,t.payload.comments),F.qb()&&U(O,p,void 0,void 0,1,1)}m&&m===n.commentId&&(u=!0)}else{if(""===n.parentId){var S=n.commentId,j=h?{state:G.a.Placeholder,initialItemCount:1}:{state:G.a.Loaded};i[n.commentId]=z.o(S,j)}o[n.commentId]=z.s(n.displayDate,!1)}})),r=z.a(e.createdCommentLie,t.payload.comments,e.cardViewState,e.draftState,!0)){var I=r.newComment.commentId;F.rb()?a&&r.newComment.commentId===a.selectedCardId&&(d=!0):d=!(!a||r.newComment.commentId!==a.selectedCardId),i[I]=e.cardViewState[I],o[I]=e.postViewState[I]}if(d){if(s&&!c&&a&&!h){O=a;a={selectedCardId:a.selectedCardId,selectionDetails:{expanded:!0,lowFidelityWarningType:void 0,editingSession_deprecated:L.a.None}},F.qb()||U(p,p,O,a,2,1)}}else{var O=a;a=void 0,F.qb()||U(p,p,O,a,3,1)}if(F.rb()){var S=z.F(p);if(S&&!i[S]&&S!==(null==r?void 0:r.draftId)){var j=p;p=z.U(p,S),F.qb()&&U(j,p,void 0,void 0,3,1)}var D=z.G(p);if(D&&!o[D]){j=p;p=z.W(p,D),F.qb()&&U(j,p,void 0,void 0,2,1)}}else e.selectedComment&&a!==e.selectedComment&&(p=z.r(a,e.selectedComment,c,p));if(!u&&m){var w=e.commentData.findIndex((function(e){return e.commentId===m}));if(w<0&&(Object(f.g)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in old commentData. Falling back to first comment",593762529),w=0),t.payload.comments.length){w>=t.payload.comments.length&&(w=t.payload.comments.length-1);var _=t.payload.comments[w];m=Object(b.b)(_)}else m=void 0}return Object(l.__assign)(Object(l.__assign)({},e),{draftState:p,commentData:Object(l.__spread)(t.payload.comments),cardViewState:i,postViewState:o,selectedComment:a,pendingCommentLoad:void 0,highlightedCommentId:v?e.highlightedCommentId:void 0,topVisibleThreadId:T?e.topVisibleThreadId:void 0,createdCommentLie:r,selectedThreadIdBeforeCommentSession:m})}(e,t);case N.a.RequestReopenThreadType:return function(e,t){var n,r=Object(l.__assign)(Object(l.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=Object(l.__assign)(Object(l.__assign)({},e.cardViewState[t.payload.commentId]),{pending:W.a.Card}),n));return Object(l.__assign)(Object(l.__assign)({},e),{cardViewState:r})}(e,t);case N.a.RequestDeletePostType:return function(e,t){var n,r=Object(l.__assign)(Object(l.__assign)({},e.postViewState),((n={})[t.payload.commentId]=Object(l.__assign)(Object(l.__assign)({},e.postViewState[t.payload.commentId]),{pending:Y.a.Delete}),n));return Object(l.__assign)(Object(l.__assign)({},e),{postViewState:r})}(e,t);case N.a.RequestDeleteThreadType:return function(e,t){var n,r=Object(l.__assign)(Object(l.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=Object(l.__assign)(Object(l.__assign)({},e.cardViewState[t.payload.commentId]),{pending:W.a.Delete}),n));return Object(l.__assign)(Object(l.__assign)({},e),{cardViewState:r})}(e,t);case N.a.DispatchLoadThreadsType:return function(e,t){var n=Object(l.__assign)({},e.cardViewState);return t.payload.threadIds.forEach((function(e){var t=n[e].loadState;n[e]=Object(l.__assign)(Object(l.__assign)({},n[e]),{loadState:t.state===G.a.Placeholder?{state:G.a.Loading,initialItemCount:t.initialItemCount}:{state:G.a.Loading}})})),Object(l.__assign)(Object(l.__assign)({},e),{cardViewState:n})}(e,t);case N.a.BeginDraftingSuccessType:return function(e,t){var n,r,o,i,a;if(z.E(e.draftState))throw new k.a("Draft already active!",-2130957551);var c=e.selectedThreadIdBeforeCommentSession;if(!Object(v.a)(t.payload.draftDetails))throw new k.a("Invalid comment draft!",-2130957545);var d=t.payload.draftDetails;switch(d.sessionConfiguration.sessionType){case"CREATE":var u={parentId:"",commentId:d.sessionConfiguration.draftId,author:d.author,anchorHintText:d.anchorHintText};return Object(l.__assign)(Object(l.__assign)({},e),{createdCommentLie:{index:d.insertIndex,newComment:u,draftId:d.sessionConfiguration.draftId},cardViewState:Object(l.__assign)(Object(l.__assign)({},z.S(e.cardViewState,[Object(w.v)()])),z.j(u)),postViewState:Object(l.__assign)(Object(l.__assign)({},z.T(e.postViewState,[Object(w.v)()])),z.k(u)),selectedComment:z.C(e.commentData,d),selectedThreadIdBeforeCommentSession:c,draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:Object(l.__assign)(Object(l.__assign)({},e.draftState.drafts),(n={},n[d.sessionConfiguration.draftId]={commentDraft:d,forceCardExpanded:!0,isDraftEmpty:!0,isInCurrentContext:!0,pendingState:V.a.None,renderContextType:t.payload.draftRenderContextType,threadId:d.sessionConfiguration.draftId},n)),cardIdToDraftIdMap:Object(l.__assign)(Object(l.__assign)({},e.draftState.cardIdToDraftIdMap),(r={},r[d.sessionConfiguration.draftId]=d.sessionConfiguration.draftId,r)),pendingDraft:void 0})});case"EDIT":case"REPLY":if(!Object(T.b)(d.sessionConfiguration)&&!Object(T.c)(d.sessionConfiguration))throw Object(f.g)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit in beginDraftingSuccessReducer",593762523),new k.a(R.d,-2130957532);var m=void 0;!e.selectedComment||Object(T.c)(d.sessionConfiguration)&&d.sessionConfiguration.threadId!==e.selectedComment.selectedCardId||y.e(d.sessionConfiguration)&&!Object(L.d)(e.selectedComment.selectionDetails)&&d.sessionConfiguration.commentId!==e.selectedComment.selectionDetails.selectedPostId?(Object(f.g)().assertConditionTag(!1,"Mismatch between initCommentSessionSuccess id and selectedComment selected id - falling back to using payload ids",593762524),m=z.C(e.commentData,d)):m=F.qb()?Object(l.__assign)(Object(l.__assign)({},e.selectedComment),{selectionDetails:Object(l.__assign)(Object(l.__assign)({},e.selectedComment.selectionDetails),{editingSession_deprecated:L.a.None,lowFidelityWarningType:void 0})}):Object(l.__assign)(Object(l.__assign)({},e.selectedComment),{selectionDetails:Object(l.__assign)(Object(l.__assign)({},e.selectedComment.selectionDetails),{editingSession_deprecated:L.a.Active})});var p,g=e.draftState.cardIdToDraftIdMap,h=e.draftState.postIdToDraftIdMap,C="",I=void 0;if(y.f(d.sessionConfiguration))g=Object(l.__assign)(Object(l.__assign)({},g),((o={})[d.sessionConfiguration.threadId]=d.sessionConfiguration.draftId,o)),C=d.sessionConfiguration.threadId,I=(!Object(L.d)(m.selectionDetails)||m.selectionDetails.expanded)&&m.selectedCardId===d.sessionConfiguration.threadId,p=!0;else if(y.e(d.sessionConfiguration)){var O=d.sessionConfiguration.commentId;h=Object(l.__assign)(Object(l.__assign)({},h),((i={})[O]=d.sessionConfiguration.draftId,i)),I=!0,p=!1,e.commentData.some((function(e){if(e.commentId===O){var t=Object(A.d)(e.commentBody);return p=0===t.length||Object(_.a)()===j.a.Web&&"\n"===t,C=Object(b.b)(e),!0}return!1}))}else Object(s.j)(d.sessionConfiguration),I=!0,p=!0;return Object(l.__assign)(Object(l.__assign)({},e),{selectedComment:Object(l.__assign)(Object(l.__assign)({},m),{selectionDetails:Object(l.__assign)({},m.selectionDetails)}),selectedThreadIdBeforeCommentSession:c,draftState:{drafts:Object(l.__assign)(Object(l.__assign)({},e.draftState.drafts),(a={},a[d.sessionConfiguration.draftId]={commentDraft:d,forceCardExpanded:I,isDraftEmpty:p,isInCurrentContext:!0,pendingState:V.a.None,renderContextType:t.payload.draftRenderContextType,threadId:C},a)),cardIdToDraftIdMap:g,postIdToDraftIdMap:h,pendingDraft:void 0},cardViewState:z.S(e.cardViewState,[Object(w.v)()]),postViewState:z.T(e.postViewState,[Object(w.v)()]),createdCommentLie:void 0});default:return e}}(e,t);case N.a.BeginDraftingFailureType:return function(e,t){if(void 0===e.selectedComment)return Object(f.g)().assertConditionTag(!1,"SelectedComment already undefined when failing selected comment",593762525),e;var n=void 0;"CREATE"!==t.payload.beginDraftingParams.sessionType?n=Object(l.__assign)(Object(l.__assign)({},e.selectedComment),{selectionDetails:Object(l.__assign)(Object(l.__assign)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0,editingSession_deprecated:L.a.None})}):e.selectedThreadIdBeforeCommentSession&&(n={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{expanded:!1,lowFidelityWarningType:void 0,editingSession_deprecated:L.a.None}});return Object(l.__assign)(Object(l.__assign)({},e),{selectedComment:n,selectedThreadIdBeforeCommentSession:void 0,createdCommentLie:void 0,draftState:F.qb()?Object(l.__assign)(Object(l.__assign)({},e.draftState),{pendingDraft:void 0}):z.X(e.draftState)})}(e,t);case N.a.SessionRequestStartedAndLockSelectionType:return function(e,t){var n,r=void 0,o=e.cardViewState,i=e.postViewState;if(e.createdCommentLie)return Object(f.g)().assertConditionTag(!1,"SessionRequestStartedAndLockSelection unexpected defined comment lie in state",593764356),e;if(y.f(t.payload.params))n=t.payload.params.threadId;else if(y.e(t.payload.params)){var a=t.payload.params.commentId,s=e.commentData.find((function(e){return e.commentId===a}));if(!s)return Object(f.g)().assertConditionTag(!1,"Could not lock selection on missing comment "+a,593764357),e;n=Object(b.b)(s)}else{var c={commentId:n=Object(w.v)()};r={index:-1,newComment:c,draftId:n},o[n]&&Object(f.g)().assertConditionTag(!1,"Unexpectedly already found card view state for lie when starting session request",593764358),o=Object(l.__assign)(Object(l.__assign)({},o),z.j(c)),i[n]&&Object(f.g)().assertConditionTag(!1,"Unexpectedly already found post view state for lie when starting session request",593764359),i=Object(l.__assign)(Object(l.__assign)({},i),z.k(c))}var d=void 0;t.payload.captureSelectedThreadIdBeforeSession&&e.selectedComment&&(d=e.selectedComment.selectedCardId);return Object(l.__assign)(Object(l.__assign)({},e),{postViewState:i,cardViewState:o,selectedThreadIdBeforeCommentSession:d,selectedComment:z.D(e.selectedComment,t,n),draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{pendingDraft:t.payload.params}),createdCommentLie:r})}(e,t);case N.a.CommentContextChangedType:return function(e,t){var n,r=Object(V.h)(),o={},i={},a=void 0,s=void 0;n=t.payload.contextDetails?Object(l.__assign)(Object(l.__assign)({},Object(q.a)(t.payload.contextDetails)),{lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1}):{nextPopulatedContextDetails:h.a.Unknown,isReadOnly:F.N()&&e.contextState.isReadOnly,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1};var c=t.payload.contextDrafts;if(c){var d=z.V(e.draftState,e.selectedComment);if(Object(V.e)(d)>0){var u={},m=void 0,p=void 0;if(Object(V.f)(d).forEach((function(t){var n=c.find((function(e){return e.draftId===t}));u[t]=Object(l.__assign)(Object(l.__assign)({},d.drafts[t]),{isInCurrentContext:!!n}),n&&e.createdCommentLie&&e.createdCommentLie.draftId===t&&(m=n.insertIndex,p=n.anchorHintText)})),r=Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:u}),F.Hb()||(a=e.selectedComment),e.createdCommentLie&&(s=e.createdCommentLie,z.M(s,r))){if(F.zb()){Object(f.g)().assertConditionTag(void 0!==m,"Index unknown for lie in latest context",587309136);var g=null!=m?m:0;g!==s.index&&(s=Object(l.__assign)(Object(l.__assign)({},s),{index:g})),void 0!==p&&p!==s.newComment.anchorHintText&&(s=Object(l.__assign)(Object(l.__assign)({},s),{newComment:Object(l.__assign)(Object(l.__assign)({},s.newComment),{anchorHintText:p})}))}var C=s.draftId;o=z.p(C),i=z.q(C),s.index>-1&&(o[C].pending=W.a.None,i[C].pending=Y.a.None)}}}return B(e.draftState,r,2),Object(l.__assign)(Object(l.__assign)({},e),{virtualized:!!t.payload.virtualized,commentData:[],cardViewState:o,postViewState:i,selectedComment:a,pendingCommentLoad:0===t.payload.numberOfComments?void 0:{numberOfComments:t.payload.numberOfComments,numberOfThreads:t.payload.numberOfThreads,selectedThreadIndex:t.payload.selectedThreadIndex},wasDataReceived_deprecated:0===t.payload.numberOfComments||e.wasDataReceived_deprecated,contextState:n,highlightedCommentId:void 0,topVisibleThreadId:t.payload.contextDetails?z.P(t.payload.contextDetails.topVisibleThreadId):void 0,createdCommentLie:s,selectedThreadIdBeforeCommentSession:void 0,draftState:r})}(e,t);case N.a.NextPopulatedContextDetailsUpdatedType:return function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{contextState:{nextPopulatedContextDetails:t.payload.nextPopulatedContextDetails,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement}})}(e,t);case N.a.ShowLowFidelityWarningType:return function(e,t){var n,r=t.payload,o=r.commentId,i=r.commentSessionState_deprecated,a=r.lowFidelityWarningType,s=e.commentData.find((function(e){return e.commentId===o}));if(!s)return Object(f.g)().assertConditionTag(!1,"Comment not found",593762530),e;if(Object(V.d)(e.draftState,e.selectedComment))return Object(f.g)().assertConditionTag(!1,"Cannot show warning with pending or active session",593762531),e;n=(F.qb()?a===L.b.DeleteThread:i===L.a.LowFidelityWarningOnDeleteThread)?{selectedCardId:o,selectionDetails:{lowFidelityWarningType:a,editingSession_deprecated:i,expanded:z.L(o,e.selectedComment)}}:{selectedCardId:Object(b.b)(s),selectionDetails:{selectedPostId:o,lowFidelityWarningType:a,editingSession_deprecated:i}};return Object(l.__assign)(Object(l.__assign)({},e),{selectedComment:n})}(e,t);case N.a.ClearCommentsType:return Object(K.a)(e.appLocale);case N.a.ClearCommentSelectionType:return function(e,t){if(!z.Y(e.draftState,e.selectedComment,t))return e;return Object(l.__assign)(Object(l.__assign)({},e),{selectedComment:void 0})}(e,t);case N.a.ClearCommentHighlightType:return function(e,t){if(void 0!==t.payload.commentId&&t.payload.commentId!==e.highlightedCommentId)return e;return Object(l.__assign)(Object(l.__assign)({},e),{highlightedCommentId:void 0})}(e,t);case N.a.ClearCommentHighlightType_deprecated:return function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{highlightedCommentId:void 0})}(e);case N.a.TopVisibleThreadChangedType:return function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{topVisibleThreadId:t.payload.threadId})}(e,t);case N.a.UpdateContextStateType:return function(e,t){var n=Object(l.__assign)({},e.contextState);void 0!==t.payload.contextState.commentThreadCounts&&(n.commentThreadCounts=t.payload.contextState.commentThreadCounts);void 0!==t.payload.contextState.nextPopulatedContextDetails&&(n.nextPopulatedContextDetails=t.payload.contextState.nextPopulatedContextDetails);void 0!==t.payload.contextState.isReadOnly&&(n.isReadOnly=t.payload.contextState.isReadOnly);return Object(l.__assign)(Object(l.__assign)({},e),{contextState:n})}(e,t);case N.a.BeginProcessingCommitType:return function(e,t){var n;if(!Object(V.b)(e.draftState,e.selectedComment))return Object(f.g)().assertConditionTag(!1,"BeginProcessingCommitAction unexpected",593764352),e;var r=e.selectedComment,o=e.draftState;if(F.qb()){var i=z.H(e.draftState);i&&(o=Object(l.__assign)(Object(l.__assign)({},o),{drafts:Object(l.__assign)(Object(l.__assign)({},o.drafts),(n={},n[i.commentDraft.sessionConfiguration.draftId]=Object(l.__assign)(Object(l.__assign)({},i),{pendingState:V.a.Commit}),n))}))}else e.selectedComment&&(r=Object(l.__assign)(Object(l.__assign)({},e.selectedComment),{selectionDetails:Object(l.__assign)(Object(l.__assign)({},e.selectedComment.selectionDetails),{editingSession_deprecated:L.a.CommitPending})}));return Object(l.__assign)(Object(l.__assign)({},e),{selectedComment:r,draftState:o})}(e);case N.a.CommitFailureType:return function(e,t){var n;if(!Object(V.i)(e.draftState,e.selectedComment))return Object(f.g)().assertConditionTag(!1,"CommitFailureAction unexpected",593764353),e;var r=e.selectedComment,o=e.draftState;if(F.qb()){var i=z.H(e.draftState);i&&(o=Object(l.__assign)(Object(l.__assign)({},o),{drafts:Object(l.__assign)(Object(l.__assign)({},o.drafts),(n={},n[i.commentDraft.sessionConfiguration.draftId]=Object(l.__assign)(Object(l.__assign)({},i),{pendingState:V.a.None}),n))}))}else e.selectedComment&&(r=Object(l.__assign)(Object(l.__assign)({},e.selectedComment),{selectionDetails:Object(l.__assign)(Object(l.__assign)({},e.selectedComment.selectionDetails),{editingSession_deprecated:L.a.Active})}));return Object(l.__assign)(Object(l.__assign)({},e),{selectedComment:r,draftState:o})}(e);case N.a.BeginProcessingDiscardType:return function(e){var t;if(!Object(V.b)(e.draftState,e.selectedComment)&&!Object(L.i)(e.selectedComment))return Object(f.g)().assertConditionTag(!1,"BeginProcessingDiscardAction unexpected",593764355),e;var n=e.selectedComment,r=e.draftState;if(F.qb()){var o=z.H(e.draftState);o&&(r=Object(l.__assign)(Object(l.__assign)({},r),{drafts:Object(l.__assign)(Object(l.__assign)({},r.drafts),(t={},t[o.commentDraft.sessionConfiguration.draftId]=Object(l.__assign)(Object(l.__assign)({},o),{pendingState:V.a.Discard}),t))}))}else e.selectedComment&&(n=Object(l.__assign)(Object(l.__assign)({},e.selectedComment),{selectionDetails:Object(l.__assign)(Object(l.__assign)({},e.selectedComment.selectionDetails),{editingSession_deprecated:L.a.DiscardPending})}));return Object(l.__assign)(Object(l.__assign)({},e),{selectedComment:n,draftState:r})}(e);case N.a.CancelDiscardType:return function(e){var t;if(!Object(V.j)(e.draftState,e.selectedComment))return Object(f.g)().assertConditionTag(!1,"CancelDiscardAction unexpected",593764354),e;var n=e.selectedComment,r=e.draftState;if(F.qb()){var o=z.H(e.draftState);o&&(r=Object(l.__assign)(Object(l.__assign)({},r),{drafts:Object(l.__assign)(Object(l.__assign)({},r.drafts),(t={},t[o.commentDraft.sessionConfiguration.draftId]=Object(l.__assign)(Object(l.__assign)({},o),{pendingState:V.a.None}),t))}))}else e.selectedComment&&(n=Object(l.__assign)(Object(l.__assign)({},e.selectedComment),{selectionDetails:Object(l.__assign)(Object(l.__assign)({},e.selectedComment.selectionDetails),{editingSession_deprecated:L.a.Active})}));return Object(l.__assign)(Object(l.__assign)({},e),{selectedComment:n,draftState:r})}(e);case N.a.LoadPersonaIconPropertiesType:return function(e,t){if(0===Object.keys(t.payload.personaIconPropertiesMap).length)return e;var n=Object(l.__assign)(Object(l.__assign)({},e.personaIconPropertiesMap),t.payload.personaIconPropertiesMap);return Object(l.__assign)(Object(l.__assign)({},e),{personaIconPropertiesMap:n})}(e,t);case N.a.CommitDraftType:return function(e,t){var n=z.E(e.draftState);if(void 0===n)return Object(f.g)().assertConditionTag(!1,"Invalid number of drafts during commit.",593762521),e;if(n.sessionConfiguration.sessionType!==t.payload.sessionType)return e;switch(t.payload.sessionType){case"CREATE":return function(e,t){if(!e.createdCommentLie)return e;var n=t.temporaryCommentId;if(!n)throw Object(f.g)().assertConditionTag(!1,"Expected middleware to set temporaryCommentId",593762520),new k.a(R.d,-2130957545);var r={parentId:"",commentId:n,commentBody:t.commentBody,author:e.createdCommentLie.newComment.author},o=Object(l.__assign)(Object(l.__assign)({},e.cardViewState),z.p(n)),i=Object(l.__assign)(Object(l.__assign)({},e.postViewState),z.q(n));return Object(l.__assign)(Object(l.__assign)({},e),{selectedComment:e.selectedComment&&{selectedCardId:n,selectionDetails:{expanded:!0,lowFidelityWarningType:void 0,editingSession_deprecated:L.a.None}},createdCommentLie:Object(l.__assign)(Object(l.__assign)({},e.createdCommentLie),{newComment:r}),cardViewState:o,postViewState:i,selectedThreadIdBeforeCommentSession:void 0,draftState:F.qb()?z.U(e.draftState,e.createdCommentLie.draftId):z.X(e.draftState)})}(e,t.payload.data);case"REPLY":return function(e,t){var n;if(!t.parentId)throw new k.a(R.e,-2130957536);var r=Object(l.__assign)(Object(l.__assign)({},e.cardViewState),((n={})[t.parentId]=Object(l.__assign)(Object(l.__assign)({},e.cardViewState[t.parentId]),{pending:W.a.Editor,loadState:{state:G.a.Loaded}}),n));return Object(l.__assign)(Object(l.__assign)({},e),{cardViewState:r,selectedComment:z.x(e,t),selectedThreadIdBeforeCommentSession:void 0,draftState:F.qb()?z.U(e.draftState,t.parentId):z.X(e.draftState)})}(e,t.payload.data);case"EDIT":return function(e,t){var n,r=z.w(e,t.commentId),o=Object(l.__assign)(Object(l.__assign)({},e.postViewState[t.commentId]),{pending:Y.a.Post});return Object(l.__assign)(Object(l.__assign)({},e),{postViewState:Object(l.__assign)(Object(l.__assign)({},e.postViewState),(n={},n[t.commentId]=o,n)),selectedComment:r,selectedThreadIdBeforeCommentSession:void 0,draftState:F.qb()?z.W(e.draftState,t.commentId):z.X(e.draftState)})}(e,t.payload.data);default:throw new k.a("Unexpected session type for commit",-2130957532)}}(e,t);case N.a.ResolveAtMentionCapabilityType:return function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{atMentionState:{capability:t.payload.capability,authToken:t.payload.authToken},authToken:t.payload.authToken,modelCapabilities:Object(l.__assign)(Object(l.__assign)({},e.modelCapabilities),{atMention:t.payload.capability})})}(e,t);case N.a.UpdateAtMentionAuthTokenType:return function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{atMentionState:{capability:e.atMentionState.capability,authToken:t.payload.authToken},authToken:t.payload.authToken})}(e,t);case N.a.SaveDraftType:return function(e,t){var n,r=e.draftState.drafts;if(F.ib()&&void 0===r[t.payload.draftId])return Object(f.g)().assertConditionTag(!Object(V.c)(e.draftState),"saveDraftReducer called with an invalid draft id while a draft is active",587531107),e;if(!F.ib()&&void 0===r[t.payload.draftId])return Promise.resolve(t.payload.draftContent.editorContent).then((function(e){Object(A.d)(e).length>0&&Object(f.g)().assertConditionTag(!1,"saveDraftReducer called with an invalid draft id and non-empty content",591661014)})).catch((function(){Object(f.g)().assertConditionTag(!1,"saveDraftReducer called with invalid draft id and failed to check content length",591661015)})),e;var o=Object(l.__assign)(Object(l.__assign)({},r),((n={})[t.payload.draftId]=Object(l.__assign)(Object(l.__assign)({},r[t.payload.draftId]),{savedDraftContent:t.payload.draftContent}),n));return Object(l.__assign)(Object(l.__assign)({},e),{draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:o})})}(e,t);case N.a.DraftEmptinessChangedType:return function(e,t){var n,r=e.draftState.drafts;if(void 0===r[t.payload.draftId])return Object(f.g)().assertConditionTag(!1,"draftEmptinessChangedReducer called with an invalid draft id",592213846),e;var o=Object(l.__assign)(Object(l.__assign)({},r),((n={})[t.payload.draftId]=Object(l.__assign)(Object(l.__assign)({},r[t.payload.draftId]),{isDraftEmpty:t.payload.isEmpty}),n));return Object(l.__assign)(Object(l.__assign)({},e),{draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:o})})}(e,t);case N.a.UpdateDraftRenderContextType:return function(e,t){var n=z.ab(e.draftState,(function(n){var r=e.draftState.drafts[n];return void 0!==t.payload.draftId&&t.payload.draftId!==n?r.renderContextType:t.payload.isClaimingLock&&r.renderContextType===D.a.None?t.actionDetail.renderContextType:t.payload.isClaimingLock||r.renderContextType!==t.actionDetail.renderContextType?r.renderContextType:D.a.None}));return Object(l.__assign)(Object(l.__assign)({},e),{draftState:n})}(e,t);case N.a.ViewContainerChangedType:return function(e,t){var n=z.ab(e.draftState,(function(n){var r=e.draftState.drafts[n];return Object(E.b)(r.renderContextType)?Object(x.a)(t.payload.viewContainer.containerType):r.renderContextType}));return Object(l.__assign)(Object(l.__assign)({},e),{draftState:n})}(e,t);case N.a.DisplayDraftWarningType:return function(e,t){var n,r=z.E(e.draftState);if(void 0===r)return Object(f.g)().assertConditionTag(!1,"Expected active draft to be present",593764360),e;var o=r.sessionConfiguration.draftId,i=e.draftState.drafts;if(!i[o])return Object(f.g)().assertConditionTag(!1,"Expected draft to be present on display draft warning",593764361),e;var a=i[o].draftWarningState,s=Object(l.__assign)(Object(l.__assign)({},i),((n={})[o]=Object(l.__assign)(Object(l.__assign)({},i[o]),{draftWarningState:{warningCounter:a?a.warningCounter+1:0,type:t.payload.draftWarningType}}),n));return Object(l.__assign)(Object(l.__assign)({},e),{draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:s})})}(e,t);case N.a.UpdateCapabilitiesType:return function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{capabilities:t.payload.capabilities})}(e,t);case N.a.UpdateModelCapabilitiesType:return function(e,t){var n={atMention:t.payload.modelCapabilityFlags&I.a.AtMentionKnown?t.payload.modelCapabilityFlags&I.a.AtMentionEnabled?m.b.Enabled:m.b.Disabled:m.b.Unknown,newThread:!!(t.payload.modelCapabilityFlags&I.a.NewThread),resolve:!!(t.payload.modelCapabilityFlags&I.a.Resolve),richTextCapabilities:t.payload.richTextCapabilityFlags,virtualized:!!(t.payload.modelCapabilityFlags&I.a.Virtualized),tasks:t.payload.modelCapabilityFlags&I.a.TasksKnown?t.payload.modelCapabilityFlags&I.a.TasksEnabled?C.a.Enabled:C.a.Disabled:C.a.Unknown};return Object(l.__assign)(Object(l.__assign)({},e),{modelCapabilities:n})}(e,t);case N.a.UpdateCurrentMentioneesType:return function(e,t){var n,r=z.E(e.draftState);if(void 0===r)return Object(f.g)().assertConditionTag(!1,"Expected active draft to be present",593764362),e;var o=r.sessionConfiguration;if(Object(T.b)(o))return e;var i=o.draftId,a=e.draftState.drafts;if(!a[i])return Object(f.g)().assertConditionTag(!1,"Expected draft to be present on update current mentionees",593764363),e;var s=a[i].selectedTaskAssignee,c=!!s&&t.payload.users.find((function(e){return Object(O.i)(e,s)})),d=Object(l.__assign)(Object(l.__assign)({},a),((n={})[i]=Object(l.__assign)(Object(l.__assign)({},a[i]),{currentMentionees_deprecated:t.payload.users,selectedTaskAssignee:c?s:void 0}),n));return Object(l.__assign)(Object(l.__assign)({},e),{draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:d})})}(e,t);case N.a.UpdateMentioneesStillInDraftType:return function(e,t){var n,r=z.E(e.draftState);if(void 0===r)return Object(f.g)().assertConditionTag(!1,"Expected active draft to be present",593764366),e;var o=r.sessionConfiguration;if(Object(T.b)(o))return e;var i=e.draftState.drafts[o.draftId];if(!i)return Object(f.g)().assertConditionTag(!1,"Missing draft for updating mentionees",593764367),e;var a=i.currentMentionees,s={};for(var c in a)s[c]={mentionee:Object(l.__assign)({},a[c].mentionee),stillInDraft:t.payload.emailsStillInDraft.has(c)};var d=i.selectedTaskAssignee;if(d){var u=Object(O.f)(d);s[u]&&s[u].stillInDraft||(d=void 0)}var m=Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:Object(l.__assign)(Object(l.__assign)({},e.draftState.drafts),(n={},n[o.draftId]=Object(l.__assign)(Object(l.__assign)({},e.draftState.drafts[o.draftId]),{currentMentionees:s,selectedTaskAssignee:d}),n))});return Object(l.__assign)(Object(l.__assign)({},e),{draftState:m})}(e,t);case N.a.AddToCurrentMentioneesType:return function(e,t){var n,r=z.E(e.draftState);if(void 0===r)return Object(f.g)().assertConditionTag(!1,"Expected active draft to be present",593764364),e;var o=r.sessionConfiguration;if(Object(T.b)(o))return e;var i=e.draftState.drafts[o.draftId];if(!i)return Object(f.g)().assertConditionTag(!1,"Missing draft for adding mentionees",593764365),e;var a=i.currentMentionees,s=Object(O.f)(t.payload.mentionee);if(a&&a[s])return e;var c={};for(var d in a)c[d]={mentionee:Object(l.__assign)({},a[d].mentionee),stillInDraft:a[d].stillInDraft};c[s]={mentionee:Object(l.__assign)({},t.payload.mentionee),stillInDraft:!0};var u=Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:Object(l.__assign)(Object(l.__assign)({},e.draftState.drafts),(n={},n[o.draftId]=Object(l.__assign)(Object(l.__assign)({},e.draftState.drafts[o.draftId]),{currentMentionees:c}),n))});return Object(l.__assign)(Object(l.__assign)({},e),{draftState:u})}(e,t);case N.a.UpdateSelectedTaskAssigneeType:return function(e,t){var n,r=z.E(e.draftState);if(void 0===r)return Object(f.g)().assertConditionTag(!1,"Expected active draft to be present",593764368),e;var o=r.sessionConfiguration;if(Object(T.b)(o))return e;var i=o.draftId,a=e.draftState.drafts;if(!a[i])return Object(f.g)().assertConditionTag(!1,"Expected draft to be present on update selected task assignee",593764369),e;var s=Object(l.__assign)(Object(l.__assign)({},a),((n={})[i]=Object(l.__assign)(Object(l.__assign)({},a[i]),{selectedTaskAssignee:t.payload.selectedAssignee}),n));return Object(l.__assign)(Object(l.__assign)({},e),{draftState:Object(l.__assign)(Object(l.__assign)({},e.draftState),{drafts:s})})}(e,t);case N.a.PopulateSmartReplyType:return function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{draftState:z.l(e.draftState,t.payload)})}(e,t);case N.a.ShowPostErrorUIType:return function(e,t){var n=Object(l.__assign)(Object(l.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!0}),r=Object(l.__assign)({},e.postViewState);return r[t.payload.commentId]=n,Object(l.__assign)(Object(l.__assign)({},e),{postViewState:r})}(e,t);case N.a.ClearPostErrorUIType:return function(e,t){var n=Object(l.__assign)(Object(l.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!1}),r=Object(l.__assign)({},e.postViewState);return r[t.payload.commentId]=n,Object(l.__assign)(Object(l.__assign)({},e),{postViewState:r})}(e,t);case N.a.UpdateDraftThreadType:return function(e,t){var n,r;if(!e.createdCommentLie)return e;if(e.createdCommentLie.draftId!==t.payload.draftId)return Object(f.g)().assertConditionTag(!1,"Unexpected draft ID in updateDraftThread payload",593844429),e;if(void 0===t.payload.anchorHintText&&void 0===t.payload.insertIndex)return e;var o=e.createdCommentLie;F.zb()?(void 0!==t.payload.insertIndex&&t.payload.insertIndex!==o.index&&(o=Object(l.__assign)(Object(l.__assign)({},o),{index:t.payload.insertIndex})),void 0!==t.payload.anchorHintText&&t.payload.anchorHintText!==o.newComment.anchorHintText&&(o=Object(l.__assign)(Object(l.__assign)({},o),{newComment:Object(l.__assign)(Object(l.__assign)({},o.newComment),{anchorHintText:t.payload.anchorHintText})}))):o=Object(l.__assign)(Object(l.__assign)({},e.createdCommentLie),{newComment:Object(l.__assign)(Object(l.__assign)({},e.createdCommentLie.newComment),{anchorHintText:null!==(n=t.payload.anchorHintText)&&void 0!==n?n:e.createdCommentLie.newComment.anchorHintText}),index:null!==(r=t.payload.insertIndex)&&void 0!==r?r:e.createdCommentLie.index});return Object(l.__assign)(Object(l.__assign)({},e),{createdCommentLie:o})}(e,t);case N.a.ViewContainerVisibilityChangedType:return function(e,t){var n=e.draftState,r=e.selectedComment;if(t.payload.visibilityState!==S.a.Visible&&!F.q()&&(n=z.V(n,e.selectedComment),e.selectedComment&&0===Object.keys(n.drafts).length&&Object.keys(e.draftState.drafts).length>0)){var o=F.rb()?z.F(e.draftState):e.selectedComment.selectedCardId;o&&(r=z.y(e.selectedComment,o))}return n=z.ab(n,(function(n){var r=e.draftState.drafts[n];return z.Z(r.renderContextType,t.payload.visibilityState)})),B(e.draftState,n,1),Object(l.__assign)(Object(l.__assign)({},e),{selectedComment:r,draftState:n})}(e,t);case N.a.UpdateSuggestionsDetailsType:return function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{suggestionsDetails:t.payload.details})}(e,t);default:return e}}var Q=n(602),X=n(202),Z=n(185),$=n(293),ee=n(330),te=n(14);function ne(){Object(f.g)().assertConditionTag(!1,"Must specify initial pane state!",595918942)}function re(e,t){switch(void 0===e&&(e={viewContainer:{closeView:ne,openView:ne,containerType:Z.b.FullPane,moveFocusToCanvas_donotuse:ne},componentTree:new ee.a(D.a.FullPane,X.a),visibilityState:S.a.Closed,initializationStatus:$.a.NotInitialized,focusTypeAfterContextChange:void 0,viewContainerDisplayConfiguration:void 0}),void 0===t&&(t=te.b),t.type){case te.a.ViewContainerChangedType:return function(e,t){var n=e.viewContainer.containerType!==t.payload.viewContainer.containerType;return Object(l.__assign)(Object(l.__assign)({},e),{viewContainer:t.payload.viewContainer,componentTree:n?new ee.a(Object(x.a)(t.payload.viewContainer.containerType),e.componentTree.contextIdentifier,e.componentTree):e.componentTree})}(e,t);case te.a.ViewContainerDisplayConfigurationChangedType:return function(e,t){if(t.payload.displayConfiguration===e.viewContainerDisplayConfiguration)return e;return Object(l.__assign)(Object(l.__assign)({},e),{viewContainerDisplayConfiguration:t.payload.displayConfiguration})}(e,t);case te.a.ViewContainerVisibilityChangedType:return function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{initializationStatus:t.payload.visibilityState!==S.a.Closed||F.B()?e.initializationStatus:$.a.NotInitialized,visibilityState:t.payload.visibilityState})}(e,t);case te.a.ViewContainerFoldableLayoutStateChangedType:return function(e,t){var n=Object(l.__assign)(Object(l.__assign)({},e.viewContainer),{foldableLayoutState:t.payload.foldableLayoutState});return Object(l.__assign)(Object(l.__assign)({},e),{viewContainer:n})}(e,t);case te.a.BeginViewInitialization:return function(e){return Object(l.__assign)(Object(l.__assign)({},e),{initializationStatus:$.a.Initializing})}(e);case te.a.EndViewInitialization:return function(e){return Object(l.__assign)(Object(l.__assign)({},e),{initializationStatus:$.a.Initialized})}(e);case te.a.UpdateFocusTypeAfterContextChangeType:return function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{focusTypeAfterContextChange:t.payload.focusTypeAfterContextChange})}(e,t);default:return e}}var oe=n(620),ie=void 0;function ae(e,t){void 0===t&&(t=u.a),ie||(ie=Object(r.combineReducers)({paneState:re,contentExtensions:Q.a,taskState:oe.b,commentState:J}));var n=ie(e,t);return d.b&&Object(s.g)("Comments Store: ACTION: ",t," STATE: ",n),n}var se=n(114),ce=n(37),de=n(163),ue=n(11),le=function(){return{threadIdRequests:new Map,sequenceId:0}},fe=function(e,t,n){return void 0===n&&(n=20),Object(de.i)(function(e){return function(t,n){var r,o,i=ue.d(e.getState());try{for(var a=Object(l.__values)(n),s=a.next();!s.done;s=a.next()){var c=s.value;i[c]&&i[c].loadState.state===G.a.Placeholder&&t.threadIdRequests.set(c,t.sequenceId++)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return t}}(e),function(e,t,n){return function(r){for(var o=Array.from(r.threadIdRequests.entries()).sort((function(e,t){var n=Object(l.__read)(e,2),r=(n[0],n[1]),o=Object(l.__read)(t,2);o[0];return r-o[1]})),i=[],a=ue.d(e.getState()),c=o.pop();c&&i.length<n;c=o.pop()){var d=Object(l.__read)(c,1)[0];r.threadIdRequests.delete(d),a[d]&&a[d].loadState.state===G.a.Placeholder&&i.push(d)}if(i.length&&e.dispatch(Object(te.r)({renderContextType:D.a.None,telemetryVisitor:t,trackback:s.d.reserveTag(594888212)},{threadIds:i})),r.threadIdRequests.size>0)return r}}(e,t,n),le,500)},me=n(324),pe=n(32),ge=n(603),he=n(58);function Ce(e,t,n){var r=e.getState(),o=ge.a(r)[pe.d.Isolated];return!!o&&(n(t),o.controller.triggerUpdate(),!0)}function ye(e,t,n,r){return"CREATE"===r&&Ce(e,t,n)}function ve(e,t){return 0===ue.f(t).lastContextChangeIncrement||ue.m(t)?pe.c.Disabled:he.a(t)?e===pe.d.Integrated?pe.c.Disabled:pe.c.Secondary:pe.c.Primary}function be(e,t){var n=ge.a(e)[t];n&&(n.controller.priority=n.priority)}var Te=n(124),Ie=function(e){return function(t){return function(n){var r=e.getState().commentState.draftState.drafts;t(n);var o=e.getState().commentState.draftState.drafts;Object.keys(r).forEach((function(e){void 0===o[e]&&r[e].commentDraft.endDrafting()}))}}},Oe=n(147),Se=n(393),je=n(540);function De(e){switch(e.type){case N.a.ApplyCommentChangesType:return{name:"ApplyCommentChangesAction",aggregationMode:f.a.OnSuccess,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.BeginProcessingCommitType:return{name:"BeginProcessingCommitAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.CancelCommentCreateThreadType:return{name:"CancelCommentCreateThreadAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.CancelCommentPostEditType:return{name:"CancelCommentPostEditAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.CancelCommentReplyType:return{name:"CancelCommentReplyAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.ClearCommentSelectionType:return{name:"ClearCommentSelectionAction",aggregationMode:f.a.OnSuccess,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.CommitDraftType:return{name:"CommitDraftAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.DisplayDraftWarningType:return{name:"DisplayDraftWarningAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.ReloadCommentsType:return{name:"ReloadCommentsAction",aggregationMode:f.a.OnSuccess,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.RequestDeletePostType:return{name:"DeletePostAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.RequestDeleteThreadType:return{name:"DeleteThreadAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent,logDocumentMetadata:f.e.Basic};case N.a.DispatchLoadThreadsType:return{name:"LoadThreadsAction",aggregationMode:f.a.OnSuccess,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.RequestReopenThreadType:return{name:"ReopenThreadAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.RequestThreadResolveType:return{name:"ResolveThreadAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent,logDocumentMetadata:f.e.Basic};case N.a.SelectCommentType:return{name:"SelectCommentAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.SelectFirstThreadInNextCommentContextType:return{name:"SelectFirstThreadInNextCommentContextAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.SelectLastThreadInPreviousCommentContextType:return{name:"SelectLastThreadInPreviousCommentContextAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.SessionRequestStartedAndLockSelectionType:return{name:"SessionRequestStartedAndLockSelectionAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.ShowLowFidelityWarningType:return{name:"ShowLowFidelityWarningAction",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};case N.a.UpdateDraftRenderContextType:return{name:"UpdateDraftRenderContext",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent};default:return}}var we=function(){return function(e){return function(t){try{return e(t)}catch(e){if(void 0===De(t)){var n=Object(f.g)().createActivityObject("ExceptionMiddlewareCatch",t.actionDetail.telemetryVisitor,f.a.None,f.b.NecessaryServiceDataEvent);n.addDataField(M.a.OperationType,t.type,f.c.SystemMetadata),n.addDataField(M.a.Trackback,t.actionDetail.trackback,f.c.SystemMetadata),n.failTag(593278723,Object(Oe.a)(e))}!function(e){if(Object(Se.a)(e))throw e;if(!Object(k.b)(e))throw Object(f.g)().assertConditionTag(!1,"Unknown error encountered, rethrowing: "+e+(e instanceof Error?"\n\nStack:\n"+e.stack:""),593278724),e;switch(e.errorCode){case-2130957565:case-2130957551:throw e;case-2130957536:return;default:Object(f.g)().assertConditionTag(!1,"Comments Error: "+e,595720020)}}(e)}}}};var _e,xe=n(177),Ee=n(419);!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unknown=2]="Unknown"}(_e||(_e={}));var Pe=function(){function e(e){this.telemetryVisitor=e,this.trackerActivityName="E2EPerfTracker",this.performanceActivities={}}return e.prototype.beginTracking=function(e,t,n,r){var o=r||Object(f.g)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,f.a.None,f.b.NecessaryServiceDataEvent);o.addDataField(M.a.OperationType,n,f.c.SystemMetadata),this.performanceActivities.hasOwnProperty(e)&&(Object(f.g)().assertConditionTag(!1,"Duplicate ID used for PerfActivity. Overwriting initial perf tracker with failure.",595132703),this.failTracker(e,s.d.reserveTag(595907678))),this.performanceActivities[e]={activity:o,expectedChangeType:t}},e.prototype.updateTrackerId=function(e,t){if(e!==t){this.performanceActivities.hasOwnProperty(t)&&(Object(f.g)().assertConditionTag(!1,"Duplicate ID used for updateTrackerId. Overwriting initial perf tracker with failure.",595132704),this.failTracker(t,s.d.reserveTag(595132705)));var n=this.performanceActivities[e];n&&(this.performanceActivities[t]=n,delete this.performanceActivities[e])}},e.prototype.failTracker=function(e,t,n){var r=this.performanceActivities[e];r&&(r.activity.failTag(t,void 0!==n?n:-2130957541),delete this.performanceActivities[e])},e.prototype.failAllTrackers=function(e,t){var n=this;Object.keys(this.performanceActivities).forEach((function(r){n.performanceActivities[r].activity.failTag(e,void 0!==t?t:-2130957541)})),this.performanceActivities={}},e.prototype.endTracker=function(e,t,n){var r=this.performanceActivities[e];r&&(r.activity.addDataField("ExpectedChangeArrived",r.expectedChangeType===t?_e.Yes:_e.No,f.c.SystemMetadata),r.activity.successTag(n),delete this.performanceActivities[e])},e.prototype.endAllTrackers=function(e){for(var t in this.performanceActivities){var n=this.performanceActivities[t];n.activity.addDataField("ExpectedChangeArrived",_e.Unknown,f.c.SystemMetadata),n.activity.successTag(e)}this.performanceActivities={}},e.prototype.getTracker=function(e,t){var n=this.performanceActivities[e];if(n&&n.expectedChangeType===t)return n},e}(),Ae=function(){function e(e){this.telemetryVisitor=e,this.trackerActivityName="LowFidelityScenarioTracker"}return e.prototype.beginTracking=function(e){var t=Object(L.c)(e);this.activity&&t!==this.selectedCommentId&&(this.activity.addDataField("OperationType",te.a.ShowLowFidelityWarningType,f.c.SystemMetadata),this.activity.successTag(593098840),this.activity=void 0,this.selectedCommentId=void 0),this.activity||this.selectedCommentId||(this.activity=Object(f.g)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,f.a.None,f.b.NecessaryServiceDataEvent),this.selectedCommentId=t)},e.prototype.endTrackingIfWarningDismissed=function(e,t){var n=Object(L.c)(t);!this.activity||n===this.selectedCommentId&&Object(L.k)(t)||(this.activity.addDataField(M.a.OperationType,e.type,f.c.SystemMetadata),this.activity.successTag(593098841),this.activity=void 0,this.selectedCommentId=void 0)},e}();function ke(e,t){t?e.addDataField(M.a.AffectingTaskMetadata,!0,f.c.SystemMetadata):e.addDataField(M.a.AffectingTaskMetadata,!1,f.c.SystemMetadata)}function Re(e,t,n){var r=t.find((function(e){return e.commentId===n})),o=(null==r?void 0:r.parentId)||(null==r?void 0:r.commentId);t.some((function(e){return(e.commentId===o||e.parentId===o)&&0!=(e.commentFlags&m.d.IsNew)}))&&o&&e.addDataField(M.a.CommentIsNew,o,f.c.SystemMetadata)}var Fe=function(e){var t=new Pe(e),n=new Ae(e);return function(e){return function(r){return function(o){var i,a,c=function(){var t,n,i,a,s,c,d=De(o);if(!d)return Object(f.g)().assertConditionTag(!1,"Event name not defined for action type: "+o.type,595616738),r(o);var u=Object(f.g)().createActivityObject(d.name,o.actionDetail.telemetryVisitor,d.aggregationMode,d.diagnosticLevel);u.addDataField(M.a.Trackback,o.actionDetail.trackback,f.c.SystemMetadata),u.addDataField(M.a.RenderContextType,o.actionDetail.renderContextType,f.c.SystemMetadata),d.logDocumentMetadata&&u.addDocumentMetadata(d.logDocumentMetadata);var l=function(e,t){u.addDataField(M.a.CommentId,t,f.c.SystemMetadata);var n=Object(z.e)(e,t);n.valid&&(u.addDataField(M.a.MatchesCommentAuthor,n.matchesCurrentUser,f.c.SystemMetadata),u.addDataField(M.a.CommentCreationTimeDeltaMs,n.timeElapsed,f.c.SystemMetadata)),Re(u,e,t)},m=e.getState(),p=me.b(e.getState());switch(o.type){case N.a.CommentContextChangedType:u.addDataField(M.a.NumberOfThreads,o.payload.numberOfThreads,f.c.SystemMetadata),o.payload.virtualized||u.addDataField(M.a.NumberOfComments,o.payload.numberOfComments,f.c.SystemMetadata);break;case N.a.CommitDraftType:var g=function(e){if(e.type===N.a.CommitDraftType)return{name:"CommitDraft"+Object(je.b)(e.payload)+"Action",aggregationMode:f.a.None,diagnosticLevel:f.b.NecessaryServiceDataEvent}}(o);if(!g)return Object(f.g)().assertConditionTag(!1,"Event name not defined for given draft action type",595903002),r(o);var h=Object(f.g)().createActivityObject(g.name,o.actionDetail.telemetryVisitor,f.a.None,f.b.NecessaryServiceDataEvent);h.addDataField(M.a.RenderContextType,o.actionDetail.renderContextType,f.c.SystemMetadata),h.successTag(595903074);var C=y.b[o.payload.sessionType];u.addDataField(M.a.SessionType,C,f.c.SystemMetadata),"REPLY"===o.payload.sessionType&&Re(u,ue.e(m),o.payload.data.parentId);break;case N.a.DisplayDraftWarningType:u.addDataField(M.a.DraftWarningType,o.payload.draftWarningType,f.c.SystemMetadata),u.addDataField(M.a.DraftWarningReason,o.payload.draftWarningReason,f.c.SystemMetadata);var v=Object(z.H)(m.commentState.draftState);v&&(u.addDataField(M.a.IsDraftInCurrentContext,v.isInCurrentContext,f.c.SystemMetadata),F.fb()&&u.addDataField(M.a.DraftId,v.commentDraft.sessionConfiguration.draftId,f.c.SystemMetadata));break;case N.a.UpdateDraftRenderContextType:u.addDataField(M.a.IsClaimingDraftLock,o.payload.isClaimingLock,f.c.SystemMetadata),u.addDataField(M.a.IsUpdatingAllDraftLocks,!o.payload.draftId,f.c.SystemMetadata);break;case N.a.SelectCommentType:u.addDataField(M.a.SelectType,te.c[o.payload.selectType],f.c.SystemMetadata),u.addDataField(M.a.ActionSource,ce.a[o.payload.source],f.c.SystemMetadata);var b=ue.p(m),T=!(!b||b.selectedCardId!==o.payload.selectedCard);u.addDataField(M.a.IsCurrentCard,T,f.c.SystemMetadata),T||Re(u,ue.e(m),o.payload.selectedCard);break;case N.a.RequestThreadResolveType:case N.a.RequestReopenThreadType:if(ke(u,o.payload.isTask),l(ue.e(m),o.payload.commentId),o.payload.isTask){var I=o.type===N.a.RequestThreadResolveType?M.a.ResolveThreadWithTask:M.a.ReopenThreadWithTask;u.addDataField(I,!0,f.c.SystemMetadata,f.d.Critical);var O=null===(i=null===(n=null===(t=p[o.payload.commentId])||void 0===t?void 0:t.history[0])||void 0===n?void 0:n.records[0])||void 0===i?void 0:i.time;u.addDataField(M.a.TaskCreationTimeDeltaMs,O?Date.now()-O.getTime():0,f.c.SystemMetadata,f.d.Critical)}break;case N.a.RequestDeleteThreadType:if(ke(u,o.payload.isTask),o.payload.isTask){u.addDataField(M.a.DeleteThreadWithTask,!0,f.c.SystemMetadata,f.d.Critical);O=null===(c=null===(s=null===(a=p[o.payload.commentId])||void 0===a?void 0:a.history[0])||void 0===s?void 0:s.records[0])||void 0===c?void 0:c.time;u.addDataField(M.a.TaskCreationTimeDeltaMs,O?Date.now()-O.getTime():0,f.c.SystemMetadata,f.d.Critical)}l(ue.e(m),o.payload.commentId);break;case N.a.RequestDeletePostType:l(ue.e(m),o.payload.commentId);break;case N.a.ReloadCommentsType:u.addDataField(M.a.NumberOfThreads,o.payload.numberOfThreads,f.c.SystemMetadata)}try{var S=e.getState(),j=r(o),D=e.getState(),w=ue.i(S),_=ue.i(D);switch(o.type){case N.a.UpdateDraftRenderContextType:var x=o.payload.draftId?w.drafts[o.payload.draftId]:Object(z.H)(w),E=o.payload.draftId?_.drafts[o.payload.draftId]:Object(z.H)(_),P=void 0!==x&&void 0!==E&&x.renderContextType!==E.renderContextType;u.addDataField(M.a.DidDraftLockUpdate,P,f.c.SystemMetadata)}return u.successTag(595616739),j}catch(e){throw u.failTag(595616768,Object(Oe.a)(e,-2130957541)),e}};switch(o.type){case N.a.BeginProcessingCommitType:var d=Object(f.g)().createActivityObject(t.trackerActivityName,o.actionDetail.telemetryVisitor,f.a.None,f.b.NecessaryServiceDataEvent);try{c()}catch(e){throw d.failTag(595687567,Object(Oe.a)(e,-2130957541)),e}if(!(m=ue.r(e.getState()))){d.failTag(595687569,-2130957541);break}var u=m.commentDraft.sessionConfiguration;t.beginTracking(u.draftId,y.a[u.sessionType],u.sessionType,d);break;case N.a.CommitFailureType:var m=ue.r(e.getState());Object(f.g)().assertConditionTag(!!m,"Draft should exist when failing a commit.",595132701),m&&t.failTracker(m.commentDraft.sessionConfiguration.draftId,s.d.reserveTag(595132702)),r(o);break;case N.a.RequestThreadResolveType:case N.a.RequestReopenThreadType:t.beginTracking(o.payload.commentId,p.a.Modify,o.type);try{c()}catch(e){throw t.failTracker(o.payload.commentId,s.d.reserveTag(595907670),Object(Oe.a)(e,-2130957541)),e}break;case N.a.RequestDeletePostType:case N.a.RequestDeleteThreadType:t.beginTracking(o.payload.commentId,p.a.Delete,o.type);try{c()}catch(e){throw t.failTracker(o.payload.commentId,s.d.reserveTag(595907671),Object(Oe.a)(e,-2130957541)),e}break;case N.a.CommentContextChangedType:try{r(o)}catch(e){throw t.failAllTrackers(s.d.reserveTag(595731294),Object(Oe.a)(e,-2130957541)),e}break;case N.a.LoadCommentType:case N.a.LoadVirtualizedCommentsType:if(!t.getTracker("LoadCommentTracker",p.a.Load)){d=Object(f.g)().createActivityObject(t.trackerActivityName,o.actionDetail.telemetryVisitor,f.a.None,f.b.NecessaryServiceDataEvent);t.beginTracking("LoadCommentTracker",p.a.Load,o.type,d)}r(o);break;case N.a.ReloadCommentsType:if(!t.getTracker("LoadCommentTracker",p.a.Load)){d=Object(f.g)().createActivityObject(t.trackerActivityName,o.actionDetail.telemetryVisitor,f.a.None,f.b.NecessaryServiceDataEvent);t.beginTracking("LoadCommentTracker",p.a.Load,o.type,d)}try{c()}catch(e){throw t.failAllTrackers(s.d.reserveTag(595907672),Object(Oe.a)(e,-2130957541)),e}t.endAllTrackers(s.d.reserveTag(595907673));break;case N.a.OnInitialRenderType:var g=t.getTracker("LoadCommentTracker",p.a.Load);g&&(o.payload.commentId&&g.activity.addDataField(M.a.AssociatedCommentId,o.payload.commentId,f.c.SystemMetadata),g.activity.addDataField(M.a.RenderContextType,o.payload.renderContextType,f.c.SystemMetadata),t.endTracker("LoadCommentTracker",p.a.Load,s.d.reserveTag(595646476))),r(o);break;case N.a.ApplyCommentChangesType:try{c()}catch(e){throw t.failAllTrackers(s.d.reserveTag(595907674),Object(Oe.a)(e,-2130957541)),e}try{for(var h=Object(l.__values)(o.payload.changes),C=h.next();!C.done;C=h.next()){var v=C.value;if(v.type===p.a.Load||v.type===p.a.Unknown)break;if(v.type!==p.a.Delete&&v.type!==p.a.Modify){if(v.type===p.a.Insert){void 0!==v.tempId&&""===v.model.parentId&&H(v.tempId,v.model.commentId,o.actionDetail.telemetryVisitor);var b=v.tempId||v.model.parentId;void 0!==b&&t.endTracker(b,v.type,s.d.reserveTag(595857620))}}else t.endTracker(v.model.commentId,v.type,s.d.reserveTag(595907675))}}catch(e){i={error:e}}finally{try{C&&!C.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}break;case N.a.CommitDraftType:m=ue.r(e.getState());if(c(),o.payload.data.temporaryCommentId&&m){var T=void 0;switch((u=m.commentDraft.sessionConfiguration).sessionType){case"CREATE":!function(e,t,n){H(e,t,n)}(u.draftId,o.payload.data.temporaryCommentId,o.actionDetail.telemetryVisitor),T=o.payload.data.temporaryCommentId;break;case"REPLY":T=o.payload.data.temporaryCommentId;break;case"EDIT":T=u.commentId;break;case"METADATA":T=u.threadId}T&&t.updateTrackerId(u.draftId,T)}break;case N.a.DispatchLoadThreadsType:case N.a.CancelCommentCreateThreadType:case N.a.CancelCommentPostEditType:case N.a.CancelCommentReplyType:case N.a.SelectFirstThreadInNextCommentContextType:case N.a.SelectLastThreadInPreviousCommentContextType:case N.a.SessionRequestStartedAndLockSelectionType:case N.a.UpdateDraftRenderContextType:case N.a.ClearCommentSelectionType:case N.a.SelectCommentType:case N.a.DisplayDraftWarningType:c();break;case N.a.ShowLowFidelityWarningType:c();var I=ue.p(e.getState());I&&n.beginTracking(I);break;case N.a.ViewContainerVisibilityChangedType:var O="";switch(o.payload.visibilityState){case S.a.Closed:O="ViewContainerClosed";break;case S.a.Hidden:O="ViewContainerHidden";break;case S.a.Visible:O="ViewContainerVisible";break;default:Object(s.j)(o.payload.visibilityState)}var j=Object(f.g)().createActivityObject(O,o.actionDetail.telemetryVisitor,f.a.Always,f.b.NecessaryServiceDataEvent);r(o),j.successTag(592241220);break;default:r(o)}var D=ue.p(e.getState());D&&n.endTrackingIfWarningDismissed(o,D)}}}},Ne=n(159),Me=n(296),Ve=n(358),Le=function(e){return function(e){return function(t){return function(n){switch(n.type){case te.a.RequestShowPaneType:(r=he.d(e.getState())).openView();break;case te.a.RequestClosePaneType:(r=he.d(e.getState())).closeView();break;case te.a.MoveFocusToCanvasType:if(!F.Fb())(r=he.d(e.getState())).moveFocusToCanvas_donotuse();break;case te.a.RequestModalConfirmationType:(r=he.d(e.getState())).invokeModalConfirmationDialog?r.invokeModalConfirmationDialog(n.payload.onConfirm,n.payload.onCancel,n.payload.displayStrings):(Object(f.g)().assertConditionTag(!1,"Host does not have modal dialog implemented",593278688),r.closeView());break;case te.a.RequestDisplayConfigurationType:if(!F.z()){var r=he.d(e.getState());Object(Me.a)(r)&&Object(Ne.b)(n.payload.displayConfig)?n.payload.completion=r.setDisplayConfiguration(n.payload.displayConfig):n.payload.completion=Promise.reject()}break;case te.a.ReadyToRenderType:(r=he.d(e.getState())).onReadyToRender&&r.onReadyToRender();break;case te.a.BeginDraftingSuccessType:r=he.d(e.getState());if(Object(Me.a)(r)){if("CREATE"===(Object(v.a)(n.payload.draftDetails)?n.payload.draftDetails.sessionConfiguration.sessionType:n.payload.draftDetails.sessionType))return F.z()?(Be(e.dispatch,n.actionDetail,{displayMode:Ne.a.Variable,desiredHeight:0}),void t(n)):r.setDisplayConfiguration({displayMode:Ne.a.Variable,desiredHeight:0}).then((function(){t(n)}))}Ue(e.getState(),r);break;case te.a.DisplayDraftWarningType:Ue(e.getState());break;case te.a.CancelCommentCreateThreadType:case te.a.CancelCommentPostEditType:case te.a.CancelCommentReplyType:if(n.payload.closeOnDiscard){r=he.d(e.getState());return t(n),void r.closeView()}}var o=e.getState(),i=t(n),a=e.getState();return function(e,t,n,r){var o=he.d(r);if(!Object(Me.a)(o))return;var i=ue.p(r),a=ue.p(n),s=ue.i(r),c=ue.i(n),d=Object(V.c)(s,i),u=Object(V.c)(c,a),l=ue.g(r),m=ue.g(n);if(d!==u||!Object(Me.a)(he.d(n))||!l&&m){if(!d)return l?void(F.z()?Be(e,t,{displayMode:Ne.a.Variable,desiredHeight:0}):o.setDisplayConfiguration({displayMode:Ne.a.Variable,desiredHeight:0}).catch((function(e){Object(k.b)(e)?Object(f.g)().assertConditionTag(!1,e.message,593278689):Object(f.g)().assertConditionTag(!1,"Unknown error in updateViewContainerOnDraftingChange when setting HalfPane display mode to Variable "+e,593278690)}))):void(F.z()?Be(e,t,{displayMode:Ne.a.Normal}):o.setDisplayConfiguration({displayMode:Ne.a.Normal}).catch((function(e){Object(k.b)(e)?Object(f.g)().assertConditionTag(!1,e.message,593278691):Object(f.g)().assertConditionTag(!1,"Unknown error in updateViewContainerOnDraftingChange when setting HalfPane display mode to Normal "+e,593278720)})));if(i&&l&&i.selectedCardId===l.draftId)return;F.z()?Be(e,t,{displayMode:Ne.a.FullScreen}):o.setDisplayConfiguration({displayMode:Ne.a.FullScreen}).catch((function(e){Object(k.b)(e)?Object(f.g)().assertConditionTag(!1,e.message,593278721):Object(f.g)().assertConditionTag(!1,"Unknown error in updateViewContainerOnDraftingChange when setting HalfPane display mode to FullScreen "+e,593278722)}))}}(e.dispatch,n.actionDetail,o,a),i}}}};function Ue(e,t){(function(e){var t=he.e(e);return F.B()&&(F.gb()?F.q()?t===S.a.Hidden:t!==S.a.Visible:!he.b(e)&&!F.q())})(e)&&(t||he.d(e)).openView()}function Be(e,t,n){e(Object(Ve.a)(t,n)).catch((function(e){Object(k.b)(e)?Object(f.g)().assertConditionTag(!1,e.message,578426776):Object(f.g)().assertConditionTag(!1,"Unknown error in updateViewContainerOnDraftingChange when setting HalfPane display mode to Variable "+e,578426777)}))}function He(e,t,n,i,d,u){var m=Object(r.compose)(Object(r.applyMiddleware)(c,a,o.default,we,Fe(i),function(e,t){return function(n){var r=fe(n,t);return function(t){return function(o){switch(o.type){case N.a.CommentContextChangedType:r.reset();break;case N.a.ClearCommentHighlightType:if(void 0===n.getState().commentState.highlightedCommentId)break;return t(o),void(o.payload.actionSource===ce.a.SharedComments&&void 0===n.getState().commentState.highlightedCommentId&&e.highlightComment(""));case N.a.ClearCommentHighlightType_deprecated:o.payload.actionSource===ce.a.SharedComments&&e.highlightComment("");break;case N.a.DisplayDraftWarningType:if(t(o),F.O()&&!F.Fb()){var i=n.getState(),a=ue.i(i),s=void 0;if(F.rb()){s=null==(S=ue.r(i))?void 0:S.threadId}else{var c=ue.p(i);s=c&&Object(V.d)(a,c)?c.selectedCardId:void 0}s&&e.selectComment(s)}return;case N.a.CommitDraftType:var d=n.getState(),u=me.b(n.getState()),l=ue.r(d);if(void 0!==l){var m=l.commentDraft;if(o.payload.metadataUpdates&&o.payload.metadataUpdates.Task){var p=void 0;m.sessionConfiguration.sessionType!==se.a&&m.sessionConfiguration.sessionType!==se.b&&(p=u[m.sessionConfiguration.threadId]&&u[m.sessionConfiguration.threadId].id),o.payload.metadataUpdates.Task.taskId=p,m.updateProperties("Task",o.payload.metadataUpdates.Task)}o.payload.data.temporaryCommentId=m.commit(o.payload.data.commentBody)}break;case N.a.QueueLoadThreadsType:var g=n.getState();return z.K(ue.l(g),ue.v(g))?void r(o.payload.threadIds):void Object(f.g)().assertConditionTag(!1,"Load threads should not be queued if host is not virtualizing comments.",593768920);case N.a.DispatchLoadThreadsType:var h=n.getState();if(!z.K(ue.l(h),ue.v(h)))return;e.loadThreads(o.payload.threadIds);break;case N.a.SessionRequestStartedAndLockSelectionType:Object(y.f)(o.payload.params)&&e.selectComment(o.payload.params.threadId);break;case N.a.HighlightCommentType:o.payload.actionSource===ce.a.SharedComments&&e.highlightComment(o.payload.commentId);break;case N.a.RequestDeletePostType:var C=n.getState(),v=ue.i(C),b=ue.p(C);if(F.wb()){if(Object(V.d)(v,b))return}else if(b&&!Object(L.d)(b.selectionDetails)&&b.selectionDetails.selectedPostId===o.payload.commentId&&Object(V.d)(v,b))return;e.deleteComment(o.payload.commentId);break;case N.a.RequestDeleteThreadType:var T=n.getState(),I=ue.i(T),O=ue.p(T);if(F.wb()&&Object(V.d)(I,O))return;e.deleteComment(o.payload.commentId);break;case N.a.RequestThreadResolveType:if(F.b())(S=e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId})).then((function(e){var t=me.b(n.getState())[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:100,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!0}),e.commit(),e.endDrafting()})).catch((function(e){Object(k.b)(e)?Object(f.g)().assertConditionTag(!1,e.message,593768922):Object(f.g)().assertConditionTag(!1,"Unknown error in CommentAPIMiddleware "+e,593768923)}));else e.setThreadResolvedState(o.payload.commentId,!0);break;case N.a.RequestReopenThreadType:var S;if(F.b())(S=e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId})).then((function(e){var t=me.b(n.getState())[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:0,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!1}),e.commit(),e.endDrafting()})).catch((function(e){Object(k.b)(e)?Object(f.g)().assertConditionTag(!1,e.message,593768924):Object(f.g)().assertConditionTag(!1,"Unknown error in CommentAPIMiddleware "+e,593768925)}));else e.setThreadResolvedState(o.payload.commentId,!1);break;case N.a.SelectFirstThreadInNextCommentContextType:e.selectFirstThreadInNextCommentContext();break;case N.a.SelectLastThreadInPreviousCommentContextType:e.selectLastThreadInPreviousCommentContext();break;case N.a.SelectCommentType:var j=n.getState();t(o);var D=n.getState(),w=ue.p(j),_=ue.p(D);return void(o.payload.source===ce.a.SharedComments&&_&&(null==w?void 0:w.selectedCardId)!==(null==_?void 0:_.selectedCardId)&&e.selectComment(_?null==_?void 0:_.selectedCardId:""));case N.a.ShowLowFidelityWarningType:var x=ue.p(n.getState()),E=x?x.selectedCardId:void 0;t(o);var P=ue.p(n.getState()),A=P?P.selectedCardId:void 0;return void(A&&A!==E&&e.selectComment(A))}return t(o)}}}}(e,i),Ie,Le(),function(e){return function(t){return function(t){return function(n){switch(n.type){case te.a.DisplayDraftWarningType:Object(xe.b)(Ee.f(e,n.payload.draftWarningType))}return t(n)}}}}(u),function(e){return function(t){return function(n){return function(r){var o,i,a;switch(r.type){case te.a.AddContentExtensionType:r.payload.extension.priority=ve(r.payload.extension.provider.scope.renderMode,t.getState());break;case te.a.RemoveContentExtensionType:try{for(var c=Object(l.__values)(r.payload.renderModes),d=c.next();!d.done;d=c.next()){var u=d.value,f=ge.a(t.getState())[u];f&&f.controller.unregisterExtension()}}catch(e){o={error:e}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(o)throw o.error}}break;case te.a.UpdateExtensionPriorityType:n(r),be(t.getState(),pe.d.Integrated),be(t.getState(),pe.d.Isolated);break;case te.a.ApplyCommentChangesType:case te.a.CancelCommentCreateThreadType:if(Ce(t,r,n))return;break;case te.a.CommentContextChangedType:case te.a.LoadCommentType:case te.a.LoadVirtualizedCommentsType:case te.a.ReloadCommentsType:case te.a.ViewContainerVisibilityChangedType:return n(r),void t.dispatch(Object(te.V)({renderContextType:D.a.None,telemetryVisitor:e,trackback:s.d.reserveTag(594834319)},(a={},a[pe.d.Integrated]=ve(pe.d.Integrated,t.getState()),a[pe.d.Isolated]=ve(pe.d.Isolated,t.getState()),a)));case te.a.BeginDraftingSuccessType:var m=r.payload.draftDetails,p=Object(v.a)(m)?m.sessionConfiguration:m;if(ye(t,r,n,p.sessionType))return;break;case te.a.BeginDraftingFailureType:if(ye(t,r,n,r.payload.beginDraftingParams.sessionType))return;break;case te.a.UpdateDraftRenderContextType:if(r.payload.isClaimingLock||r.actionDetail.renderContextType===D.a.DiscreteIsolated)break;var g=ue.r(t.getState());if(g&&ye(t,r,n,g.commentDraft.sessionConfiguration.sessionType))return}return n(r)}}}}(i),function(e){return function(t){return function(n){return function(r){if(!F.Fb())return n(r);n(r);var o=t.getState();switch(r.type){case te.a.DisplayDraftWarningType:var i=ue.i(o);if(F.O()){var a=void 0;if(F.rb())a=null==(d=ue.r(o))?void 0:d.threadId;else a=(s=ue.p(o))&&Object(V.d)(i,s)?s.selectedCardId:void 0;a&&e.bringContentIntoView({contentIdentifier:{contentId:a,contentType:pe.b.CommentThread}})}break;case te.a.SelectCommentType:var s=ue.p(o),c=void 0;if(F.sb())c=!0;else if(F.rb()){var d=ue.r(o);c=!!s&&!!d&&s.selectedCardId===d.threadId}else{i=ue.i(o);c=Object(V.d)(i,s)}r.payload.source===ce.a.SharedComments&&c&&s&&e.bringContentIntoView({contentIdentifier:{contentId:s.selectedCardId,contentType:pe.b.CommentThread}});break;case te.a.ViewContainerVisibilityChangedType:if(he.a(o))break;var u=F.Ib()?ue.r(o):ue.s(o),l=void 0;if(F.rb())l=u&&u.isInCurrentContext?u.threadId:void 0;else{i=ue.i(o);l=(s=ue.p(o))&&Object(V.d)(i,s)&&(null==u?void 0:u.isInCurrentContext)?s.selectedCardId:void 0}l&&e.bringContentIntoView({contentIdentifier:{contentId:l,contentType:pe.b.CommentThread}});break;case te.a.SelectContentType:e.selectNextOrPreviousContent(r.payload.selectDirection,r.payload.from);break;case te.a.MoveFocusToCanvasType:e.moveFocus({region:Te.a.Canvas,resource:r.payload.resource})}}}}}(d)));return Object(r.createStore)(ae,n,m)}n.d(t,"a",(function(){return He}))},8:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.AddContentExtensionType="ADD_CONTENT_EXTENSION",e.AddToCurrentMentioneesType="ADD_TO_CURRENT_MENTIONEES",e.ApplyCommentChangesType="APPLY_COMMENT_CHANGES",e.BeginDraftingFailureType="BEGIN_DRAFTING_FAILURE",e.BeginDraftingSuccessType="BEGIN_DRAFTING_SUCCESS",e.BeginProcessingCommitType="BEGIN_PROCESSING_COMMIT",e.BeginProcessingDiscardType="BEGIN_PROCESSING_DISCARD",e.BeginViewInitialization="BEGIN_VIEW_INIT",e.CallDeleteCommentType="CALL_DELETE_COMMENT",e.CancelCommentCreateThreadType="CANCEL_COMMENT_CREATE_THREAD",e.CancelCommentPostEditType="CANCEL_COMMENT_POST_EDIT",e.CancelCommentReplyType="CANCEL_COMMENT_REPLY",e.CancelDiscardType="CANCEL_DISCARD",e.ClearCommentHighlightType="CLEAR_COMMENT_HIGHLIGHT",e.ClearCommentHighlightType_deprecated="CLEAR_COMMENT_HIGHLIGHT_DEPRECATED",e.ClearCommentSelectionType="CLEAR_COMMENT_SELECTION",e.ClearCommentsType="CLEAR_COMMENTS",e.ClearPostErrorUIType="CLEAR_POST_ERROR_STATE",e.CommentContextChangedType="COMMENT_CONTEXT_CHANGED",e.CommitDraftType="COMMIT_DRAFT",e.CommitFailureType="COMMIT_FAILURE",e.ContextDetailsUpdatedType="CONTEXT_DETAILS_UPDATED",e.DeleteCommentsType="DELETE_COMMENTS",e.DispatchLoadThreadsType="DISPATCH_LOAD_THREADS",e.DisplayDraftWarningType="DISPLAY_DRAFT_WARNING",e.DraftEmptinessChangedType="DRAFT_EMPTINESS_CHANGED",e.EmptyActionType="",e.EndViewInitialization="END_VIEW_INIT",e.EndCommentSessionType="END_COMMENT_SESSION",e.EnterEditCommentModeOnClickType="ENTER_EDIT_COMMENT_MODE_ON_CLICK",e.HighlightCommentType="HIGHLIGHT_COMMENT",e.SessionRequestStartedAndLockSelectionType="SESSION_REQUEST_STARTED",e.InsertCommentType="INSERT_COMMENT",e.LoadCommentType="LOAD_COMMENT",e.LoadPersonaIconPropertiesType="LOAD_PERSONA_ICON_PROPERTIES",e.MoveFocusToCanvasType="MOVE_FOCUS_TO_CANVAS",e.NextPopulatedContextDetailsUpdatedType="NEXT_POPULATED_CONTEXT_DETAILS_UPDATED",e.OnInitialRenderType="ON_INITIAL_RENDER",e.PopulateSmartReplyType="POPULATE_SMART_REPLY",e.UpdateMentioneesStillInDraftType="UPDATE_MENTIONEES_STILL_IN_DRAFT",e.QueueLoadThreadsType="QUEUE_LOAD_THREADS",e.ReadyToRenderType="READY_TO_RENDER",e.ReloadCommentsType="RELOAD_COMMENTS",e.RemoveContentExtensionType="REMOVE_CONTENT_EXTENSION",e.RequestClosePaneType="REQUEST_CLOSE_PANE",e.RequestDeletePostType="REQUEST_DELETE_POST",e.RequestDeleteThreadType="REQUEST_DELETE_THREAD",e.RequestDisplayConfigurationType="REQUEST_DISPLAY_CONFIG",e.RequestModalConfirmationType="REQUEST_MODAL_CONFIRMATION",e.RequestReopenThreadType="REQUEST_REOPEN_THREAD",e.RequestShowPaneType="REQUEST_SHOW_PANE",e.RequestThreadResolveType="REQUEST_THREAD_RESOLVE",e.ResolveAtMentionCapabilityType="RESOLVE_ATMENTION_CAPABILITY",e.SaveDraftType="SAVE_DRAFT",e.SelectCommentType="SELECT_COMMENT",e.SelectContentType="SELECT_CONTENT",e.SelectFirstThreadInNextCommentContextType="SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT",e.SelectLastThreadInPreviousCommentContextType="SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT",e.ShowLowFidelityWarningType="SHOW_LOW_FIDELITY_WARNING",e.ShowPostErrorUIType="SHOW_POST_ERROR_STATE",e.TopVisibleThreadChangedType="TOP_VISIBLE_THREAD_CHANGED",e.UpdateAtMentionAuthTokenType="UPDATE_ATMENTION_AUTH_TOKEN",e.UpdateCapabilitiesType="UPDATE_CAPABILITIES",e.UpdateModelCapabilitiesType="UPDATE_MODEL_STATE",e.UpdateCommentType="UPDATE_COMMENT",e.UpdateContextStateType="UPDATE_CONTEXT_DETAILS",e.UpdateDraftRenderContextType="UPDATE_DRAFT_RENDER_CONTEXT",e.UpdateDraftThreadType="UPDATE_DRAFT_THREAD",e.UpdateFocusTypeAfterContextChangeType="UPDATE_FOCUS_TYPE_AFTER_CONTEXT_CHANGE",e.UpdateCurrentMentioneesType="UPDATE_CURRENT_MENTIONEES",e.ViewContainerChangedType="VIEW_CONTAINER_CHANGED",e.ViewContainerDisplayConfigurationChangedType="VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED",e.ViewContainerFoldableLayoutStateChangedType="VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED",e.ViewContainerVisibilityChangedType="VIEW_CONTAINER_VISIBILITY_CHANGED",e.LoadVirtualizedCommentsType="VIRTUALIZE_COMMENTS",e.UpdateSelectedTaskAssigneeType="UPDATE_SELECTED_TASK_ASSIGNEE",e.UpdateExtensionPriorityType="UPDATE_EXTENSION_PRIORITY",e.UpdateSuggestionsDetailsType="UPDATE_SUGGESTIONS_DETAILS"}(r||(r={}))},809:function(e,t,n){"use strict";var r,o=n(1),i=n(0);function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.apply(void 0,Object(i.__spreadArrays)(n,t))}),t)}function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){return e.apply(void 0,t)}),t)}function c(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(r)throw new Error("Recursive calls of hooks is not supported!");r=e;var o=s.apply(void 0,t);return r=void 0,o}}n.d(t,"a",(function(){return u}));var d,u={useMemo:c(o.useMemo),useEffect:c(o.useEffect),useLayoutEffect:c(o.useLayoutEffect),useCallback:(d=o.useCallback,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(r)throw new Error("Recursive calls of hooks is not supported!");r=d;var n=a.apply(void 0,e);return r=void 0,n})}},81:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(650);Object.defineProperty(t,"RekaInstance",{enumerable:!0,get:function(){return r.RekaInstance}});var o=n(650);Object.defineProperty(t,"DataServiceManager",{enumerable:!0,get:function(){return o.RekaInstance}});var i=n(652);Object.defineProperty(t,"CustomTypeRegistry",{enumerable:!0,get:function(){return i.CustomTypeRegistry}});var a=n(651);Object.defineProperty(t,"RekaServiceRegistry",{enumerable:!0,get:function(){return a.RekaServiceRegistry}}),Object.defineProperty(t,"registerClasses",{enumerable:!0,get:function(){return a.registerClasses}});var s=n(651);Object.defineProperty(t,"DataServiceRegistry",{enumerable:!0,get:function(){return s.RekaServiceRegistry}});var c=n(351);Object.defineProperty(t,"EventImpl",{enumerable:!0,get:function(){return c.EventImpl}})},83:function(e,t,n){"use strict";n.d(t,"k",(function(){return C})),n.d(t,"l",(function(){return y})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return b})),n.d(t,"h",(function(){return T})),n.d(t,"g",(function(){return I})),n.d(t,"e",(function(){return O})),n.d(t,"i",(function(){return S})),n.d(t,"d",(function(){return j})),n.d(t,"f",(function(){return D})),n.d(t,"j",(function(){return w})),n.d(t,"b",(function(){return _}));var r=n(0),o=n(3),i=n(203),a=n(76),s=n(238),c=n(110),d=n(21),u=n(87),l=n(7),f=n(141),m=n(158),p=n(347);function g(e,t,n){for(var r=t;r<e.length;++r)if(e[r].commentId===n.commentId)return r;return-1}function h(e,t,n,r,i,a){for(var s=[],c=t,d=i;c<=n&&d<=a;){var u=e[c].date;Object(o.g)().assertConditionTag(!!u,"commentDate should not be undefined",595719177),!u||u<=r.history[d].records[0].time?(Object(o.g)().assertConditionTag(e[c].parentId===r.commentId,"comments must belong to the same thread",595719173),s.push({commentModel:e[c]}),++c):(Object(o.g)().assertConditionTag(!r.history[d].commentId,"Unachored history item should not have commentId",595719178),s.push({historyItem:r.history[d],parentThreadId:r.commentId}),++d)}for(;c<=n;++c)s.push({commentModel:e[c]});for(;d<=a;++d)Object(o.g)().assertConditionTag(!r.history[d].commentId,"Unachored history item should not have commentId",595719179),s.push({historyItem:r.history[d],parentThreadId:r.commentId});return s}function C(e,t){if(!l.b()||!t||0===t.history.length)return e.map((function(e){return{commentModel:e}}));var n=!0;if(l.c()||t.commentId===t.history[0].commentId||(Object(o.g)().assertConditionTag(!1,"taskItem.commentId must match the first history item",595719174),n=!1),e[0].commentId!==t.commentId&&(Object(o.g)().assertConditionTag(!1,"TaskItem must be paired with the root comment",595719303),n=!1),!n)return e.map((function(e){return{commentModel:e}}));var i=[];l.c()||i.push({commentModel:e[0],historyItem:t.history[0]});for(var a=l.c()?0:1,s=l.c()?0:1,c=l.c()?0:1;a<e.length&&c<t.history.length;){var d=g(e,a,t.history[c]);d>=0&&(i.push.apply(i,Object(r.__spread)(h(e,a,d-1,t,s,c-1))),Object(o.g)().assertConditionTag(0===d||e[d].parentId===t.commentId,"comments must belong to the same thread",595719175),i.push({commentModel:e[d],historyItem:t.history[c]}),a=d+1,s=c+1),++c}return i.push.apply(i,Object(r.__spread)(h(e,a,e.length-1,t,s,t.history.length-1))),i}function y(e,t){for(var n=[],o=0,i=1;i<=e.length;i++)(i===e.length||Object(a.a)(e[i]))&&(n.push.apply(n,Object(r.__spread)(C(e.slice(o,i),t[e[o].commentId]))),o=i);return n}function v(e){return e.filter(m.a).map((function(e){return e.commentModel}))}function b(e,t){var n=e.find((function(e){return Object(m.a)(e)&&e.commentModel.commentId===t}));if(Object(m.a)(n))return n.commentModel}function T(e){var t=e[0];if(Object(m.a)(t))return t.commentModel;throw new d.a(u.a,2130957505)}function I(e){return Object(m.a)(e)?e.commentModel.parentId:e.parentThreadId}function O(e){return Object(m.a)(e)?e.commentModel.commentId:e.historyItem.records[0].recordId}function S(e){return Object(m.a)(e)?Object(a.b)(e.commentModel):e.parentThreadId}function j(e,t){var n=e.records[0];switch(n.type){case s.a.Create:if(!(i=e.records[1])||i.type!==s.a.Assign)return Object(o.g)().assertConditionTag(!1,"HistoryRecordType Create encountered without Assign ",595723398),{icon:0,description:"Unexpected HistoryRecordType"};var r=Object(c.g)(i.assignee);return{icon:13,description:t.formatString(114,r)};case s.a.UnassignAll:case s.a.Unassign:var i;if(!(i=e.records[1])||i.type!==s.a.Assign)return Object(o.g)().assertConditionTag(!1,"HistoryRecordType Unassign encountered without Assign ",595723399),{icon:14,description:t.getString(204)};r=Object(c.g)(i.assignee);return{icon:14,description:t.formatString(115,r)};case s.a.Progress:return 100===n.completion?{icon:15,description:t.getString(116)}:{icon:21,description:t.getString(117)};case s.a.Schedule:return{icon:17,description:t.getString(118)};default:return Object(o.g)().assertConditionTag(!1,"Unexpected HistoryRecordType",595723400),{icon:0,description:t.getString(119)}}}function D(e,t){return e.findIndex((function(e){return e.length>0&&S(e[0])===t}))}function w(e,t){return e.some((function(e){return Object(m.a)(e)&&!!(e.commentModel.commentFlags&i.e.LowFidelity)&&(void 0===t||t===e.commentModel.parentId||t===e.commentModel.commentId)}))}function _(e,t,n,r,i){for(var a=[],s=!i&&void 0!==n&&(void 0===n.newComment.parentId||""===n.newComment.parentId)&&n.index>=0,c=v(e).length,d=n&&n.index===c?c:-1,u=-1,l=0;l<e.length;l+=1){var g=e[l],h=Object(m.a)(g)?g:void 0;if(h&&void 0!==t[h.commentModel.commentId])if(t[h.commentModel.commentId].pending===f.a.Delete&&r)for(;!(l+1>=e.length||""===I(e[l+1]));)++l;else{++u,a.push([h]),s&&-1===d&&n&&u===n.index&&(d=a.length-1);for(var C=l+1;C<e.length;C+=1){var y=e[C];if(Object(m.a)(y)){var b=I(y);if(b!==h.commentModel.commentId){Object(o.g)().assertConditionTag(!b,"Orphaned reply with id "+O(y)+", expected parent "+h.commentModel.commentId+" but was "+b,593085889);break}a[a.length-1].push(y),++u}else a[a.length-1].push(y);++l}}else{var T=h?h.commentModel.commentId:"",S=h?h.commentModel.parentId:"";for(Object(o.g)().assertConditionTag(!1,"CommentData corruption detected with orphaned reply. Skipping to allow render. commentDataLength: "+e.length+" | cardViewStateLength: "+Object.keys(t).length+" | isLieThread: "+s+" | CommentId: "+T+" | ParentId: "+S,593085888);!(l+1>=e.length||""===I(e[l+1]));)++l}}if(-1!==d&&s&&n){var j=Object(p.a)(n);a.splice(d,0,[{commentModel:j}])}return a}},830:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},831:function(e,t,n){var r=n(1037);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},832:function(e,t,n){var r=n(833),o=n(835),i=n(1038);e.exports=function(e){return function(t,n,a){var s,c=r(t),d=o(c.length),u=i(a,d);if(e&&n!=n){for(;d>u;)if((s=c[u++])!=s)return!0}else for(;d>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}}},833:function(e,t,n){var r=n(648),o=n(649);e.exports=function(e){return r(o(e))}},834:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},835:function(e,t,n){var r=n(836),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},836:function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},837:function(e,t,n){var r=n(838)("unscopables"),o=Array.prototype;null==o[r]&&n(645)(o,r,{}),e.exports=function(e){o[r][e]=!0}},838:function(e,t,n){var r=n(647)("wks"),o=n(646),i=n(429).Symbol,a="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=r},839:function(e,t,n){n(1043),e.exports=n(341).Array.findIndex},84:function(e,t,n){"use strict";function r(e){return void 0!==e.numberOfComments&&void 0!==e.numberOfThreads}function o(e){return void 0!==e.comments||void 0!==e.threads}function i(e){return void 0!==e.threads&&void 0===e.comments}var a;function s(e){return(void 0!==e.comments||void 0!==e.commentIds)&&void 0!==e.numberOfThreads}function c(e){return void 0!==e.commentIds&&void 0!==e.numberOfThreads}function d(e){return void 0!==e.changes}function u(e){return void 0!==e.commentId}function l(e){return void 0!==e.commentId}function f(e){return void 0!==e.contextDetails}function m(e){return void 0!==e.capabilities}function p(e){return void 0!==e.modelCapabilityFlags}function g(e){return void 0!==e.errorType}function h(e){return void 0!==e.draftId}function C(e){return void 0!==e.draftId}function y(e){return void 0!==e.commentId&&void 0!==e.smartReplies}n.d(t,"b",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"p",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"l",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"m",(function(){return h})),n.d(t,"o",(function(){return C})),n.d(t,"n",(function(){return y})),function(e){e[e.Thread=0]="Thread",e[e.Reply=1]="Reply"}(a||(a={}))},840:function(e,t,n){var r=n(649);e.exports=function(e){return Object(r(e))}},841:function(e,t,n){n(1048),e.exports=n(341).Object.assign},844:function(e,t,n){"use strict";var r=n(351),o=function(e){this.onMockUIAction=new r.EventImpl((function(){}))};t.a=o},845:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-1.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M7.4375,24.8349609 C7.875,24.8349609 8.29654745,24.8919265 8.70214844,25.0058594 C9.10774942,25.1197922 9.48827947,25.2815745 9.84375,25.4912109 C10.1992205,25.7008474 10.522785,25.9514959 10.8144531,26.2431641 C11.1061213,26.5348322 11.3567698,26.8583967 11.5664062,27.2138672 C11.7760427,27.5693377 11.937825,27.9498678 12.0517578,28.3554688 C12.1656907,28.7610697 12.2226562,29.1826172 12.2226562,29.6201172 C12.2226562,30.2444693 12.1030285,30.8471651 11.8637695,31.4282227 C11.6245105,32.0092802 11.2838564,32.5208311 10.8417969,32.9628906 L5.12011719,38.6777344 L4.50488281,38.0625 L10.2197266,32.3408203 C10.5797544,31.9807925 10.8577464,31.5649438 11.0537109,31.0932617 C11.2496755,30.6215797 11.3476562,30.1305364 11.3476562,29.6201172 C11.3476562,29.0869114 11.2439789,28.5833357 11.0366211,28.109375 C10.8292633,27.6354143 10.5478533,27.2207049 10.1923828,26.8652344 C9.83691229,26.5097638 9.42220289,26.2283539 8.94824219,26.0209961 C8.47428148,25.8136383 7.97070579,25.7099609 7.4375,25.7099609 C6.94531004,25.7099609 6.51123235,25.7840162 6.13525391,25.9321289 C5.75927546,26.0802416 5.41178545,26.2762032 5.09277344,26.5200195 C4.77376143,26.7638359 4.46728663,27.0406886 4.17333984,27.3505859 C3.87939306,27.6604833 3.57063964,27.9794905 3.24707031,28.3076172 L6.125,28.3076172 L6.125,29.1826172 L1.75,29.1826172 L1.75,24.8076172 L2.625,24.8076172 L2.625,27.6855469 C2.87565229,27.4303373 3.11604703,27.1831067 3.34619141,26.9438477 C3.57633579,26.7045886 3.80647671,26.479005 4.03662109,26.2670898 C4.26676547,26.0551747 4.50146365,25.8614918 4.74072266,25.6860352 C4.97998167,25.5105785 5.23518745,25.3601894 5.50634766,25.2348633 C5.77750787,25.1095371 6.07145024,25.0115563 6.38818359,24.940918 C6.70491695,24.8702796 7.05468559,24.8349609 7.4375,24.8349609 Z",id:"Reopen"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},846:function(e,t,n){"use strict";var r=n(1077).SharedCommentsVersion;t.a=r},847:function(e,t,n){"use strict";var r;!function(e){e[e.NoDialog=0]="NoDialog",e[e.AbandonDraft=1]="AbandonDraft",e[e.ResumeDrafting=2]="ResumeDrafting"}(r||(r={})),t.a=r},848:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(3),o=n(7),i=n(15),a=n(18),s=n(140),c=n(135);function d(e,t,n){var d=o.rb()?Object(i.H)(e):function(e,t){if(!t)return;if(Object(a.d)(t.selectionDetails))return e.drafts[e.cardIdToDraftIdMap[t.selectedCardId]];return e.drafts[e.postIdToDraftIdMap[t.selectionDetails.selectedPostId]]}(e,n);if(!d)return Object(r.g)().assertConditionTag(!1,"Attempting to discard a draft when no draft is active within card.",593085890),Object(c.b)(t)?s.a.ClosePaneDraft:s.a.CancelNewDraft;switch(d.commentDraft.sessionConfiguration.sessionType){case"CREATE":return s.a.CancelNewDraft;case"EDIT":return s.a.CancelPostEdit;case"REPLY":return s.a.CancelReplyDraft;case"METADATA":return Object(r.g)().assertConditionTag(!1,"Metadata session should not be canceled with modal dialog.",593085891),s.a.CancelNewDraft}}},87:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"m",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"o",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"l",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"n",(function(){return f})),n.d(t,"f",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"p",(function(){return C})),n.d(t,"a",(function(){return y}));var r="Selection bug - selection is not on card after typing in the reply box",o="Selected comment not found",i="Selected thread index out of bounds",a="Invalid number of posts for display more replies string",s="Unrecognized post display mode",c="Method not implemented",d="CommentId not found in model",u="StringId is invalid",l="LocalizationModule NativeModule not valid",f="Store state unexpected",m="Editor reference is invalid",p="Invalid arguments",g="Comment ID value is invalid in the current operation",h="Attempting to perform an operation on an inactive draft",C="Feature not running with the correct feature gates which expect view manager construction",y="CommentModel not found in a thread of RenderableItems"},9:function(e,t,n){"use strict";var r,o,i=function(){},a=function(){},s=function(){},c=n(163),d=Object(c.g)(0),u={reserve:function(){return d},reserveTag:c.g};!function(e){e[e.None=0]="None",e[e.Redux=1]="Redux",e[e.Comments=2]="Comments"}(r||(r={}));function l(e,t){if(o){var n=null===window||void 0===window?void 0:window.performance;if(n&&"function"==typeof n.measure&&"function"==typeof n.mark)return new o(e,t,n)}}function f(e){throw new Error("Unreachable throw hit! Passed in value is "+e+".")}function m(e,t){if(!e)throw new Error(t)}function p(){try{throw new Error}catch(e){return e.stack?e.stack.split("\n").slice(2,3).join("\n"):"<unable to get stack>"}}n.d(t,"k",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"b",(function(){return!1})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return r})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return f}))},90:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return r}));var r,o=n(321);function i(e){return e===o.a.CheckEnabled}function a(e){return e===o.a.CheckToggled}function s(e){return e===o.a.Execute}!function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.NotHandled=2]="NotHandled"}(r||(r={}))},907:function(e,t,n){"use strict";var r,o=n(0),i=n(9),a=n(163),s=n(3),c=n(303),d=n(32),u=n(413),l=n(111),f=n(321),m=n(122),p=n(148),g=n(113),h=n(90),C=n(84),y=n(253),v=n(213),b=n(175),T=n(20),I=n(330),O=n(124),S=n(136),j=n(125),D=n(7),w=n(14),_=n(37),x=n(382),E=n(15),P=n(141),A=n(39),k=n(187),R=n(18),F=n(11),N=n(58),M=n(139);!function(e){e[e.NoCommand=0]="NoCommand",e[e.ShouldRetry=1]="ShouldRetry",e[e.Handled=2]="Handled"}(r||(r={}));var V,L=n(95),U=n(105),B=n(135);function H(e,t){return{type:V.DispatchAction,action:t,causedBy:e}}function z(e){return e.type===V.FocusComponent&&void 0!==e.component}function W(e,t,n){return Object(o.__assign)({type:V.FocusComponent,component:t,causedBy:e},n)}!function(e){e[e.FocusComponent=0]="FocusComponent",e[e.FocusTag=1]="FocusTag",e[e.DispatchAction=2]="DispatchAction",e[e.Compound=3]="Compound"}(V||(V={}));var q=n(224),G=n(35);function Y(e,t){if(void 0===t&&(t=!1),!t||(n=e.renderContextType,Object(U.a)()!==L.a.Windows&&(Object(U.a)()!==L.a.iOS||n!==T.a.FullPane)&&Object(B.b)(n))){var n;if(e.getComponent(G.a.ClosePaneButton))return W(void 0,{componentType:G.a.ClosePaneButton});Object(s.g)().assertConditionTag(t&&(Object(U.a)()===L.a.Windows||Object(U.a)()===L.a.iOS&&e.renderContextType===T.a.FullPane),"cant find close button on platform where we should be able to find it",579086371)}}var K=n(508);function J(e,t,n){return t?n?{type:V.Compound,first:t,then:n,causedBy:e}:t:n}function Q(e,t){if(t)t.focus(e.preventScroll?{preventScroll:e.preventScroll}:void 0);else if(e.shouldRetryOnMount||e.shouldRetryOnCardPropsUpdate)return r.ShouldRetry;return r.Handled}function X(e,t,n){if(!e)return r.NoCommand;var o=r.Handled;if(z(e)){var a=e.component;if(D.x()&&a.componentType===G.a.Card&&Object(U.a)()===L.a.iOS&&(K.a&&Object(i.g)("Switching focus command from Card to Post to workaround iOS platform difference with card container focus"),a.componentType=G.a.Post),Object(G.c)(a))o=Q(e,t.getComponentById(a));else if(a.componentType!==G.a.Unknown){var s=a.componentType;o=Q(e,t.getComponent(s))}}else!function(e){return e.type===V.DispatchAction&&void 0!==e.action}(e)?function(e){return e.type===V.Compound&&void 0!==e.first&&void 0!==e.then}(e)&&(X(e.first,t,n),X(e.then,t,n)):n.dispatch(e.action);return e.stopPropagation&&e.causedBy&&e.causedBy.stopPropagation(),e.preventDefault&&e.causedBy&&e.causedBy.preventDefault(),o}var Z=function(){function e(e){this._sourceEvent=e,this.eventPhase=e.eventPhase}return e.prototype.isEventTarget=function(e){return e===this._sourceEvent.target},e.prototype.stopPropagation=function(){this._sourceEvent.stopPropagation()},e.prototype.preventDefault=function(){this._sourceEvent.preventDefault()},e}(),$=function(e){function t(t){var n=e.call(this,t)||this,r=t.nativeEvent,o=r.altKey,i=r.shiftKey,a=r.ctrlKey,s=r.metaKey,c=r.key;return n.altKey=o,n.shiftKey=i,n.ctrlKey=a,n.metaKey=s,n.key=Object(S.f)(c),n}return Object(o.__extends)(t,e),t}(Z);function ee(e,t,n){var r=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return n.apply(void 0,Object(o.__spread)([e],t))},i=function(n){for(var i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];var s=r.apply(void 0,Object(o.__spread)([n],i)),c=X(s,n,e);t(s,c)};return i.processCommand=r,i}function te(e,t,n,r){var i=function(t,n){var r,i=Object(o.__read)(n),s=i[0],c=i.slice(1),d=s();X(a.apply(void 0,Object(o.__spread)([(r=t,new $(r)),d],c)),d,e)},a=function(e,i){for(var a=[],s=2;s<arguments.length;s++)a[s-2]=arguments[s];if(n(i)){var c=Object(S.d)(Object(S.f)(e.key),t),d=r[S.b[c]];return d?d.handler.apply(d,Object(o.__spread)([e,i],a)):void 0}},s=Object.keys(r).map((function(e){return{key:e,eventPhase:r[e].phase}})),c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{onKeyDown:function(t){return i(t,e)},getKeyDownEvents:function(){return s}}};return c.processEvent=a,c}var ne=n(168),re=function(){function e(e,t,n,a){var c=this;this.commentStore=e,this.selectionCommandFactory=t,this.isRTL=n,this.telemetryVisitor=a,this.focusToRetry=void 0,this.commandExecuteCallback=function(e,t){e&&z(e)&&(t===r.ShouldRetry?c.focusToRetry={command:Object(o.__assign)(Object(o.__assign)({},e),{shouldRetryOnMount:!1}),timestamp:Date.now()}:c.focusToRetry=void 0)},this.commentContentsKeyDown=te(this.commentStore,this.isRTL,(function(e){var t=F.i(c.commentStore.getState()),n=F.p(c.commentStore.getState());if(D.Hb()){var r=Object(E.F)(t);if(r&&e.isFocusOn({componentType:G.a.CardEditor,id:r,renderContextType:t.drafts[t.cardIdToDraftIdMap[r]].renderContextType}))return!1;var o=Object(E.G)(t);if(o&&e.isFocusOn({componentType:G.a.PostEditor,id:o,renderContextType:t.drafts[t.postIdToDraftIdMap[o]].renderContextType}))return!1}else if(Object(A.c)(t,n))return!1;return!D.Eb()||!e.isFocusOn({componentType:G.a.GhostCard})&&!e.isFocusOn({componentType:G.a.NewCommentButton})}),{ArrowDown:{handler:function(e,t,n){var r=c.onDownKey(e,t,n?n():void 0);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r},phase:S.a.Bubbling},ArrowUp:{handler:function(e,t,n){var r=c.onUpKey(e,t,n?n():void 0);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r},phase:S.a.Bubbling},ArrowRight:{handler:function(e,t,n){var r=c.onRightKey(e,t.renderContextType,n?n():void 0);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r},phase:S.a.Bubbling},ArrowLeft:{handler:function(e,t){var n=c.onLeftKey(e,t.renderContextType);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n},phase:S.a.Bubbling},Tab:{handler:function(e,t){if(!D.Bb()){var n=c.onTabKeyInPane(e,t.renderContextType);return n&&(n.stopPropagation=!0),n}},phase:S.a.None},Home:{handler:function(e,t){if(t.renderContextType===T.a.FullPane){var n=c.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,_.a.SharedComments,t.renderContextType);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:S.a.Capturing},End:{handler:function(e,t){if(t.renderContextType===T.a.FullPane){var n=c.selectionCommandFactory.selectLastThreadInCurrentContext(e,!1,_.a.SharedComments,t.renderContextType);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:S.a.Capturing},F12:{handler:function(e,t){var n=c.handleMoveFocusEvent(e,t);return n&&(n.stopPropagation=!0),n},phase:S.a.None}}),this.focusCommentCardCommand=ee(this.commentStore,this.commandExecuteCallback,(function(e,t){var n=F.i(c.commentStore.getState()),r=Object(E.H)(n),o=F.p(c.commentStore.getState());if(!D.Hb()&&(D.rb()?(null==r?void 0:r.threadId)===t:o&&o.selectedCardId===t)){var i=c.checkForActiveEditorFocus(void 0,e.renderContextType,n,o);if(i)return i}var a=W(void 0,{componentType:Object(q.b)(t,F.g(c.commentStore.getState())),id:t,renderContextType:e.renderContextType});return a.preventScroll=e.renderContextType===T.a.DiscreteIntegrated,a})),this.focusCommentPostCommand=ee(this.commentStore,this.commandExecuteCallback,(function(e,t){var n=F.i(c.commentStore.getState()),r=F.p(c.commentStore.getState());if(!D.Hb()&&(D.rb()?n.postIdToDraftIdMap[t]:r&&!Object(R.d)(r.selectionDetails)&&r.selectionDetails.selectedPostId===t)){var o=c.checkForActiveEditorFocus(void 0,e.renderContextType,n,r);if(o)return o}return W(void 0,{componentType:G.a.Post,id:t,renderContextType:e.renderContextType})})),this.focusCommentPaneCommand=ee(this.commentStore,this.commandExecuteCallback,(function(e){if(Object(B.b)(e.renderContextType)){var t=F.i(c.commentStore.getState()),n=F.p(c.commentStore.getState()),r=void 0;if(r=c.checkForActiveEditorFocus(void 0,e.renderContextType,t,n))return r;if(r=c.checkForCommentSelectionFocus(e.renderContextType,n,F.g(c.commentStore.getState())))return r;if(!D.N()){if(!e.getComponent(G.a.ClosePaneButton)){var o=F.e(c.commentStore.getState());return o.length>0?c.focusCommentCardCommand.processCommand(e,o[0].commentId):void Object(s.g)().assertConditionTag(Object(U.a)()===L.a.Windows||Object(U.a)()===L.a.iOS&&e.renderContextType===T.a.FullPane,"Shouldn't be reached on non-windows platforms",593802307)}return W(void 0,{componentType:G.a.ClosePaneButton})}if(D.M()&&Object(U.a)()!==L.a.iOS){var i=e.getComponent(G.a.NewCommentButton);if(!i||i.disabled)return W(void 0,{componentType:G.a.PaneRoot})}return W(void 0,{componentType:G.a.NewCommentButton})}Object(s.g)().assertConditionTag(!1,"paneContainerFocusHandler called outside of a pane render context",593802306)})),this.focusActiveEditorCommand=ee(this.commentStore,this.commandExecuteCallback,(function(e,t){if(D.rb()){var n=F.i(c.commentStore.getState());return c.checkForActiveEditorFocus(void 0,e.renderContextType,n,void 0)}var r=F.p(c.commentStore.getState());if(r&&r.selectionDetails.editingSession_deprecated===R.a.Active)switch(t.type){case"REPLY":case"CREATE":return W(void 0,{componentType:G.a.CardEditor,id:r.selectedCardId,renderContextType:e.renderContextType});case"EDIT":if(!Object(R.d)(r.selectionDetails))return W(void 0,{componentType:G.a.PostEditor,id:r.selectionDetails.selectedPostId,renderContextType:e.renderContextType});break;default:Object(s.g)().assertConditionTag(!1,"Unknown session type.",593802308)}})),this.commentCardMounted=ee(this.commentStore,this.commandExecuteCallback,(function(e,t){var n;if(n=c.handleFocusRetry({componentType:Object(q.b)(t.id,F.g(c.commentStore.getState())),id:t.id,renderContextType:e.renderContextType}))return n;var r=Object(B.b)(e.renderContextType);return r&&!e.isFocusWithinPane()||!(r||e.isFocusWithinAny(G.a.Card)||e.isFocusWithinAny(G.a.DraftCard))?void 0:t.selected?c.focusCommentCardCommand.processCommand(e,t.id):void 0})),this.commentCardEditorMounted=ee(this.commentStore,this.commandExecuteCallback,(function(e,t){return c.handleFocusRetry({componentType:G.a.CardEditor,id:t,renderContextType:e.renderContextType})})),this.commentPostEditorMounted=ee(this.commentStore,this.commandExecuteCallback,(function(e,t){return c.handleFocusRetry({componentType:G.a.PostEditor,id:t,renderContextType:e.renderContextType})})),this.commentPanePropsUpdated=ee(this.commentStore,this.commandExecuteCallback,(function(e,t,n){var r;if(r=c.checkForRetryCommandOnPropsUpdated(e))return r;if(r=c.checkIfCardEditorShouldFocusForReturnToDraft(e,t.draftState,n.draftState))return r;if(r=c.checkIfPostEditorShouldFocusForReturnToDraft(e,t.draftState,n.draftState))return r;if(r=c.checkForNewDraft(e.renderContextType,t.draftState,n.draftState))return r;var o=t.draftState,i=n.draftState,a=t.selectedCommentInfo&&t.selectedCommentInfo.selectedComment,s=n.selectedCommentInfo&&n.selectedCommentInfo.selectedComment;return(r=c.checkForDiscard(e,o,i,a,s))||D.z()&&(r=c.checkForHalfPaneFullTransition(e,t,n))?r:e.isFocusWithinPane()?(r=c.checkForSelectionChange(e,i,a,s))||(r=c.checkForCardPendingChange(e,t.cardViewStates,n.cardViewStates,n.createdCommentLie))||(r=c.checkForReplyFinished(e,t.draftState,n.draftState,a,s,s&&n.cardViewStates[s.selectedCardId]))?r:c.checkForLowFidelityWarning(e,a,s):void 0})),this.discreteCommentCardPropsUpdated=ee(this.commentStore,this.commandExecuteCallback,(function(e,t,n){return n.cardRelativeDraftingState===M.a.InCard&&c.shouldFocusDraftEditorForReturnToDraft(t.draftState.drafts[t.draftState.cardIdToDraftIdMap[t.threadId]],n.draftState.drafts[n.draftState.cardIdToDraftIdMap[n.threadId]])?Object(o.__assign)(Object(o.__assign)({},W(void 0,{renderContextType:e.renderContextType,componentType:G.a.CardEditor,id:n.threadId})),{shouldRetryOnMount:!0}):(r=c.checkForRetryCommandOnDiscreteCardPropsUpdated(e,n))||n.cardRelativeDraftingState===M.a.InChildPost&&(r=c.checkIfPostEditorShouldFocusForReturnToDraft(e,t.draftState,n.draftState))?r:n.cardRelativeDraftingState!==M.a.InCard&&n.cardRelativeDraftingState!==M.a.InChildPost||!(r=c.checkForNewDraft(e.renderContextType,t.draftState,n.draftState))?(r=c.checkForDiscard(e,t.draftState,n.draftState,t.selectedState,n.selectedState))?r:e.isFocusWithinAny(G.a.Card)||e.isFocusWithinAny(G.a.DraftCard)?c.shouldFocusFromCardPendingStateChange(t.cardState,n.cardState)?W(void 0,{renderContextType:e.renderContextType,componentType:Object(q.b)(n.isDraftThread),id:n.threadId}):(r=c.checkForSelectionChange(e,n.draftState,t.selectedState,n.selectedState))||(r=c.checkForReplyFinished(e,t.draftState,n.draftState,t.selectedState,n.selectedState,n.cardState))?r:c.checkForLowFidelityWarning(e,t.selectedState,n.selectedState):void 0:r;var r})),this.paneContainerKeyDown=te(this.commentStore,this.isRTL,(function(e){return!!Object(B.b)(e.renderContextType)||(Object(s.g)().assertConditionTag(!1,"paneContainerKeyDownHandler called outside of a pane render context",593802309),!1)}),{Escape:{handler:function(e,t){return H(e,w.D({renderContextType:t.renderContextType,trackback:i.d.reserveTag(593802310),telemetryVisitor:c.telemetryVisitor}))},phase:S.a.Capturing},Tab:{handler:function(e,t){if(Object(U.a)()!==L.a.Windows)return c.paneContainerTabHandling(e,t)},phase:S.a.None},ArrowDown:{handler:function(e,t){if(!D.Eb()&&Object(U.a)()!==L.a.Windows){var n=c.onDownKey(e,t);return n&&(n.stopPropagation=!0),n}},phase:S.a.None},ArrowUp:{handler:function(e,t){if(!D.Eb()&&Object(U.a)()!==L.a.Windows){var n=c.onUpKey(e,t);return n&&(n.stopPropagation=!0),n}},phase:S.a.None}}),this.commentEditorKeyDown=te(this.commentStore,this.isRTL,(function(){return!0}),{F12:{handler:function(e,t){var n=c.handleMoveFocusEvent(e,t);return n&&(n.stopPropagation=!0),n},phase:S.a.None}}),this.onUserAction=ee(this.commentStore,this.commandExecuteCallback,(function(e,t){if(D.x()||e.renderContextType===T.a.FullPane)switch(t.userAction){case ne.a.RequestNewCommentFromHost:return W(void 0,{componentType:G.a.PaneRoot});case ne.a.CancelReplyDraft:return void 0===t.selectedCardId?void Object(s.g)().assertConditionTag(!1,"Cancelling reply with no focused comment?",589845512):W(void 0,{componentType:G.a.Card,id:t.selectedCardId,renderContextType:e.renderContextType});case ne.a.DeleteThread:case ne.a.CancelNewThreadDraft:if(void 0===t)return Object(s.g)().assertConditionTag(void 0!==t,"User action options are required",595121954),c.tryCreateFocusNewButtonCommandWithFallback(e);if(t.isNewCommentButtonFocusable)return c.tryCreateFocusNewButtonCommandWithFallback(e);if(D.M()&&Object(U.a)()!==L.a.iOS)return W(void 0,{componentType:G.a.PaneRoot});if(e.renderContextType!==T.a.FullPane)return;return c.selectionCommandFactory.focusAndSelectSiblingThread(e.renderContextType,t.threadIndex);case ne.a.ResolveThread:return void 0===t.selectedCardId?void Object(s.g)().assertConditionTag(!1,"Cancelling reply with no focused comment?",579736267):W(void 0,{componentType:G.a.ReopenThreadButton,id:t.selectedCardId,renderContextType:e.renderContextType},{shouldRetryOnCardPropsUpdate:!0});default:Object(i.j)(t)}}))}return e.prototype.handleFocusRetry=function(e){if(this.focusToRetry){var t=Date.now()-this.focusToRetry.timestamp;if(t>15e3)return Object(s.g)().assertConditionTag(!1,"Took too long to mount component for focus retry: "+t+" ms",594060876),void(this.focusToRetry=void 0);var n=this.focusToRetry.command.component;if(Object(G.b)(n,e)){var r=this.focusToRetry.command;return this.focusToRetry=void 0,r}}},e.prototype.shouldArrowNavigatePosts=function(e,t){var n=F.g(this.commentStore.getState());if(!D.yb())return!(Object(R.d)(e.selectionDetails)||t.isFocusOn({componentType:Object(q.b)(e.selectedCardId,n),id:e.selectedCardId,renderContextType:t.renderContextType}));if(Object(R.d)(e.selectionDetails)&&!e.selectionDetails.expanded)return!1;if(e.selectedCardId===(null==n?void 0:n.newComment.commentId))return!1;var r={componentType:G.a.Post,id:Object(R.c)(e),renderContextType:t.renderContextType};return t.isFocusOn(r)||t.isFocusWithin(r)},e.prototype.onDownKey=function(e,t,n){if(F.e(this.commentStore.getState()).length){var r=F.p(this.commentStore.getState());if(r){if(!this.shouldArrowNavigatePosts(r,t)){if(t.renderContextType===T.a.DiscreteIsolated)return;var o={direction:O.d.Next,source:_.a.SharedComments,collapseCard:!0,forceCurrentContext:!0},i=D.q()&&!N.a(this.commentStore.getState());return this.selectionCommandFactory.selectNextOrPreviousThread(e,o,t.renderContextType,t,i)}return this.selectionCommandFactory.selectNextPostWithinCard(e,t.renderContextType,n)}if(t.renderContextType!==T.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,_.a.SharedComments,t.renderContextType);Object(s.g)().assertConditionTag(!1,"selectedComment missing on down key handler for DiscreteIsolated card",593802311)}},e.prototype.onUpKey=function(e,t,n){if(F.e(this.commentStore.getState()).length){var r=F.p(this.commentStore.getState());if(r){if(!this.shouldArrowNavigatePosts(r,t)){if(t.renderContextType===T.a.DiscreteIsolated)return;var o={direction:O.d.Previous,source:_.a.SharedComments,collapseCard:!0,forceCurrentContext:!0},i=D.q()&&!N.a(this.commentStore.getState());return this.selectionCommandFactory.selectNextOrPreviousThread(e,o,t.renderContextType,t,i)}return this.selectionCommandFactory.selectPreviousPostWithinCard(e,t.renderContextType,n)}if(t.renderContextType!==T.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,_.a.SharedComments,t.renderContextType);Object(s.g)().assertConditionTag(!1,"selectedComment missing on up key handler for DiscreteIsolated card",593802312)}},e.prototype.onRightKey=function(e,t,n){if(F.e(this.commentStore.getState()).length){if(D.Hb()){var r=F.p(this.commentStore.getState()),o=F.g(this.commentStore.getState());if(r&&o&&r.selectedCardId===o.newComment.commentId)return}var i=this.selectionCommandFactory.selectRootPostOfSelectedThread(e,t);return i||(t===T.a.DiscreteIsolated?this.selectionCommandFactory.selectNextPostWithinCard(e,t,n):this.selectionCommandFactory.selectNextPost(e,t,n))}},e.prototype.onLeftKey=function(e,t){if(F.e(this.commentStore.getState()).length)return this.selectionCommandFactory.selectAndCollapseSelectedThread(e,_.a.SharedComments,t)},e.prototype.onTabKeyInPane=function(e,t){return void 0===F.p(this.commentStore.getState())&&F.e(this.commentStore.getState()).length>0?D.Bb()||t!==T.a.DiscreteIsolated?this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,_.a.SharedComments,t):void Object(s.g)().assertConditionTag(!1,"selectedComment missing on tab key handler for DiscreteIsolated card",593802313):this.checkForActiveEditorFocus(e,t,F.i(this.commentStore.getState()),F.p(this.commentStore.getState()))},e.prototype.isDraftInOtherContext=function(){var e=F.r(this.commentStore.getState());return e&&!e.isInCurrentContext},e.prototype.checkForActiveEditorFocus=function(e,t,n,r){if(!this.isDraftInOtherContext()){if(D.rb()){var o=Object(E.G)(n);if(o)return W(e,{componentType:G.a.PostEditor,id:o,renderContextType:t});var i=Object(E.F)(n);return i?W(e,{componentType:G.a.CardEditor,id:i,renderContextType:t}):void 0}return r&&Object(R.d)(r.selectionDetails)&&Object(A.c)(n,r)?W(e,{componentType:G.a.CardEditor,id:r.selectedCardId,renderContextType:t}):r&&!Object(R.d)(r.selectionDetails)&&Object(A.c)(n,r)?W(e,{componentType:G.a.PostEditor,id:r.selectionDetails.selectedPostId,renderContextType:t}):void 0}},e.prototype.handleMoveFocusEvent=function(e,t){if(e.altKey){var n=F.p(this.commentStore.getState()),r=n?{contentId:null==n?void 0:n.selectedCardId,contentType:d.b.CommentThread}:void 0;return H(e,w.v({renderContextType:t.renderContextType,trackback:i.d.reserveTag(593802314),telemetryVisitor:this.telemetryVisitor},r))}},e.prototype.checkForCommentSelectionFocus=function(e,t,n){if(!this.isDraftInOtherContext())return t&&t.selectedCardId?W(void 0,{componentType:Object(q.b)(t.selectedCardId,n),id:t.selectedCardId,renderContextType:e}):void 0},e.prototype.checkForDiscard=function(e,t,n,r,o){if(Object(U.a)()!==L.a.Web&&r&&o){var i=r.selectionDetails,a=o.selectionDetails;if(D.qb()?Object(A.j)(t)&&!Object(A.c)(n):i.editingSession_deprecated===R.a.DiscardPending&&a.editingSession_deprecated===R.a.None)return this.focusCommentCardCommand.processCommand(e,o.selectedCardId);if(Object(R.d)(i)===Object(R.d)(a)&&r.selectedCardId===o.selectedCardId&&Object(A.m)(t,n,r,o)){if(Object(R.d)(i)||Object(R.d)(a))return W(void 0,{componentType:G.a.CardEditor,id:o.selectedCardId,renderContextType:e.renderContextType},{shouldRetryOnMount:!0});if(i.selectedPostId===a.selectedPostId)return W(void 0,{componentType:G.a.PostEditor,id:a.selectedPostId,renderContextType:e.renderContextType},{shouldRetryOnMount:!0})}}},e.prototype.paneContainerTabHandling=function(e,t){var n=this.commentStore.getState(),r=Object(E.K)(F.l(n),F.v(n));if(!Object(x.a)({commentData:F.e(n),pendingCommentLoad:F.m(n),virtualized:r}))return(c=W(e,{componentType:G.a.ClosePaneButton})).stopPropagation=!0,c.preventDefault=!0,c;var o=t.getComponent(G.a.ClosePaneButton),i=t.getComponent(G.a.NewCommentButton),a=!D.q()&&Object(A.c)(F.i(n),F.p(n))||!i?o:i;if(D.l()){var s=F.p(n),c=void 0;return s?t.isFocusWithin({componentType:Object(q.b)(s.selectedCardId,F.g(this.commentStore.getState())),id:s.selectedCardId,renderContextType:t.renderContextType})||(c=this.checkForActiveEditorFocus(e,t.renderContextType,F.i(n),F.p(n))):a&&e.isEventTarget(a)&&!e.shiftKey&&(c=this.onTabKeyInPane(e,t.renderContextType)),c&&(c.stopPropagation=!0,c.preventDefault=!0),c}return o&&e.isEventTarget(o)&&e.shiftKey||a&&e.isEventTarget(a)&&!e.shiftKey?((c=this.onTabKeyInPane(e,t.renderContextType))&&(c.preventDefault=!0,c.stopPropagation=!0),c):void 0},e.prototype.checkForNewDraft=function(e,t,n){if(!this.isDraftInOtherContext()){var r=Object(E.H)(n);if(r&&r.renderContextType===e){var i=t.drafts[r.commentDraft.sessionConfiguration.draftId];if(!i||i.renderContextType!==e){if(Object(j.i)(r.commentDraft.sessionConfiguration))return W(void 0,{componentType:G.a.PostEditor,id:r.commentDraft.sessionConfiguration.commentId,renderContextType:e});var a=Object(j.k)(r.commentDraft.sessionConfiguration)?r.commentDraft.sessionConfiguration.threadId:r.commentDraft.sessionConfiguration.draftId;return Object(o.__assign)(Object(o.__assign)({},W(void 0,{componentType:G.a.CardEditor,id:a,renderContextType:e})),{shouldRetryOnMount:!0})}}}},e.prototype.checkForSelectionChange=function(e,t,n,r){if(r&&((!n||Object(R.c)(n)!==Object(R.c)(r)||Object(R.d)(n.selectionDetails)!==Object(R.d)(r.selectionDetails))&&(D.Hb()||!Object(A.d)(t,r))&&!e.isFocusOn({componentType:G.a.NextCommentButton})&&!e.isFocusOn({componentType:G.a.PreviousCommentButton})))return Object(R.d)(r.selectionDetails)?this.focusCommentCardCommand.processCommand(e,r.selectedCardId):this.focusCommentPostCommand.processCommand(e,r.selectionDetails.selectedPostId)},e.prototype.checkForReplyFinished=function(e,t,n,r,o,i){if(D.rb()){var a=Object(E.F)(t),s=Object(E.F)(n);if(!i||i.pending===P.a.Editor)return;return a&&!s?this.focusCommentCardCommand.processCommand(e,a):void 0}if(o&&r&&Object(R.d)(o.selectionDetails)&&i&&i.pending!==P.a.Editor&&r.selectionDetails.editingSession_deprecated!==R.a.None)return o.selectionDetails.editingSession_deprecated===R.a.None?this.focusCommentCardCommand.processCommand(e,o.selectedCardId):void 0},e.prototype.checkForHalfPaneFullTransition=function(e,t,n){if(e.renderContextType===T.a.HalfPane&&Object(j.j)(n.displayConfigurationState)&&n.displayConfigurationState.displayMode===j.d.Normal&&(!Object(j.j)(t.displayConfigurationState)||t.displayConfigurationState.displayMode===j.d.Variable))return W(void 0,{componentType:G.a.ClosePaneButton})},e.prototype.shouldFocusFromCardPendingStateChange=function(e,t){return!!e&&(e.pending!==t.pending&&t.pending!==P.a.Editor)},e.prototype.checkForCardPendingChange=function(e,t,n,r){var o=this,i=Object.entries(n).find((function(e){var n=t[e[0]];return o.shouldFocusFromCardPendingStateChange(n,e[1])}));if(i)return W(void 0,{renderContextType:e.renderContextType,componentType:Object(q.b)(i[0],r),id:i[0]})},e.prototype.shouldFocusDraftEditorForReturnToDraft=function(e,t){var n;return D.m()?Object(E.d)(e,t)&&(null===(n=null==t?void 0:t.draftWarningState)||void 0===n?void 0:n.type)!==k.a.CommitFailed:Object(E.d)(e,t)},e.prototype.checkForRetryCommandOnPropsUpdated=function(e){if(this.focusToRetry&&this.focusToRetry.command.shouldRetryOnCardPropsUpdate&&this.focusToRetry.command.component.componentType!==G.a.Unknown)return(Object(G.c)(this.focusToRetry.command.component)?e.getComponentById(this.focusToRetry.command.component):e.getComponent(this.focusToRetry.command.component.componentType))?this.handleFocusRetry(this.focusToRetry.command.component):void 0},e.prototype.checkForRetryCommandOnDiscreteCardPropsUpdated=function(e,t){if(this.focusToRetry&&this.focusToRetry.command.shouldRetryOnCardPropsUpdate&&(!Object(G.c)(this.focusToRetry.command.component)||!Object(G.d)(this.focusToRetry.command.component.componentType)||this.focusToRetry.command.component.id===t.threadId))return this.checkForRetryCommandOnPropsUpdated(e)},e.prototype.checkIfCardEditorShouldFocusForReturnToDraft=function(e,t,n){var r=this,i=Object.keys(n.cardIdToDraftIdMap).filter((function(e){var o=n.cardIdToDraftIdMap[e];return r.shouldFocusDraftEditorForReturnToDraft(t.drafts[o],n.drafts[o])}));if(i.length>0)return Object(o.__assign)(Object(o.__assign)({},W(void 0,{renderContextType:e.renderContextType,componentType:G.a.CardEditor,id:i[0]})),{shouldRetryOnMount:!0})},e.prototype.checkIfPostEditorShouldFocusForReturnToDraft=function(e,t,n){var r=this,i=Object.keys(n.postIdToDraftIdMap).filter((function(e){var o=n.postIdToDraftIdMap[e];return r.shouldFocusDraftEditorForReturnToDraft(t.drafts[o],n.drafts[o])}));if(i.length>0)return Object(o.__assign)(Object(o.__assign)({},W(void 0,{renderContextType:e.renderContextType,componentType:G.a.PostEditor,id:i[0]})),{shouldRetryOnMount:!0})},e.prototype.checkForLowFidelityWarning=function(e,t,n){if(D.I()){if(n&&(D.l()?Object(R.k)(n):Object(R.i)(n))){var r=t?Object(R.c)(t):void 0,o=Object(R.c)(n);if(o!==r||n.selectionDetails.lowFidelityWarningType!==(null==t?void 0:t.selectionDetails.lowFidelityWarningType))return W(void 0,{componentType:G.a.Post,renderContextType:e.renderContextType,id:o})}}else{if(!n||Object(R.d)(n.selectionDetails)||!Object(R.k)(n))return;if(!t||Object(R.d)(t.selectionDetails)||!Object(R.k)(t))return W(void 0,{componentType:G.a.Post,renderContextType:e.renderContextType,id:n.selectionDetails.selectedPostId})}},e.prototype.tryCreateFocusNewButtonCommandWithFallback=function(e){if(D.y()&&(!D.N()||e.renderContextType!==T.a.FullPane))return Y(e,!D.y());var t=function(e){if(D.N()&&e.renderContextType===T.a.FullPane){if(e.getComponent(G.a.NewCommentButton))return W(void 0,{componentType:G.a.NewCommentButton});Object(s.g)().assertConditionTag(!D.y()&&!D.N(),"cant find new comment button, but its enabled",579086400)}}(e);return t||Y(e,!D.y())},e}(),oe=n(157),ie=n(203),ae=n(76),se=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startPostIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.model[this.pointer]){var t=Object(ae.b)(this.model[this.pointer]);return e&&e.commentId===t?e:this.model.find((function(e){return e.commentId===t}))}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.model.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.model.length&&e&&e.commentFlags&ie.e.Resolved);else++this.pointer;return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&ie.e.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),ce=n(300),de=n(83),ue=n(211),le=n(158),fe=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.items=e,this.startItemIndex=t,this.ignoreResolvedThreads=n,this.pointer=0,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.items[this.pointer]){var t=de.i(this.items[this.pointer]);if(e&&e.commentId===t)return e;for(var n=this.pointer;n>=0;--n){var r=this.items[n];if(Object(le.a)(r)&&r.commentModel.commentId===t)return r.commentModel}for(n=this.pointer+1;n<this.items.length;++n){r=this.items[n];if(Object(le.a)(r)&&r.commentModel.commentId===t)return r.commentModel}}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.items.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.items.length&&e&&e.commentFlags&ue.a.Resolved);else++this.pointer;return this.pointer<this.items.length-1||this.pointer===this.items.length-1&&t<this.items.length-1?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&ue.a.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}();var me=function(){function e(e,t){this.commentStore=e,this.telemetryVisitor=t}return e.prototype.selectThreadInCurrentContext=function(e,t,n,r,o){return H(e,w.L(t,n,void 0,r?w.c.CollapseCard:w.c.ExpandCard,o))},e.prototype.selectPost=function(e,t,n,r,o){return H(e,w.L(t,n,r,w.c.SelectPost,o))},e.prototype.selectFirstThreadInCurrentContext=function(e,t,n,r,o){if(void 0===o&&(o=!1),D.Hb()){var a=F.h(this.commentStore.getState());if(a&&0===a.index)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(588129411),telemetryVisitor:this.telemetryVisitor},a.newComment.commentId,!1,n)}var s=void 0;o?s=new ce.a(F.e(this.commentStore.getState()),-1,o).next().value:s=F.e(this.commentStore.getState())[0];if(s)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(593278811),telemetryVisitor:this.telemetryVisitor},s.commentId,t,n)},e.prototype.selectLastThreadInCurrentContext=function(e,t,n,r,o){void 0===o&&(o=!1);var a=F.e(this.commentStore.getState());if(D.Hb()){var c=F.h(this.commentStore.getState());if(c&&c.index===a.length)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(588129412),telemetryVisitor:this.telemetryVisitor},c.newComment.commentId,!1,n)}if(Object(E.c)(a,o)){var d=new ce.a(a,a.length,o).previous().value;if(d)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(593278813),telemetryVisitor:this.telemetryVisitor},d.commentId,t,n);Object(s.g)().assertConditionTag(!1,"Unable to find last thread",593278812)}},e.prototype.selectAndCollapseSelectedThread=function(e,t,n){var r=F.p(this.commentStore.getState());if(r){if(D.Hb()){var o=F.g(this.commentStore.getState());if(o&&o.newComment.commentId===r.selectedCardId)return}var a=r.selectionDetails;if(!Object(R.d)(a)||Object(R.d)(a)&&a.expanded)return this.selectThreadInCurrentContext(e,{renderContextType:n,trackback:i.d.reserveTag(593278814),telemetryVisitor:this.telemetryVisitor},r.selectedCardId,!0,t)}},e.prototype.selectNextOrPreviousThread=function(e,t,n,r,o){var a=this.commentStore.getState(),s=F.e(a),c=F.p(a),u=F.h(a),l=F.f(a).nextPopulatedContextDetails;if(void 0!==c){if(D.Fb()&&n===T.a.DiscreteIntegrated)return H(e,w.M({renderContextType:n,trackback:i.d.reserveTag(593278815),telemetryVisitor:this.telemetryVisitor},t.direction,{contentId:c.selectedCardId,contentType:d.b.CommentThread},_.a.SharedComments));var f=void 0;f=D.Hb()&&u&&c.selectedCardId===u.newComment.commentId?u.index+(t.direction===O.d.Next?-1:0):D.Jb()?this.getSelectedThreadIndex():this.getSelectedIndex();var m=new ce.a(s,f,o),p=t.direction===O.d.Next?m.next():m.previous();if(D.Hb()&&u&&c.selectedCardId!==u.newComment.commentId)if(t.direction===O.d.Next?f<u.index&&(p.done||m.currentIndex()>=u.index):f>=u.index&&(p.done||m.currentIndex()<u.index))return this.selectThreadInCurrentContext(e,{renderContextType:n,trackback:i.d.reserveTag(588289059),telemetryVisitor:this.telemetryVisitor},u.newComment.commentId,!1,t.source);if(!p.done)return this.selectThreadInCurrentContext(e,{renderContextType:n,trackback:i.d.reserveTag(593278816),telemetryVisitor:this.telemetryVisitor},p.value.commentId,!!t.collapseCard,t.source);if(!t.forceCurrentContext)return this.selectAcrossContexts(e,t.direction,n,r)}else{if(Object(E.c)(s,o))return this.selectFirstThreadInCurrentContext(e,!!t.collapseCard,t.source,n,o);if(!t.forceCurrentContext&&l!==oe.a.NoComments)return this.selectAcrossContexts(e,t.direction,n,r)}},e.prototype.selectAcrossContexts=function(e,t,n,r){return J(e,void this.telemetryVisitor,t===O.d.Next?H(e,w.N({renderContextType:n,trackback:i.d.reserveTag(593278817),telemetryVisitor:this.telemetryVisitor})):H(e,w.O({renderContextType:n,trackback:i.d.reserveTag(593278818),telemetryVisitor:this.telemetryVisitor})))},e.prototype.selectNextPost=function(e,t,n){var r;if(D.b()){if(n){var o=new fe(n,this.getSelectedIndexFromRenderableItems(n),t===T.a.DiscreteIntegrated).next();if(!o.done)return this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278850),telemetryVisitor:this.telemetryVisitor},de.i(o.value),de.e(o.value),_.a.SharedComments);if(D.Fb()&&t===T.a.DiscreteIntegrated){var a=F.p(this.commentStore.getState());m=a?{contentId:a.selectedCardId,contentType:d.b.CommentThread}:void 0;return H(e,w.M({renderContextType:t,trackback:i.d.reserveTag(593278851),telemetryVisitor:this.telemetryVisitor},O.d.Next,m,_.a.SharedComments))}var c=new ce.a(F.e(this.commentStore.getState()),this.getSelectedThreadIndex(),t===T.a.DiscreteIntegrated).next();return c.done?void 0:this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278852),telemetryVisitor:this.telemetryVisitor},Object(ae.b)(c.value),c.value.commentId,_.a.SharedComments)}Object(s.g)().assertConditionTag(!1,"renderableItems must not be undefined",593278849)}else{var u=new se(F.e(this.commentStore.getState()),this.getSelectedIndex(),t===T.a.DiscreteIntegrated).next();if(!u.done){var l=null===(r=F.p(this.commentStore.getState()))||void 0===r?void 0:r.selectedCardId,f=Object(ae.b)(u.value);if(D.Fb()&&t===T.a.DiscreteIntegrated&&l!==f){var m=l?{contentId:l,contentType:d.b.CommentThread}:void 0;return H(e,w.M({renderContextType:t,trackback:i.d.reserveTag(593278819),telemetryVisitor:this.telemetryVisitor},O.d.Next,m,_.a.SharedComments))}return this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278848),telemetryVisitor:this.telemetryVisitor},f,u.value.commentId,_.a.SharedComments)}}},e.prototype.selectNextPostWithinCard=function(e,t,n){if(void 0!==F.p(this.commentStore.getState())){if(!D.b()){var r=F.e(this.commentStore.getState()),o=this.getSelectedIndex(),a=new se(r,o).next(),c=r[o];return!a.done&&a.value.parentId&&a.value.parentId===Object(ae.b)(c)?this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278854),telemetryVisitor:this.telemetryVisitor},a.value.parentId,a.value.commentId,_.a.SharedComments):void 0}if(n){var d=this.getSelectedIndexFromRenderableItems(n),u=new fe(n,d).next(),l=n[d],f=de.i(l);return u.done||de.i(u.value)!==f?void 0:this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278856),telemetryVisitor:this.telemetryVisitor},de.i(u.value),de.e(u.value),_.a.SharedComments)}Object(s.g)().assertConditionTag(!1,"renderableItems must not be undefined",593278855)}else Object(s.g)().assertConditionTag(!1,"Expected selectedCommentIndex",593278853)},e.prototype.selectPreviousPostWithinCard=function(e,t,n){if(void 0!==F.p(this.commentStore.getState()))if(D.b())if(n){var r=this.getSelectedIndexFromRenderableItems(n),o=n[r],a=de.g(o);if(a)if(!(c=new fe(n,r).previous()).done&&de.i(c.value)===a)return this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278860),telemetryVisitor:this.telemetryVisitor},de.i(c.value),de.e(c.value),_.a.SharedComments)}else Object(s.g)().assertConditionTag(!1,"renderableItems must not be undefined",593278859);else{var c,d=F.e(this.commentStore.getState()),u=this.getSelectedIndex(),l=d[u];if(l.parentId&&!(c=new se(d,u).previous()).done&&Object(ae.b)(c.value)===l.parentId)return this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278858),telemetryVisitor:this.telemetryVisitor},Object(ae.b)(c.value),c.value.commentId,_.a.SharedComments)}else Object(s.g)().assertConditionTag(!1,"Expected selectedCommentIndex",593278857)},e.prototype.selectRootPostOfSelectedThread=function(e,t){var n=F.p(this.commentStore.getState());if(n&&Object(R.d)(n.selectionDetails)){var r=this.getSelectedIndex(),o=F.e(this.commentStore.getState())[r];return this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278861),telemetryVisitor:this.telemetryVisitor},o.commentId,o.commentId,_.a.SharedComments)}},e.prototype.focusAndSelectSiblingThread=function(e,t){if(!(t<0)){var n,r=F.e(this.commentStore.getState()).filter((function(e){return!e.parentId}));if(0!==r.length)if(!(t-1<0&&t+1>=r.length))return n=t-1>=0?t-1:t+1,J(void 0,W(void 0,{componentType:G.a.Card,id:r[n].commentId,renderContextType:e}),H(void 0,w.L({renderContextType:e,trackback:i.d.reserveTag(593278862),telemetryVisitor:this.telemetryVisitor},r[n].commentId,void 0,w.c.CollapseCard,_.a.SharedComments)))}},e.prototype.getSelectedIndex=function(){return Object(E.n)(F.e(this.commentStore.getState()),F.p(this.commentStore.getState()))},e.prototype.getSelectedThreadIndex=function(){var e=this.commentStore.getState();if(D.Jb())return Object(E.I)(F.e(e),F.p(e));var t=F.p(e);return t?F.e(e).findIndex((function(e){return e.commentId===t.selectedCardId})):-1},e.prototype.getSelectedIndexFromRenderableItems=function(e){var t=F.p(this.commentStore.getState());if(!t)return-1;var n=Object(R.c)(t);return e.findIndex((function(e){return Object(le.a)(e)?e.commentModel.commentId===n:e.historyItem.records[0].recordId===n}))},e}(),pe=function(e){function t(t,n,r){return e.call(this,t,new me(t,r),n,r)||this}return Object(o.__extends)(t,e),t.prototype.focusActiveEditor=function(e,t){return this.focusActiveEditorCommand(t,e)},t}(re),ge=function(){function e(e,t){this.commentStore=e,this.commandFactory=new me(this.commentStore,t)}return e.prototype.selectNextOrPreviousThread=function(e,t){var n=D.q()&&!N.a(this.commentStore.getState()),o=N.c(this.commentStore.getState());return X(this.commandFactory.selectNextOrPreviousThread(void 0,e,t,o,n),o,this.commentStore)===r.Handled},e.prototype.selectAcrossContexts=function(e,t){var n=N.c(this.commentStore.getState());X(this.commandFactory.selectAcrossContexts(void 0,e,t,n),n,this.commentStore)},e}(),he=n(753),Ce=n(604),ye={PostHeight:69,ExpandButtonHeight:26,ReplyDraftHeight:44,TaskTopper:29};function ve(e){var t=e.itemCount,n=e.readOnly,r=e.isTask,o=ye.PostHeight;return t>1&&(o+=ye.PostHeight+0),t>2&&(o+=ye.ExpandButtonHeight+0),n||(o+=ye.ReplyDraftHeight+0),r&&(o+=ye.TaskTopper),o}var be=n(1);function Te(e,t){return function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return Object(o.__extends)(r,n),r.prototype.render=function(){var n=Object(o.__assign)(Object(o.__assign)({},t),this.props);return be.createElement(e,n)},r}(be.PureComponent)}var Ie=n(144);function Oe(e,t){return function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return Object(o.__extends)(r,n),r.prototype.render=function(){return be.createElement(Ie.a,{store:t},be.createElement(e,Object(o.__assign)({},this.props)))},r}(be.PureComponent)}var Se=n(249),je=n.n(Se),De=n(108),we=n(464),_e=n(140),xe=n(178),Ee=n(355),Pe=n(754),Ae=n(173),ke=n(21),Re=n(147),Fe=n(324),Ne=n(411),Me=n(680),Ve=n(131),Le=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getId=function(){return this.mockId},e}(),Ue=function(){function e(e,t){var n=this;this.viewManager=e,this.mockUIDriver=t,this.pendingActionReason=Ve.a.None,this.pendingAction=void 0,this.getActiveComponentTree=function(){var e=n.commentStore.getState();return N.a(e)&&Object(D.w)()?N.c(e):n.viewManager.getComponentTreeForRenderMode(d.d.Integrated)},this.getCompleteHostableCommentCardRendererOwnProps=function(e){return Object(o.__assign)(Object(o.__assign)({},n.viewManager.getHostableCommentCardRendererProps(d.d.Integrated)),{resource:{id:e},componentInstanceId:je()()})},this.getCompletePaneOwnProps=function(){return Object(o.__assign)(Object(o.__assign)({},n.viewManager.getPaneOwnProps()),{resource:{id:"CommentPane"}})},this.getDispatchProps=function(e){var t=n.commentStore.getState(),r=n.commentStore.dispatch;return N.a(t)?Object(we.b)(r,n.getCompletePaneOwnProps()):Object(we.a)(r,n.getCompleteHostableCommentCardRendererOwnProps(e))},this.getNewThreadDraftId=function(){var e=F.h(n.commentStore.getState());return null==e?void 0:e.draftId},this.getParentId=function(e){var t=n.commentStore.getState(),r=F.e(t),o=r.findIndex((function(t){return t.commentId===e}));return Object(j.h)(r[o])},this.isNewCommentButtonFocusable=function(){return N.b(n.commentStore.getState())},this.invokeModalDialog=function(e,t,r){var o={renderContextType:n.getActiveComponentTree().renderContextType,trackback:i.d.reserveTag(592240791),telemetryVisitor:n.viewManager.getTelemetryVisitor()},a=n.commentStore.dispatch,c=n.getCompletePaneOwnProps(),d=Object(we.b)(a,c),u=n.commentStore.getState(),l=F.p(u),f=F.i(u);switch(e){case _e.a.CancelNewDraft:case _e.a.CancelReplyDraft:return d.discardDraftAsync(o,_.a.SharedComments,!1);case _e.a.DeleteThread:return l&&d.requestDeleteThread(o,l.selectedCardId),Promise.resolve(g.a.Handled);case _e.a.ClosePaneDraft:return xe.o({ownProps:c,dispatchProps:d,componentTree:n.getActiveComponentTree(),draftState:f,selectedComment_deprecated:l,invokeModalDialog:n.invokeModalDialog}),Promise.resolve(g.a.Handled);default:return Object(s.g)().assertConditionTag(!1,"Unknown ModalDialogMode",592269457),Promise.resolve(g.a.Unhandled)}},this.handleStoreUpdate=function(){var e=n.commentStore.getState(),t=F.i(e),r=F.i(n.previousStoreState),o=F.p(e);!Object(A.d)(t,o)&&n.pendingActionReason===Ve.a.NeedNotDrafting&&n.pendingAction&&(Object(s.g)().createActivityObject("TriggerPendingActionNeedNotDrafting",n.viewManager.getTelemetryVisitor(),s.a.None,s.b.FullEvent).successTag(592269458),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Ve.a.None);var i=Object(A.b)(t),a=Object(A.b)(r);i&&!a&&n.pendingActionReason===Ve.a.NeedDrafting&&n.pendingAction&&(Object(s.g)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),s.a.None,s.b.FullEvent).successTag(592269459),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Ve.a.None),n.previousStoreState=e},this.onDrafting=function(e){var t=Object(s.g)().createActivityObject("OnDraftingCallback",n.viewManager.getTelemetryVisitor(),s.a.None,s.b.FullEvent),r=F.i(n.commentStore.getState());Object(A.b)(r)?(t.addDataField("ActionDeferred",!1,s.c.SystemMetadata),e(),t.successTag(592269460)):(t.addDataField("ActionDeferred",!0,s.c.SystemMetadata),n.pendingAction=e,n.pendingActionReason=Ve.a.NeedDrafting,t.successTag(592269461))},this.onNotDrafting=function(e){var t=Object(s.g)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),s.a.None,s.b.FullEvent),r=F.i(n.commentStore.getState());Object(A.d)(r)?(t.addDataField("ActionDeferred",!0,s.c.SystemMetadata),n.pendingAction=e,n.pendingActionReason=Ve.a.NeedNotDrafting,t.successTag(592269462)):(t.addDataField("ActionDeferred",!1,s.c.SystemMetadata),e(),t.successTag(592269463))},this.runAction=function(e,t){switch(e){case Ve.a.NeedDrafting:return n.onDrafting(t);case Ve.a.NeedNotDrafting:return n.onNotDrafting(t);case Ve.a.None:return t()}},this.onMockUIAction=function(e){var t=Object(s.g)().createActivityObject("OnMockUIAction",n.viewManager.getTelemetryVisitor(),s.a.None,s.b.FullEvent);t.addDataField("MockUIActionType",e.actionType,s.c.SystemMetadata);try{switch(e.actionType){case De.a.CreateThread:De.g(e)?n.runAction(Ve.a.NeedDrafting,(function(){return n.onCreateOrReply(new Ne.a(n.getNewThreadDraftId(),e.content))})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269464);break;case De.a.CancelCreateThread:De.b(e)?n.runAction(Ve.a.NeedDrafting,(function(){return n.onCancelCreateThread(new Ne.a(n.getNewThreadDraftId()))})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269465);break;case De.a.StartReplySession:De.p(e)?n.runAction(Ve.a.NeedNotDrafting,(function(){return n.onStartReplySession(new Ne.a(e.threadId))})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269466);break;case De.a.CancelReplySession:De.d(e)?n.runAction(Ve.a.NeedDrafting,(function(){return n.onCancelReplySession(new Ne.a(e.threadId))})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269467);break;case De.a.PostReply:De.k(e)?n.runAction(Ve.a.NeedDrafting,(function(){return n.onCreateOrReply(new Ne.a(e.threadId,e.content))})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269468);break;case De.a.DeleteComment:De.h(e)?n.runAction(Ve.a.NeedNotDrafting,(function(){return n.onDeleteComment(e.commentId)})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269469);break;case De.a.DeleteThread:De.i(e)?n.runAction(Ve.a.NeedNotDrafting,(function(){return n.onDeleteThread(e.threadId)})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269470);break;case De.a.ResolveThread:De.m(e)?n.runAction(Ve.a.NeedNotDrafting,(function(){return n.onResolveThread(e.threadId)})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269471);break;case De.a.ReopenThread:De.l(e)?n.runAction(Ve.a.NeedNotDrafting,(function(){return n.onReopenThread(e.threadId)})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269472);break;case De.a.StartEditSession:De.o(e)?n.runAction(Ve.a.NeedNotDrafting,(function(){return n.onStartEditSession(e.commentId)})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269473);break;case De.a.CancelEditSession:De.c(e)?n.runAction(Ve.a.NeedDrafting,(function(){return n.onCancelEditSession(new Me.a(e.commentId))})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269474);break;case De.a.PostEdit:if(De.j(e)){var r=new Me.a(e.commentId);r.setContents(e.content),n.runAction(Ve.a.NeedDrafting,(function(){return n.onPostEdit(r)}))}else Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269475);break;case De.a.SelectComment:De.n(e)?n.runAction(Ve.a.NeedNotDrafting,(function(){return n.onSelectComment(new Le(e.commentId))})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269504);break;case De.a.ClosePane:n.onClosePane();break;case De.a.ClickGhostCard:De.e(e)?n.runAction(Ve.a.NeedNotDrafting,(function(){return n.onGhostCommentClicked()})):Object(s.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269505);break;default:Object(s.g)().assertConditionTag(!1,"Received unknown MockUIAction: "+e,592269506)}}catch(e){return void t.failTag(592269507,Object(Re.a)(e))}t.successTag(592269508)},this.onStartEditSession=function(e){var t=n.commentStore.getState();xe.E({trackback:i.d.reserveTag(592269509),id:e,data:n.getRenderableItems(t),selectedComment:F.p(t),renderContextType:n.getActiveComponentTree().renderContextType,actionDispatchers:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.onResolveThread=function(e,t){xe.k({componentTree:n.getActiveComponentTree(),focusHandlerRegistry:n.viewManager.getFocusManager(),trackback:i.d.reserveTag(592269510),id:e,renderContextType:n.getActiveComponentTree().renderContextType,dispatchProps:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,isTask:t})},this.onClosePane=function(){var e=n.commentStore.getState();if(N.b(e)){var t=n.commentStore.dispatch;Object(we.b)(t,n.getCompletePaneOwnProps()).requestClosePane({telemetryVisitor:n.viewManager.getTelemetryVisitor(),renderContextType:T.a.None,trackback:i.d.reserveTag(592269511)})}else Object(s.g)().assertConditionTag(!1,"Pane was already closed.",592269512)},this.onCreateOrReply=function(e){var t=e.getId(),r=n.commentStore.getState(),o=F.i(r),a=Object(E.H)(o),c=F.p(r),d=F.g(r),u=(null==d?void 0:d.newComment.commentId)===t?{type:"CREATE"}:{type:"REPLY",parentId:t};xe.b({trackback:i.d.reserveTag(592269513),commentCardRef:e,draftState:o,selectedComment_deprecated:c,areMentionsEnabled:Object(E.f)(F.l(r),F.a(r))===j.b.Enabled,session:u,componentTree:n.getActiveComponentTree(),dispatchProps:n.getDispatchProps(t),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,selectedTaskAssignee:a&&a.selectedTaskAssignee}).catch((function(e){Object(ke.b)(e)?Object(s.g)().assertConditionTag(!1,e.message,592269514):Object(s.g)().assertConditionTag(!1,"Unknown error thrown from cardOnCommit: "+e,592269515)}))},this.onCancelCreateThread=function(e){var t=e.getId(),r=n.getDispatchProps(t),o=n.commentStore.getState(),a=F.h(o),s=(null==a?void 0:a.newComment.commentId)===e.getId(),c=F.p(o),d=F.i(o),u=N.b(o),l=n.getActiveComponentTree().renderContextType,f=F.q(o),m=s&&Object(Ee.b)(u,l,c,a,f),p=d.cardIdToDraftIdMap[t],g=de.f(n.getRenderableItemThreads(o,n.getActiveComponentTree()),t);xe.d({trackback:i.d.reserveTag(592269516),selectedComment_deprecated:c,showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(),dispatchProps:r,closeOnDiscard:m,cardId:t,draftId_deprecated:p,draftState:d,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusHandlerRegistry:n.viewManager.getFocusManager(),isNewCommentButtonFocusable:n.isNewCommentButtonFocusable(),lieIndex:g})},this.onGhostCommentClicked=function(){N.b(n.commentStore.getState())||Object(s.g)().assertConditionTag(!1,"There is no Ghost Card because the pane is closed.",592269517),n.viewManager.getPaneOwnProps().selectionManager.selectAcrossContexts(O.d.Next,n.getActiveComponentTree().renderContextType)},this.onPostEdit=function(e){var t=n.commentStore.getState(),r=n.getRenderableItems(t),o=F.i(t),a=F.p(t),c=n.getParentId(e.getId()),d=n.getDispatchProps(c),u=F.a(t),l=F.l(t);xe.C({trackback:i.d.reserveTag(592269518),id:e.getId(),data:r,draftState:o,selectedComment_deprecated:a,contentPromise:e.getContentsAsync(),atMentionsEnabled:Object(E.f)(l,u)===j.b.Enabled,componentTree:n.getActiveComponentTree(),actionDispatchers:d,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI}).catch((function(e){Object(ke.b)(e)?Object(s.g)().assertConditionTag(!1,e.message,592269519):Object(s.g)().assertConditionTag(!1,"Unknown error thrown from onPostEdit: "+e,592269520)}))},this.onCancelEditSession=function(e){var t=n.commentStore.getState(),r=F.i(t),o=F.p(t),a=N.b(t),s=F.h(t),c=F.q(t),d=Object(Ee.b)(a,n.getActiveComponentTree().renderContextType,o,s,c),u=n.getRenderableItems(t),l=n.getParentId(e.getId()),f=n.getDispatchProps(l);xe.z({trackback:i.d.reserveTag(592269521),commentId:e.getId(),setContents:e.setContents.bind(e),data:u,draftState:r,selectedComment_deprecated:o,shouldClosePaneAfterDiscardDraft:d,onWillDiscardCallback:void 0,renderContextType:n.getActiveComponentTree().renderContextType,dispatchProps:f,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})},this.onCancelReplySession=function(e){var t=n.commentStore.getState(),r=F.h(t),o=(null==r?void 0:r.newComment.commentId)===e.getId(),a=F.p(t),s=F.i(t),c=e.getId(),d=n.getDispatchProps(c),u=N.b(t),l=n.getActiveComponentTree().renderContextType,f=F.q(n.commentStore.getState()),m=o&&Object(Ee.b)(u,l,a,r,f),p=a?s.cardIdToDraftIdMap[a.selectedCardId]:void 0,g=de.f(n.getRenderableItemThreads(t,n.getActiveComponentTree()),c);xe.d({trackback:i.d.reserveTag(592269522),selectedComment_deprecated:a,showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(),dispatchProps:d,closeOnDiscard:m,cardId:e.getId(),draftId_deprecated:p,draftState:s,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusHandlerRegistry:n.viewManager.getFocusManager(),isNewCommentButtonFocusable:n.isNewCommentButtonFocusable(),lieIndex:g})},this.onDeleteThread=function(e){var t=n.commentStore.getState(),r=F.p(t),o=n.getDispatchProps(e),a=Fe.a(t);xe.c({trackback:i.d.reserveTag(592269523),id:e,data:n.getRenderableItems(t),selectedComment:r,componentTree:n.getActiveComponentTree(),invokeModalDialog:n.invokeModalDialog,dispatchProps:o,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusHandlerRegistry:n.viewManager.getFocusManager(),isTask:!!a.tasks[e],isNewCommentButtonFocusable:n.isNewCommentButtonFocusable(),threadIndex:de.f(n.getRenderableItemThreads(t,n.getActiveComponentTree()),e),shouldCheckForLowFidelity:!0})},this.onDeleteComment=function(e){var t=n.commentStore.getState(),r=F.p(t),o="string"==typeof e?e:Object(Pe.a)(e)?e.getId():"",a=n.getParentId(o),s=n.getDispatchProps(a);xe.D({trackback:i.d.reserveTag(592269524),id:o,data:n.getRenderableItems(t),selectedComment:r,renderContextType:n.getActiveComponentTree().renderContextType,actionDispatchers:s,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})},this.onSelectComment=function(e){var t=n.commentStore.getState(),r=F.h(t),o=n.getRenderableItems(t),a=e.getId(),c=a===(null==r?void 0:r.draftId)?r&&{commentModel:r.newComment}:o.find((function(e){return de.e(e)===a}));if(c&&Object(le.a)(c)){var d=c,u=d.commentModel.parentId,l=n.getDispatchProps(u?d.commentModel.commentId:d.commentModel.parentId);xe.H({trackback:i.d.reserveTag(592269526),renderableItem:c,selectedComment:F.p(t),dispatchProps:l,telemetryVisitor:n.viewManager.getTelemetryVisitor(),shouldFocusAfter:!1,componentTree:n.getActiveComponentTree(),draftState:F.i(t)}).catch(Object(Ae.a)(i.d.reserveTag(590123734)))}else Object(s.g)().assertConditionTag(!1,"Selection coming from an unknown post?",592269525)},this.onStartReplySession=function(e){xe.a({trackback:i.d.reserveTag(592269527),threadId:e.getId(),renderContextType:n.getActiveComponentTree().renderContextType,dispatchProps:n.getDispatchProps(e.getId()),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.commentStore=this.viewManager.getCommentStore(),this.previousStoreState=this.commentStore.getState(),this.unsubscribeStoreListener=this.commentStore.subscribe(this.handleStoreUpdate),this.getRenderableItems=F.y(),this.getRenderableItemThreads=F.x(this.getRenderableItems)}return e.prototype.initialize=function(){this.registrationToken=this.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction)},e.prototype.teardown=function(){this.registrationToken.unsubscribe(),this.unsubscribeStoreListener()},e.prototype.onReopenThread=function(e,t){xe.j({trackback:i.d.reserveTag(592269528),id:e,renderContextType:this.getActiveComponentTree().renderContextType,dispatchProps:this.getDispatchProps(e),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:t})},e}(),Be=n(549);var He=n(551);var ze=n(532);function We(e,t,n,r){return function(o){return Object(d.e)().registerExtension(t,n,r).then((function(t){return o(Object(ze.a)(e,t)),t}))}}var qe,Ge=n(28),Ye=n(354);!function(e){e[e.HasToken=0]="HasToken",e[e.EmptyToken=1]="EmptyToken",e[e.TokenFailed=2]="TokenFailed",e[e.MentionsDisabled=3]="MentionsDisabled"}(qe||(qe={}));var Ke=n(346),Je=n(245),Qe=n(199),Xe=function(){function e(){this.hostableComponentRegistry=new Map}return e.prototype.registerComponent=function(e,t,n){this.hostableComponentRegistry.has(e)||this.hostableComponentRegistry.set(e,new Map);var r=this.hostableComponentRegistry.get(e);n?r.set(t,n):r.delete(t)},e.prototype.getComponent=function(e,t){var n=this.hostableComponentRegistry.get(e);if(n)return n.get(t)},e}(),Ze=function(){function e(e){var t=this,n=e.apiContext,r=e.viewProvider,o=e.commentAPI,s=e.peopleAPI,c=e.localizationAPI,l=e.themeAPI,f=e.initializationReason,m=e.commentStore,p=e.viewStrategyFactory,g=e.mockUIDriver;this.initialized=!1,this.initialLoadComplete=!1,this.commentUIActionListeners=[],this.commentInterruptableCommandListeners=[],this.unprocessedActionPayloads=[],this.onInitialRender=function(e){t.commentStore.dispatch(w.x({renderContextType:T.a.None,trackback:i.d.reserveTag(595646478),telemetryVisitor:t.telemetryVisitor},{commentId:e.commentId,renderContextType:e.renderContextType})),Object(B.b)(e.renderContextType)&&t.sendDataReceivedCodeMarker()},this.sendDataReceivedCodeMarker=Object(a.h)((function(){u.a.sendCodeMarker({context:t.apiContext,type:u.b.DataReceived,assertTag:i.d.reserveTag(595731293)})})),this.getComponentTree=function(e){switch(e){case T.a.None:case T.a.ModalDraft:Object(i.k)(!1,"Unexpected render context type:"+e);case T.a.FullPane:case T.a.HalfPane:return N.c(t.getCommentStore().getState());case T.a.DiscreteIntegrated:return t.getComponentTreeForRenderMode(d.d.Integrated);case T.a.DiscreteIsolated:return t.getComponentTreeForRenderMode(d.d.Isolated)}},this.getCommentContainerOwnProps=function(){return{commentAPI:t.commentAPI,localizationAPI:t.localizationAPI,peopleAPI:t.peopleAPI,focusManager:t.focusManager,telemetryVisitor:t.telemetryVisitor,onInitialRender:t.onInitialRender}},this.setComponentRef=function(e,n,r){t.viewManagerRefRegistry.registerComponent(e,n,r)},this.onSuggestionsDetailsChange=function(e){t.commentStore.dispatch(w.ab({renderContextType:T.a.None,trackback:i.d.reserveTag(592492758),telemetryVisitor:t.telemetryVisitor},e))},this.internalInterruptableCommandHandler=function(e){return t.activeViewStrategy.handleCommentInterruptableCommand(e,t.commentStore.dispatch,t.commentStore.getState)},this.apiContext=n,this.viewProvider=r,this.commentAPI=o,this.peopleAPI=s,this.localizationAPI=c,this.themeAPI=l,this.lastInitializationReason=f,this.viewStrategyFactory=p,this.mockUIDriver=g,this.telemetryVisitor=Qe.a.getTelemetryVisitor(this.apiContext),this.correlationId=Qe.a.getCorrelationId(this.apiContext)||Object(a.b)(),this.registerComponentUIActionListener=this.registerComponentUIActionListener.bind(this),this.registerInterruptableCommandListener=this.registerInterruptableCommandListener.bind(this),this.onCommentEventReceived=this.onCommentEventReceived.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onCommentInterruptableCommandReceived=this.onCommentInterruptableCommandReceived.bind(this),this.unregisterComponentUIActionListener=this.unregisterComponentUIActionListener.bind(this),this.unregisterComponentInterruptableCommandListener=this.unregisterComponentInterruptableCommandListener.bind(this),this.refreshAtMentionAuthToken=this.refreshAtMentionAuthToken.bind(this),this.onViewContainerEvent=this.onViewContainerEvent.bind(this),this.observeStore=this.observeStore.bind(this),this.onChange=this.onChange.bind(this),this.processInitialPendingActions=this.processInitialPendingActions.bind(this),this.getComponentTreeForRenderMode=this.getComponentTreeForRenderMode.bind(this),this.selectionManager=new ge(m,this.telemetryVisitor),this.focusManager=new pe(m,this.localizationAPI.getLocaleInfo().isRightToLeft,this.telemetryVisitor);var h=m.getState();this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(h.paneState.viewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor),this.commentStore=m,this.discreteIntegratedComponentTree=new I.a(T.a.DiscreteIntegrated,this.apiContext),this.discreteIsolatedComponentTree=new I.a(T.a.DiscreteIsolated,this.apiContext),this.viewManagerRefRegistry=new Xe,D.q()&&this.registerActions(),this.observeStore(this.commentStore),this.mockUIDriver&&(this.mockCommentViewHelper=new Ue(this,this.mockUIDriver)),this.registerInterruptableCommandListener(this.internalInterruptableCommandHandler)}return e.prototype.getMockDriver=function(){return this.mockUIDriver},e.prototype.refreshAtMentionCapability=function(){var e,t,n;(0,this.commentStore.dispatch)((e={renderContextType:T.a.None,trackback:i.d.reserveTag(595616912),telemetryVisitor:this.telemetryVisitor},t=this.commentAPI,n=this.getAtMentionAuthToken,function(r){var o=Object(s.g)().createActivityObject("ResolveAtMentionCapabilityState",e.telemetryVisitor,s.a.None,s.b.NecessaryServiceDataEvent);return t.checkAtMentionCapability().then((function(t){var r=t?l.b.Enabled:l.b.Disabled;return t?n().then((function(t){return o.addDataField(Ge.a.MentionTokenState,void 0!==t?qe.HasToken:qe.EmptyToken,s.c.SystemMetadata),Object(Ye.a)(e,r,t)}),(function(t){return o.addDataField(Ge.a.MentionTokenState,qe.TokenFailed,s.c.SystemMetadata),Object(Ye.a)(e,r,void 0)})):(o.addDataField(Ge.a.MentionTokenState,qe.MentionsDisabled,s.c.SystemMetadata),Object(Ye.a)(e,r,void 0))})).then((function(e){o.addDataField(Ge.a.AtMentionsEnabled,e.payload.capability===l.b.Enabled,s.c.SystemMetadata),o.successTag(595903522),r(e)})).catch((function(t){o.failTag(595903523,Object(Re.a)(t,-2130957528)),r(Object(Ye.a)(e,l.b.Disabled,void 0))}))})).catch((function(e){Object(ke.b)(e)?Object(s.g)().assertConditionTag(!1,e.message,595152915):Object(s.g)().assertConditionTag(!1,"Unknown error when dispatching requestAtMentionCapabilityThunk "+e,595152916)}))},e.prototype.refreshAtMentionAuthToken=function(){var e,t,n=this.commentStore.getState();Object(E.f)(F.l(n),F.a(n))===l.b.Enabled&&(0,this.commentStore.dispatch)((e={renderContextType:T.a.None,trackback:i.d.reserveTag(595899736),telemetryVisitor:this.telemetryVisitor},t=this.getAtMentionAuthToken,function(n){var r=Object(s.g)().createActivityObject("RefreshAtMentionAuthToken",e.telemetryVisitor,s.a.OnSuccess,s.b.NecessaryServiceDataEvent);return t().then((function(t){r.successTag(595899734),n(Object(Be.a)(e,t))}),(function(e){r.failTag(595899735,-2130957528)}))})).catch((function(e){Object(ke.b)(e)?Object(s.g)().assertConditionTag(!1,e.message,595632139):Object(s.g)().assertConditionTag(!1,"Unknown error in refreshAtMentionAuthToken "+e,595632140)}))},e.prototype.getCommentStore=function(){return this.commentStore},e.prototype.getFocusManager=function(){return this.focusManager},e.prototype.getInitializationReason=function(){return this.lastInitializationReason},e.prototype.getSelectionManager=function(){return this.selectionManager},e.prototype.beginInitialization=function(){var e,t;this.initialized||(this.commentAPI.registerForCommentEvents(this.onCommentEventReceived),D.q()||this.registerActions(),void 0!==this.commentAPI.registerForInterruptableCommands&&this.commentAPI.registerForInterruptableCommands(this.onCommentInterruptableCommandReceived),D.q()&&this.initializeContentExtensions(),this.viewProvider.registerForViewContainerEvents(this.onViewContainerEvent),this.refreshAtMentionCapability(),D.Q()||this.commentStore.dispatch(w.R({renderContextType:T.a.None,trackback:i.d.reserveTag(595732560),telemetryVisitor:this.telemetryVisitor},{resolve:this.commentAPI.resolveSupported()})),D.Q()&&this.commentStore.dispatch(w.Y({renderContextType:T.a.None,trackback:i.d.reserveTag(595685378),telemetryVisitor:this.telemetryVisitor},this.commentAPI.resolveSupported()?y.a.Resolve:y.a.None,void 0)),this.peopleAPI.capabilities&v.a.GetSuggestionsDetails&&(this.commentStore.dispatch((e={renderContextType:T.a.None,trackback:i.d.reserveTag(592492753),telemetryVisitor:this.telemetryVisitor},t=this.peopleAPI,function(n){if(!(t.capabilities&v.a.GetSuggestionsDetails))return Promise.resolve();var r=Object(s.g)().createActivityObject("RefreshSuggestionsDetails",e.telemetryVisitor,s.a.OnSuccess,s.b.NecessaryServiceDataEvent);return t.getSuggestionsDetails?t.getSuggestionsDetails().then((function(t){r.successTag(592492760),n(Object(He.a)(e,t))}),(function(e){r.failTag(592492761,-2130957495)})):(r.failTag(592492759,-2130957494),Promise.resolve())})).catch((function(e){Object(ke.b)(e)?Object(s.g)().assertConditionTag(!1,e.message,592492754):Object(s.g)().assertConditionTag(!1,"Unknown error when dispatching refreshSuggestionsDetailsThunk "+e,592492755)})),Object(s.g)().assertConditionTag(!!this.peopleAPI.registerForSuggestionsDetailsChanges,"registerForSuggestionsDetailsChanges expected to be defined if capability is set",592492756),this.peopleAPI.registerForSuggestionsDetailsChanges&&this.peopleAPI.registerForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),this.mockCommentViewHelper&&this.mockCommentViewHelper.initialize(),this.initialized=!0)},e.prototype.getTelemetryVisitor=function(){return this.telemetryVisitor},e.prototype.getAtMentionAuthToken=function(){return Promise.resolve(void 0)},e.prototype.onChange=function(e){!this.initialLoadComplete&&e&&void 0===F.m(e)&&F.e(e).length>0&&this.processInitialPendingActions()},e.prototype.observeStore=function(e){var t,n=this;return e.subscribe((function(){var r=e.getState();if(D.q()){var o=F.m(r);o!==t&&(t=o,n.onChange(r))}}))},e.prototype.processInitialPendingActions=function(){var e=this;this.initialLoadComplete=!0,this.unprocessedActionPayloads.forEach((function(t){e.onCommentUIAction(t)})),this.unprocessedActionPayloads=[]},e.prototype.registerActions=function(){this.commentAPI.registerForAction(p.a.AddComment,this.onCommentUIAction),this.commentAPI.registerForAction(p.a.NextThread,this.onCommentUIAction),this.commentAPI.registerForAction(p.a.PreviousThread,this.onCommentUIAction),this.commentAPI.registerForAction(p.a.DeleteThread,this.onCommentUIAction),this.commentAPI.registerForAction(p.a.BackKeyPressed,this.onCommentUIAction),this.commentAPI.registerForAction(p.a.ShowHideCommentPane,this.onCommentUIAction)},e.prototype.getComponentTreeForRenderMode=function(e){switch(e){case d.d.Integrated:return this.discreteIntegratedComponentTree;case d.d.Isolated:return this.discreteIsolatedComponentTree}},e.prototype.getPaneOwnProps=function(){return Object(o.__assign)(Object(o.__assign)({},this.getCommentContainerOwnProps()),{selectionManager:this.selectionManager,initializationReason:this.lastInitializationReason,registerComponentUIActionListener:this.registerComponentUIActionListener,registerComponentInterruptableCommandListener:this.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this.unregisterComponentInterruptableCommandListener,unregisterComponentUIActionListener:this.unregisterComponentUIActionListener,refreshAtMentionAuthToken:this.refreshAtMentionAuthToken,correlationId:this.correlationId})},e.prototype.getHostableCommentCardRendererProps=function(e){var t=this;return Object(o.__assign)(Object(o.__assign)({},this.getCommentContainerOwnProps()),{componentTree:this.getComponentTreeForRenderMode(e),setComponentRef:function(n,r){t.setComponentRef(e,n,r)},correlationId:this.correlationId,themeAPI:this.themeAPI})},e.prototype.initializeContentExtensions=function(){var e,t=this;Object(Ke.c)("CommentPaneContainer").then((function(n){if(void 0!==(e=n)){var r=Oe(Te(e.CommentPaneContainer,Object(o.__assign)({},t.getPaneOwnProps())),t.commentStore),a=Object(Je.d)(Je.a,t.apiContext);Object(c.b)().registerComponent(a,r)}var u;Object(Ke.c)("HostableCommentCardRendererContainer").then((function(e){if(void 0!==(u=e)){var n=Oe(Te(u.HostableCommentCardRendererContainer,Object(o.__assign)({},t.getHostableCommentCardRendererProps(d.d.Integrated))),t.commentStore),r=Object(Je.d)(Je.b,t.apiContext);t.discreteIntegratedComponentController=Object(c.b)().registerComponent(r,n),t.discreteIntegratedComponentController.onComponentCommand.subscribe((function(e){t.processHostableComponentCommand(e,d.d.Integrated)}));var a=Oe(Te(u.HostableCommentCardRendererContainer,Object(o.__assign)({},t.getHostableCommentCardRendererProps(d.d.Isolated))),t.commentStore),l=Object(Je.d)(Je.c,t.apiContext);t.discreteIsolatedComponentController=Object(c.b)().registerComponent(l,a),t.discreteIsolatedComponentController.onComponentCommand.subscribe((function(e){t.processHostableComponentCommand(e,d.d.Isolated)})),t.commentStore.dispatch(We({renderContextType:T.a.None,trackback:i.d.reserveTag(595616915),telemetryVisitor:t.telemetryVisitor},d.b.CommentThread,r,{renderMode:d.d.Integrated,priority:d.c.Disabled,instanceId:t.apiContext,componentDimensions:t.getAverageCardSize()})).catch((function(e){Object(ke.b)(e)?Object(s.g)().assertConditionTag(!1,e.message,595645980):Object(s.g)().assertConditionTag(!1,"Unknown error in initializeContentExtensions "+e,595645981)})),t.commentStore.dispatch(We({renderContextType:T.a.None,trackback:i.d.reserveTag(595616916),telemetryVisitor:t.telemetryVisitor},d.b.CommentThread,l,{renderMode:d.d.Isolated,priority:d.c.Disabled,instanceId:t.apiContext,componentDimensions:t.getAverageCardSize(),isContentAvailable:function(e){var n=t.commentStore.getState(),r=Object(Ce.c)(e,F.e(n),F.d(n)),o=F.p(n),i=F.i(n);return Object(Ce.a)(e,Object(Ce.b)(e,F.e(n),r,F.h(n),i.drafts[e]),i,o,T.a.DiscreteIsolated,Object(he.a)(e,T.a.DiscreteIsolated,i,o))}})).catch((function(e){Object(ke.b)(e)?Object(s.g)().assertConditionTag(!1,e.message,595645982):Object(s.g)().assertConditionTag(!1,"Unknown error in initializeContentExtensions "+e,595645983)}))}})).catch((function(e){Object(ke.b)(e)?Object(s.g)().assertConditionTag(!1,e.message,595645984):Object(s.g)().assertConditionTag(!1,"Unknown error in initializeContentExtensions "+e,595645985)}))})).catch((function(e){Object(ke.b)(e)?Object(s.g)().assertConditionTag(!1,e.message,595645986):Object(s.g)().assertConditionTag(!1,"Unknown error in initializeContentExtensions "+e,595645987)}))},e.prototype.getAverageCardSize=function(){return{width:259,height:ve({itemCount:3,readOnly:!1,isTask:!1})}},e.prototype.processHostableComponentCommand=function(e,t){var n,r=this;switch(e.command){case"Focus":return void(D.tb()?setTimeout((function(){var n;return null===(n=r.viewManagerRefRegistry.getComponent(t,e.details.componentInstanceId))||void 0===n?void 0:n.focus()})):null===(n=this.viewManagerRefRegistry.getComponent(t,e.details.componentInstanceId))||void 0===n||n.focus());case"UpdateComponentDataProps":break;default:return void Object(s.g)().assertConditionTag(!1,"Unexpected command type",593786644)}},e.prototype.teardownContentExtensions=function(){this.commentStore.dispatch(w.C({renderContextType:T.a.None,trackback:i.d.reserveTag(595616917),telemetryVisitor:this.telemetryVisitor},d.d.Integrated,d.d.Isolated));var e=Object(Je.d)(Je.a,this.apiContext);Object(c.b)().unregisterComponent(e)},e.prototype.teardown=function(){this.initialized&&(this.viewProvider.unregisterForViewContainerEvents(this.onViewContainerEvent),this.commentAPI.unregisterForCommentEvents(this.onCommentEventReceived),this.commentAPI.unregisterForAction(p.a.AddComment),this.commentAPI.unregisterForAction(p.a.NextThread),this.commentAPI.unregisterForAction(p.a.PreviousThread),this.commentAPI.unregisterForAction(p.a.DeleteThread),this.commentAPI.unregisterForAction(p.a.BackKeyPressed),this.commentAPI.unregisterForAction(p.a.ShowHideCommentPane),void 0!==this.commentAPI.unregisterForInterruptableCommands&&this.commentAPI.unregisterForInterruptableCommands(this.onCommentInterruptableCommandReceived),this.peopleAPI.capabilities&v.a.GetSuggestionsDetails&&(Object(s.g)().assertConditionTag(!!this.peopleAPI.unregisterForSuggestionsDetailsChanges,"unregisterForSuggestionsDetailsChanges should be defined if capability is set",592492757),this.peopleAPI.unregisterForSuggestionsDetailsChanges&&this.peopleAPI.unregisterForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),D.q()&&this.teardownContentExtensions(),this.initialized=!1)},e.prototype.registerComponentUIActionListener=function(e){this.commentUIActionListeners.push(e)},e.prototype.unregisterComponentUIActionListener=function(e){var t=this.commentUIActionListeners.indexOf(e);t>-1&&this.commentUIActionListeners.splice(t,1)},e.prototype.registerInterruptableCommandListener=function(e){this.commentInterruptableCommandListeners.push(e)},e.prototype.unregisterComponentInterruptableCommandListener=function(e){var t=this.commentInterruptableCommandListeners.indexOf(e);t>-1&&this.commentInterruptableCommandListeners.splice(t,1)},e.prototype.onCommentUIAction=function(e){var t,n;if(D.q()&&e.actionBehavior===f.a.Execute&&(this.initialized||this.beginInitialization(),!this.initialLoadComplete))return this.unprocessedActionPayloads.push(e),!0;try{for(var r=Object(o.__values)(this.commentUIActionListeners),i=r.next();!i.done;i=r.next()){var a=(0,i.value)(e);if(a!==h.a.NotHandled)return a===h.a.Success}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return this.activeViewStrategy.processCommentUIAction(e,this.commentStore.dispatch,this.commentStore.getState)===h.a.Success},e.prototype.onCommentEventReceived=function(e,t){var n=Object(i.i)(i.c.Comments,m.a[e]);this.activeViewStrategy.processCommentEvent(e,t,this.commentStore.dispatch,this.commentStore.getState),null==n||n.end(),D.q()&&!this.initialLoadComplete&&e===m.a.CommentContextChanged&&C.b(t)&&0===t.numberOfComments&&this.processInitialPendingActions()},e.prototype.onCommentInterruptableCommandReceived=function(e){var t=Promise.resolve(g.a.Unhandled);return this.commentInterruptableCommandListeners.reduce((function(t,n){return t.then((function(t){return t!==g.a.Unhandled?Promise.resolve(t):n(e)}))}),t)},e.prototype.onViewContainerEvent=function(e){var t=this,n=this.commentStore.dispatch;switch(e.eventType){case b.a.VisibilityChanged:return void n(w.db({renderContextType:T.a.None,trackback:i.d.reserveTag(592241221),telemetryVisitor:this.telemetryVisitor},e.viewContainerVisibilityState));case b.a.ViewContainerChanged:return n(w.bb({renderContextType:T.a.None,trackback:i.d.reserveTag(595616919),telemetryVisitor:this.telemetryVisitor},e.newViewContainer)),void(this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(e.newViewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor));case b.a.FocusTriggered:return void setTimeout((function(){return t.focusManager.focusCommentPaneCommand(N.c(t.commentStore.getState()))}));case b.a.FoldableLayoutStateChanged:n(w.cb({renderContextType:T.a.None,trackback:i.d.reserveTag(591660549),telemetryVisitor:this.telemetryVisitor},e.newFoldableLayoutState))}},e}();n.d(t,"a",(function(){return $e}));var $e=function(e){function t(t){var n=e.call(this,t)||this;return t.initializeImmediately&&n.beginInitialization(),n}return Object(o.__extends)(t,e),t}(Ze)},910:function(e,t,n){"use strict";var r,o=n(185),i=n(9),a=n(3),s=n(124),c=n(125),d=n(122),u=n(148),l=n(90),f=n(84);!function(e){e[e.HostCanvas=1]="HostCanvas",e[e.ContentNavigation=2]="ContentNavigation"}(r||(r={}));var m=n(146),p=n(20),g=n(178),h=n(83),C=n(14),y=n(37),v=n(297),b=n(394),T=n(276),I=n(410),O=n(176),S=n(187),j=n(18),D=n(11),w=n(58),_=n(173),x=n(21),E=n(7),P=n(476),A=function(){function e(e,t,n,r,o){this.localizationAPI=e,this.peopleAPI=t,this.commentAPI=n,this.selectionManager=r,this.telemetryVisitor=o,this.getDraftRenderContextType=D.w(),this.getRenderableItems=D.y()}return e.prototype.processCommentEvent=function(e,t,n,o){var s=o();switch(e){case d.a.CommentContextChanged:if(!f.b(t))return void Object(a.g)().assertConditionTag(!1,"Invalid eventPayload",595912090);n(C.p({renderContextType:p.a.None,trackback:i.d.reserveTag(595912089),telemetryVisitor:this.telemetryVisitor},t));break;case d.a.CommentsChanged:if(!f.i(t))return void Object(a.g)().assertConditionTag(!1,"Invalid eventPayload",595912091);break;case d.a.LoadComments:if(!f.j(t))return void Object(a.g)().assertConditionTag(!1,"Invalid eventPayload",595912092);break;case d.a.CommentSelected:if(!f.h(t))return void Object(a.g)().assertConditionTag(!1,"Invalid eventPayload",595912096);if(t.commentId)if(E.o()){var c=void 0;if(void 0!==D.d(s)[t.commentId])c=Object(T.a)(t.commentId,y.a.Canvas,{selectType:t.selectionReason===r.ContentNavigation?C.c.CollapseCard:C.c.ExpandCard});else{if(void 0===(l=D.e(s).find((function(e){return e.commentId===t.commentId}))))return;c=Object(T.a)(l.parentId,y.a.Canvas,{selectType:C.c.SelectPost,selectedPost:t.commentId})}n(Object(T.b)(void 0,{renderContextType:p.a.None,trackback:i.d.reserveTag(579744149),telemetryVisitor:this.telemetryVisitor},c,!1)).catch(Object(_.a)(i.d.reserveTag(579744150)))}else if(void 0!==D.d(s)[t.commentId]){var u=t.selectionReason===r.ContentNavigation?C.c.CollapseCard:C.c.ExpandCard;n(C.L({renderContextType:p.a.None,trackback:i.d.reserveTag(595912093),telemetryVisitor:this.telemetryVisitor},t.commentId,void 0,u,y.a.Canvas))}else{var l;void 0!==(l=D.e(s).find((function(e){return e.commentId===t.commentId})))&&n(C.L({renderContextType:p.a.None,trackback:i.d.reserveTag(595912094),telemetryVisitor:this.telemetryVisitor},l.parentId,t.commentId,C.c.SelectPost,y.a.Canvas))}else n(C.m({renderContextType:p.a.None,trackback:i.d.reserveTag(595912095),telemetryVisitor:this.telemetryVisitor}));break;case d.a.CommentContextReload:if(!f.d(t))return void Object(a.g)().assertConditionTag(!1,"Invalid eventPayload",595912097);break;case d.a.CommentHighlighted:if(!f.f(t))return void Object(a.g)().assertConditionTag(!1,"Invalid eventPayload",595912128);t.commentId?n(C.u({renderContextType:p.a.None,trackback:i.d.reserveTag(595912098),telemetryVisitor:this.telemetryVisitor},t.commentId,y.a.Canvas)):E.j()?n(C.k({renderContextType:p.a.None,trackback:i.d.reserveTag(578586723),telemetryVisitor:this.telemetryVisitor},y.a.Canvas,void 0)):n(C.l({renderContextType:p.a.None,trackback:i.d.reserveTag(595912099),telemetryVisitor:this.telemetryVisitor},y.a.Canvas));break;case d.a.NextPopulatedContextDetailsUpdated:if(!f.l(t)||!t.contextDetails.nextPopulatedContextDetails)return void Object(a.g)().assertConditionTag(!1,"Invalid eventPayload",595912130);n(C.w({renderContextType:p.a.None,trackback:i.d.reserveTag(595912129),telemetryVisitor:this.telemetryVisitor},t.contextDetails.nextPopulatedContextDetails));break;case d.a.CommentHostCapabilitiesChanged:f.g(t)?n(C.R({renderContextType:p.a.None,trackback:i.d.reserveTag(595732558),telemetryVisitor:this.telemetryVisitor},t.capabilities)):Object(a.g)().assertConditionTag(!1,"Invalid eventPayload",595732559);break;case d.a.ModelCapabilitiesChanged:f.k(t)?n(C.Y({renderContextType:p.a.None,trackback:i.d.reserveTag(595685376),telemetryVisitor:this.telemetryVisitor},t.modelCapabilityFlags,t.richTextCapabilityFlags)):Object(a.g)().assertConditionTag(!1,"Invalid eventPayload",595616784);break;case d.a.CommentError:if(!f.e(t))return void Object(a.g)().assertConditionTag(!1,"Invalid eventPayload",595912131);break;case d.a.ReturnToDraftRequested:f.m(t)&&n(C.s({draftWarningType:S.a.ReturnToDraft,draftWarningReason:O.a.HostRequest},{renderContextType:p.a.None,trackback:i.d.reserveTag(593376912),telemetryVisitor:this.telemetryVisitor}));break;case d.a.UpdateDraftThread:f.o(t)?n(C.U({renderContextType:p.a.None,trackback:i.d.reserveTag(594023371),telemetryVisitor:this.telemetryVisitor},t)):Object(a.g)().assertConditionTag(!1,"Invalid eventPayload",594023372);break;case d.a.SmartReplyPopulated:if(!f.n(t))return void Object(a.g)().assertConditionTag(!1,"Invalid eventPayload for smart replies",590202467);n(C.y({renderContextType:p.a.None,trackback:i.d.reserveTag(590202466),telemetryVisitor:this.telemetryVisitor},t));break;default:return void Object(a.g)().assertConditionTag(!1,"Deprecated event detected.",595912132)}},e.prototype.processCommentUIAction=function(e,t,n,r){var o=this,c=n();switch(e.actionType){case u.a.ShowHideCommentPane:return l.c(e.actionBehavior)?w.b(c)?l.a.Success:l.a.Fail:(l.d(e.actionBehavior)&&(w.b(c)?t(C.D({renderContextType:p.a.None,trackback:i.d.reserveTag(595912133),telemetryVisitor:this.telemetryVisitor})):t(C.I({renderContextType:p.a.None,trackback:i.d.reserveTag(595912134),telemetryVisitor:this.telemetryVisitor}))),l.a.Success);case u.a.AddComment:if(l.b(e.actionBehavior)){if(!Object(P.a)(D.i(c),D.p(c),D.g(c)))return l.a.Fail}else if(l.d(e.actionBehavior)){var d={renderContextType:p.a.None,trackback:i.d.reserveTag(595146382),telemetryVisitor:this.telemetryVisitor};return t(Object(v.a)(d,this.commentAPI,{sessionType:"CREATE"},!(!r||!r.retainSelectionOnAddComment),this.peopleAPI,void 0)).catch(Object(_.a)(i.d.reserveTag(592314376))),l.a.Success}return l.a.Success;case u.a.NextThread:if(Object(a.g)().assertConditionTag(!l.c(e.actionBehavior),"This action type does not support toggled status",595899713),l.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return o.selectionManager.selectNextOrPreviousThread({direction:s.d.Next,source:y.a.SharedComments},p.a.None)}),t,E.Hb()?void 0:O.a.NextThread,i.d.reserveTag(591729749));else if(l.b(e.actionBehavior))return Object(P.c)(c)?l.a.Success:l.a.Fail;return l.a.Success;case u.a.PreviousThread:if(Object(a.g)().assertConditionTag(!l.c(e.actionBehavior),"This action type does not support toggled status",595899714),l.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return o.selectionManager.selectNextOrPreviousThread({direction:s.d.Previous,source:y.a.SharedComments},p.a.None)}),t,E.Hb()?void 0:O.a.PreviousThread,i.d.reserveTag(591729750));else if(l.b(e.actionBehavior))return Object(P.c)(c)?l.a.Success:l.a.Fail;return l.a.Success;case u.a.DeleteThread:if(Object(a.g)().assertConditionTag(!l.c(e.actionBehavior),"This action type does not support toggled status",595899715),l.b(e.actionBehavior)){if(!Object(P.b)(c.commentState))return l.a.Fail}else l.d(e.actionBehavior)&&this.handleActionOrReturnToDraft((function(){var e=D.p(c);e&&t(C.F({renderContextType:p.a.None,trackback:i.d.reserveTag(591738706),telemetryVisitor:o.telemetryVisitor},e.selectedCardId))}),t,O.a.DeleteThread,i.d.reserveTag(591729751));return l.a.Success}return l.a.NotHandled},e.prototype.handleCommentInterruptableCommand=function(e,t,n){switch(e.type){case"EditComment":var r=n(),o=this.getRenderableItems(r),s=D.p(r),d=Object(h.a)(o,e.commentId);return d?Object(g.I)({comment:d,threads:o,selectedComment:s,warningType:j.b.Edit,warningType_deprecated:j.a.LowFidelityWarningOnEdit})?(t(C.P({renderContextType:p.a.None,telemetryVisitor:this.telemetryVisitor,trackback:i.d.reserveTag(593000206)},e.commentId,j.b.Edit,j.a.LowFidelityWarningOnEdit)),Promise.resolve(c.e.Handled)):(Object(I.a)(this.commentAPI,this.peopleAPI,t,{sessionType:"EDIT",commentId:e.commentId},!1,{renderContextType:p.a.None,telemetryVisitor:this.telemetryVisitor,trackback:i.d.reserveTag(593000207)},{renderContextType:p.a.None,telemetryVisitor:this.telemetryVisitor,trackback:i.d.reserveTag(593000208)}),Promise.resolve(c.e.Handled)):(Object(a.g)().assertConditionTag(!1,"Comment not found",593000205),Promise.resolve(c.e.Handled));case"ReplyComment":return t(Object(v.a)({renderContextType:p.a.None,trackback:i.d.reserveTag(593000209),telemetryVisitor:this.telemetryVisitor},this.commentAPI,{sessionType:"REPLY",threadId:e.threadId},!1,this.peopleAPI,void 0)).catch(Object(_.a)(i.d.reserveTag(593000210))),Promise.resolve(c.e.Handled);default:return Promise.resolve(c.e.Unhandled)}},e.prototype.handleActionOrReturnToDraft=function(e,t,n,r){t(Object(b.a)({renderContextType:p.a.None,trackback:r,telemetryVisitor:this.telemetryVisitor},y.a.SharedComments,n)).then((function(t){void 0!==n&&t.draftDiscardBehavior!==m.a.NoDraft&&t.draftDiscardResult!==c.e.Handled||e()})).catch((function(e){Object(x.b)(e)?Object(a.g)().assertConditionTag(!1,e.message,591738704):Object(a.g)().assertConditionTag(!1,"Unknown error in execute action "+e,591738705)}))},e}(),k=n(168),R=n(601),F=n(537),N=n(538),M=n(539),V=n(541),L=n(99),U=n(548),B=n(550);function H(e,t,n,r){return function(o,a){var s=a();r&&o(r);var c=r?r.actionDetail.telemetryVisitor:t;if(n){if(void 0!==n.topVisibleThreadId&&o(Object(U.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953696)},n.topVisibleThreadId||void 0)),void 0!==n.selectedCommentId)if(n.selectedCommentId){var d=D.p(s);if(d&&d.selectedCardId===n.selectedCommentId)if(Object(j.d)(d.selectionDetails))o(Object(L.b)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953697)},n.selectedCommentId,void 0,d.selectionDetails.expanded?L.a.ExpandCard:L.a.CollapseCard,y.a.Canvas));else{var u=d.selectionDetails.selectedPostId,l=a();D.e(l).find((function(e){return e.commentId===u}))?o(Object(L.b)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953698)},n.selectedCommentId,u,L.a.SelectPost,y.a.Canvas)):o(Object(L.b)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953699)},n.selectedCommentId,void 0,L.a.ExpandCard,y.a.Canvas))}else o(Object(L.b)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953728)},n.selectedCommentId,void 0,L.a.ExpandCard,y.a.Canvas))}else o(Object(M.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953729)}));void 0!==n.highlightedCommentId&&(n.highlightedCommentId?o(Object(V.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953730)},n.highlightedCommentId,y.a.Canvas)):E.j()?o(Object(F.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(578586722)},y.a.Canvas,void 0)):o(Object(N.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953731)},y.a.Canvas)));var f=Object(R.a)(n);f&&o(Object(B.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953732)},f))}}}var z=n(403),W=n(15),q=n(16),G=n(327);var Y=n(542),K=n(543);function J(e,t,n){return function(r){f.p(t)?r(Object(K.a)(Object(q.a)(e,i.d.reserveTag(595137280)),t.threads)):(E.V()&&r(Object(G.a)(Object(q.a)(e,i.d.reserveTag(595137282)),t.comments,t.tasks,n)),r(Object(Y.a)(Object(q.a)(e,i.d.reserveTag(595137283)),t.comments,t.tasks)))}}var Q=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.focusManager=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,r){switch(e){case d.a.CommentsChanged:f.i(t)&&n(H(p.a.None,this.telemetryVisitor,t.contextDetails,Object(C.e)({renderContextType:p.a.None,trackback:i.d.reserveTag(595937042),telemetryVisitor:this.telemetryVisitor},t.changes)));break;case d.a.LoadComments:f.j(t)&&n(J({renderContextType:p.a.None,trackback:i.d.reserveTag(595899532),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI));break;case d.a.CommentContextReload:f.d(t)&&n((o={renderContextType:p.a.None,trackback:i.d.reserveTag(595899533),telemetryVisitor:this.telemetryVisitor},s=t,c=this.peopleAPI,u=this.telemetryVisitor,function(e,t){var n=[];Object(f.c)(s)?(Object(a.g)().assertConditionTag(!t||Object(W.K)(D.l(t()),D.v(t())),"contextReloadThunk's payload should only include comment ids when state is virtualized",595162893),n=Object(z.a)(s.commentIds,(function(){return t().commentState}))):n=s.comments;var r=Object(f.c)(s)?[]:s.tasks;e(H(o.renderContextType,u,s.contextDetails,Object(C.B)(Object(q.a)(o,i.d.reserveTag(595953694)),{comments:n,numberOfThreads:s.numberOfThreads,tasks:r}))),E.V()&&e(Object(G.a)(Object(q.a)(o,i.d.reserveTag(595932895)),n,r,c)).catch((function(e){Object(x.b)(e)?Object(a.g)().assertConditionTag(!1,e.message,595645974):Object(a.g)().assertConditionTag(!1,"Unknown error in contextReloadThunk "+e,595645975)}))}))}var o,s,c,u;this.commonViewStrategy.processCommentEvent(e,t,n,r)},e.prototype.processCommentUIAction=function(e,t,n){if(e.actionType===c.c.AddComment&&e.actionBehavior!==c.a.CheckEnabled){var r=n();w.b(r)&&this.focusManager.onUserAction(r.paneState.componentTree,{userAction:k.a.RequestNewCommentFromHost})}return this.commonViewStrategy.processCommentUIAction(e,t,n)},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}(),X=n(270),Z=n(293),$=n(0),ee=n(94),te=n(76),ne=n(87);var re=n(382);var oe=n(544);var ie=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.lastInitializationReason=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,r){switch(e){case d.a.CommentsChanged:f.i(t)&&n((o=t,s=this.telemetryVisitor,function(e,t){var n,r,c,d=t(),u=!1,l=o.contextDetails;if(""===(null==l?void 0:l.selectedCommentId)&&(l=Object($.__assign)(Object($.__assign)({},l),{selectedCommentId:void 0})),e(H(p.a.None,s,l,Object(C.e)({renderContextType:p.a.None,trackback:i.d.reserveTag(595953743),telemetryVisitor:s},o.changes))),!o.contextDetails||!o.contextDetails.selectedCommentId){var f=D.p(d),m=f?f.selectedCardId:void 0,g=t(),h=D.p(g),v=D.e(d),b=D.e(g);if(m){if(m&&o.changes.some((function(e){return e.type===ee.a.Delete&&e.model.commentId===m}))){var T=v.findIndex((function(e){return e.commentId===m}));try{for(var I=Object($.__values)(o.changes),O=I.next();!O.done;O=I.next()){var S=O.value;switch(S.type){case ee.a.Insert:S.index<=T&&++T;break;case ee.a.Delete:S.index<T&&--T;break;case ee.a.Modify:case ee.a.Unknown:}}}catch(e){n={error:e}}finally{try{O&&!O.done&&(r=I.return)&&r.call(I)}finally{if(n)throw n.error}}if(h)throw new x.a(ne.n,-2130957551);if(b.length){var j=T;j===b.length&&(j=b.length-1);var w=b[j],_=Object(te.b)(w);e(Object(C.L)({renderContextType:p.a.None,trackback:i.d.reserveTag(595953744),telemetryVisitor:s},_,void 0,L.a.ExpandCard,y.a.SharedComments)),u=!0}}}else!v.length&&b.length&&(e(Object(C.L)({renderContextType:p.a.None,trackback:i.d.reserveTag(595947723),telemetryVisitor:s},b[0].commentId,void 0,L.a.ExpandCard,y.a.SharedComments)),u=!0);Object(a.g)().assertConditionTag(u||0===b.length||""!==(null===(c=o.contextDetails)||void 0===c?void 0:c.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in applyCommentChangesAndPreserveSelectionPositionThunk",590991767)}}));break;case d.a.LoadComments:f.j(t)&&(r().paneState.initializationStatus===Z.a.Initialized||this.lastInitializationReason!==X.a.NewThread?n(function(e,t,n,r){return function(o,a){o(J({renderContextType:e,trackback:i.d.reserveTag(595899530),telemetryVisitor:r},t,n));var s=a(),c=Object(W.K)(D.l(s),D.v(s)),d=D.e(s);Object(re.a)({commentData:d,pendingCommentLoad:D.m(s),virtualized:c})&&d.length&&!D.p(s)&&o(Object(C.L)({renderContextType:e,trackback:i.d.reserveTag(595953680),telemetryVisitor:r},d[0].commentId,void 0,L.a.ExpandCard,y.a.SharedComments))}}(p.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor)):n(J({renderContextType:p.a.None,trackback:i.d.reserveTag(595899531),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI)));break;case d.a.CommentContextReload:f.d(t)&&n(function(e,t,n,r){return function(o,s){var c,d,u=s(),l=!1,m=[];Object(f.c)(t)?(Object(a.g)().assertConditionTag(Object(W.K)(D.l(u),D.v(u)),"reloadCommentsAndPreserveSelectionPositionThunk's payload should only include comment ids when state is virtualized",595162891),m=Object(z.a)(t.commentIds)):m=t.comments;var p=t.contextDetails;""===(null==p?void 0:p.selectedCommentId)&&(p=Object($.__assign)(Object($.__assign)({},p),{selectedCommentId:void 0}));var g=Object(f.c)(t)?[]:t.tasks;o(H(e,r,p,Object(oe.a)({renderContextType:e,telemetryVisitor:r,trackback:i.d.reserveTag(595953677)},{comments:m,numberOfThreads:t.numberOfThreads,tasks:g}))),E.V()&&o(Object(G.a)({renderContextType:e,telemetryVisitor:r,trackback:i.d.reserveTag(595162892)},m,g,n)).catch((function(e){Object(x.b)(e)?Object(a.g)().assertConditionTag(!1,e.message,595645962):Object(a.g)().assertConditionTag(!1,"Unknown error in reloadCommentsAndPreserveSelectionPositionThunk "+e,595645963)}));var h=null===(c=D.p(u))||void 0===c?void 0:c.selectedCardId,v=D.e(u),b=s(),T=D.e(b);if(h){if(!D.p(b)){var I=v.findIndex((function(e){return e.commentId===h}));if(I<0)return;if(T.length){var O=I;O===T.length&&(O=T.length-1);var S=Object(te.b)(T[O]);o(Object(C.L)({renderContextType:e,telemetryVisitor:r,trackback:i.d.reserveTag(595953678)},S,void 0,L.a.ExpandCard,y.a.SharedComments)),l=!0}}}else!v.length&&T.length&&(o(Object(C.L)({renderContextType:e,telemetryVisitor:r,trackback:i.d.reserveTag(595947722)},T[0].commentId,void 0,L.a.ExpandCard,y.a.SharedComments)),l=!0);Object(a.g)().assertConditionTag(l||0===T.length||""!==(null===(d=t.contextDetails)||void 0===d?void 0:d.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in reloadCommentsAndPreserveSelectionPositionThunk",590991766)}}(p.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor))}var o,s;this.commonViewStrategy.processCommentEvent(e,t,n,r)},e.prototype.processCommentUIAction=function(e,t,n){return this.commonViewStrategy.processCommentUIAction(e,t,n,{retainSelectionOnAddComment:!0})},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}();n.d(t,"a",(function(){return ae}));var ae=function(){function e(){}return e.prototype.createViewStrategy=function(e,t,n,r,i,a,s,c){var d=new A(t,n,r,i,c);switch(e.containerType){case o.a.HalfPane:return new ie(d,n,s,c);case o.a.FullPane:return new Q(d,n,a,c)}},e}()},922:function(e,t,n){"use strict";var r;n(7);!function(e){e.None="NONE",e.SmallPhone="SMALL_PHONE",e.Phablet="PHABLET",e.LargeDisplay="LARGE_DISPLAY",e.Infinite="INFINITE"}(r||(r={}));var o=n(95),i=(n(20),n(105),n(135),n(40));n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));r.None;var a=function(e){return e===o.a.iOS||e===o.a.Android};function s(e,t,n){return!e||t||n?i.a.WHITE:i.a.COLLAPSED_RESOLVED_BODY}},94:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Unknown="unk",e.Insert="ins",e.Modify="mod",e.Delete="del",e.Load="load"}(r||(r={})),t.b=r},95:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.iOS="ios",e.Android="android",e.Windows="windows",e.Mac="macos",e.Web="web"}(r||(r={}))},954:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r,o,i,a=n(208),s=Object(a.a)({from:{opacity:0},to:{opacity:1}}),c=Object(a.a)({from:{opacity:1},to:{opacity:0}}),d=Object(a.a)({from:{transform:"scale3d(1.15, 1.15, 1)"},to:{transform:"scale3d(1, 1, 1)"}}),u=Object(a.a)({from:{transform:"scale3d(1, 1, 1)"},to:{transform:"scale3d(0.9, 0.9, 1)"}}),l=Object(a.a)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(-48px, 0, 0)"}}),f=Object(a.a)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(48px, 0, 0)"}}),m=Object(a.a)({from:{transform:"translate3d(48px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),p=Object(a.a)({from:{transform:"translate3d(-48px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),g=Object(a.a)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(0, -48px, 0)"}}),h=Object(a.a)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(0, 48px, 0)"}}),C=Object(a.a)({from:{transform:"translate3d(0, 48px, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),y=Object(a.a)({from:{transform:"translate3d(0, -48px, 0)"},to:{transform:"translate3d(0, 0, 0)"}});function v(e,t,n){return e+" "+t+" "+n}!function(e){e.duration1="100ms",e.duration2="200ms",e.duration3="300ms",e.duration4="400ms"}(r||(r={})),function(e){e.accelerate="cubic-bezier(0.9, 0.1, 1, 0.2)",e.decelerate="cubic-bezier(0.1, 0.9, 0.2, 1)",e.linear="cubic-bezier(0, 0, 1, 1)",e.standard="cubic-bezier(0.8, 0, 0.2, 1)"}(o||(o={})),function(e){e.fadeIn=v(s,r.duration1,o.linear),e.fadeOut=v(c,r.duration1,o.linear),e.scaleDownIn=v(d,r.duration3,o.decelerate),e.scaleDownOut=v(u,r.duration3,o.decelerate),e.slideLeftOut=v(l,r.duration1,o.accelerate),e.slideRightOut=v(f,r.duration1,o.accelerate),e.slideLeftIn=v(m,r.duration1,o.decelerate),e.slideRightIn=v(p,r.duration1,o.decelerate),e.slideUpOut=v(g,r.duration1,o.accelerate),e.slideDownOut=v(h,r.duration1,o.accelerate),e.slideUpIn=v(C,r.duration1,o.decelerate),e.slideDownIn=v(y,r.duration1,o.decelerate)}(i||(i={}))},99:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r,o=n(16),i=n(8);function a(e,t,n,r,a){return Object(o.b)(i.a.SelectCommentType,{selectedCard:t,selectedPost:n,selectType:r,source:a},e)}!function(e){e[e.ExpandCard=0]="ExpandCard",e[e.CollapseCard=1]="CollapseCard",e[e.SelectPost=2]="SelectPost"}(r||(r={}))}},[[1401,2,0,1]]]);
//# sourceMappingURL=sharedComments.min.js.map